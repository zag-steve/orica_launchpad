//@ui5-bundle sap/ui/comp/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/DateRangeType", ["sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/DatePicker","sap/m/Text","sap/m/Select","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/model/type/Integer","sap/ui/model/Sorter","sap/ui/model/Filter","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/CustomDynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/base/util/UriParameters","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos"],function(jQuery,e,t,a,n,i,r,o,s,l,u,g,T,p,f,E,d,c,D,I,h,y,v,m,_,N,O,A,R){"use strict";var S=a.ValueState;var C=i.PlacementType;var F=Object.keys(i.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var x;var P;var M;var Y=d.extend("sap.ui.model.type.NullableInteger",{parseValue:function(e,t){if(this.getPrimitiveType(t)=="string"){if(e===""){return null}}return d.prototype.parseValue.apply(this,arguments)}});var L=e.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(t,a,i){e.apply(this,[t,a,i]);this.oDateFormat=a&&a._oDateFormatSettings?a._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var r=this.oFieldMetadata&&this.oFieldMetadata.name,o=a&&a._oAdditionalConfiguration&&a._oAdditionalConfiguration.getControlConfigurationByKey(t)||r&&a._oAdditionalConfiguration.getControlConfigurationByKey(r);this._bSingleFilterRestriction=i&&i.filterRestriction===n.smartfilterbar.FilterType.single&&(a._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=i&&i.filterRestriction===n.smartfilterbar.FilterType.interval&&i.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});L.prototype.applySettings=function(t){e.prototype.applySettings.apply(this,arguments);if(t&&t.ignoreTime){this._bIgnoreTime=t.ignoreTime}};L.setStartTime=function(e){e=L.toUniversalDate(e);return h.resetStartTime(e)};L.setEndTime=function(e,t){e=L.toUniversalDate(e);if(!t){return h.resetEndTime(e)}else{return h.resetStartTime(e)}};L.toUniversalDate=function(e){if(e instanceof Date){return T.getInstance(e)}if(!e){return T.getInstance()}if(!(e instanceof T)){return L.toUniversalDate(new Date(e))}return e};L.getWeekStartDate=function(e){return h.getWeekStartDate(e)};L.getMonthStartDate=function(e){return h.getMonthStartDate(e)};L.getQuarterStartDate=function(e){return h.getQuarterStartDate(e)};L.getYearStartDate=function(e){return h.getYearStartDate(e)};L.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new T}else{a=new T(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=h.getWeekStartDate(a);break;case"MONTH":a=h.getMonthStartDate(a);break;case"QUARTER":a=h.getQuarterStartDate(a);break;case"YEAR":a=h.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return h.getRange(e,t,a,false)};L.getTextField=function(t,a){var n=e._createStableId(t,"text");if(t._oOperationSelect){var i=t._oOperationSelect.getAriaLabelledBy();var r=false;for(var o=0;o<i.length;o++){if(n===i[o]){r=true;break}}if(!r){t._oOperationSelect.addAriaLabelledBy(n)}}if(a){return new s(n,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:t.oDateFormat.style,pattern:t.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:t.oDateFormat.style,pattern:t.oDateFormat.pattern})+"}"})}else{return new s(n,{text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:t.oDateFormat.style,pattern:t.oDateFormat.pattern}}})}};L.getIntField=function(t){return new r(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:new Y({},{minimum:0,maximum:t._maxIntValue})},textAlign:"End",width:"100%"})};L.getIntFromToField=function(t,a,n){var i=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var r=t._createIntFromToControl(t,"fieldFrom","value1");i.setLabelFor(r);a.push(r);i=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var o=t._createIntFromToControl(t,"fieldTo","value2");i.setLabelFor(o);a.push(o);t._setIntControlBinding(r,n,"value1");t._setIntControlBinding(o,n,"value2")};L.ControlFactory=function(t,a,n){if(n.type==="range"){var i=L.getTextField(t,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);return}if(n.type==="int"){var i=L.getIntField(t);a.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var t=n.descriptionTextKeys[0];var a=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return e.getTranslatedText(t)}else{return e.getTranslatedText(a||t)}}})}}if(n.type==="[int,int]"){L.getIntFromToField(t,a,n)}};L._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};L._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};L._IntFromToOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("-{0}")>=0&&this.basicLanguageText.indexOf("+{1}")>=0){var a=new RegExp(this.basicLanguageText.replace("/","\\/").replace("-{0}","(\\- (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)").replace("+{1}","(\\+ (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)")+"$","i");var n=e.match(a);if(n){var i=n[3];var r=n[9];if(i&&r){var o=parseInt(i);var s=parseInt(r);if(t._isValidFromToPeriod(o,s)){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",s);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};L._DateOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length);if(a.length>0&&a[0]===" "){a=a.trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=t._getDateFormatter(true);var i=n.parse(a);if(i){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",i);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}return false};L._DateWithDefaultsOnChangeHandler=function(e,t){var a,n,i,r,o,s=e.toLowerCase().indexOf(this.languageText.toLowerCase())===0;if(s){a=t._getDateFormatter(true);n=typeof this.defaultValues==="function"&&this.defaultValues();i=n[0]&&n[0].oDate;if(e.indexOf(this.languageText+" ")===0){r=e.slice(this.languageText.length+1);if(r[0]==="("&&r[r.length-1]===")"){r=r.slice(1,r.length-1)}}o=a.parse(r);if(o instanceof Date&&o.getTime()!==i.getTime()){return false}}return L._DateOnChangeHandler.apply(this,arguments)};L._DateRangeOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length).trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=a.split("-")[0];var i=a.split("-")[1];var r=t._getDateFormatter(true);var o=r.parse(n);var s=r.parse(i);if(o&&s){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",s);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};L._MonthOnChangeHandler=function(e,t){var a;var n=false;if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){a=e.slice(this.languageText.length).trim();if(a.indexOf("(")==0){a=a.slice(1);a=a.slice(0,a.length-1)}n=true}else{a=e}var i=this.getValueList();var r=-1;i.some(function(e,t){var n=e.text.toLowerCase()===a.toLowerCase();if(n){r=t}return n});if(r>-1){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",r);t.oModel.setProperty("inputstate","NONE",t.getContext());return true}else{if(n){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return n}};L._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};L._HideFilterSuggestItem=function(e,t,a){return false};L._IntFilterSuggestItem=function(t,a,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||e.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var s=t.split(" ");if(s.length<1||s.length>3){return false}var l=false;var u;var g=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(s[0].toLowerCase())){if(s[1]){if(g(s[1])){u=s[1];if(s[2]){if(o.toLowerCase().startsWith(s[2].toLowerCase())){l=true}}else{l=true}}}else{l=true}}else if(g(s[0])&&s.length<3){u=s[0];if(s[1]){if(o.toLowerCase().startsWith(s[1].toLowerCase())){l=true}}else{l=true}}else if(o.toLowerCase().startsWith(s[0].toLowerCase())&&s.length==1){l=true}if(l&&u){var T;switch(this.category){case"DYNAMIC.DATE.INT":T="DAY";break;case"DYNAMIC.WEEK.INT":T="WEEK";break;case"DYNAMIC.MONTH.INT":T="MONTH";break;case"DYNAMIC.QUARTER.INT":T="QUARTER";break;case"DYNAMIC.YEAR.INT":T="YEAR";break;default:T="DAY";break}var p=parseInt(u),f=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(p>n._maxIntValue){l=false}if(this.key.startsWith("LAST")){p=p*-1;f=false}var E;if(this.getDateRange){var d=this.getDateRange({operation:this.key,value1:p});E=[d.value1,d.value2]}else{E=L.getDateRange(p,T,true,f,f)}var c=n._getDateFormatter(true);if(Math.abs(p)===1&&this.singulareBasicLanguageText){a.setText(this.singulareBasicLanguageText);if(T!=="DAY"){a.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}else{a.setAdditionalText(c.format(E[0]))}}else{a.setText(n._fillNumberToText(this.basicLanguageText,u));a.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}a._value1=parseInt(u)}else{a.setAdditionalText(null);a.setText(this.languageText);a._value1=null}return l};L._IntFromToFilterSuggestItem=function(e,t,a){var n=new RegExp("(\\- ([0-9]+))","i"),i=new RegExp("(\\+ ([0-9]+))","i"),r=new RegExp("(\\- ((\\(-)?([0-9]+)(\\)))?)","i"),o=new RegExp("(\\+ ((\\(-)?([0-9]+)(\\)))?)","i"),s=e.match(n),l=e.match(i),u=e.match(r),g=e.match(o);if(!s&&!u||!l&&!g){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var T=function(e,t){if(e&&!isNaN(e[2])){return parseInt(e[2])}else if(t&&t[2]){var a=t[2].replace("(","").replace(")","");if(!isNaN(a)){return parseInt(a)}}return null},p,f;p=T(s,u);f=T(l,g);if(!a._isValidFromToPeriod(p,f)){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var E=a._getDateFormatter(true),d,c;d=a._getTodayFromToValueFrom(p);c=a._getTodayFromToValueTo(f);t.setText(a._fillNumberToText(this.basicLanguageText,p,f));t.setAdditionalText(E.format(d)+" - "+E.format(c));t._value1=p;t._value2=f;return true};L._DateFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i=n.parse(e);if(i){t.setText(this.languageText+" ("+n.format(i)+")");t._value1=i;return true}else{t.setText(this.languageText);t._value1=null;return false}};L._DateRangeFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i,r;var o="-";var s=false;var l=e.split(o);if(l.length===2){if(l[0].slice(l[0].length-1,l[0].length)==" "){l[0]=l[0].slice(0,l[0].length-1)}if(l[1].slice(0,1)==" "){l[1]=l[1].slice(1)}}else{l=e.split(" "+o+" ")}if(l.length<2){var u=e.split(" ");if(u.length===2){l=u}}if(l.length>=1&&l.length<=2){i=n.parse(l[0]);if(i){t._value1=i;if(l.length==2&&l[1]===""){l.splice(1,1)}if(l.length==2){r=n.parse(l[1]);if(r){t._value2=r;s=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+" "+n.format(r)+")")}}else{s=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+")")}}}if(!s){t.setText(this.languageText);t._value1=null;t._value2=null}return s};L._MonthFilterSuggestItem=function(e,t,a){var n=false;t._value1=null;var i=this.getValueList();for(var r=0;r<i.length;r++){var o=i[r];n=o.text.toLowerCase().startsWith(e.toLowerCase());if(n){t.setText(this.languageText+" ("+o.text+")");t._value1=r;break}}return n};L._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L._IntOnItemsSelected=function(e,t,a){var n=t._value1;var i=t._value2;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("/condition/value2",i);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L.getFixedRangeOperation=function(e,t,a,n,i,r){return{key:e,textKey:t,category:a,order:r||100,defaultValues:n||null,type:"range",display:"range",filterSuggestItem:i||L._DefaultFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory}};L.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,s){return{key:e,textKey:t,singularTextKey:a,zeroNumberTextKey:s,category:n,order:o,defaultValues:[i],value1:null,type:"int",descriptionTextKeys:r,onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory,_getInitialValues:function(e){return[e.value1,e.value2]}}};L.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,onChange:L._DateRangeOnChangeHandler,filterSuggestItem:L._DateRangeFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a){var n=false,i=false,r=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(r);var s=new o(e._createStableId(t,"field1"),{dateValue:{path:"$smartEntityFilter>value1"},maxDate:{path:"$smartEntityFilter>value2"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var a=e.getSource(),i=e.getParameter("valid");a.setValueState(i?S.None:S.Error);if(!n){n=true;a.getBinding("maxDate").attachChange(function(e){t.datePickerValidateLastValue(a)})}}});r.setLabelFor(s);a.push(s);r=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(r);var l=new o(e._createStableId(t,"field2"),{dateValue:{path:"$smartEntityFilter>value2"},minDate:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var a=e.getSource(),n=e.getParameter("valid");a.setValueState(n?S.None:S.Error);if(!i){i=true;a.getBinding("minDate").attachChange(function(e){t.datePickerValidateLastValue(a)})}}});r.setLabelFor(l);a.push(l)}},DATE:{key:"DATE",textKey:"CONDITION_DATERANGETYPE_DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a){var n=new o(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(n)}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a){var n=new o(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(n)}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a,n){var i=new o(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(i)}},LASTDAYS:L.createSingleIntRangeOperation("LASTDAYS","CONDITION_DATERANGETYPE_LASTDAYS","CONDITION_DATERANGETYPE_YESTERDAY","DYNAMIC.DATE.INT",1,["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],4,"CONDITION_DATERANGETYPE_TODAY"),LASTWEEKS:L.createSingleIntRangeOperation("LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEK","DYNAMIC.WEEK.INT",1,["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],8,"CONDITION_DATERANGETYPE_THISWEEK"),LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_LASTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_LASTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_LASTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",singularTextKey:"CONDITION_DATERANGETYPE_TOMORROW",zeroNumberTextKey:"CONDITION_DATERANGETYPE_TODAY",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTWEEK",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISWEEK",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new T;return[e.getMonth()]},value1:null,onChange:L._MonthOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,filterSuggestItem:L._MonthFilterSuggestItem,getControls:function(t,a,n){var i=new l(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,width:"100%",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});i.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new u({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}}),templateShareable:false});a.push(i)},getValueList:function(){var e=new T,t=[],a=p.getDateInstance({pattern:"LLLL"});e.setDate(15);e.setMonth(0);for(var n=0;n<12;n++){t.push({text:a.format(e),key:n});e.setMonth(e.getMonth()+1)}return t}},YESTERDAY:{key:"YESTERDAY",textKey:"CONDITION_DATERANGETYPE_YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return h.ranges.yesterday()},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return h.ranges.today()},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},TOMORROW:{key:"TOMORROW",textKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=h.ranges.tomorrow();return e},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},THISWEEK:L.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return h.ranges.currentWeek()},L._DefaultFilterSuggestItem,6),LASTWEEK:L.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return h.ranges.lastWeek()},L._DefaultFilterSuggestItem,7),LAST2WEEKS:L.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-2)},L._HideFilterSuggestItem,-1),LAST3WEEKS:L.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-3)},L._HideFilterSuggestItem,-1),LAST4WEEKS:L.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-4)},L._HideFilterSuggestItem,-1),LAST5WEEKS:L.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-5)},L._HideFilterSuggestItem,-1),NEXTWEEK:L.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return h.ranges.nextWeek()},L._DefaultFilterSuggestItem,9),NEXT2WEEKS:L.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(2)},L._HideFilterSuggestItem,-1),NEXT3WEEKS:L.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(3)},L._HideFilterSuggestItem,-1),NEXT4WEEKS:L.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(4)},L._HideFilterSuggestItem,-1),NEXT5WEEKS:L.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(5)},L._HideFilterSuggestItem,-1),THISMONTH:L.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return h.ranges.currentMonth()},L._DefaultFilterSuggestItem,12),LASTMONTH:L.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return h.ranges.lastMonth()},L._DefaultFilterSuggestItem,13),NEXTMONTH:L.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return h.ranges.nextMonth()},L._DefaultFilterSuggestItem,15),THISQUARTER:L.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return h.ranges.currentQuarter()},L._DefaultFilterSuggestItem,17),LASTQUARTER:L.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return h.ranges.lastQuarter()},L._DefaultFilterSuggestItem,18),NEXTQUARTER:L.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return h.ranges.nextQuarter()},L._DefaultFilterSuggestItem,20),YEARTODATE:L.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return h.ranges.yearToDate()},L._DefaultFilterSuggestItem,31),THISYEAR:L.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return h.ranges.currentYear()},L._DefaultFilterSuggestItem,26),LASTYEAR:L.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return h.ranges.lastYear()},L._DefaultFilterSuggestItem,27),NEXTYEAR:L.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return h.ranges.nextYear()},L._DefaultFilterSuggestItem,29),QUARTER1:L.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){return h.ranges.quarter(1)},L._DefaultFilterSuggestItem,22),QUARTER2:L.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){return h.ranges.quarter(2)},L._DefaultFilterSuggestItem,23),QUARTER3:L.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){return h.ranges.quarter(3)},L._DefaultFilterSuggestItem,24),QUARTER4:L.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){return h.ranges.quarter(4)},L._DefaultFilterSuggestItem,25),TODAYFROMTO:{key:"TODAYFROMTO",textKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",singularTextKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null,descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:L._IntFromToOnChangeHandler,filterSuggestItem:L._IntFromToFilterSuggestItem,onItemSelected:L._IntOnItemsSelected,getControls:L.ControlFactory}};L.SingleOperations={DATE:Object.assign({},L.Operations.DATE,{defaultOperation:true}),YESTERDAY:L.Operations.YESTERDAY,TODAY:L.Operations.TODAY,TOMORROW:L.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYWEEK",values:[]})}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYWEEK",values:[]})}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYYEAR",values:[]})}}};L.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new O).toDates({operator:"DATETOYEAR",values:[]})}}};L.DTOffsetOperations=Object.assign({},L.Operations,L.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},L.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});L.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=L.ControlFactory}e.getControls(this,t,e);return t};L.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};e.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};L.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new T(n)}if(i instanceof Date){i=new T(i)}}return[n,i]};L.prototype.getOperations=function(){if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=L.Operations;if(this._isNewDynamicDateRangeEnabled()){t=Object.assign({},t,L.NewDynamicDateRangeOperations)}for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};L.prototype.getSingleOperations=function(){var e=[];for(var t in L.SingleOperations){var a=L.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};L.prototype.getDTOffsetOperations=function(){var e=[];for(var t in L.DTOffsetOperations){var a=L.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};L.prototype._updateOperation=function(t){e.prototype._updateOperation.apply(this,[t]);if(t.languageText&&!t.basicLanguageText){t.basicLanguageText=t.languageText;if(!t.singulareBasicLanguageText&&t.singularTextKey){t.singulareBasicLanguageText=this.getTranslatedText(t.singularTextKey)}if(!t.zeroNumberLanguageText&&t.zeroNumberTextKey){t.zeroNumberLanguageText=this.getTranslatedText(t.zeroNumberTextKey)}t.languageText=this._fillNumberToText(t.languageText)}if(t.display){var a=this.getDefaultValues(t);var n=this._getDateFormatter(false);if(t.display==="start"&&a[0]!==null){t.textValue=n.format(a[0].oDate)}else if(t.display==="range"&&a&&a[0]&&a[1]){t.textValue=n.format(a[0].oDate)+" - "+n.format(a[1].oDate)}}t.suggestText=t.languageText};L.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};L.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};L.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};L.prototype.providerDataUpdated=function(e,t){};L.prototype.initialize=function(t){e.prototype.initialize.apply(this,[t]);this.oModel.suspend();var a=Object.assign({},t,true),n,i;var r=(new T).getCalendarType();if(!t.conditionTypeInfo){if(t.ranges&&t.ranges.length==1){var o;if(this.hasSemanticDate(t)&&!this._bSingleFilterRestriction){o=t.ranges[0].semantic.operation;if(t.ranges[0].semantic.value1||t.ranges[0].semantic.value1==0){n=t.ranges[0].semantic.value1}if(t.ranges[0].semantic.value2||t.ranges[0].semantic.value2==0){i=t.ranges[0].semantic.value2}if(this.getDefaultOperation().key===o){var s=this.getOperation(o),l=s&&s._getInitialValues?s._getInitialValues(t):null;if(!l){l=this.getDefaultValues(s)}if(l[0]&&l[0].oDate&&l[0].oDate.toISOString()!==t.ranges[0].value1||l[1]&&l[1].oDate&&l[1].oDate.toISOString()!==t.ranges[0].value2){o="DATERANGE"}}}else if(this.hasSemanticDate(t)&&this._bSingleFilterRestriction){o=t.ranges[0].semantic.operation;if(t.ranges[0].semantic.value1||t.ranges[0].semantic.value1==0){n=t.ranges[0].semantic.value1}t.ranges[0].value2=null;if(t.ranges[0].semantic.value2||t.ranges[0].semantic.value2==0){i=null}if(this.getDefaultOperation().key===o){var s=this.getOperation(o),l=s&&s._getInitialValues?s._getInitialValues(t):null;if(!l){l=this.getDefaultValues(s)}if(l[0]&&l[0].oDate&&l[0].oDate.toISOString()!==t.ranges[0].value1||l[1]&&l[1].oDate&&l[1].oDate.toISOString()!==t.ranges[0].value2){o="DATE"}if(l[0]&&l[0].oDate&&l[0].oDate.toISOString()===n){n=t.ranges[0].value1?t.ranges[0].value1:t.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(t)){this._customSemanticOperation=t.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){o="DATE"}else{o="DATERANGE"}}else if(this._bSingleFilterRestriction){o="DATE"}else{o="DATERANGE"}if(t.ranges[0].operation==="GE"){o="FROM"}if(t.ranges[0].operation==="LE"){o="TO"}t.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:o,value1:n||n==0?n:t.ranges[0].value1,value2:i||i==0?i:t.ranges[0].value2,calendarType:r}}}else{var s=this.getDefaultOperation(),u=s?s.key:"";if(t.value1){var g=t.value1}if(t.value2){var p=t.value2}t.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:u,calendarType:r}};if(g){t.conditionTypeInfo.data.value1=g}if(p){t.conditionTypeInfo.data.value2=p}}}if(t.conditionTypeInfo){t=t.conditionTypeInfo}if(t.name&&t.data){if(t.name!==this.getName()){I.debug("ConditionType "+this.getName()+" tries to deserialize data from "+t.name)}t=t.data}if(!t.operation){return}if(this.getOperation(t.operation)&&this.getOperation(t.operation).order<0){var f=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(t.operation);if(f>=0){t.operation="LASTWEEKS";t.value1=f+2}f=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(t.operation);if(f>=0){t.operation="NEXTWEEKS";t.value1=f+2}}var E=this.getOperation(t.operation);if(!E){if(this.getAsync()){this.setPending(true);var d=this,c=function(e){if(e.getParameter("pending")===false){d.oFilterProvider.detachPendingChange(c);d.initialize(a)}};this.oFilterProvider.attachPendingChange(c);this.oModel.resume();return}}var D;if(r!==t.calendarType&&(t.calendarType==="Islamic"||r==="Islamic")&&t.operation==="SPECIFICMONTH"){t.operation="DATERANGE";var y=parseInt(t.value1),v=T.getInstance(new Date,t.calendarType);v.setMonth(y);v=h.getMonthStartDate(v);D=h.getRange(0,"MONTH",v);t.value1=D[0].oDate.toISOString();t.value2=D[1].oDate.toISOString()}var m=this.getConditionContext().getObject();m.operation=t.operation;m.key=t.key;m.value1=null;m.value2=null;if(t.operation==="DATERANGE"){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new T(t.value1).oDate}if(typeof t.value2==="string"){t.value2=t.value2===""?null:new T(t.value2).oDate}m.value1=t.value1;m.value2=t.value2}else if(["DATE","FROM","TO"].indexOf(t.operation)!==-1){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new T(t.value1).oDate}m.value1=t.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(t.operation)!==-1){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new T(t.value1).oDate}m.value1=t.value1;if(typeof t.value2==="string"){t.value2=t.value2===""?null:new T(t.value2).oDate}m.value2=t.value2}else if(["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(t.operation)>-1){m.value1=t.value1}else if(t.operation==="SPECIFICMONTH"){m.value1=t.value1+""}else if(t.operation==="TODAYFROMTO"){m.value1=t.value1;m.value2=t.value2}else{E=this.getOperation(t.operation);D=E&&E._getInitialValues?E._getInitialValues(t):null;if(!D){D=this._getValuesFromCurrentOperation(t)}if(!D){D=this.getDefaultValues(E)}m.value1=D[0];m.value2=D[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,t)};L.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};L.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new T).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};L.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n;var i=false;var r=0;var o=0;var s=0;var l=this.oModel.getData(),u=l.currentoperation;if(u&&u.languageText){var g=u.languageText;if(this._isIntIntInterval(u)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){g=this._formatIntIntInterval(u,e)}n="NONE";if(!this._isValidFromToPeriod(e.conditionTypeInfo.data.value1,e.conditionTypeInfo.data.value2)){n="ERROR"}}else if(this._isIntInterval(u)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){g=this._formatIntInterval(u,e);n="NONE"}else if(this._bSuggestItemSelected){g=this._fillNumberToText(u.basicLanguageText);var T=u.basicLanguageText.indexOf("{0}");r=T+1;o=T;s=T+1;i=true}else{g="";n="NONE"}}else if(this._isFixedRange(u)){g=this._formatFixedRange(u,u.textValue);n="NONE"}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var p=this._calculateDateRangeValueText(u,e);var f=p.value;i=p.bSetCursor;if(f){g=this._formatFixedRange(u,f);r=g.length-1;n="NONE"}else{g=""}}else{g=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",g);if(n&&!this._isNewDynamicDateRangeEnabled()){this.oModel.setProperty("inputstate",n,this.getContext())}if(i&&!(this._oPopup&&this._oPopup.isOpen())&&this._oInput){this._oInput.$("inner").cursorPos(r);if(o<s){this._oInput.selectText(o,s)}this._oInput._lastValue=""}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};L.prototype.getFilterRanges=function(){var e,t=this.getCondition(),a=[],n;if(this._bSingleFilterRestriction){t.operation="EQ";delete t.value2}else if(t.operation==="LASTDAYS"){if(!isNaN(t.value1)){a=h.ranges.lastDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTWEEKS"){if(!isNaN(t.value1)){a=h.ranges.lastWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTMONTHS"){if(!isNaN(t.value1)){a=h.ranges.lastMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTQUARTERS"){if(!isNaN(t.value1)){a=h.ranges.lastQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTYEARS"){if(!isNaN(t.value1)){a=h.ranges.lastYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTDAYS"){if(!isNaN(t.value1)){a=h.ranges.nextDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTWEEKS"){if(!isNaN(t.value1)){a=h.ranges.nextWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMONTHS"){if(!isNaN(t.value1)){a=h.ranges.nextMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTQUARTERS"){if(!isNaN(t.value1)){a=h.ranges.nextQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTYEARS"){if(!isNaN(t.value1)){a=h.ranges.nextYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="SPECIFICMONTH"){var i=parseInt(t.value1),r=new T;if(Number.isFinite(i)){r.setDate(1);r.setMonth(i);r=h.getMonthStartDate(r);a=h.getRange(0,"MONTH",r);t.value1=a[0];t.value2=a[1]}}else if(t.operation==="TODAYFROMTO"){if(!isNaN(parseInt(t.value1))){t.value1=this._getTodayFromToValueFrom(t.value1)}if(!isNaN(parseInt(t.value2))){t.value2=this._getTodayFromToValueTo(t.value2)}}else{var o=this.getOperation(t.operation);if(o&&o.getDateRange){n=o.getDateRange(t);if(!n){return[]}t.value1=n&&n.value1?n.value1:null;t.value2=n&&n.value2?n.value2:null}}if(t.value1 instanceof T){t.value1=t.value1.oDate}if(t.value2 instanceof T){t.value2=t.value2.oDate}if(t.operation==="DATE"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="BT";t.value2=t.value1;t.value1=L.setStartTime(t.value1).oDate;t.value2=L.setEndTime(t.value2,this._bIgnoreTime,this._Precision).oDate}else if(t.operation==="FROM"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="GE";delete t.value2;t.value1=L.setStartTime(t.value1,this._bIgnoreTime).oDate}else if(t.operation==="TO"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="LE";delete t.value2;t.value1=L.setEndTime(t.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(!(this.isValidCondition()&&t.value1)){return[]}}else if(t.operation==="DATETIME"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="EQ";delete t.value2}else if(t.operation==="DATETIMERANGE"){if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT"}else{if(n){t.operation=n.operation;t.value1=t.value1?L.setStartTime(t.value1).oDate:null;t.value2=t.value2?L.setEndTime(t.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT";t.value1=L.setStartTime(t.value1).oDate;t.value2=L.setEndTime(t.value2,this._bIgnoreTime).oDate}}t.exclude=false;t.keyField=t.key;delete t.key;if(this._isNewDynamicDateRangeEnabled()&&t.value2){if(typeof t.value1.getTime==="function"&&typeof t.value2.getTime==="function"&&t.value1.getTime()>t.value2.getTime()){e=t.value2;t.value2=t.value1;t.value1=e}}return[t]};L.prototype.getTokenText=function(){return""};L.prototype.getName=function(){return this.getMetadata().getName()};L.prototype.getType=function(){return"Edm.Date"};L.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return S.Error}else{return S.None}}})};L.prototype.initializeFilterItem=function(){if(this._isNewDynamicDateRangeEnabled()){return this._initializeFilterItemNew.apply(this,arguments)}return this._initializeFilterItemOld.apply(this,arguments)};L.prototype._initializeFilterItemOld=function(){this._oInput=new r(e._createStableId(this),{value:"{$smartEntityFilter>formattedText}",showValueHelp:true,showSuggestion:true,maxSuggestionWidth:"auto",valueHelpRequest:this._toggleOpen.bind(this)});this._oInput._highlightListText=function(){var e,t,a=this._oList.$().find(".sapMDLILabel, .sapMSLITitleOnly");for(e=0;e<a.length;e++){t=a[e];t.innerHTML=this._createHighlightedText(t)}};this._bindValueState(this._oInput);this._oInput.bindAggregation("suggestionItems",{path:"$smartEntityFilter>operations",sorter:new c("order",false,false),filters:new D("order",function(e){return e!==undefined&&e>-1}),template:new u({key:{path:"$smartEntityFilter>key"}}),templateShareable:false});this._oInput.setFilterFunction(function(e,t){if(this._oPopup&&this._oPopup.isOpen()){return false}var a=this.getOperation(t.getKey());e=e.trim();if(e==="?"){L._DefaultFilterSuggestItem.call(a,e,t,this);return a.category!=="DYNAMIC.DATERANGE"&&a.category!=="DYNAMIC.DATE"}if(a.filterSuggestItem){return a.filterSuggestItem(e,t,this)}else{return L._DefaultFilterSuggestItem.call(a,e,t,this)}}.bind(this));this._oInput.attachSuggestionItemSelected(function(e){var t=e.getParameter("selectedItem");if(!t){return}var a=t.getKey();var n=this.getOperation(a);var i=e.oSource.getValue().trim();if(n.onItemSelected){n.onItemSelected(i,t,this);return}else{L._DefaultOnItemSelected.call(n,i,t,this)}}.bind(this));this._oInput.attachChange(function(e){var t=e.getParameter("value");if(t){var a=this.getOperations();var n=a.some(function(e){if(e.onChange){return e.onChange(t,this)}else{return L._defaultOnChangeHandler.call(e,t,this)}},this);if(!n){this.oModel.setProperty("inputstate","ERROR",this.getContext())}}else{this.setCondition({key:this.sFieldName,operation:"FROM",value1:null,value2:null});this.oModel.setProperty("inputstate","NONE",this.getContext())}}.bind(this));this._oInput.attachBrowserEvent("focusin",function(e){if(jQuery(e.target).hasClass("sapMInputBaseInner")&&this._oPopup&&this._oPopup.isOpen()){this._oPopup.close()}}.bind(this));this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};L.prototype._toggleOpen=function(a){if(!this._oPopup){if((!x||!P||t.system.phone&&!M)&&!this._bPopoverRequested){x=sap.ui.require("sap/m/ResponsivePopover");P=sap.ui.require("sap/m/VBox");if(t.system.phone){M=sap.ui.require("sap/m/Button");if(!x||!P||!M){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox","sap/m/Button"],b.bind(this));this._bPopoverRequested=true}}else if(!x||!P){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox"],b.bind(this));this._bPopoverRequested=true}}if(!x||!P||t.system.phone&&!M){return}this._oPopupLayout=new P;this._oPopupLayout.addStyleClass("sapUiCompDateRangeType");this._initializeFilterItemPopoverContent(this._oPopupLayout);this._oPopup=new x({showCloseButton:false,showArrow:true,showHeader:false,horizontalScrolling:false,placement:C.VerticalPreferedBottom,content:this._oPopupLayout,contentWidth:"18rem",afterClose:function(){if(K(this._oPopup)){this._oPopup.getModel("$smartEntityFilter").refresh(true)}if(this.oFilterProvider._oSmartFilter.getLiveMode()){var e=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar");this.oFilterProvider._oSmartFilter.triggerSearch(e.LIVE_MODE_INTERVAL)}}.bind(this)});this._oPopup.addAriaLabelledBy(this._oOperationLabel);if(t.system.phone){this._oPopup.setBeginButton(new M({text:e.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_CLOSEBUTTON"),type:"Emphasized",press:function(e){this._oPopup.close()}.bind(this)}))}sap.ui.getCore().getMessageManager().registerObject(this._oPopup,true);this._oPopup.setModel(this.getModel(),"$smartEntityFilter");this._oPopup._oControl.oPopup.setAutoCloseAreas([this._oInput.getDomRef()])}if(!this._oPopup.isOpen()){this._oPopup.openBy(this._oInput._getValueHelpIcon())}else{this._oPopup.close()}};function b(e,t,a){x=e;P=t;M=a;this._bPopoverRequested=false;if(!this._bIsBeingDestroyed){this._toggleOpen()}}function K(e){var t,a,n=false,i=e.getContent()[0].getItems();for(t=0;t<i.length;t++){a=i[t];if(a.getMetadata().getName()==="sap.m.DatePicker"&&a.getValueState()!==S.None){n=true;break}}return n}L.prototype.datePickerValidateLastValue=function(e){var t;if(!e.isValidValue()){t=e.getValue();e.resetProperty("value");e.setValue(t);if(e.isValidValue()){e.setValueState(e.isValidValue()?S.None:S.Error)}}};L.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=p.getInstance(t)}return this._oDateFormatter};L.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};L.prototype._setIntControlBinding=function(t,a,n){t.setFieldWidth("auto");t.bindProperty("description",{path:"$smartEntityFilter>"+n,type:"sap.ui.model.type.Integer",formatter:function(){var t=a.descriptionTextKeys[0];var n=a.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return e.getTranslatedText(t)}else{return e.getTranslatedText(n||t)}}})};L.prototype._createIntFromToControl=function(t,a,n){return new r(e._createStableId(t,a),{value:{path:"$smartEntityFilter>"+n,type:new Y({},{minimum:-t._maxIntValue,maximum:t._maxIntValue})},ariaLabelledBy:t._oOperationSelect||null,textAlign:"End",width:"100%"})};L.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};L.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=h.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return h.getRange(-e,"DAY")[0]};L.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=h.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return h.getRange(e,"DAY")[1]};L.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};L.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(this._oPopup){sap.ui.getCore().getMessageManager().unregisterObject(this._oPopup);this._oPopup.destroy()}e.prototype.destroy.apply(this,arguments)};L.prototype._initializeFilterItemNew=function(){this._createCustomDDOptions(this.getOperations());var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this._oInput=new y(e._createStableId(this),{name:this.sFieldName,formatter:m.getInstance({date:t}),enableGroupHeaders:!this._bSingleFilterRestriction,options:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.map(function(e){if(F.includes(e.key)){return e.key}return this._getCustomDDOptionName(e.key)}.bind(this))}.bind(this)},value:this._getDefaultValueDDR(),change:this._onDDRChange.bind(this)});this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};L.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}if(this._isNewDynamicDateRangeEnabled()){this._createCustomDDOptions(e)}this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};L.prototype.setCondition=function(t){e.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,t);return this};L.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};L.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!F.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};L.prototype._getDDROption=function(e){if(F.includes(e)){return v.getOption(e)}return v.getOption(this._getCustomDDOptionName(e))};L.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};L.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};L.prototype._createCustomDDOptions=function(e){e.forEach(this._createCustomDDOption,this)};L.prototype._createCustomDDOption=function(e){if(F.includes(e.key)){return}var t;var a=typeof e.category==="object"?e.category.key:e.category;if(a.toLowerCase().startsWith("fixed")||e.type==="range"){t=this._createCustomFixedDDOption(e)}else{t=this._createCustomDynamicDDOption(e)}t.getGroupHeader=function(){if(typeof e.category==="object"){var t=e.category.bundle;var a=e.category.key;if(sap.ui.getCore().getLibraryResourceBundle(t).hasText(a)){return sap.ui.getCore().getLibraryResourceBundle(t).getText(a)}}if(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText(e.category)}if(sap.ui.getCore().getLibraryResourceBundle("sap.m").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText(e.category)}return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("DDR_OPTIONS_GROUP_0")};t.getGroup=function(){return e.order};v.addOption(t)};L.prototype._createCustomFixedDDOption=function(t){var a=this;var n=new _({key:this._getCustomDDOptionName(t.key),getText:function(){return t.languageText||e.getTranslatedText(t.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!a.getOperation(a._getOptionName(t.key))){return false}var e=typeof t.category==="object"?t.category.key:t.category;if(e.toUpperCase().startsWith("FIXED.")&&t.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(){var e=t.defaultValues;if(typeof e==="function"){e=e()}return e},parse:function(a){var n=t.basicLanguageText||t.languageText||e.getTranslatedText(t.textKey);if(a&&n&&n.toLowerCase().startsWith(a.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return n};L.prototype._createCustomDynamicDDOption=function(t){var a=this;var n=new _({key:this._getCustomDDOptionName(t.key),getText:function(){var n=t.languageText||e.getTranslatedText(t.textKey);if(n.indexOf("{0}")>=0){return a._fillNumberToText(n)}return n},getValueHelpUITypes:function(){if(t.type==="int"){return[new N({type:"int"})]}else if(t.type==="[int,int]"){return[new N({type:"int"}),new N({type:"int"})]}},createValueHelpUI:function(e,n){e.aControlsByParameters={};e.aControlsByParameters[this.getKey()]=[];a.setControls([]);var i=a.getControls(t),r=t.defaultValues.length,o=t.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(t){if(!t.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}t.setValue(o[0]);o.shift();a.oModel.setProperty("/condition/value"+(r-o.length),t.getValue())}if(typeof n==="function"){t.attachChange(function(){n(this)},this)}e.aControlsByParameters[this.getKey()].push(t)},this);a.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var t=a.oModel.getProperty("",a.oConditionContext),n=t.operation,i=t.value1,r=t.value2;t.operation=a._getOptionName(e.operator);t.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];t.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=a.getFilterRanges();t.operation=n;t.value1=i;t.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(e){var n=new u({key:t.key}),i=t.filterSuggestItem.call(t,e,n,a);if(i){return{operator:this.getKey(),values:[n._value1,n._value2||null]}}return null},validateValueHelpUI:function(e){var t=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var n=this.getValueHelpUITypes();for(var i=0;i<n.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(n[i].getType()){case"int":return t.call(a,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return n};L.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var s=o.value;if(s){r=this._formatFixedRange(a,s)}else{r=""}}else{r=""}}}return r};L.prototype._isNewDynamicDateRangeEnabled=function(){if(!this.oFieldMetadata||this._bSingleFilterRestriction){return true}return!this.oFieldMetadata.disableNewDateRangeControl};L.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};L.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};L.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};L.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};L.prototype._isFixedRange=function(e){return e.textValue};L.prototype._formatFixedRange=function(e,t){if(this._isNewDynamicDateRangeEnabled()){return e.languageText}return e.languageText+" ("+t+")"};L.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n&&!(this._oPopup&&this._oPopup.isOpen())){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};L.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};L.prototype._prepareDDRValues=function(e,t,a){var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._getDDROption(a).toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=R.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=R.localToUiTimezone(i[1].oDate)}}return this._convertUniversalDateToDate(i)};L.prototype._setDDROperation=function(e){if(this._isNewDynamicDateRangeEnabled()&&this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=R.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=R.uiTimezoneToLocal(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return L});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/Type", ["sap/ui/base/EventProvider","sap/ui/model/json/JSONModel","sap/m/Select","sap/ui/core/ListItem","sap/m/Label","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/core/date/UniversalDate"],function(t,e,o,i,n,r,a,s){"use strict";var l=t.extend("sap.ui.comp.config.condition.Type",{constructor:function(o,i,n){t.call(this);this.oFilterProvider=i;var r={condition:{operation:"",value1:null,value2:null,key:o},operations:[],controls:[],currentoperation:{},pending:false};this.oModel=new e(r);var a=this.oModel.checkUpdate;this.oModel.suspend=function(){this.bSuspended=true;this.checkUpdate=function(){}};this.oModel.resume=function(){this.bSuspended=false;this.checkUpdate=a;this.checkUpdate()};this.oContext=this.oModel.getContext("/");this.oConditionContext=this.oModel.getContext("/condition");this.sFieldName=o;var s=this.oModel.bindProperty("operation",this.oConditionContext),l=this;s.attachChange(function(){var t=l.oModel.getProperty("operation",l.getConditionContext()),e=l.getOperation(t);if(e){e=Object.assign({},e);if(!l.bIgnoreBindingChange){var o=l.getDefaultValues(e);if(l._bSingleFilterRestriction&&o[0]){l.setDefaultValues(o[0].oDate,o[1])}else{l.setDefaultValues(o[0],o[1])}}}l.setControls([]);l.setControls(l.getControls(e));if(e){if(e.getValueList){e.valueList=e.getValueList()}l.oModel.setProperty("/currentoperation",e)}if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var u=this.oModel.bindProperty("value1",this.oConditionContext);u.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var d=this.oModel.bindProperty("value2",this.oConditionContext);d.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var p=this.oModel.bindProperty("pending",this.oContext);p.attachChange(function(){if(l.bAsync){if(l._iPendingTimer){clearTimeout(l._iPendingTimer)}l._iPendingTimer=setTimeout(l["fireEvent"].bind(l,"PendingChange",{oSource:l,pending:l.oModel.getProperty("/pending")}),10)}});this._oOperationSelect=null;this.oFieldMetadata=n;this.oOperationFilter=null;this.bAsync=false}});l._createStableId=function(t,e){if(t&&t.oFilterProvider&&t.oFieldMetadata){return t.oFilterProvider._createFilterControlId(t.oFieldMetadata)+(e?e:"")}else{return undefined}};l.getTranslatedText=function(t,e){if(typeof t==="object"){e=t.bundle;t=t.key}if(!e){e="sap.ui.comp"}return sap.ui.getCore().getLibraryResourceBundle(e).getText(t)||t};l.prototype.getTranslatedText=l.getTranslatedText;l.prototype.applySettings=function(t){if(t&&t.defaultOperation){this._sSettingsDefaultOperation=t.defaultOperation}if(t&&t.defaultDate&&!t.defaultOperation){var e=new Date(t.defaultDate);if(e instanceof Date){this._sSettingsDefaultOperation="DATE";this._defaultDate=t.defaultDate}}if(t&&t.operations&&t.operations.filter){this.oOperationFilter=t.operations.filter}else{this.oOperationFilter=null}};l.prototype.getParent=function(){return this.oFilterProvider._oSmartFilter};l.prototype.getModel=function(){return this.oModel};l.prototype.getConditionContext=function(){return this.oConditionContext};l.prototype.setDefaultValues=function(t,e){this.oModel.setProperty("value1",t,this.getConditionContext(),true);this.oModel.setProperty("value2",e,this.getConditionContext(),true)};l.prototype.getContext=function(){return this.oContext};l.prototype.getControls=function(t){return[]};l.prototype.getOperations=function(){return[]};l.prototype.isPending=function(){return this.getModel().getProperty("pending",this.getContext())};l.prototype.attachPendingChange=function(t){this.attachEvent("PendingChange",t)};l.prototype.detachPendingChange=function(t){this.detachEvent("PendingChange",t)};l.prototype.setPending=function(t){if(this.bAsync){this.getModel().setProperty("pending",t,this.getContext())}};l.prototype._filterOperation=function(t){if(!this.oOperationFilter){return true}var e=Array.isArray(this.oOperationFilter)?this.oOperationFilter:[this.oOperationFilter],o;e.some(function(e){if(!e.path){return false}var i=t[e.path];var n=e.exclude||false;var r;if(e.contains&&i){r=typeof e.contains==="string"?e.contains.split(","):e.contains;o=n;for(var a=0;a<r.length;a++){if(n&&i.indexOf(r[a])>-1){o=false;return true}else if(!n&&i.indexOf(r[a])>-1){o=true;return true}}}if(e.equals&&i){r=typeof e.equals==="string"?e.equals.split(","):e.equals;o=n;for(var a=0;a<r.length;a++){if(n&&i===r[a]){o=false;return true}else if(!n&&i===r[a]){o=true;return true}}}return false});return o};l.prototype._updateOperation=function(t){if(!t.textValue){t.textValue=""}if(!t.languageText&&t.textKey){t.languageText=this.getTranslatedText(t.textKey)}};l.prototype.updateOperations=function(){this.oModel.setProperty("operations",[],this.getContext())};l.prototype.getOperation=function(t){var e=this.oModel.getProperty("operations",this.getContext())||[];for(var o=0;o<e.length;o++){if(t===e[o].key){return e[o]}}return null};l.prototype.getDefaultOperation=function(){var t=this.getOperations();if(!t||t.length===0){return null}for(var e=0;e<t.length;e++){if(this._sSettingsDefaultOperation===t[e].key){if(this._defaultDate&&t[e].key==="DATE"){t[e].defaultValues=[new s(this._defaultDate).oDate];this._defaultDate=null}return t[e]}if(!this._sSettingsDefaultOperation&&t[e].defaultOperation){if(!this._defaultDate&&t[e].key==="DATE"&&t[e].defaultValues&&t[e].defaultValues[0]){t[e].defaultValues=[null]}return t[e]}}return t[0]};l.prototype.setControls=function(t){var e=this.oModel.getProperty("controls",this.getContext());var o;if(e){for(o=0;o<e.length;o++){e[o].destroy()}}this.oModel.setProperty("controls",t,this.getContext());if(t){for(o=0;o<t.length;o++){t[o].setBindingContext(this.getConditionContext(),"$smartEntityFilter")}this._setAriaLabeledByToControls(t)}};l.prototype._setAriaLabeledByToControls=function(t){if(this._oOperationLabel&&t){for(var e=0;e<t.length;e++){if(t[e].addAriaLabelledBy){if(t[e].getAriaLabelledBy().indexOf(this._oOperationLabel.getId())===-1){t[e].addAriaLabelledBy(this._oOperationLabel)}}}}};l.prototype.setOperation=function(t){var e=this.getOperation(t);if(e){this.setCondition({operation:e.key,key:this.sFieldName,value1:e.defaultValues[0]||null,value2:e.defaultValues[1]||null});this.getModel().checkUpdate(true)}else{}};l.prototype.isValidCondition=function(){return false};l.prototype.setCondition=function(t){this.oModel.setProperty("key",t.key,this.oConditionContext);this.oModel.setProperty("operation",t.operation,this.oConditionContext);this.oModel.setProperty("value1",t.value1,this.oConditionContext);this.oModel.setProperty("value2",t.value2,this.oConditionContext);this.oModel.setProperty("tokenText",this.getTokenText(t),this.oConditionContext);return this};l.prototype.setAsync=function(t){this.bAsync=t};l.prototype.getAsync=function(t){return this.bAsync};l.prototype.initialize=function(t){this.updateOperations()};l.prototype.serialize=function(){};l.prototype.validate=function(t){this._bForceError=t!==false;var e=this.getModel().getProperty("inputstate",this.getContext())||"NONE";if(!this.isPending()&&this.oFieldMetadata&&this.oFieldMetadata.isMandatory&&(!this.isValidCondition()||e!=="NONE")&&this._bForceError){this.getModel().setProperty("inputstate","ERROR",this.getContext());return false}this.getModel().setProperty("inputstate","NONE",this.getContext());return true};l.prototype.getCondition=function(){var t=Object.assign({},this.oModel.getProperty("",this.oConditionContext));return t};l.prototype.providerDataUpdated=function(t,e){};l.prototype.getFilter=function(t){return null};l.prototype.getFilterRanges=function(t){return null};l.prototype.getTokenText=function(t){return""};l.prototype.getName=function(){return this.getMetadata().getName()};l.prototype.getType=function(){return"Edm"};l.prototype._initializeFilterItemPopoverContent=function(t){var e=new n({text:l.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_LABEL")});t.addItem(e);this._oOperationLabel=e;var s=new o(l._createStableId(this,"select"),{width:"100%"});if(s._oList&&s._oList.setShowSecondaryValues){s._oList.setShowSecondaryValues(true)}s.bindProperty("selectedKey",{path:"$smartEntityFilter>condition/operation"});s.bindAggregation("items",{path:"$smartEntityFilter>operations",sorter:new r("order",false,false),filters:new a("order",function(t){return t!==undefined&&t>-1}),template:new i({text:{path:"$smartEntityFilter>languageText"},key:{path:"$smartEntityFilter>key"},additionalText:{path:"$smartEntityFilter>textValue"}})});s.setBindingContext(this.getContext(),"$smartEntityFilter");var u=this.getModel().bindList("controls",this.getContext());u.attachChange(function(){var e=u.getModel().getProperty("controls",u.getContext());if(e){for(var o=0;o<e.length;o++){t.addItem(e[o])}}});t.addItem(s);e.setLabelFor(s);this._oOperationSelect=s;t.setModel(this.getModel(),"$smartEntityFilter");this.bIgnoreBindingChange=true;this.getModel().checkUpdate(true);this.bIgnoreBindingChange=false;this.oLayout=t};l.prototype.destroy=function(){this.setControls([]);this.oLayout=null;t.prototype.destroy.apply(this,arguments)};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterBar", ["sap/ui/core/library","sap/m/Button","sap/m/Label","sap/m/Panel","sap/m/Text","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/Device","sap/ui/comp/state/UIState","./VariantConverterFrom","./VariantConverterTo","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagementUi2","sap/ui/core/InvisibleText","sap/ui/layout/Grid","sap/ui/layout/GridRenderer","sap/ui/layout/GridData","sap/ui/layout/HorizontalLayout","sap/ui/layout/VerticalLayout","sap/ui/layout/AlignedFlowLayout","sap/m/library","sap/ui/model/json/JSONModel","./FilterGroupItem","sap/base/Log","sap/base/util/merge","sap/ui/core/ShortcutHintsMixin","sap/base/util/Deferred","sap/m/delegate/ValueStateMessage","sap/m/ToolbarSeparator"],function(t,e,i,r,a,n,s,o,l,h,d,u,f,_,c,p,g,m,F,A,y,v,I,b,V,S,B,C,T){"use strict";var M=t.ValueState;var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SEARCH_FIELD_VALIDATION_WARNING_MESSAGE");var D=t.TextAlign;var L=y.ButtonType;var T;var E;var N;var x;var w;var O=c.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"},isRunningInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false},disableSearchMatchesPatternWarning:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"},firedFromFilterBar:{type:"boolean"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogSearch:{},filtersDialogCancel:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:{apiVersion:2}});O.INTERNAL_GROUP="__$INTERNAL$";O.prototype.init=function(){var t=this.getFilterContainerWidth();c.prototype.init.apply(this,arguments);this._filterGroupItemChange=this._filterGroupItemChange.bind(this);this._filterItemChange=this._filterItemChange.bind(this,null);this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._mAdvancedAreaFilterFlat=[];this._aOrderedFilterItems=[];this._aAdaptFilterItems=[];this._mAdvancedAreaHiddenFilters=[];this._mAdaptFiltersDialogInitialItemsOrder=[];this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oShowAllFiltersButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._bIsInitialized=false;this._bSearchFiredFromFilterBar=false;this._bMoveTriggered=false;this._oInitializedDeferred=new B;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._nMaxFiltersByDefault=8;this._bResetFiltersDialogTriggered=false;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar sapUiCompFilterBarMarginBottom sapUiCompFilterBarPaddingPanel sapContrastPlus");this.addStyleClass(this._isPhone()?"sapUiCompFilterBarPhone":"sapUiCompFilterBarNonPhone");this._oToolbar=this._createToolbar();this.addContent(this._oToolbar);this._bDelayRendering=true;this._bShowAllFilters=false;this._oBasicAreaLayout=new A;this._oBasicAreaLayout.setVisible(false);this._oBasicAreaLayout.setLayoutData(new g({span:"L12 M12 S12"}));this._oBasicAreaLayout.setMinItemWidth(t);this._oBasicAreaLayout.setMaxItemWidth(t);this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new r;this._oAdvancedPanel.setLayoutData(new g({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this.addContent(this._oAdvancedPanel);this.oModel=new v({});this.setModel(this.oModel,"FilterBar");this._oHintText=new a({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:D.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false)}this.getMetadata().addPublicMethods("getInitializedPromise")};O.prototype.onBeforeRendering=function(){if(c.prototype.onBeforeRendering){c.prototype.onBeforeRendering.apply(this,arguments)}if(this.getIsRunningInValueHelpDialog()){if(this._isTablet()){this.addStyleClass("compFilterBarTablet")}this.iAddedContentLength=4-this._oBasicAreaLayout.getContent().length;var t=this.iAddedContentLength;if(t<4&&t>0&&!this._bLayoutAdded){while(t>0){this._oBasicAreaLayout.addContent((new F).data("blankLayout",true));t--}this._bLayoutAdded=true}if(this._oShowAllFiltersButton===null){this.initShowAllFiltersButton()}if(this._oBasicSearchField&&this._oBasicSearchField.isA("sap.m.SearchField")){this._oBasicSearchField.setWidth("100%")}this._oBasicAreaLayout.setMaxItemWidth(null);this._oAdvancedPanel.setVisible(false);this._rerenderFilters()}else if(this._oShowAllFiltersButton){this._oBasicAreaLayout.removeEndContent(this._oShowAllFiltersButton);this._oShowAllFiltersButton=null}else{this._oHideShowButton&&this._oHideShowButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn")}};O.prototype.getShowAllFiltersButton=function(){return this._oShowAllFiltersButton};O.prototype.setFilterContainerWidth=function(t){this._oBasicAreaLayout.setMinItemWidth(t);if(this.getUseToolbar()){this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth())}else{this._setMaxItemWidth2()}this.setProperty("filterContainerWidth",t);return this};O.prototype._setMaxItemWidth2=function(){var t,e,i=this._oBasicAreaLayout.getMinItemWidth();["rem","%","px","em"].some(function(e){var r=i.indexOf(e);if(r>0){i=i.substring(0,r);t=e;return true}return false});if(t){e=parseInt(i);if(!isNaN(e)){e*=2;this._oBasicAreaLayout.setMaxItemWidth(e+t)}}};O.prototype._hasAnyVisibleFiltersOnFB=function(){var t=this._retrieveVisibleAdvancedItems();for(var e=0;e<t.length;e++){if(t[e].filterItem.getVisibleInFilterBar()){return true}}return false};O.prototype._showHintText=function(){var t=0;if(!this._oHintText){return}if(this._isNewFilterBarDesign()){return}if(!this.getAdvancedMode()&&!this._isPhone()){var e=!this._hasAnyVisibleFiltersOnFB();if(e){t=this._oAdvancedPanel.indexOfContent(this._oHintText);if(t<0){this._oAdvancedPanel.insertContent(this._oHintText,0)}}this._oHintText.setVisible(e);this._oAdvancedPanel.setVisible(e);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!e&&this.getFilterBarExpanded())}}};O.prototype._hasRelevantFilters=function(){var t,e=null,i;if(!this._mAdvancedAreaFilter||Object.keys(this._mAdvancedAreaFilter)<1){return false}if(this.getAdvancedMode()){for(e in this._mAdvancedAreaFilter){var r=this._mAdvancedAreaFilter[e];if(r&&r.items){for(t=0;t<r.items.length;t++){i=r.items[t];if(i){if(this._determineVisibility(i.filterItem)){return true}}}}}return false}return true};O.prototype._adaptButtonsEnablement=function(){var t=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(t);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters())}}this._oClearButtonOnFB.setEnabled(t);this._oRestoreButtonOnFB.setEnabled(t);this._oFiltersButton.setEnabled(t);var e=true;if(this._isPhone()&&this.getUseToolbar()){e=false}if(t&&this.getFilterBarExpanded()&&e&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true)}};O.prototype.getVariantManagement=function(){return this._oVariantManagement};O.prototype.setShowClearOnFB=function(t){this.setProperty("showClearOnFB",t);this._oClearButtonOnFB.setVisible(t);return this};O.prototype.setShowRestoreOnFB=function(t){this.setProperty("showRestoreOnFB",t);this._oRestoreButtonOnFB.setVisible(t);return this};O.prototype.setShowGoOnFB=function(t){this.setProperty("showGoOnFB",t);this._calcVisibilityGoButton();return this};O.prototype._calcVisibilityGoButton=function(){var t=this.getShowGoOnFB();if(t&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){t=false}this._oSearchButton.setVisible(t)};O.prototype.setShowGoButton=function(t){this.setShowGoOnFB(t);return this};O.prototype.getShowGoButton=function(){return this.getShowGoOnFB()};O.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false)};O.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB())};O.prototype.setShowFilterConfiguration=function(t){this.setProperty("showFilterConfiguration",t);if(this._oFiltersButton){this._oFiltersButton.setVisible(t)}return this};O.prototype.isCurrentVariantStandard=function(){var t;if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId();if(t===""){return true}return t===this._oVariantManagement.getStandardVariantKey()}return undefined};O.prototype.setCurrentVariantId=function(t,e){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(t,e)}};O.prototype.getCurrentVariantId=function(){var t="";if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId()}return t};O.prototype.getDataSuiteFormat=function(t){return this._getDataSuiteFormat(t,null)};O.prototype._getDataSuiteFormat=function(t,e){var i=null,r,a,n,s,o;if(this._oVariantManagement){r=this.getCurrentVariantId();if(this.getFilterDataAsString){n=this._determineVariantFiltersInfo(t,true);if(this.getFilterContextUrl){o=this.getFilterContextUrl()}if(this.getParameterContextUrl){s=this.getParameterContextUrl()}a=this.getFilterDataAsString(t);if(a){var l=new d;i=l.convert(r,n,a,this,e,s,o)}}}return i};O.prototype.getBasicSearchName=function(){var t=null;if(this._oBasicSearchField&&this.getEntitySet){t="$"+this.getEntitySet()+".basicSearch"}return t};O.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue()};O.prototype.setUiStateAsVariant=function(t){var e={replace:true,strictMode:true};this.setUiState(t,e);this.fireAfterVariantLoad("SPV_VARIANT",false);this._applyVisibility(t.getSelectionVariant())};O.prototype._applyVisibility=function(t){var e=function(t){if(t&&t.getVisible()&&!t.getHiddenFilter()){if(!t.getVisibleInFilterBar()){t.setVisibleInFilterBar(true)}if(!t.getPartOfCurrentVariant()){t.setPartOfCurrentVariant(true)}}};if(this._bIsInitialized){for(var i in this._mAdvancedAreaFilter){if(i){this._mAdvancedAreaFilter[i].items.forEach(function(t){if(t&&t.filterItem&&t.filterItem.getMandatory()){e(t.filterItem)}else if(t&&t.filterItem){if(t.filterItem.getVisibleInFilterBar()){t.filterItem.setVisibleInFilterBar(false)}if(t.filterItem.getPartOfCurrentVariant()){if(i===O.INTERNAL_GROUP){t.filterItem.setPartOfCurrentVariant(true)}else{t.filterItem.setPartOfCurrentVariant(false)}}}})}}if(t&&t.Parameters){t.Parameters.forEach(function(t){var i=this.determineFilterItemByName(t.PropertyName);e(i)}.bind(this))}if(t&&t.SelectOptions){t.SelectOptions.forEach(function(t){var i=this.determineFilterItemByName(t.PropertyName);e(i)}.bind(this))}}};O.prototype.getUiState=function(t){var e,i,r=false,a=null,n,s;if(t){r=t.allFilters===true}i=this._getDataSuiteFormat(r,"13.0");e=new l;e.selectionVariant=JSON.parse(i);e.setSelectionVariant(e.selectionVariant);var o=e.getSelectionVariant();if(o){if(this.getModelData&&this.getModelData()){a=this.getModelData()}s=l.calcSemanticDates(o,a);e.setSemanticDates(s);n=l.calculateValueTexts(o,a);e.setValueTexts(n);window.sessionStorage.setItem(this.getId(),JSON.stringify(n));window.sessionStorage.setItem("semanticDates",JSON.stringify(s))}return e};O.prototype.setUiState=function(t,e){var i,r,a=null,n=false,s=true,o;if(e&&typeof e.replace==="boolean"){n=e.replace}if(e&&typeof e.strictMode==="boolean"){s=e.strictMode}if(t){a=t.getSelectionVariant();if(a){r=JSON.stringify(a)}i=t.getValueTexts();o=t.getSemanticDates()}if(!i){i=JSON.parse(window.sessionStorage.getItem(this.getId()))}if(!o){o=JSON.parse(window.sessionStorage.getItem("semanticDates"))}this._setDataSuiteFormat(r,n,s,i,o);this._enhanceFilterItemsWithTextValue(i,a)};O.prototype.getDescriptionForKeys=function(t){};O.prototype._enhanceFilterItemsWithTextValue=function(t,e){var i=l.determineFiltersWithOnlyKeyValues(t,e,[this.getBasicSearchName()]);this.getDescriptionForKeys(i)};O.prototype.setDataSuiteFormat=function(t,e){this._setDataSuiteFormat(t,e,true)};O.prototype._setDataSuiteFormat=function(t,e,i,r,a){var n,s,o;if(t){n=new h;s=n.convert(t,this,i);if(s){this._clearErrorState();if(s.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(s.variantId,"DATA_SUITE")}else{this._setFilterVisibility(s.variantId)}}this._oVariantManagement.setInitialSelectionKey(s.variantId)}if(s.payload&&(e||Object.keys(JSON.parse(s.payload)).length>0)&&this.setFilterDataAsString){o=s.payload;if(r){o=l.enrichWithValueTexts(o,r)}if(a){o=l.enrichWithSemanticDates(o,a)}this.setFilterDataAsString(o,e)}if(s.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||s.basicSearch);this._updateToolbarText()}}}};O.prototype._setFilterVisibility=function(t){if(this._oVariantManagement.getSelectionKey()!==t){this._oVariantManagement.setInitialSelectionKey(t);var e=this._getStandardVariant();if(e){var i=this._oVariantManagement.getVariantContent(this,t);if(i&&i.filterbar){if(i.hasOwnProperty("version")){i=this.mergeVariant(e,i)}this._reapplyVisibility(i.filterbar)}}}};O.prototype.applySettings=function(t){if(this._possibleToChangeVariantManagement()){if(t&&t.customData){for(var e=0;e<t.customData.length;e++){var i=t.customData[e];if(i&&i.mProperties&&i.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(i.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true}}}}if(t&&t.persistencyKey){this._bHostedVariantManagement=true}c.prototype.applySettings.apply(this,arguments);if(!this.getUseToolbar()&&!this.getFilterBarExpanded()){this.setFilterBarExpanded(true)}this._afterVariantsLoad()};O.prototype.setPersistencyKey=function(t){this.setProperty("persistencyKey",t);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true)}return this};O.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true}return false};O.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection()}};O.prototype.setSearchEnabled=function(t){this.setProperty("searchEnabled",t);if(this._oSearchButton){this._oSearchButton.setEnabled(t)}return this};O.prototype.setSearchButtonEmphType=function(t){};O.prototype.setSimplifiedMode=function(t){};O.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false}return true};O.prototype.setExpandAdvancedArea=function(t){this.setFilterBarExpanded(t);return this};O.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded()};O.prototype.setAdvancedMode=function(t){this.setProperty("advancedMode",t);this.toggleStyleClass("sapContrastPlus",!t);if(t){if(!this._oAdvancedAreaForm){this._oAdvancedAreaForm=this._createAdvancedAreaForm()}if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false)}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1)}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true)}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant")}}}this._oFiltersButton.setVisible(!t);if(this._oHideShowButton){this._oHideShowButton.setVisible(t&&this._isPhone()?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"))}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"))}}}if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!t&&this.getFilterBarExpanded())}this._oAdvancedPanel.setVisible(t&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this};O.prototype.setUseToolbar=function(t){this.setProperty("useToolbar",t);if(!t){this._adaptNewFilterBarDesign()}else{this._recreateToolbar()}return this};O.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null}this._oToolbar=this._createToolbar(true);this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof f||this._oVariantManagement.getId()===this.getId()+"-variant"){this._oToolbar.insertContent(this._oVariantManagement,0)}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField)}this._oHintText=new a({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:D.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());this._updateToolbarText()}};O.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var t=this._oBasicSearchFieldContainer.removeAllContent();if(t){for(var e=0;e<t.length;e++){if(t[e]!==this._oBasicSearchField){t[e].destroy()}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null}};O.prototype.setHeader=function(t){this.setProperty("header",t);if(this.getUseToolbar()){this._addHeaderToToolbar(t)}return this};O.prototype._addHeaderToToolbar=function(t){if(this._oToolbar){if(t){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&this._oToolbar.indexOfContent(this._oVariantManagement)>-1){if(!this._oSeparator){if(!T&&!this._bToolbarSeparatorRequested){T=sap.ui.require("sap/m/ToolbarSeparator");if(!T){sap.ui.require(["sap/m/ToolbarSeparator"],P.bind(this));this._bToolbarSeparatorRequested=true}}if(T){this._oSeparator=new T(this.getId()+"-HeadSep")}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem")}if(!this._oText){this._oText=new a(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader")}this._oText.setText(t);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0)}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight()}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText}}}};function P(t){T=t;this._bToolbarSeparatorRequested=false;if(!this._bIsBeingDestroyed){this._addHeaderToToolbar(this.getHeader())}}O.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false}if(!this.getUseToolbar()){return true}return false};O.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(true&&this.getFilterBarExpanded())}if(this._oToolbar){var t=this._oToolbar.getContent();for(var e=0;e<t.length;e++){this._oToolbar.removeContent(t[e]);if(t[e].isA("sap.m.ToolbarSpacer")){t[e].destroy()}}if(!this.getUseToolbar()){this.removeContent(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea()}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField)}this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._setMaxItemWidth2()}};O.prototype._addButtonsToBasicArea=function(){var t=new F;if(sap.ui.getCore().getConfiguration().getRTL()){t.addStyleClass("sapUiCompFilterBarFloatLeft")}else{t.addStyleClass("sapUiCompFilterBarFloatRight")}var e=new m;t.addContent(new a);t.addContent(e);e.addContent(this._oSearchButton);e.addContent(this._oClearButtonOnFB);e.addContent(this._oRestoreButtonOnFB);e.addContent(this._oFiltersButton);this._updateToolbarText();this._oBasicAreaLayout.addEndContent(t);this._oButtonsVLayout=t};O.prototype._addBasicSearchToBasicArea=function(t){if(this._oBasicSearchFieldContainer){this._cleanBasicSearchContainer()}if(t){var e=new i({text:""});e.addStyleClass("sapBasicSearchFilter");var r=this._addControlToBasicAreaContainer(null,t,e);if(r){r.setVisible(true);this._oBasicAreaLayout.insertContent(r,0);this._oBasicSearchFieldContainer=r;this._oBasicSearchFieldContainer.setWidth("100%")}}};O.prototype._setCollectiveSearch=function(t){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch)}this._oCollectiveSearch=t;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant")}}};O.prototype.setBasicSearch=function(t){var e=this;this.setAssociation("basicSearch",t,true);if(typeof t==="string"){t=sap.ui.getCore().byId(t)}if(t&&t.getParent()){if(this._isUi2Mode()){t.attachLiveChange(function(t){e.fireFilterChange(t)})}this._oBasicSearchField=t;return}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField)}if(t&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(t)}else{if(t&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var i=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(t,i);if(this._isUi2Mode()){t.attachLiveChange(function(t){e.fireFilterChange(t)})}}}this._oBasicSearchField=t;return this};O.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue()}return null};O.prototype._indexOfSpacerOnToolbar=function(){var t=this._oToolbar.getContent(),e;if(t){for(e=0;e<t.length;e++){if(t[e]instanceof s){return e}}}return 0};O.prototype.addFilterItem=function(t){var e,i,r,a;if(!t){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty")}e=t.getName();if(!e){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty")}i=t._getControl();if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty")}this.addAggregation("filterItems",t,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[]}var n={control:t._getControl(),filterItem:t};this._aBasicAreaSelection.push(n);a=t.getId()+"__filterGroupItem";r=sap.ui.getCore().byId(a);if(!r){r=new I(t.getId()+"__filterGroupItem",{label:t.getLabel(),controlTooltip:t.getControlTooltip(),name:t.getName(),mandatory:t.getMandatory(),visible:t.getVisible(),visibleInFilterBar:t.getVisibleInFilterBar(),partOfCurrentVariant:true,control:t._getControl(),groupName:O.INTERNAL_GROUP,groupTitle:"",hiddenFilter:t.getHiddenFilter(),entitySetName:t.getEntitySetName(),entityTypeName:t.getEntityTypeName()})}if(t.data("isCustomField")){r.data("isCustomField",true)}t.attachChange(this._filterItemChange);this.addFilterGroupItem(r);return this};O.prototype.addFilterGroupItem=function(t){var e,i,r,a;if(!t){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty")}this.addAggregation("filterGroupItems",t,true);i=t.getGroupName();if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty")}e=t.getName();if(!e){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty")}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={}}if(!this._mAdvancedAreaFilter[i]){this._mAdvancedAreaFilter[i]={};this._mAdvancedAreaFilter[i].filterItem=null;this._mAdvancedAreaFilter[i].items=[]}if(!this._mAdvancedAreaFilter[i].items){this._mAdvancedAreaFilter[i].items=[]}if(!this._mAdvancedAreaFilter[i].filterItem){this._mAdvancedAreaFilter[i].filterItem=t}r={control:t._getControl(),filterItem:t};if(this.getAdvancedMode()||t.getVisibleInFilterBar()){t.setVisibleInFilterBar(true)}else{t.setVisibleInFilterBar(false)}this._mAdvancedAreaFilter[i].items.push(r);if(!t.getHiddenFilter()){a=this._addControlToBasicAreaFormContainer(t);if(a){r.container=a;a.setVisible(t.getVisible()&&t.getVisibleInFilterBar());if(t.getVisibleInFilterBar()){t.setPartOfCurrentVariant(t.getVisibleInFilterBar())}t.attachChange(this._filterGroupItemChange)}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA()}else{this._showHintText()}}this._adaptButtonsEnablement();return this};O.prototype.removeFilterItem=function(t){var e,i,r,a,n=this.getFilterItems(),s=this.getFilterGroupItems();if(!n||!n.length){return null}i=this._getRemovedItemAsObject(t,n);if(!i){return null}i.detachChange(this._filterItemChange);for(e=0;e<this._aBasicAreaSelection.length;e++){if(this._aBasicAreaSelection[e].filterItem.getId()===i.getId()){this._aBasicAreaSelection.splice(e,1);if(this._aBasicAreaSelection.length===0){this._aBasicAreaSelection=null}break}}this.removeAggregation("filterItems",i,true);r=i.getId()+"__filterGroupItem";a=this._getRemovedItemAsObject(r,s);this._removeFilterGroupItem(a);return i};O.prototype.removeFilterGroupItem=function(t){var e,i=this.getFilterGroupItems();if(!i||!i.length){return null}e=this._getRemovedItemAsObject(t,i);if(!e){return null}return this._removeFilterGroupItem(e)};O.prototype._getRemovedItemAsObject=function(t,e){var i,r;if(typeof t==="string"){for(i=0;i<e.length;i++){if(e[i].getId()===t){r=e[i];break}}}if(typeof t==="number"){if(t<0||t>=e.length){b.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItems() is called with invalid index "+t)}else{r=e[t]}}if(typeof t==="object"){r=t}return r};O.prototype._removeFilterGroupItem=function(t){var e,i,r,a=t.getGroupName();t.detachChange(this._filterGroupItemChange);this.removeAggregation("filterGroupItems",t,true);if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[a]&&this._mAdvancedAreaFilter[a].items){i=this._mAdvancedAreaFilter[a];for(e=0;e<i.items.length;e++){r=i.items[e];if(r.filterItem.getId()===t.getId()){r.container.removeAllContent();r.container.destroy();i.items.splice(e,1);if(i.filterItem.getId()===t.getId()){if(i.items.length){i.filterItem=i.items[0].filterItem}else{delete this._mAdvancedAreaFilter[a]}}break}}if(this.getFilterGroupItems().length===0){this._mAdvancedAreaFilter=null;this._adaptButtonsEnablement()}}return t};O.prototype._addParameter=function(t){var e,i,r,a=false,n=false,s=O.INTERNAL_GROUP;t._setParameter(true);t.setVisibleInFilterBar(true);t.setPartOfCurrentVariant(true);this.addAggregation("_parameters",t,true);i={control:t._getControl(),filterItem:t};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={}}if(!this._mAdvancedAreaFilter[s]){this._mAdvancedAreaFilter[s]={};this._mAdvancedAreaFilter[s].filterItem=null}if(!this._mAdvancedAreaFilter[s].items){this._mAdvancedAreaFilter[s].items=[]}for(e=0;e<this._mAdvancedAreaFilter[s].items.length;e++){var o=this._mAdvancedAreaFilter[s].items[e];if(o.filterItem._isParameter()){continue}this._mAdvancedAreaFilter[s].items.splice(e,0,i);a=true;break}if(!a){this._mAdvancedAreaFilter[s].items.push(i);if(Object.keys(this._mAdvancedAreaFilter).length>1){n=true}}r=this._addControlToBasicAreaFormContainer(t);if(r){i.container=r;r.setVisible(t.getVisible());t.attachChange(this._filterGroupItemChange.bind(this))}if(a||n){this._oBasicAreaLayout.removeContent(r);if(t.getVisible()){this._addContainerInOrder(i.filterItem,i.container)}}if(!this.getAdvancedMode()){this._showHintText()}this._adaptButtonsEnablement();return this};O.prototype._filterItemChange=function(t,e){var i,r,a,n;if(e&&e.oSource&&e.oSource.isA("sap.ui.comp.filterbar.FilterItem")){a=e.getParameter("propertyName");if(a==="visibleInFilterBar"||a==="visible"||a==="label"||a==="labelTooltip"||a==="controlTooltip"||a==="mandatory"){i=this._determineItemByName(e.oSource.getName(),O.INTERNAL_GROUP);if(i&&i.filterItem){if(a==="visible"){r=e.oSource.getVisible();i.filterItem.setVisible(r)}else if(a==="visibleInFilterBar"){r=e.oSource.getVisibleInFilterBar();var s=this._checkChangePossibleVisibleInFilterBar(i.filterItem,r);if(s){i.filterItem.setVisibleInFilterBar(r)}else{e.oSource.setVisibleInFilterBar(true)}}else if(a==="label"){i.filterItem.setLabel(e.oSource.getLabel())}else if(a==="labelTooltip"){i.filterItem.setLabelTooltip(e.oSource.getLabelTooltip())}else if(a==="controlTooltip"){n=this.determineControlByFilterItem(i.filterItem,true);if(n&&n.setTooltip){n.setTooltip(i.filterItem.getControlTooltip())}}else if(a==="mandatory"){r=e.oSource.getMandatory();i.filterItem.setMandatory(r)}}}}};O.prototype._filterGroupItemChange=function(t){var e;var i;if(t&&t.oSource){i=t.getParameter("propertyName");if(i==="visibleInFilterBar"||i==="visible"){e=this._determineItemByName(t.oSource.getName(),t.oSource.getGroupName());if(e){if(i==="visibleInFilterBar"){var r=t.oSource.getVisibleInFilterBar();var a=r;var n=this._checkChangePossibleVisibleInFilterBar(t.oSource,r);if(!n){t.oSource.setVisibleInFilterBar(true);a=true}if(a){t.oSource.setPartOfCurrentVariant(true)}if(!r&&!this._isFilterItemInBasicGroup(e.filterItem)){t.oSource.setPartOfCurrentVariant(false)}if(!this.getAdvancedMode()&&!this._oAdaptFiltersDialog){this._rerenderItem(e)}}else if(i==="visible"){if(!this._oAdaptFiltersDialog){if(this.getAdvancedMode()&&e.container){e.container.setVisible(true)}else{this._updateToolbarText();this._rerenderItem(e)}}}this._showHintText()}}else if(i==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[t.oSource.getGroupName()]){this._adaptGroupTitle(t.oSource.getGroupName())}}else if(i==="label"){if(!this._oAdaptFiltersDialog){this._adaptGroupTitleForFilter(t.oSource)}}else if(i==="mandatory"){this._mandatoryFilterItemChange(t.oSource)}else if(i==="partOfCurrentVariant"&&this.ensureLoadedValueHelpList){var s=this.determineFilterItemByName(t.oSource.getName());if(s&&s.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(t.oSource.getName())}}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA()}}};O.prototype._addContainer=function(t){if(t&&this._oBasicAreaLayout){if(t.container&&this._oBasicAreaLayout.indexOfContent(t.container)===-1){this._addContainerInOrder(t.filterItem,t.container)}}};O.prototype._removeContainer=function(t){if(t&&this._oBasicAreaLayout){if(t.container&&this._oBasicAreaLayout.indexOfContent(t.container)>-1){this._oBasicAreaLayout.removeContent(t.container)}}};O.prototype._addContainerInOrder=function(t,e){var i,r,a,n=this._oBasicAreaLayout.getContent(),s=-1;if(this._oBasicSearchField&&this._isNewFilterBarDesign()){s++}if(this._mAdvancedAreaFilter){for(i in this._mAdvancedAreaFilter){var o=this._mAdvancedAreaFilter[i];if(o&&o.items){for(r=0;r<o.items.length;r++){if(!o.items[r].container){continue}if(o.items[r].container===e){this._oBasicAreaLayout.insertContent(e,s+1);return}a=n.indexOf(o.items[r].container);if(a>=0){s=a}}}}}};O.prototype._checkChangePossibleVisibleInFilterBar=function(t,e){if(t&&t.getMandatory()&&!e){var i=this._hasFilterValue(t);if(!i){t.setVisibleInFilterBar(true);return false}}return true};O.prototype._hasFilterValue=function(t){var e;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){e=this.getAllFiltersWithValues()}else{e=this._getFiltersWithValues()}return this._checkFilterForValue(e,t)};O.prototype._adaptGroupTitleForFilter=function(t){var e;var i;if(t&&!t.getHiddenFilter()){e=t.getLabel();i=t.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(i&&t.getGroupTitle()){i.setText(e+" ("+t.getGroupTitle()+")")}}else{i.setText(e)}}};O.prototype._adaptGroupTitle=function(t){var e;var i;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[t]&&this._mAdvancedAreaFilter[t].items){for(e=0;e<this._mAdvancedAreaFilter[t].items.length;e++){i=this._mAdvancedAreaFilter[t].items[e];if(i&&i){this._adaptGroupTitleForFilter(i.filterItem)}}}};O.prototype.registerGetFiltersWithValues=function(t){this._fRegisterGetFiltersWithValues=t;return this};O.prototype.registerFetchData=function(t){this._fRegisteredFetchData=t;return this};O.prototype.registerApplyData=function(t){this._fRegisteredApplyData=t;return this};O.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true}}return false};O.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null)}this._fireInitialiseEvent()}else{this._initializeVariantManagement()}if(this.getIsRunningInValueHelpDialog()){this._rerenderFilters()}};O.prototype.variantsInitialized=function(){this._afterVariantsLoad();this.fireInitialized();this._oInitializedDeferred.resolve()};O.prototype.fireInitialized=function(){this.fireEvent("initialized");this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat();this._oInitializedDeferred.resolve()};O.prototype.getInitializedPromise=function(){return this._oInitializedDeferred.promise};O.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this)}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise()}}else{this._fireInitialiseEvent()}};O.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");this._showHintText()}catch(t){b.error("error during initialise event handling - "+t.message)}this._bIsInitialized=true;this._updateToolbarText()};O.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false)}};O.prototype.fireAfterVariantLoad=function(t,e){this._rerenderFilters();this._aAdaptFilterItems=[];var i={context:t,executeOnSelect:e};try{this.fireEvent("afterVariantLoad",i)}catch(t){b.error("error during 'afterVariantLoad' event handling - "+t.message)}};O.prototype.fireBeforeVariantSave=function(t){var e={context:t};var i=this._getConsiderFilterChanges();if(t){this._setConsiderFilterChanges(false)}this.fireEvent("beforeVariantSave",e);if(t){this._setConsiderFilterChanges(i)}};O.prototype.destroyFilterGroupItems=function(){var t=this.getFilterGroupItems();this._destroyItems(t);return this};O.prototype.destroyFilterItems=function(){var t=this.getFilterItems();this._destroyItems(t);return this};O.prototype.removeAllFilterItems=function(){var t,e=this.getFilterItems();if(e&&e.length){for(t=0;t<e.length;t++){this.removeFilterItem(e[t])}}return e};O.prototype.removeAllFilterGroupItems=function(){var t,e=[],i=this.getFilterGroupItems();if(i&&i.length){for(t=0;t<i.length;t++){e.push(i[t]);this.removeFilterGroupItem(i[t])}}return e};O.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch()};O.prototype.removeBasicSearch=function(){this.setBasicSearch(null)};O.prototype.getAllFilterItems=function(t){var e,i=null;var r=[];var a,n;if(!t){this._ensureFilterLoaded(null)}if(this._mAdvancedAreaFilter){for(i in this._mAdvancedAreaFilter){if(i){a=this._mAdvancedAreaFilter[i];if(a.items){for(e=0;e<a.items.length;e++){n=a.items[e];if(n&&n.filterItem&&n.filterItem.getVisible()){if(t){if(n.filterItem.getVisibleInFilterBar()||this._checkIfFilterHasValue(n.filterItem.getName())||n.filterItem.data("isCustomField")&&this._checkIfCustomControlFilterHasValue(n)){r.push(n.filterItem)}}else{r.push(n.filterItem)}}}}}}}return r};O.prototype._checkIfFilterHasValue=function(t){return false};O.prototype._checkIfCustomControlFilterHasValue=function(t){return false};O.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState()};O.prototype.getAggregation=function(t){if(t=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null)}return c.prototype.getAggregation.apply(this,arguments)};O.prototype._getFilterInformation=function(){return[]};O.prototype._createVisibleFilters=function(){this._getFilters()};O.prototype._getFilters=function(){var t=[],e=this._oFilterProvider&&this._oFilterProvider.getModel()&&this._oFilterProvider.getModel().getData();if(e){t=Object.keys(e).filter(function(t){return this._checkIfFilterHasValue(t)}.bind(this))}this._aFields=this._getFilterInformation();var i,r;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[O.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[O.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[O.INTERNAL_GROUP].items=null}}for(i=0;i<this._aFields.length;i++){r=this._aFields[i];if(r.groupName!==O.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[r.groupName]){this._mAdvancedAreaFilter[r.groupName]={};this._mAdvancedAreaFilter[r.groupName].groupTitle=r.groupTitle;this._mAdvancedAreaFilter[r.groupName].filterItem=null;this._mAdvancedAreaFilter[r.groupName].items=[]}}if(r.visibleInAdvancedArea||r.groupName===O.INTERNAL_GROUP||t.includes(r.name)){this._instanciateFilterItem(r)}}}this._adaptButtonsEnablement()};O.prototype.isVisibleInFilterBarByName=function(t){var e,i=this._getFilterMetadata(t);if(i&&i.factory){if(i.hasOwnProperty("visibleInAdvancedArea")&&i.visibleInAdvancedArea||i.groupName===O.INTERNAL_GROUP){return true}}else{e=this.determineFilterItemByName(t);if(e){return e.getVisibleInFilterBar()}}return false};O.prototype._getFilterMetadata=function(t){if(this._aFields){for(var e=0;e<this._aFields.length;e++){if(this._aFields[e].fieldName===t){return this._aFields[e]}}}return null};O.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames()}else{return this._getNonVisibleCustomFilterNames()}};O.prototype._getLazyNonVisibleCustomFilterNames=function(){var t=this,e=[];this._aFields.forEach(function(i){if(i.factory){if(i.isCustomFilterField&&!i.visibleInAdvancedArea){e.push(i.fieldName)}}else if(t._isNonVisibleCustomFilterNamesByName(i.fieldName,i.groupName)){e.push(i.fieldName)}});return e};O.prototype._isNonVisibleCustomFilterNamesByName=function(t,e){var i,r;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(i=0;i<this._mAdvancedAreaFilter[e].items.length;i++){r=this._mAdvancedAreaFilter[e].items[i];if(r.filterName&&r.filterItem.getName()===t){return this._isNonVisibleCustomFilterNamesByFilter(r.filterItem)}}}return false};O.prototype._isNonVisibleCustomFilterNamesByFilter=function(t){if(t.data("isCustomField")&&!t.getVisibleInFilterBar()){return true}return false};O.prototype._getNonVisibleCustomFilterNames=function(){var t=this,e=[],i=this.getAllFilterItems();if(i){i.forEach(function(i){if(t._isNonVisibleCustomFilterNamesByFilter(i)){e.push(i.getName())}})}return e};O.prototype._ensureFilterLoaded=function(t){var e,i,r;if(this._aFields&&this._aFields.length>0){for(i=0;i<this._aFields.length;i++){r=this._aFields[i];if(!r.factory){continue}if(t){for(e=0;e<t.length;e++){if(r.fieldName===t[e].name){if(r.groupName===t[e].group){this._instanciateFilterItem(r);break}else if(r.groupEntityType===t[e].group){this._instanciateFilterItem(r)}}}}else{this._instanciateFilterItem(r)}}if(!t){this._aFields=[]}}};O.prototype._instanciateFilterItem=function(t){var e=t.factory;if(e){delete t.factory;e.call(t)}};O.prototype._destroyItems=function(t){if(t&&t.length){for(var e=0;e<t.length;e++){t[e].destroy()}}};O.prototype._reapplyVisibility=function(t,e){var i,r=null;var a;var n=[];if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){var s=this._mAdvancedAreaFilter[r];if(s&&s.items){for(i=0;i<s.items.length;i++){a=s.items[i];if(a&&a.filterItem){this._setPersVisibility(t,a.filterItem,n,e)}}}}}}return n};O.prototype._setPersVisibility=function(t,e,i,r){var a,n;if(e&&!e.getHiddenFilter()){a=e.getGroupName();n=this._checkForFilterInfo(t,e);if(this._isTINAFScenario()){if(n){e.setVisibleInFilterBar(n.visibleInFilterBar);if(n.hasOwnProperty("visible")){e.setVisible(n.visible)}}else{e.setVisibleInFilterBar(false);if(a===O.INTERNAL_GROUP||e._isParameter()){}}}else{if(n&&n.visibleInFilterBar!==undefined){e.setVisibleInFilterBar(n.visibleInFilterBar)}else{if(a!==O.INTERNAL_GROUP&&n&&n.group===a){e.setVisibleInFilterBar(n!==null)}}}if(e){var s=this.determineControlByFilterItem(e,true);if(!r&&s&&s.getValueState&&s.getValueState()!==M.None){s.setValueState(M.None)}if(n&&n.hasOwnProperty("partOfCurrentVariant")&&!n.partOfCurrentVariant){i.push(e)}}}};O.prototype._checkForFilterInfo=function(t,e){var i,r,a=e.getName(),n=[e.getGroupName(),e.getEntitySetName(),e.getEntityTypeName()];var s=[];if(t&&t.length){for(i=0;i<t.length;i++){if(t[i].name===a){if(n.indexOf(t[i].group)>-1){s.push(t[i])}}}}if(s.length===1){return s[0]}else if(s.length>1){for(r=0;r<n.length;r++){for(i=0;i<s.length;i++){if(s[i].group===n[r]){return s[i]}}}}return null};O.prototype._createVariantManagement=function(){var t=new f(this.getId()+"-variantUi2",{});var e=new u({type:"filterBar",keyName:"persistencyKey"});e.setControl(this);t.addPersonalizableControl(e);t.addStyleClass("sapUiCompFilterBarMarginLeft");return t};O.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged")};O.prototype.retrieveFiltersWithValuesAsText=function(){var t,e,i=this.retrieveFiltersWithValues(),r,a=this.getBasicSearchValue();if(a&&i){i.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"))}if(!i||i.length===0){t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO")}else if(i&&i.length===1){if(!this._isPhone()){t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER",[i.length,i[0]])}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_MOBILE",[i.length])}}else{if(!this._isPhone()){r=Math.min(5,i.length);e="";for(var n=0;n<r;n++){e+=i[n];if(n<r-1){e+=", "}}t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[i.length,e]);if(r<i.length){t+=", ..."}}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[i.length])}}return t};O.prototype.retrieveFiltersWithValuesAsTextExpanded=function(){var t,e="",i=this.retrieveFiltersWithValues(),r=this.getBasicSearchValue(),a=this.retrieveNonVisibleFiltersWithValues();if(a.length>0){e=" "+this._oRb.getText("FILTER_BAR_ASSIGNED_HIDDEN_FILTERS",[a.length])}if(r&&i){i.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"))}if(i.length===0){t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO")}else if(i.length===1){if(!this._isPhone()){t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_EXPANDED",[i.length]);t+=e}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_MOBILE",[i.length]);t+=e}}else{if(!this._isPhone()){t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_EXPANDED",[i.length]);t+=e}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[i.length]);t+=e}}return t};O.prototype.retrieveFiltersWithValues=function(){var t,e=[];var i=this._getFiltersWithValues();if(i){for(t=0;t<i.length;t++){if(i[t].getHiddenFilter()){continue}if(i[t].getVisible()&&i[t].getPartOfCurrentVariant()){e.push(i[t].getLabel())}}}return e};O.prototype.retrieveNonVisibleFiltersWithValues=function(){var t,e=[],i,r=this._getFiltersWithValues();if(r){for(t=0;t<r.length;t++){i=r[t];if(i.getHiddenFilter()){continue}if(i.getVisible()&&!i.getVisibleInFilterBar()&&i.getPartOfCurrentVariant()){e.push(i.getLabel())}}}return e};O.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues()}catch(t){b.error("callback for obtaining the filter count throws an exception")}}return null};O.prototype._getFiltersWithValuesCount=function(){var t=0;var e=this.retrieveFiltersWithValues();t=e.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){t++}return t};O.prototype._checkFilterForValue=function(t,e){var i;if(t){for(i=0;i<t.length;i++){if(t[i]===e){return true}}}return false};O.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var t=false;var e=this._oToolbar.getContent();for(var i=0;i<e.length;i++){if(e[i]instanceof s){continue}if(e[i].getVisible&&e[i].getVisible()){t=true;break}}this._oToolbar.setVisible(t)}};O.prototype._hasMandatoryFields=function(){return this.getFilterGroupItems().some(function(t){return t.getMandatory()})};O.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());this._bShowAllFilters=this._hasMandatoryFields()?true:false;if(!this.getAdvancedMode()){this._rerenderFilters()}};O.prototype._updateToolbarText=function(){var t=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var e=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var i=this._getFiltersWithValuesCount();var r=i?this._oRb.getText(t,[i]):this._oRb.getText(e);this._oFiltersButton.setText(r);this.fireAssignedFiltersChanged()};O.prototype.setFilterBarExpanded=function(t){var e;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",t);if(this._oHideShowButton){if(t){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"))}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"))}}this._calcVisibilityGoButton();if(this.getIsRunningInValueHelpDialog()){this._oBasicAreaLayout.setVisible(t)}else{this._oAdvancedPanel.setVisible(t)}}else{if(this._isPhone()&&this.getUseToolbar()){e=false}else{e=t}this.setProperty("filterBarExpanded",e);if(this._isNewFilterBarDesign()){return this}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false)}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false)}else{if(this._oHideShowButton){if(e){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"))}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"))}this._oHideShowButton.setVisible(true)}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(e)}else{this._oBasicAreaLayout.setVisible(false)}}}}this._updateToolbarText();return this};O.prototype._selectionChangedInFilterDialogByValue=function(t,e){e.setVisibleInFilterBar(t);if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}this._bDirtyViaDialog=true};O.prototype._onLiveChangeValidateSymbols=function(t){var e=new RegExp("[\\w][*][\\w]"),i=new RegExp("[+]"),r=t.getSource(),a=r.getValue(),n=e.test(a)||i.test(a);this._onSymbolsValidationSetValueState.call(this,n,r)};O.prototype._onSymbolsValidationSetValueState=function(t,e){var i=e._oValueStateMessage,r="sapMSFContentWrapperWarning";if(t&&!e.hasStyleClass(r)&&e.setValueState===undefined){e.addStyleClass(r);e.getValueState=function(){return M.Warning};i.open()}else if(!t&&e.hasStyleClass(r)&&e.setValueState===undefined){e.getValueState=function(){return M.None};i.close();e.removeStyleClass(r)}else if(t&&e.getValueState&&e.getValueState()===M.None){e.setValueState(M.Warning);e.setValueStateText(R)}else if(!t&&e.getValueState()===M.Warning){e.setValueState(M.None)}};O.prototype._mandatoryFilterChange=function(t){if(!t){return}var e=t.getParameters();if(!e||!e.oSource){return}var i=this._determineByControl(e.oSource);if(i){this._mandatoryFilterItemChange(i.filterItem)}};O.prototype._mandatoryFilterItemChange=function(t){if(t){if(!t.getMandatory()){return}var e=this._hasFilterValue(t);if(!t.getVisibleInFilterBar()&&!e){t.setVisibleInFilterBar(true)}}};O.prototype._isPhone=function(){return!!o.system.phone};O.prototype._isTablet=function(){return!!(o.system.tablet&&!o.system.desktop)};O.prototype.fireSearch=function(t){if(this._bOKFiltersDialogTriggered&&this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.close()}else if(this._oAdaptFiltersDialog){this._bEnterPressedLeadsToSearch=true}this.fireEvent("search",t)};O.prototype._variantSave=function(t){this._oVariant={};this.fireBeforeVariantSave()};O.prototype._afterVariantSave=function(t){this._aOrderedFilterItems=this._aAdaptFilterItems;this._aAdaptFilterItems=[];this.fireAfterVariantSave()};O.prototype._filterSetInErrorState=function(t){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}this._bDirtyViaDialog=true}};O.prototype._cancelFilterDialog=function(t){if(t&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled}if(!this.getPersistencyKey()&&this.getUseSnapshot()===false){this.fireCancel();return}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){var e=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(e);this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantKey(this._oInitialVariant.key)}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified)}this.fireCancel()}};O.prototype._resetFiltersInErrorValueState=function(){var t;t=this._retrieveCurrentSelectionSet(true,true);t.forEach(function(t){if(t.control&&t.control.setValueState&&t.control.getValueState){if(t.control.getValueState()===M.Error){if(t.control.setValue){t.control.setValue("")}t.control.setValueState(M.None)}}})};O.prototype.setContentWidth=function(t){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentWidth(t+"px")}};O.prototype.setContentHeight=function(t){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentHeight(t+"px")}};O.prototype.addAdaptFilterDialogCustomContent=function(t){this._mCustomViewInfo={item:t.item,search:t.search,selectionChange:t.selectionChange,filterSelect:t.filterSelect,content:t.content}};O.prototype._createStructureForAdaptFiltersDialog=function(){var t,e,i={filtersOnFilterBar:{},allFilters:[]};var r,a=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){t=this._mAdvancedAreaFilter[n];if(t.items){for(var s=0;s<t.items.length;s++){e=t.items[s];r=this._checkFilterForValue(a,e.filterItem);if(e.filterItem.getVisibleInFilterBar()){i.filtersOnFilterBar[e.filterItem.getName()]=e.filterItem}var o=e.filterItem.getGroupName()?e.filterItem.getGroupName():O.INTERNAL_GROUP;var l=o===O.INTERNAL_GROUP?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):e.filterItem.getGroupTitle();var h=e.filterItem.getControlTooltip()?e.filterItem.getControlTooltip():"";i.allFilters.push({name:e.filterItem.getName(),label:e.filterItem.getLabel(),group:o,groupLabel:l,tooltip:h,visibleInDialog:e.filterItem.getVisible(),filterItem:e.filterItem,active:r,required:e.filterItem.getMandatory()})}}}}if(i.allFilters.length>0){var d=[],u=this._aAdaptFilterItems.length>0?this._aAdaptFilterItems:this._aOrderedFilterItems;if(u.length>0){u.forEach(function(t,e){d[t.name]=e});i.allFilters.sort(function(t,e){return d[t.name]-d[e.name]})}}}return i};O.prototype._getAllFilterItemsFlat=function(){var t,e,i,r=[];if(this._mAdvancedAreaFilter){for(var a in this._mAdvancedAreaFilter){if(a){t=this._mAdvancedAreaFilter[a];if(t.items){for(var n=0;n<t.items.length;n++){e=t.items[n];i=e.filterItem;var s=i.getGroupName()?i.getGroupName():O.INTERNAL_GROUP;var o=s===O.INTERNAL_GROUP?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):i.getGroupTitle();var l=i.getControlTooltip()?i.getControlTooltip():"";r.push({name:i.getName(),label:i.getLabel(),group:s,groupLabel:o,tooltip:l,visibleInDialog:i.getVisible(),filterItem:i,required:i.getMandatory()})}}}}}return r};O.prototype._restoreControls=function(t,e){var i,r,a;if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null}if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){i=this._mAdvancedAreaFilter[n];if(i.items){for(var s=0;s<i.items.length;s++){r=i.items[s];if(r.filterItem&&!r.filterItem.getHiddenFilter()&&r.control&&r.container){if(r.contentReplaced){r.contentReplaced=undefined;a=r.container.getContent();var o=a[1];r.container.removeContent(o);if(o&&o.getValueState){if(e&&o.getValueState()!=r.control.getValueState()){r.control.setValueState(o.getValueState())}}o.destroy();r.container.getContent()[0].setLabelFor(r.control);r.container.insertContent(r.control,1)}r.filterItem.detachChange(t)}}}}}}this._rerenderFilters()};O.prototype._expandGroup=function(t){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialogModel&&this._oAdaptFiltersPanel&&t&&t.filterItem){var e=t.filterItem.getGroupName()?t.filterItem.getGroupName():O.INTERNAL_GROUP;var i=this._oAdaptFiltersDialogModel.getData().itemsGrouped;for(var r=0;r<i.length;r++){if(i[r].group===e){for(var a=0;a<i[r].items.length;a++){if(i[r].items[a].name===t.filterItem.getName()){this._oAdaptFiltersPanel.setGroupExpanded(i[r].items[a].group,true);return}}return}}}};var G,H;O.prototype._getEntitiesLazy=function(){if(G&&H){return Promise.resolve()}this.setBusy(true);return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(t){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder","sap/ui/mdc/p13n/panels/AdaptFiltersPanel"],function(e,i){G=e;H=i;t();this.setBusy(false)}.bind(this))}.bind(this))}.bind(this))};O.prototype._filtersButtonPressed=function(){this._oFiltersButton.focus();this.showAdaptFilterDialog()};O.prototype._checkAssignedFilters=function(){if(this._oAdaptFiltersDialog){var t=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();var e=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<e.length;i++){if(e[i].hasOwnProperty("filterItem")){var r=this._checkFilterForValue(t,e[i].filterItem);if(e[i].active!==r){e[i].active=r}}}}};O.prototype.showAdaptFilterDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;this.showAdaptFilterDialog().then(function(){this._oAdaptFiltersDialog.addStyleClass(t);G.addRTACustomFieldButton(this._oAdaptFiltersDialog)}.bind(this))};O.prototype._createKeyUserChange=function(){var t=[];if(this._bOKFiltersDialogTriggered&&this._oVariantManagement&&this._oVariantManagement.isA("sap.ui.comp.smartvariants.SmartVariantManagement")&&this._oVariantManagement.getVisible()&&this._oVariantManagement._getPersoController()){t=[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]}return t};O.prototype.showAdaptFilterDialog=function(t){return new Promise(function(e){this._getEntitiesLazy().then(function(){var i;if(!this._oAdaptFiltersDialog){i=new v;i.setSizeLimit(0);var r=function(t,e){for(var i=0;i<t.length;i++){if(t[i].group===e){var r=t[i].items;for(var a=0;a<r.length;a++){if(r[a].filterItem&&r[a].filterItem.getVisible()){if(!t[i].groupVisible){t[i].groupVisible=true}return}}if(t[i].groupVisible){t[i].groupVisible=false}return}}};var a=function(t){if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.filterbar.FilterItem")){var e=t.getParameter("propertyName");if(this._oAdaptFiltersDialogModel&&e){var i=this._oAdaptFiltersDialogModel.getData().items;for(var a=0;a<i.length;a++){if(i[a].hasOwnProperty("filterItem")&&i[a].filterItem===t.oSource){if(e==="visible"){var n=t.oSource.getVisible();if(i[a].visibleInDialog!=n){i[a].visibleInDialog=n;r(this._oAdaptFiltersDialogModel.getData().itemsGrouped,i[a].group);this._oAdaptFiltersDialogModel.checkUpdate();break}}else if(e==="visibleInFilterBar"){i[a].visible=t.oSource.getVisibleInFilterBar();this._oAdaptFiltersDialogModel.checkUpdate();break}}}}}}.bind(this);this._ensureFilterLoaded(null);var n=this._createStructureForAdaptFiltersDialog();var s=this;var o=G.prepareAdaptationData(n.allFilters,function(t,e){V(t,e);var i=true;if(!e.filterItem||e.filterItem.getHiddenFilter()){s._mAdvancedAreaHiddenFilters.push(t);i=false}t.visible=!!n.filtersOnFilterBar[e.name];return i},true);G.sortP13nData({visible:"visible",position:"position"},o.items);this._oAdaptFiltersDialogModel=new v;this._oAdaptFiltersDialogModel.setSizeLimit(1e3);this._oAdaptFiltersDialogModel.setData(o);this._mAdaptFiltersDialogInitialItemsOrder=[].concat(this._oAdaptFiltersDialogModel.getData().items,this._mAdvancedAreaHiddenFilters);var l=this._oAdaptFiltersDialogModel.getData().items;for(var h=0;h<l.length;h++){if(l[h].hasOwnProperty("filterItem")){l[h].filterItem.attachChange(a)}}this._fRegisteredFilterChangeHandlers=function(t){this._mandatoryFilterChange(t)}.bind(this);this.attachFilterChange(this._fRegisteredFilterChangeHandlers);var d=function(t,e){if(t&&t.filterItem&&t.filterItem.getVisibleInFilterBar()!==e){this._selectionChangedInFilterDialogByValue(e,t.filterItem)}}.bind(this);var u=function(t){var e,i,r,a,n=t.getParameter("item"),s=t.getParameter("reason"),o=s==="Add"||s==="SelectAll"||s==="RangeSelect";if(s==="SelectAll"||s==="DeselectAll"){if(this._oAdaptFiltersPanel.getCurrentViewKey()===this._oAdaptFiltersPanel.GROUP_KEY){i=t.getParameter("item").group;r=this._oAdaptFiltersDialogModel.getProperty("/itemsGrouped").filter(function(t){return t.group===i})[0].items}else{r=this._oAdaptFiltersDialogModel.getProperty("/items")}for(e=0;e<r.length;e++){n=r[e];if(!o&&this._shouldBeVisible(n)){a="/items/"+e;this._oAdaptFiltersDialogModel.setProperty(a+"/visible",true)}else{d(n,o)}}}else if(s==="RangeSelect"&&n){if(this._oAdaptFiltersPanel.getCurrentViewKey()===this._oAdaptFiltersPanel.LIST_KEY){for(e=0;e<n.length;e++){var l=n[e];if(!o&&this._shouldBeVisible(l)){a="/items/"+e;this._oAdaptFiltersDialogModel.setProperty(a+"/visible",true)}else{d(l,o)}}}}else if((s==="Add"||s==="Remove")&&n){if(!o&&this._shouldBeVisible(n)){n.visible=true}else{d(n,o)}}else if(s==="Move"){this._bDirtyViaDialog=true;this._bMoveTriggered=true}}.bind(this);var f=new H({enableReorder:true});f.getView(f.GROUP_KEY).getContent().attachChange(u);f.getView(f.LIST_KEY).getContent().attachChange(u);this._oAdaptFiltersPanel=f;f.setItemFactory(function(t){var e,r,a,n;n=t.getObject();if(!n){return undefined}a=this._determineItemByName(n.name,n.group);if(!a||!a.filterItem||!a.control){return undefined}e=a.control;if(!a.contentReplaced&&a.container&&a.container.getContent()[1]===e){a.contentReplaced=true;a.container.removeContent(e);r=e.clone();a.container.getContent()[0].setLabelFor("");r.setModel(i);a.container.insertContent(r,1)}return e}.bind(this));this.fireFiltersDialogBeforeOpen({newDialog:true});if(this._mCustomViewInfo&&this._mCustomViewInfo.item&&this._mCustomViewInfo.item.getKey()){f.addCustomView(this._mCustomViewInfo);f.switchView(t?t:f.getDefaultView())}var _=function(t){this._dialogCancel(this._oAdaptFiltersDialog)}.bind(this);var c=function(t){this._bOKFiltersDialogTriggered=true;this._oAdaptFiltersDialog.close()}.bind(this);var p;if(this.getShowRestoreButton()&&!this._fGetDataForKeyUser){p={onExecute:this._dialogRestore.bind(this),idButton:this.getId()+"-resetBtn"}}G.createP13nDialog(f,{id:this.getId()+"-adapt-filters-dialog",title:this._oRb.getText(this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_DIALOG":"FILTER_BAR_ADV_FILTERS_DIALOG"),reset:p,verticalScrolling:false,cancel:_,confirm:{text:this._oRb.getText("FILTER_BAR_OK"),handler:c}}).then(function(t){this._oAdaptFiltersDialog=t;this._oAdaptFiltersDialog.setParent(this);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified()}this._oInitialVariant={};V(this._oInitialVariant,this._oVariant);this._bOKFiltersDialogTriggered=false;this._oAdaptFiltersDialog.attachBeforeOpen(function(){this._bDirtyViaDialog=false;this._bEnterPressedLeadsToSearch=false}.bind(this));this._oAdaptFiltersDialog.attachBeforeClose(function(){this._restoreControls(a,!this._bOKFiltersDialogTriggered);if(!this._bOKFiltersDialogTriggered){this._cancelFilterDialog(false)}if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}}.bind(this));this._oAdaptFiltersDialog.attachAfterClose(function(){if(this._bOKFiltersDialogTriggered){this._aAdaptFilterItems=this._oAdaptFiltersDialogModel.getProperty("/items");this._aAdaptFilterItems=[].concat(this._aAdaptFilterItems,this._mAdvancedAreaHiddenFilters);this._mAdvancedAreaFilter=this._mapReorderedFilterItemsInGroups(this._aAdaptFilterItems);this._reorderItemsInBasicAreaLayout(this._aAdaptFilterItems);this._bMoveTriggered=false;this._mAdvancedAreaHiddenFilters=[]}else{this._aAdaptFilterItems=[]}this._oBasicAreaLayout.rerender();this._oAdaptFiltersDialogModel=null;this._oAdaptFiltersPanel=null;this._oVariant={};this._oInitialVariant=null;this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;this._fGetDataForKeyUser=null;if((this._bOKFiltersDialogTriggered&&this._bDirtyViaDialog||this._bResetFiltersDialogTriggered)&&!this._bEnterPressedLeadsToSearch){if(!this.isLiveMode||!this.isLiveMode()){this.fireFilterChange()}}this._bEnterPressedLeadsToSearch=false;this._bResetFiltersDialogTriggered=false;this.fireFiltersDialogClosed({context:this._bOKFiltersDialogTriggered?"SEARCH":"CANCEL"});if(this._bNoFiltersInAdvancedArea&&this._oHintText&&!this._oHintText.getVisible()){this._bNoFiltersInAdvancedArea=false;this.setFilterBarExpanded(true)}}.bind(this));if(this.$().closest(".sapUiSizeCompact").length>0){this._oAdaptFiltersDialog.addStyleClass("sapUiSizeCompact")}this._oAdaptFiltersDialog.isPopupAdaptationAllowed=function(){return false};this._oAdaptFiltersDialog.open();e()}.bind(this));f.setP13nModel(this._oAdaptFiltersDialogModel);return}e()}.bind(this))}.bind(this))};O.prototype._mapReorderedFilterItemsInGroups=function(t){var e=[];t.forEach(function(t){if(!e[t.group]){e[t.group]={};e[t.group].filterItem=null;e[t.group].items=[]}if(!e[t.group].items){e[t.group].items=[]}e[t.group].items.push(this._mAdvancedAreaFilter[t.group].items.find(function(e){return e.filterItem===t.filterItem}));if(!e[t.group].filterItem){e[t.group].filterItem=t.filterItem}}.bind(this));return e};O.prototype._reorderItemsInBasicAreaLayout=function(t){if(!t||!t.length){return}t.forEach(function(t,e){var i=this._determineItemByName(t.name,t.group);if(!i||!i.filterItem||!i.control){return}var r=this._oBasicAreaLayout.removeContent(i.container);this._oBasicAreaLayout.insertContent(r,e+1);return}.bind(this))};O.prototype._reorderItemsInAdvancedAreaFilter=function(){var t,e;t=this._createStructureForAdaptFiltersDialog();e=t.allFilters;this._mAdvancedAreaFilter=this._mapReorderedFilterItemsInGroups(e)};O.prototype.isDialogOpen=function(){return this._oAdaptFiltersDialog?true:false};O.prototype._dialogCancel=function(t){if(t){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();t.close()}};O.prototype._dialogRestore=function(){this.reset();if(this._oVariantManagement&&this._oVariantManagement.getVisible()&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false)}if(this._oAdaptFiltersPanel){var t=[],e=this._oAdaptFiltersDialogModel.getData();if(this._bMoveTriggered&&this._mAdaptFiltersDialogInitialItemsOrder.length>0){this._mAdaptFiltersDialogInitialItemsOrder.forEach(function(e,i){t[e.name]=i});e.items.sort(function(e,i){return t[e.name]-t[i.name]})}else{this._aOrderedFilterItems.forEach(function(e,i){t[e.name]=i});e.items.sort(function(e,i){return t[e.name]-t[i.name]});G.sortP13nData({visible:"visible",position:"position"},e.items)}this._oAdaptFiltersPanel.setP13nData(e)}this._bDirtyViaDialog=false;this._bResetFiltersDialogTriggered=true};O.prototype._createButtons=function(t){var i=this;this._oSearchButton=new e(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:L.Emphasized}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");S.addConfig(this._oSearchButton,{event:"search"},this);this._oSearchButton.attachPress(function(){i._oSearchButton.focus();i._searchFromFilterBar()});t.addContent(this._oSearchButton);this._oHideShowButton=new e(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),type:L.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){i._toggleHideShow()});t.addContent(this._oHideShowButton);this._oClearButtonOnFB=new e(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),type:L.Transparent,enabled:false}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");this._oClearButtonOnFB.attachPress(function(){i.clear();if(i.isLiveMode&&i.isLiveMode()){i._searchFromFilterBar()}});t.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new e(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),type:L.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){i.reset();if(i._oVariantManagement){i._oVariantManagement.currentVariantSetModified(false)}});t.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new e(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:L.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){this._filtersButtonPressed()}.bind(this));t.addContent(this._oFiltersButton)};O.prototype._toggleAllFilters=function(){this._bShowAllFilters=!this._bShowAllFilters;this._oShowAllFiltersButton.setVisible(!this._bShowAllFilters);this._rerenderFilters()};O.prototype.initShowAllFiltersButton=function(){this._oShowAllFiltersButton=new e(this.getId()+"-btnShowAll",{text:this._oRb.getText("FILTER_BAR_VH_SHOW_ALL"),type:L.Transparent,press:this._toggleAllFilters.bind(this)});this._oBasicAreaLayout.addEndContent(this._oShowAllFiltersButton)};O.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false)}this._registerVariantManagement();return this._oVariantManagement};O.prototype._createToolbar=function(t){var e=new n(this.getId()+"-toolbar");if(!t){var i=this._createVariantLayout();e.addContent(i)}e.addContent(new s);this._createButtons(e);e.addStyleClass("sapUiCompFilterBarToolbar");e.setLayoutData(new g({span:"L12 M12 S12"}));return e};O.prototype._replaceVariantManagement=function(t){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement)}this._oVariantManagement.destroy()}this._oVariantManagement=t;this._registerVariantManagement();this._adaptNewFilterBarDesign()};O.prototype._createAdvancedAreaForm=function(){if((!E||!N||!x||!w)&&!this._bAdvancedRequested){E=sap.ui.require("sap/ui/layout/form/Form");N=sap.ui.require("sap/ui/layout/form/FormContainer");x=sap.ui.require("sap/ui/layout/form/FormElement");w=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");if(!E||!N||!x||!w){sap.ui.require(["sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout"],U.bind(this));this._bAdvancedRequested=true}}if(!E||!N||!x||!w){return}var t=new w(this.getId()+"-AdvancedFormLayout");t.addStyleClass("sapUiCompFilterBarPaddingForm");t.setColumnsL(3);t.setColumnsM(2);var e=new E(this.getId()+"-AdvancedForm",{editable:true});e.setLayout(t);if(!this.oInvisibleFormTitle){this.oInvisibleFormTitle=new _({text:this._oRb.getText("ADVANCED_SEARCH_TEXT")});this.addContent(this.oInvisibleFormTitle)}e.addAriaLabelledBy(this.oInvisibleFormTitle);this._oAdvancedPanel.addContent(e);return e};function U(t,e,i,r){E=t;N=e;x=i;w=r;this._bAdvancedRequested=false;if(!this._bIsBeingDestroyed){if(!this.getIsRunningInValueHelpDialog()){this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._rerenderAA()}}}O.prototype._addControlToBasicAreaFormContainer=function(t){var e=t._getControl();if(!e){b.error("no Control obtained");return null}var i=t.getLabelControl(this.getId());if(!i){b.error("no Label obtained");return null}this._adaptGroupTitleForFilter(t);return this._addControlToBasicAreaContainer(t,e,i)};O.prototype._addControlToBasicAreaContainer=function(t,e,i){var r=new F;if(e.setWidth){e.setWidth("100%")}r.setWidth("100%");if(i){if(!i.hasStyleClass("sapUiCompFilterLabel")){i.addStyleClass("sapUiCompFilterLabel")}r.addContent(i);if(i.setLabelFor){if(t&&e){i.setLabelFor(e);if(e.setTooltip&&t.getControlTooltip()){e.setTooltip(t.getControlTooltip())}}}}r.addContent(e);if((!this.getAdvancedMode()||this.getIsRunningInValueHelpDialog())&&!this._oAdaptFiltersDialog){if(t&&t.getVisible()&&t.getVisibleInFilterBar()){var a=this._oBasicAreaLayout.getContent();if(this._isNewFilterBarDesign()&&!this._isPhone()){this._oBasicAreaLayout.insertContent(r,a.length)}else{this._oBasicAreaLayout.addContent(r)}}}return r};O.prototype._rerenderAA=function(){if(this._oAdvancedAreaForm){this._oAdvancedAreaForm.removeAllFormContainers();var t=this._flattenMap();this._layOutAA(t)}};O.prototype._groupsWithVisibleFilters=function(){var t,e,i=this._mAdvancedAreaFilter;if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){i={};for(var r in this._mAdvancedAreaFilter){if(r&&this._mAdvancedAreaFilter[r]&&this._mAdvancedAreaFilter[r].items){t=this._mAdvancedAreaFilter[r].items.length;for(var a=0;a<this._mAdvancedAreaFilter[r].items.length;a++){e=this._mAdvancedAreaFilter[r].items[a].filterItem;if(e&&(e.getHiddenFilter()||!e.getVisible())){t--}}if(t){i[r]={}}}}}return i};O.prototype._layOutAA=function(t){var e=this._groupsWithVisibleFilters();if(e&&Object.keys(e).length>1){this._layOutAAMultipleGroup(t)}else{this._layOutAASingleGroup(t)}};O.prototype._layOutAAMultipleGroup=function(t){var e,i,r=0,a=null,n=false;for(e=0;e<t.length;e++){if(t[e].control===null){r++}}if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length===2&&this._mAdvancedAreaFilter[O.INTERNAL_GROUP]&&this._mAdvancedAreaFilter[O.INTERNAL_GROUP].items&&this._mAdvancedAreaFilter[O.INTERNAL_GROUP].items.length>0){n=true}var s=this._oAdvancedAreaForm.getLayout();if(s){if(r>=3){s.setLabelSpanL(5);s.setLabelSpanM(5);s.setColumnsL(3);s.setColumnsM(2)}else if(r===2){s.setLabelSpanL(4);s.setLabelSpanM(5);s.setColumnsL(2);s.setColumnsM(2)}else if(r===1){s.setLabelSpanL(4);s.setLabelSpanM(5);s.setColumnsL(2);s.setColumnsM(2)}}for(e=0;e<t.length;e++){if(t[e].control===null){a=new N;if(Object.keys(this._mAdvancedAreaFilter).length>1&&!n){if(r>=3&&t[e].filterItem.getGroupName()===O.INTERNAL_GROUP){a.setTitle(this._oRb.getText("FILTER_BAR_BASIC_GROUP"))}else{a.setTitle(t[e].filterItem.getGroupTitle())}}this._oAdvancedAreaForm.addFormContainer(a);i=e+1;while(i<t.length&&t[i].control){this._addControlToAdvancedArea(t[i].filterItem,t[i].control,a);i++}e=i-1}}if(r===1){this._oAdvancedAreaForm.addFormContainer(new N)}};O.prototype._layOutAASingleGroup=function(t){var e,i,r,a;var n=t.length-1;var s=n>2?2:1;if(s>1){r=Math.floor(n/s);a=r*s<n;for(e=1;e<s;e++){i=e*r;if(a){++i}if(i+e<t.length){t.splice(i+e,0,t[0])}}}this._layOutAAMultipleGroup(t)};O.prototype._flattenMap=function(){var t=null,e,i=[],r;if(this._mAdvancedAreaFilter){for(t in this._mAdvancedAreaFilter){if(t&&this._mAdvancedAreaFilter[t].items){r=false;for(e=0;e<this._mAdvancedAreaFilter[t].items.length;e++){var a=this._mAdvancedAreaFilter[t].items[e];if(a.filterItem&&a.filterItem.getVisibleInFilterBar()&&a.filterItem.getVisible()&&!a.filterItem.getHiddenFilter()){if(!r){r=true;i.push({control:null,filterItem:this._mAdvancedAreaFilter[t].filterItem})}i.push({control:a.control,filterItem:a.filterItem})}}}}}return i};O.prototype._rerenderItem=function(t,e){var i;if(t){i=t.filterItem.getVisible()&&t.filterItem.getVisibleInFilterBar()&&!t.filterItem.getHiddenFilter();if(e!==undefined){i=i&&!e}if(t.container){t.container.setVisible(i);if(i){this._addContainer(t)}else{this._removeContainer(t)}}}};O.prototype._rerenderFilters=function(){var t;var e=null;var i=null;var r=[];if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];var a=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar()&&!i.filterItem.getHiddenFilter();if(a){r.push({visible:a,item:i})}else{this._removeContainer(i)}}}}}var n=this.getIsRunningInValueHelpDialog()&&!this._bShowAllFilters;var s=r.length;var o=r.length>this._nMaxFiltersByDefault?this._nMaxFiltersByDefault-1:this._nMaxFiltersByDefault;for(var l=0;l<r.length;l++){var h=n&&l>=o;this._rerenderItem(r[l].item,h)}if(this._oShowAllFiltersButton){if(n&&s>this._nMaxFiltersByDefault){this._oShowAllFiltersButton.setVisible(true)}else{this._oShowAllFiltersButton.setVisible(false)}}this._updateToolbarText()};O.prototype.rerenderFilters=function(){this._rerenderFilters()};O.prototype._setTriggerFilterChangeState=function(t){this._triggerFilterChangeState=t};O.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState};O.prototype._setConsiderFilterChanges=function(t){this._filterChangeSemaphore=t};O.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore};O.prototype.fireFilterChange=function(t){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}if(this._oAdaptFiltersDialog&&!this._oAdaptFiltersDialog.isOpen()){return}if(this._oAdaptFiltersDialog){this._bDirtyViaDialog=true;this._checkAssignedFilters()}this.fireEvent("filterChange",t)};O.prototype._notifyAboutChangedFilters=function(t,e){var i,r=this._determineByControl(e);if(t){i={added:e,filterItem:r}}else{i={deleted:e,filterItem:r}}this.fireFilterChange(i)};O.prototype._determineVariantFiltersInfo=function(t,e){var i;var r=null,a,n;var s=[];if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){if(this._mAdvancedAreaFilter[r].items){for(i=0;i<this._mAdvancedAreaFilter[r].items.length;i++){a=this._mAdvancedAreaFilter[r].items[i];if(t||a.filterItem.getVisible()){n={group:a.filterItem.getGroupName(),name:a.filterItem.getName(),partOfCurrentVariant:a.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:a.filterItem.getVisibleInFilterBar(),visible:a.filterItem.getVisible()};if(e||this._considerFilter(n)){s.push(n)}}}}}}}return s};O.prototype.mergeVariant=function(t,e){var i={};V(i,e);i.filterbar=[];i.filterBarVariant={};V(i.filterbar,t.filterbar);V(i.filterBarVariant,t.filterBarVariant);if(e&&e.hasOwnProperty("version")){i.filterbar=this._mergeVariantFields(i.filterbar,e.filterbar);i.filterBarVariant=e.filterBarVariant}return i};O.prototype._mergeVariantFields=function(t,e){var i;e.forEach(function(e){for(i=0;i<t.length;i++){if(t[i].group===e.group&&t[i].name===e.name){t.splice(i,1);break}}});return t.concat(e)};O.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof f){return true}return false};O.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false}return this.getDeltaVariantMode()};O.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this)};O.prototype._considerFilter=function(t){if(!this._isDeltaHandling()){return true}var e=null;var i=this._getStandardVariant();if(i&&i.filterbar){for(var r=0;r<i.filterbar.length;r++){if(i.filterbar[r].group===t.group&&i.filterbar[r].name===t.name){e=i.filterbar[r];break}}}if(!e){if(!t.partOfCurrentVariant){return false}return true}if(e.partOfCurrentVariant!==t.partOfCurrentVariant||e.visibleInFilterBar!==t.visibleInFilterBar||e.visible!==t.visible){return true}return false};O.prototype._addControlToAdvancedArea=function(t,e,i){var r=new x({label:t.getLabelControl(this.getId()),fields:[e!==null?e:new a]});i.addFormElement(r)};O.prototype._determineVisibility=function(t){var e=false;if(t){e=t.getVisible()&&(t.getVisibleInFilterBar()||this._checkIfFilterHasValue(t.getName()));e=e&&!t.getHiddenFilter()}return e};O.prototype._retrieveVisibleAdvancedItems=function(){var t,e=null,i;var r=[];if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e){if(this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];if(i){if(this._determineVisibility(i.filterItem)){r.push(i)}}}}}}}return r};O.prototype._retrieveCurrentSelectionSet=function(t,e){var i,r,a,n=[];var s=this._retrieveVisibleAdvancedItems();for(i=0;i<s.length;i++){r=s[i];if(r.control&&r.filterItem&&(e||!r.filterItem._isParameter())){if(t){a={name:s[i].filterItem.getName(),control:s[i].control}}else{a=s[i].control}n.push(a)}}return n};O.prototype.search=function(){this.fireSearch({selectionSet:this._retrieveCurrentSelectionSet(false),firedFromFilterBar:this._bSearchFiredFromFilterBar});this._bSearchFiredFromFilterBar=false;return true};O.prototype._searchFromFilterBar=function(){this._bSearchFiredFromFilterBar=true;this.search.apply(this,arguments)};O.prototype.clear=function(){var t={};t.selectionSet=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(t.selectionSet);this._clearErrorState();this.fireClear(t);this._updateToolbarText()};O.prototype._deleteValidatingTokenFlag=function(t){t.forEach(function(t){if(t.hasOwnProperty("__bValidatingToken")){delete t.__bValidatingToken}})};O.prototype.reset=function(){var t={};t.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(t);this._resetVariant()};O.prototype._resetVariant=function(){var t=null,e=null;this._resetFiltersInErrorValueState();var i=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(i);if(this._oVariantManagement){var r=this._oVariantManagement.getSelectionKey()||this._oVariantManagement.getStandardVariantKey();if(r){t=this._oVariantManagement.getVariantContent(this,r);if(this._oVariant){this._oVariant.content=t;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=t;this._oInitialVariant.modified=false;this._oInitialVariant.key=r}}if(!this.getPersistencyKey()&&this.getUseSnapshot()===undefined&&this._oInitialVariant&&this._oInitialVariant.content){e=this._oInitialVariant.content}if(t||e){this.applyVariant(t||e,"RESET")}}}};O.prototype._removeValuesForNonPartOfCurrentVariants=function(t){};O.prototype._removeEmptyFilters=function(t){return t};O.prototype._applyVariant=function(t,e,i,r){var a,n=null,s,o=false,l=[];if(t){if(i){s=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false)}this._setConsiderFilterChanges(false);a=t.filterBarVariant;n=t.filterbar;if(this._oFilterProvider){this._oFilterProvider._setSingleInputsTextArrangementData(JSON.parse(t.singleInputsTextArrangementData||"{}"))}l=t.orderedFilterItems?JSON.parse(t.orderedFilterItems):[];if(!l.length){l=this._mAdvancedAreaFilterFlat}if(Array.isArray(n)&&n.length){this._ensureFilterLoaded(n.filter(function(t){return t.visibleInFilterBar}))}this._applyVariantFields(a,r);var h=this._reapplyVisibility(n,e==="CANCEL");this._removeValuesForNonPartOfCurrentVariants(h);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||t.basicSearch)}if(t.executeOnSelection){o=t.executeOnSelection}this._reorderItemsInBasicAreaLayout(l);this._aOrderedFilterItems=l;this._reorderItemsInAdvancedAreaFilter();this.fireAfterVariantLoad(e,o);this._setConsiderFilterChanges(true);this._updateToolbarText();if(o||this.getLiveMode&&this.getLiveMode()){this._searchFromFilterBar()}else if(e!=="CANCEL"){this._clearErrorState()}if(i){this._setTriggerFilterChangeState(s)}}};O.prototype._fetchVariantFiltersData=function(t){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(t)}catch(t){b.error("callback for fetching data throws an exception")}}else{b.warning("no callback for fetch data supplied")}return null};O.prototype._applyVariantFields=function(t,e){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(t,e)}catch(t){b.error("callback for applying data throws an exception")}}else{b.warning("no callback for apply data supplied")}};O.prototype._isStandardVariant=function(){var t=this.getCurrentVariantId();if(!t){return true}if(this._oVariantManagement){if(t===this._oVariantManagement.getStandardVariantKey()){return true}if(this._oVariantManagement._oStandardVariant===null){return true}}return false};O.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var t=this.getCurrentVariantId();if(!t){return this._oVariantManagement.getExecuteOnSelectForStandardVariant()}var e=this._oVariantManagement.getItemByKey(t);if(e){return e.getExecuteOnSelection()}}return false};O.prototype.fetchVariant=function(){var t,e={},i,r,a=[];if(this._isDeltaHandling()){if(!this._isStandardVariant()){e.version="V3"}}this.fireBeforeVariantFetch();t=this._determineVariantFiltersInfo(true,!e.version);e.filterbar=!t?[]:t;var n=function(t){t.forEach(function(t){a.push({name:t.name,group:t.group})})};if(this._aAdaptFilterItems&&this._aAdaptFilterItems.length>0){n(this._aAdaptFilterItems);e.orderedFilterItems=JSON.stringify(a)}else{this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat();n(this._mAdvancedAreaFilterFlat);e.orderedFilterItems=JSON.stringify(a)}r=this._fetchVariantFiltersData(e.version);e.filterBarVariant=this._removeEmptyFilters(r);e.singleInputsTextArrangementData=JSON.stringify(this._oFilterProvider?this._oFilterProvider._getSingleInputsTextArrangementData():{});i=this._getBasicSearchValue();if(i){e.basicSearch=i}if(this._oVariant&&this._oVariant.content){this._oVariant.content=e}return e};O.prototype.applyVariant=function(t,e,i){if(t.hasOwnProperty("version")){t=this.mergeVariant(this._getStandardVariant(),t,e)}this._applyVariant(t,e,i,t.version)};O.prototype._afterVariantsLoad=function(){if(this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded())}this._bDelayRendering=false};O.prototype.determineMandatoryFilterItems=function(){var t;var e=[];var i=this._retrieveVisibleAdvancedItems();for(t=0;t<i.length;t++){if(i[t].filterItem.getMandatory()===true){if(i[t].control){e.push(i[t].filterItem)}}}return e};O.prototype.determineControlByFilterItem=function(t,e){var i,r=null;var a,n;if(!t||!e&&t._isParameter()){return null}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){a=this._aBasicAreaSelection[i];if(t===a.filterItem){return a.control}}}if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){n=this._mAdvancedAreaFilter[r];if(n&&n.items){for(i=0;i<n.items.length;i++){a=n.items[i];if((e||!a.filterItem._isParameter())&&t===a.filterItem){return a.control}}}}}}return null};O.prototype.determineControlByName=function(t,e){var i=this._determineEnsuredItemByName(t,e);if(i&&i.filterItem&&!i.filterItem._isParameter()){return i.control}return null};O.prototype.determineLabelByName=function(t,e){var i=this._determineEnsuredItemByName(t,e);if(i&&i.filterItem){return i.filterItem._oLabel}return null};O.prototype._determineEnsuredItemByName=function(t,e){if(!e){e=this._determineGroupNameByName(t)}this._ensureFilterLoaded([{name:t,group:e}]);return this._determineItemByName(t,e)};O.prototype._determineGroupNameByName=function(t){if(this._aFields){for(var e=0;e<this._aFields.length;e++){if(this._aFields[e].fieldName===t){return this._aFields[e].groupName}}}var i=this._determineFilterItemByName(t);if(i){var r=i.getGroupName();if(r!==O.INTERNAL_GROUP){return r}}return null};O.prototype._determineItemByName=function(t,e){var i;var r,a;var n=e;if(!t){return null}if(!n){n=O.INTERNAL_GROUP}if(this._mAdvancedAreaFilter){a=this._mAdvancedAreaFilter[n];if(a&&a.items){for(i=0;i<a.items.length;i++){r=a.items[i];if(r&&r.filterItem&&r.filterItem.getName()===t){return r}}}}return null};O.prototype.determineFilterItemByName=function(t,e){var i;if(e){i=this._determineEnsuredItemByName(t,e)}else{i=this._determineEnsuredItemByName(t)}if(i&&i.filterItem){return i.filterItem}return null};O.prototype._determineFilterItemByName=function(t){var e,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){i=this._determineItemByName(t,e);if(i){return i.filterItem}}}return null};O.prototype._determineByControl=function(t){var e=null,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e){var r=this._mAdvancedAreaFilter[e];if(r&&r.items){for(i=0;i<r.items.length;i++){if(r.items[i]&&r.items[i].control===t){return r.items[i]}}}}}}return null};O.prototype.onAfterRendering=function(t){if(!(this._isPhone()||this._isTablet())){if(this._oHintText&&this._oHintText.getVisible()){this._bNoFiltersInAdvancedArea=true;this.setFilterBarExpanded(false)}}if(this.getIsRunningInValueHelpDialog()){if(!this._isPhone()){var e=this.iAddedContentLength,i=this._oBasicAreaLayout.getContent(),r;if(e>0&&e<4){for(var a=3;a>=4-e;a--){r=i[a].$().parent()[0];if(r){r.style.height="0px";r.style.margin="0px"}}}}}else{if(this._oToolbar&&this._oBasicSearchField&&(this._oVariantManagement&&this._oVariantManagement.getVisible()||this.getHeader())&&!this._isPhone()&&!this._oToolbar.getContent()[1].isA("sap.m.ToolbarSeparator")){this._oToolbar.insertContent((new T).addStyleClass("sapUiTinyMarginEnd"),1)}}};O.prototype._destroyLazyFilterControl=function(){var t,e;if(this._aFields&&this._aFields.length>0){if(this._aFields&&this._aFields.length>0){for(t=0;t<this._aFields.length;t++){e=this._aFields[t];if(e.factory){if(e.control){e.control.destroy()}}}}}};O.prototype._destroyNonVisibleFilterControl=function(){var t,e,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];if(i&&i.container){if(this._oBasicAreaLayout&&this._oBasicAreaLayout.indexOfContent(i.container)<0){if(i.control&&!i.bDestroyed){i.control.destroy();i.bDestroyed=true}}}}}}}};O.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl()}};O.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this)}};O.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy()}}};O.prototype.showFilterDialog=function(){if(!this._oAdaptFiltersDialog){this.showAdaptFilterDialog()}};O.prototype.addFilterDialogContent=function(t){if(this._oAdaptFiltersDialog){return t}return null};O.prototype.getFilterDialogContent=function(){if(this._oAdaptFiltersDialog){return new sap.ui.layout.form.Form}return null};O.prototype.setShowOldFilterDialog=function(){};O.prototype._getFilterControlById=function(t){for(var e in this._mAdvancedAreaFilter){var i=this._mAdvancedAreaFilter[e];for(var r=0;r<i.items.length;r++){var a=i.items[r];if(a.control&&a.control.getId()===t){return a.control}}}return null};O.prototype._getFilterControlByIndex=function(t){var e=0;for(var i in this._mAdvancedAreaFilter){var r=this._mAdvancedAreaFilter[i];for(var a=0;a<r.items.length;a++){var n=r.items[a];if(n.filterItem.getVisibleInFilterBar()){if(e===t){return n.control}e++}}}};function W(t,e){var i=t.filter(function(t){return t.getText()===e});return i.length>0}O.prototype._getFilterControlByLabel=function(t){for(var e in this._mAdvancedAreaFilter){var i=this._mAdvancedAreaFilter[e];for(var r=0;r<i.items.length;r++){var a=i.items[r];if(a.control){if(W(a.control.getLabels(),t)){return a.control}}}}};O.prototype._isFilterItemInBasicGroup=function(t){return t&&!t.getGroupName()||t.getGroupName()===O.INTERNAL_GROUP};O.prototype._shouldBeVisible=function(t){return t.filterItem.getMandatory()&&!this._hasFilterValue(t.filterItem)||t.name==="_BASIC_SEARCH_FIELD"};O.prototype.exit=function(){this._unregisterVariantManagement();this._destroyFilterControls();if(this._oHintText&&this._oAdvancedPanel.indexOfContent(this._oHintText)<0){this._oHintText.destroy()}window.sessionStorage.removeItem(this.getId());window.sessionStorage.removeItem("semanticDates");c.prototype.exit.apply(this,arguments);if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null}if(this._oAdaptFiltersDialogModel){this._oAdaptFiltersDialogModel=null}if(this._oAdaptFiltersPanel){this._oAdaptFiltersPanel=null}if(this.oModel){this.oModel.destroy();this.oModel=null}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;this._bLayoutAdded=null;this.iAddedContentLength=null;this._bSearchFiredFromFilterBar=false;this._oInitializedDeferred=null};return O});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterGroupItem", ["./FilterItem","sap/ui/comp/library"],function(t,e){"use strict";var r=t.extend("sap.ui.comp.filterbar.FilterGroupItem",{metadata:{library:"sap.ui.comp",properties:{groupTitle:{type:"string",group:"Misc",defaultValue:null},groupName:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false}}}});r.prototype.init=function(){this.setVisibleInAdvancedArea(false);this._setParameter(false)};r.prototype._setParameter=function(t){this._bIsParameter=t};r.prototype.setGroupTitle=function(t){this.setProperty("groupTitle",t);this.fireChange({propertyName:"groupTitle"});return this};r.prototype.setVisibleInAdvancedArea=function(t){this.setVisibleInFilterBar(t);return this};r.prototype.getVisibleInAdvancedArea=function(){return this.getVisibleInFilterBar()};r.prototype._getControl=function(){return this.getControl.apply(this,arguments)};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments)};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterItem", ["sap/m/Label","sap/ui/core/Element","sap/ui/comp/util/IdentifierUtil"],function(t,e,r){"use strict";var o=e.extend("sap.ui.comp.filterbar.FilterItem",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},name:{type:"string",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},visible:{type:"boolean",group:"Misc",defaultValue:true},labelTooltip:{type:"string",group:"Misc",defaultValue:null},controlTooltip:{type:"string",group:"Misc",defaultValue:null},partOfCurrentVariant:{type:"boolean",group:"Misc",defaultValue:true},visibleInFilterBar:{type:"boolean",group:"Misc",defaultValue:true},hiddenFilter:{type:"boolean",group:"Misc",defaultValue:false},entitySetName:{type:"string",group:"Misc",defaultValue:null},entityTypeName:{type:"string",group:"Misc",defaultValue:null}},aggregations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});o.prototype.init=function(){this._oLabel=null;this._bIsParameter=false;this._sControlId=null};o.prototype.setControl=function(t){if(t&&t.getId){this._sControlId=t.getId()}this.setAggregation("control",t);return this};o.prototype.getControl=function(){var t=this.getAggregation("control");if(t){return t}if(this._sControlId===null){return null}return sap.ui.getCore().byId(this._sControlId)};o.prototype._getControl=function(){return this.getControl.apply(this,arguments)};o.prototype._isParameter=function(){return this._bIsParameter};o.prototype.setVisible=function(t){this.setProperty("visible",t);this.fireChange({propertyName:"visible"});return this};o.prototype.setVisibleInFilterBar=function(t){this.setProperty("visibleInFilterBar",t);this.fireChange({propertyName:"visibleInFilterBar"});return this};o.prototype.setPartOfCurrentVariant=function(t){if(t){this.fireChange({propertyName:"partOfCurrentVariant"})}return this};o.prototype.getPartOfCurrentVariant=function(){return true};o.prototype._getGroupName=function(){var t="";if(this.getGroupName){t=r.replace(this.getGroupName())}return t};o.prototype._getName=function(){var t=r.replace(this.getName());var e=this._getGroupName();if(e){t=e+"-"+t}return t};o.prototype._createLabelControl=function(e){var r=this.getLabel();var o="filterItem-"+this._getName();if(e){o=e+"-"+o}var i=new t({id:o,required:this.getMandatory(),textAlign:"Begin"});i.setText(r);i.setTooltip(this.getLabelTooltip());return i};o.prototype.setMandatory=function(t){this.setProperty("mandatory",t);if(this._oLabel){this._oLabel.setRequired(t)}this.fireChange({propertyName:"mandatory"});return this};o.prototype.setLabel=function(t){this.setProperty("label",t);if(this._oLabel){this._oLabel.setText(t)}if(!this.getLabelTooltip()){this.setLabelTooltip(t)}this.fireChange({propertyName:"label"});return this};o.prototype.setLabelTooltip=function(t){this.setProperty("labelTooltip",t);if(this._oLabel){this._oLabel.setTooltip(t)}this.fireChange({propertyName:"labelTooltip"});return this};o.prototype.setControlTooltip=function(t){this.setProperty("controlTooltip",t);this.fireChange({propertyName:"controlTooltip"});return this};o.prototype.getLabelControl=function(t){if(!this._oLabel){this._oLabel=this._createLabelControl(t)}return this._oLabel};o.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._oLabel&&!this._oLabel.bIsDestroyed){this._oLabel.destroy()}if(this._getControl()&&!this._getControl().bIsDestroyed){this._getControl().destroy()}var t=this.getId()+"__filterGroupItem",r=sap.ui.getCore().byId(t);if(r){e.prototype.destroy.apply(r,arguments);if(r._oLabel&&!r._oLabel.bIsDestroyed){r._oLabel.destroy()}r._oLabel=null}this._oLabel=null;this._sQuickinfo=null};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/VariantConverterFrom", ["sap/ui/comp/library","sap/ui/comp/util/DateTimeUtil","sap/m/DatePicker","sap/m/DateRangeSelection","sap/base/Log","sap/ui/core/format/DateFormat"],function(e,t,i,a,r,n){"use strict";var o=e.ANALYTICAL_PARAMETER_PREFIX;var l=e.smartfilterbar.FilterType;var s=e.valuehelpdialog.ValueHelpRangeOperation;var f=function(){};f.prototype.convert=function(e,t,i){var a=null,r=null,n;if(e){this._bStrictMode=i;n=JSON.parse(e);if(t&&t.getFilterBarViewMetadata&&n){this._sBasicSearchName=null;this._sBasicSearchValue=null;if(t.getBasicSearchName){this._sBasicSearchName=t.getBasicSearchName()}a={};if(n.Parameters){this._addParameters(n.Parameters,t,a)}if(n.SelectOptions){this._addSelectOptions(n.SelectOptions,t,a)}r={payload:null,variantId:null};r.payload=JSON.stringify(a);if(n.SelectionVariantID){r.variantId=n.SelectionVariantID}if(this._sBasicSearchValue){r.basicSearch=this._sBasicSearchValue}}}return r};f.prototype.retrieveVariantId=function(e){var t=null;var i;if(e){i=JSON.parse(e);if(i&&i.SelectionVariantID){t=i.SelectionVariantID}}return t};f.prototype._getParameterMetaData=function(e,t,i){if(this._bStrictMode){return this._getParameterMetaDataStrictMode(e,t)}return this._getParameterMetaDataNonStrictMode(e,t,i)};f.prototype._getFilter=function(e,t){var i,a,r,n;n=t.getFilterBarViewMetadata();if(n){for(i=0;i<n.length;i++){r=n[i];for(a=0;a<r.fields.length;a++){if(e===r.fields[a].fieldName){return r.fields[a]}}}}return null};f.prototype._getParameter=function(e,t){var i,a;if(t.getAnalyticalParameters){a=t.getAnalyticalParameters();if(a){for(i=0;i<a.length;i++){if(e===a[i].fieldName){return a[i]}}}}return null};f.prototype._getParameterWithInnerPrefix=function(e,t){var i=e;if(e.indexOf(o)!==0){i=o+e}return this._getParameter(i,t)};f.prototype._getParameterMetaDataStrictMode=function(e,t){var i=this._getExactFilterParameterMatch(e,t);if(i){return i}return null};f.prototype._getParameterMetaDataNonStrictMode=function(e,t,i){var a,r,n,l,s=e,f=false,c=function(){return f&&s===l||!f&&s!==l};if(e.indexOf(o)===0){s=e.substr(o.length);f=true}if(s.indexOf("P_")===0){r=s;n=s.substr(2)}else{r="P_"+s;n=s}if(s!==r){l=r}else if(s!==n){l=n}a=this._getExactParameterMatch(s,t);if(a){return a}a=this._getExactParameterMatch(l,t);if(a){return a}if(c()){a=this._getFilter(n,t);if(a){return a}}return null};f.prototype._getExactParameterMatch=function(e,t){var i;i=this._getParameterWithInnerPrefix(e,t);if(i){return i}return null};f.prototype._getExactFilterParameterMatch=function(e,t){var i,a;i=this._getFilter(e,t);if(i){return i}a=this._getParameterWithInnerPrefix(e,t);if(a){return a}return null};f.prototype._addParameters=function(e,t,i){var a;var n,o;var l;for(a=0;a<e.length;a++){o=e[a].PropertyValue;n=e[a].PropertyName;if(this._sBasicSearchName&&n===this._sBasicSearchName){this._sBasicSearchValue=o;continue}l=this._getParameterMetaData(n,t,true);if(l){t.determineControlByName(n);this._addAccordingMetaData(i,t,l,o)}else{r.error("neither metadata nor custom information for filter '"+n+"'")}}};f.prototype._addSelectOptions=function(e,t,i){var a;var n,o;var l,s;for(a=0;a<e.length;a++){n=e[a].PropertyName;o=e[a].Ranges;if(this._sBasicSearchName&&n===this._sBasicSearchName){if(o&&o.length>0){this._sBasicSearchValue=o[0].Low}continue}t.determineControlByName(n);l=this._getParameterMetaData(n,t,false);if(l){s=l.control;this._addRangesAccordingMetaData(i,t,l,o,s)}else{r.error("neither metadata nor custom information for filter '"+n+"'")}}};f.convertOption=function(e,t){var i;switch(e){case"CP":i=s.Contains;if(t){var a=t.indexOf("*");var n=t.lastIndexOf("*");if(a>-1){if(a===0&&n!==t.length-1){i=s.EndsWith;t=t.substring(1,t.length)}else if(a!==0&&n===t.length-1){i=s.StartsWith;t=t.substring(0,t.length-1)}else{t=t.substring(1,t.length-1)}}}break;case"EQ":if(t===""||t===null){i=s.Empty;t=null}else{i=e}break;case"BT":case"LE":case"GE":case"GT":case"LT":i=e;break;default:r.error("Suite Option is not supported '"+e+"'");i=undefined;t=undefined}return{op:i,v:t}};f.prototype._getYearMonthDatePattern=function(e){var t=e.match(/^([0-9]{4})([0-9]{2})([0-9]{2})$/);if(t){return[t[1],t[2],t[3]]}};f.prototype._getTimeZoneFormat=function(e){return e.split(/[\s+-]/)[0]};f.prototype._createDateObject=function(e){var t,i,a,r,n,o,l,s;if(!e){return}t=e.split(".");i=t[0];a=t[1];if(a){a=this._getTimeZoneFormat(a)}n=i.split("T");s=n[0].split("-");if(s.length===1){r=this._getYearMonthDatePattern(s[0]);if(r){s=r}}if(n.length<2){o=new Date(s[0],s[1]-1,s[2])}else{l=n[1].split(":");o=new Date(s[0],s[1]-1,s[2],l[0],l[1],l[2],a?a:0)}o.setFullYear(s[0]);return o};f.prototype._addRangesAccordingMetaData=function(e,o,c,u,d,m){var h,p;var g=function(e,i,a,n){if(i&&i.isInUTCMode&&a.indexOf("PT")===-1&&e.filterType==="date"){if(i.isInUTCMode()){a=a.split("T")[0]+"T00:00:00"}else if(!i.isInUTCMode()&&a.split("T").length===1){a+="T00:00:00"}}if(a.indexOf("Z")!==a.length-1){if(i&&i.isInUTCMode&&!i.isInUTCMode()){n=t.localToUtc(this._createDateObject(a)).toJSON()}else{n=this._createDateObject(a).toJSON()}}else{r.error("Property '"+e.fieldName+"' was added with zulu time zone information.")}return n}.bind(this);var v=function(e){var t=n.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};var _=function(e){var t=e;if(e&&c){if(c.filterType==="numeric"){if(c.type==="Edm.Decimal"||c.type==="Edm.Float"||c.type==="Edm.Double"||c.type==="Edm.Single"){t=parseFloat(e)}else{t=parseInt(e)}}else{switch(c.type){case"Edm.DateTime":t=g(c,o,e,t);break;case"Edm.Time":if(e.indexOf("PT")===0){t=v(e)}else{t=g(c,o,e,t)}break;case"Edm.String":if(c.isCalendarDate&&!(c.filterType==="stringdate"&&c.controlType==="date")){t=g(c,o,e,t)}break;case"Edm.DateTimeOffset":t=e;break;case"Edm.Date":var i=e.split("T"),a=i[1];if(a){a=this._getTimeZoneFormat(a)}t=a?i[0]+"T"+a:e;break;default:t=e;break}}}return t};var y=function(t,i){var a,r,n;for(a=0;a<i.length;a++){n=f.convertOption(i[a].Option,i[a].Low);if(n&&n.op){r={exclude:i[a].Sign==="E",operation:n.op,keyField:t,value1:_(n.v),value2:_(i[a].High)};if(!e[t]){e[t]={ranges:[],items:[],value:null}}e[t].ranges.push(r)}}};var S=function(e){for(var t=0;t<e.length;t++){if(e[t].Sign==="E"){return true}}return false};if(u&&u.length>0){if(c.isCustomFilterField){if(!e._CUSTOM){e._CUSTOM={}}if(Array.isArray(u)&&u.length>1){e._CUSTOM[c.fieldName]=u.map(function(e){return e.Low})}else{e._CUSTOM[c.fieldName]=u[0].Low}return}if(c.conditionType){for(h=0;h<u.length;h++){if(!u[h].High){u[h].High=u[h].Low}}y(c.fieldName,u);return}if(c.filterRestriction===l.single){if(!u[0].Low&&d&&d instanceof i){e[c.fieldName]=null}else{e[c.fieldName]=_(u[0].Low)}}else if(c.filterRestriction===l.interval){if(d&&d instanceof a){if(u[0].Low&&u[0].High){e[c.fieldName]={low:_(u[0].Low),high:_(u[0].High)}}else if(u[0].Low&&!u[0].High){e[c.fieldName]={low:_(u[0].Low),high:_(u[0].Low)}}else if(!u[0].Low&&u[0].High){e[c.fieldName]={low:_(u[0].High),high:_(u[0].High)}}else{e[c.fieldName]={low:null,high:null}}}else{if(c.type==="Edm.Time"){y(c.fieldName,u)}else{e[c.fieldName]={low:u[0].Low===undefined?null:_(u[0].Low),high:u[0].High===undefined?null:_(u[0].High)}}}}else if(c.filterRestriction===l.multiple){e[c.fieldName]={ranges:[],items:[],value:null};var T=c.type==="Edm.DateTimeOffset"||c.isCalendarDate||c.type==="Edm.DateTime"||c.type==="Edm.Time";var M=d&&d.isA("sap.m.MultiInput")&&S(u);if(d&&!T&&(d.isA("sap.m.MultiComboBox")||d.isA("sap.m.MultiInput"))&&!M){var P;for(h=0;h<u.length;h++){P=_(u[h].Low);if(u[h].Option==="EQ"&&P===""){p={op:u[h].Option,v:P}}else{p=f.convertOption(u[h].Option,P)}if(p.op===s.EQ){e[c.fieldName].items.push({key:_(p.v)})}}}else{y(c.fieldName,u)}}else{y(c.fieldName,u)}r.warning("potential reduced information for filter '"+c.fieldName+"'")}else{r.warning("no Ranges-section found for filter '"+c.fieldName+"'")}};f.prototype._addAccordingMetaData=function(e,t,i,a){var r=i.type==="Edm.DateTime"?"":a;var n=[{Sign:"I",Low:a,High:r,Option:"EQ"}];this._addRangesAccordingMetaData(e,t,i,n)};return f},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/VariantConverterTo", ["sap/ui/comp/library","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/core/format/DateFormat","sap/ui/core/format/TimezoneUtil","sap/base/Log"],function(e,a,t,i,n,l,r){"use strict";var s=e.smartfilterbar.FilterType;var o=e.valuehelpdialog.ValueHelpRangeOperation;var g=e.ANALYTICAL_PARAMETER_PREFIX;var u=function(){};u.prototype.convert=function(e,a,t,i,n,l,r){var s,o,g,d,f=null,h,p;var c={SelectionVariantID:e};if(l){c.ParameterContextUrl=l}if(r){c.FilterContextUrl=r}this._sAPILevel=n;if(t&&a){g=JSON.parse(t);if(g){s=this._getFields(a);if(s&&s.length>0){for(o=0;o<s.length;o++){this._convertField(c,s[o],g,i)}}if(g._CUSTOM){if(typeof g._CUSTOM==="string"){d=JSON.parse(g._CUSTOM)}else{d=g._CUSTOM}for(f in d){if(f){if(Array.isArray(d[f])&&d[f].length>1){this._addArrayOfSingleValues(c,f,d[f])}else{this._addSingleValue(c,f,u._getValue(d[f],true))}}}}if(i&&i.getBasicSearchName){h=i.getBasicSearchName();if(h){p=i.getBasicSearchValue();this._addSingleValue(c,h,u._getValue(p,true))}}}}return JSON.stringify(c)};u.prototype._getParameterMetaData=function(e,a){var t,i,n;var l=a.getFilterBarViewMetadata();if(l){for(t=0;t<l.length;t++){n=l[t];for(i=0;i<n.fields.length;i++){if(e===n.fields[i].fieldName){return n.fields[i]}}}}if(a.getAnalyticalParameters){var r=a.getAnalyticalParameters();if(r){for(i=0;i<r.length;i++){if(e===r[i].fieldName){return r[i]}}}}return null};u.prototype._convertField=function(e,a,n,l){var r,o,g=null,d,f,h,p;if(n&&a&&e){r=n[a];if(r){f=this._getParameterMetaData(a,l);if(f){if(f.isCustomFilterField){return}var c=l.getUseDateRangeType()&&(f.type==="Edm.DateTime"&&f.displayFormat==="Date"||f.type==="Edm.String"&&f.isCalendarDate)||n[a]&&n[a].conditionTypeInfo&&n[a].conditionTypeInfo.name&&n[a].conditionTypeInfo.name==="sap.ui.comp.config.condition.DateRangeType";if(f.filterRestriction===s.single&&(!c||f.isParameter)){o=r.value===undefined?r:r.value;o=u._getValueWithMetadata(l,f,o,true);this._addSingleValue(e,a,o);if(c&&f.isParameter){if(n&&a&&e&&n[a]&&n[a].conditionTypeInfo){var r=n[a];if(r.ranges&&r.ranges.length>0){d=u.addRangeEntry(e,a);u.addRanges(d,r.ranges,l,f)}}}}else if(f.filterRestriction===s.interval){if(r.conditionTypeInfo){this._convertFieldByValue(e,a,n,l,f)}else{d=u.addRangeEntry(e,a);if(f.type==="Edm.DateTime"&&!r.high){r.high=r.low}else if(f.type==="Edm.String"&&!r.high){g="EQ"}if(f.type==="Edm.Time"){this._addRangeMultipleRangeValues(l,f,d,r.ranges,true)}else if(f.type==="Edm.DateTimeOffset"&&!r.high){g="BT";h=i.parseDateTimeOffsetInterval(r.low);if(h&&h.length===2&&h[0]){h[0]=f.ui5Type.parseValue(h[0],"string");if(h.length===2){h[1]=f.ui5Type.parseValue(h[1],"string")}p={low:h[0],high:h[1]};this._addRangeLowHigh(l,f,d,p,"BT")}else{this._addRangeLowHigh(l,f,d,r,"EQ")}}else if(t.isNumeric(f.type)&&!r.high){h=i.parseFilterNumericIntervalData(r.low);if(h&&h.length===2&&h[0]){this._addRangeLowHigh(l,f,d,{low:h[0],high:h[1]},"BT")}else{this._addRangeLowHigh(l,f,d,r,"EQ")}}else{this._addRangeLowHigh(l,f,d,r,g)}}}else if(f.filterRestriction===s.multiple){d=u.addRangeEntry(e,a);if(r.items&&r.items.length>0){this._addRangeMultipleSingleValues(l,f,d,r.items)}else if(r.ranges&&r.ranges.length>0){this._addRangeMultipleRangeValues(l,f,d,r.ranges,r.conditionTypeInfo?true:false)}else{this._addRangeSingleValue(d,r.value)}}else{this._convertFieldByValue(e,a,n,l,f)}}else{this._convertFieldByValue(e,a,n,l,f)}}}};u.prototype._convertFieldByValue=function(e,a,t,i,n){var l;var r;if(t&&a&&e){l=t[a];if(l){if(l.conditionTypeInfo){if(l.ranges&&l.ranges.length>0){r=u.addRangeEntry(e,a);u.addRanges(r,l.ranges,i,n)}}else if(l.ranges!==undefined&&l.items!==undefined&&l.value!==undefined){r=u.addRangeEntry(e,a);if(l.ranges&&l.ranges.length>0){u.addRanges(r,l.ranges,i,n)}if(l.items&&l.items.length>0){this._addRangeMultipleSingleValues(i,n,r,l.items)}if(l.value){this._addRangeSingleValue(r,u._getValueWithMetadata(i,n,l.value))}}else if(l.items!==undefined&&l.items&&l.items.length>0){r=u.addRangeEntry(e,a);this._addRangeMultipleSingleValues(i,n,r,l.items)}else if(l.low!==undefined&&l.low&&l.high!==undefined&&l.high){r=u.addRangeEntry(e,a);this._addRangeLowHigh(i,n,r,l)}else if(l.value!==undefined&&l.value){this._addSingleValue(e,a,l.value)}else if(l){this._addSingleValue(e,a,l)}}}};u.addRangeEntry=function(e,a){var t={PropertyName:a,Ranges:[]};if(!e.SelectOptions){e.SelectOptions=[]}e.SelectOptions.push(t);return t.Ranges};u.addRanges=function(e,a,t,i){var n,l,s,g;for(var d=0;d<a.length;d++){n=a[d].exclude?"E":"I";s=u._getValueWithMetadata(t,i,a[d].value1,true);g=null;if(a[d].operation===o.BT){g=u._getValueWithMetadata(t,i,a[d].value2)}switch(a[d].operation){case o.Contains:l="CP";if(s){s="*"+s+"*"}break;case o.StartsWith:l="CP";if(s){s=s+"*"}break;case o.EndsWith:l="CP";if(s){s="*"+s}break;case o.Empty:l="EQ";s="";break;case o.EQ:case o.BT:case o.LE:case o.GE:case o.GT:case o.LT:l=a[d].operation;break;default:r.error("ValueHelpRangeOperation is not supported '"+a[d].operation+"'");return}e.push({Sign:n,Option:l,Low:s,High:g})}};u.prototype._addRangeMultipleSingleValues=function(e,a,t,i){for(var n=0;n<i.length;n++){t.push({Sign:"I",Option:"EQ",Low:u._getValueWithMetadata(e,a,i[n].key,true),High:null})}};u.prototype._addRangeMultipleRangeValues=function(e,a,t,i,n){for(var l=0;l<i.length;l++){t.push({Sign:"I",Option:n?"BT":"EQ",Low:u._getValueWithMetadata(e,a,i[l].value1,true),High:n?u._getValueWithMetadata(e,a,i[l].value2):null})}};u.prototype._addRangeSingleValue=function(e,a){e.push({Sign:"I",Option:"EQ",Low:u._getValue(a,true),High:null})};u.prototype._addRangeLowHigh=function(e,a,t,i,n){var l=n||"BT";t.push({Sign:"I",Option:l,Low:u._getValueWithMetadata(e,a,i.low,true),High:u._getValueWithMetadata(e,a,i.high)})};u.prototype._addParamaterSingleValue=function(e,a,t){if(!e.Parameters){e.Parameters=[]}e.Parameters.push({PropertyName:a,PropertyValue:t})};u.prototype._createRangeSingleValue=function(e,a,t){var i=u.addRangeEntry(e,a);this._addRangeSingleValue(i,t)};u.prototype._addSingleValue=function(e,a,t){var i;if(this._sAPILevel){i=a.split(g);if(i.length>1){this._addParamaterSingleValue(e,i[i.length-1],t)}else{this._createRangeSingleValue(e,a,t)}}else{this._addParamaterSingleValue(e,a,t)}};u.prototype._addArrayOfSingleValues=function(e,a,t){var i=u.addRangeEntry(e,a);t.forEach(function(e){i.push({Sign:"I",Option:"EQ",Low:u._getValue(e,true),High:null})})};u.prototype._getFields=function(e){var a=[];if(e){for(var t=0;t<e.length;t++){a.push(e[t].name)}}return a};u._getValue=function(e,a){if(e===null||e===undefined||e===""){return a?"":null}return""+e};u._getValueWithMetadata=function(e,t,i,n){if(i===null||i===undefined||i===""){return n?"":null}else if(e&&t){if(t.type==="Edm.DateTime"||t.type==="Edm.Time"){if(t.isParameter&&i.oData){i=i.oData}if(t.isParameter&&!i.oData&&i.ranges&&i.ranges[0]&&i.ranges[0].value1){i=i.ranges[0].value1}if(e&&e.isInUTCMode&&e.isInUTCMode()){i=a.localToUtc(new Date(i)).toJSON()}if(i.indexOf("Z")===i.length-1){i=i.substr(0,i.length-1)}}else if(t.type==="Edm.DateTimeOffset"){var l=e&&e._oFilterProvider&&e._oFilterProvider._getFilterTimeZone(t.name);if(l){i=a.toTimezone(i,l).toJSON()}else{i=new Date(i).toJSON()}}}return""+i};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/Constants", function(){"use strict";var r="sapui5.history.";var t="ui5.";var e="__sapui5_suggestion_order";var i=5;return{getHistoryPrefix:function(){return r},getShortHistoryPrefix:function(){return t},getSuggestionsGroupPropertyName:function(){return e},getMaxHistoryItems:function(){return i}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryAppDataService", ["sap/ui/base/Object","./Constants","./Utils","./HistoryGlobalDataService"],function(t,i,e,a){"use strict";var n="en";var r;var s=t.extend("sap.ui.comp.historyvalues.HistoryAppDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});s.prototype._initialize=function(){this._initializeAppContainerId=this._initializeAppContainerId.bind(this);this._initializeAppData=this._initializeAppData.bind(this);this._sContainerId="";this._sItemId=i.getHistoryPrefix()+"appData";this._oPersonalizer=null;this._sAppId=i.getHistoryPrefix()+e.getAppInfo().id;this._oData={};this._oDataReadyPromise=this._getHistoryGlobalDataService().getApps().then(this._initializeAppContainerId).then(this._initializeAppData)};s.prototype._getHistoryGlobalDataService=function(){return a.getInstance()};s.prototype._initializeAppContainerId=function(t){this._sContainerId=t[this._sAppId];if(!this._sContainerId){this._createAndSaveContainerId(t)}return this._sContainerId};s.prototype._initializeAppData=function(){return this._getPersonalizer().getPersData().then(function(t){this._oData=t||this._getDefaultData();return this._oData}.bind(this))};s.prototype._getPersonalizer=function(){if(this._oPersonalizer){return this._oPersonalizer}var t=sap.ushell.Container.getService("Personalization"),i={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},e={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=t.getPersonalizer(e,i);return this._oPersonalizer};s.prototype._createAndSaveContainerId=function(t){this._sContainerId=this._createContainerId();t[this._sAppId]=this._sContainerId;this._getHistoryGlobalDataService().setApps(t)};s.prototype._createContainerId=function(){var t="xxxxxxxx.xxxx.4xxx.yxxx.xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=Math.random()*16|0;if(t==="y"){i=i&3|8}return i.toString(16)});return i.getShortHistoryPrefix()+t};s.prototype._getDefaultData=function(){return{}};s.prototype._isDataReady=function(){return this._oDataReadyPromise};s.prototype._getHistoryEnabled=function(){return this._getHistoryGlobalDataService().getHistoryEnabled()};s.prototype.getFieldData=function(t){return this._isDataReady().then(this._getHistoryEnabled.bind(this)).then(function(e){if(!e){return[]}var a=[],n=this._getLanguage();if(this._isDefaultLanguage(n)){a=this._oData[t]||[]}else{var r=i.getHistoryPrefix()+n;if(!this._oData[r]){a=[]}else{a=this._oData[r][t]||[]}}return a.slice()}.bind(this))};s.prototype.setFieldData=function(t,e){return this._isDataReady().then(this._getHistoryEnabled.bind(this)).then(function(a){if(!a){return false}var n=this._getLanguage();if(this._isDefaultLanguage(n)){this._oData[t]=e}else{var r=i.getHistoryPrefix()+n;if(!this._oData[r]){this._oData[r]={}}this._oData[r][t]=e}return this._getPersonalizer().setPersData(this._oData)}.bind(this))};s.prototype._getLanguage=function(){var t=sap.ui.getCore().getConfiguration().getLanguage()||n;var i=t.match(/[a-z]+/i);if(i[0]){t=i[0].toLowerCase()}return t};s.prototype._isDefaultLanguage=function(t){return t===n};s.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._sAppId="";this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){var t=i.getHistoryPrefix()+e.getAppInfo().id;if(!r){r=new s}if(r._sAppId!==t){r.destroy();r=new s}return r}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryGlobalDataService", ["sap/ui/base/Object","./Constants"],function(t,i){"use strict";var e;var a=t.extend("sap.ui.comp.historyvalues.HistoryGlobalDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});a.prototype._initialize=function(){this._initializeHistoryData=this._initializeHistoryData.bind(this);this._sContainerId=i.getHistoryPrefix()+"HistorySettings";this._sItemId=i.getHistoryPrefix()+"settings";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=this._getPersonalizer().getPersData().then(this._initializeHistoryData)};a.prototype._initializeHistoryData=function(t){this._oData=t||this._getDefaultData();return Object.assign({},this._oData)};a.prototype._getPersonalizer=function(){if(this._oPersonalizer){return this._oPersonalizer}var t=sap.ushell.Container.getService("Personalization"),i={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},e={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=t.getPersonalizer(e,i);return this._oPersonalizer};a.prototype._getDefaultData=function(){return{historyEnabled:true,apps:{}}};a.prototype._isDataReady=function(){return this._oDataReadyPromise};a.prototype.getHistoryEnabled=function(){return this._isDataReady().then(function(){return this._oData.historyEnabled}.bind(this))};a.prototype.setHistoryEnabled=function(t){return this._isDataReady().then(function(){this._oData.historyEnabled=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};a.prototype.getApps=function(){return this._isDataReady().then(function(){return Object.assign({},this._oData.apps)}.bind(this))};a.prototype.setApps=function(t){return this._isDataReady().then(function(){this._oData.apps=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};a.prototype.deleteHistory=function(){return this._isDataReady().then(function(){var t=this._oData,i=[],e=t.apps;Object.keys(e).forEach(function(t){i.push(sap.ushell.Container.getService("Personalization").delContainer(e[t]))});return Promise.all(i)}.bind(this))};a.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){if(!e){e=new a}return e}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryOptOutProvider", ["sap/ui/base/Object","sap/ui/core/Core","sap/ui/core/IconPool","./HistoryGlobalDataService","./Constants","./Utils","sap/m/Dialog","sap/m/MessageBox","sap/m/FlexBox","sap/m/VBox","sap/m/HBox","sap/m/Switch","sap/m/Button","sap/m/Label"],function(t,e,o,i,s,n,a,r,l,u,_,h,c,y){"use strict";var p;var H=t.extend("sap.ui.comp.historyvalues.HistoryOptOutProvider",{metadata:{library:"sap.ui.comp"},constructor:function(){t.apply(this,arguments);this._initialize()}});H.prototype._initialize=function(){this._oRB=e.getLibraryResourceBundle("sap.ui.comp");this._oHistoryGlobalDataService=i.getInstance();this._oDialog=null;this._oHistoryEnabledSwitch=null;this._oHistoryEnabledLabel=null;this._oDeleteHistoryButton=null;this._oDeleteHistoryLabel=null;this._oSaveButton=null;this._oCancelButton=null;this._oDialogLayout=null;this._oHistoryEnabledLayout=null;this._oDeleteHistoryLayout=null};H.prototype._createOptOutUserProfileEntry=function(){var t=sap.ushell.Container.getRenderer("fiori2"),e={controlType:"sap.m.Button",oControlProperties:{id:s.getHistoryPrefix()+"optOut.trigger",text:this._oRB.getText("HISTORY_SETTING_TITLE"),icon:o.getIconURI("history"),press:function(){this._createDialogContent();this._createLayouts();this._createDialog();this._oHistoryGlobalDataService.getHistoryEnabled().then(function(t){this._oHistoryEnabledSwitch.setState(t);this._oDialog.open()}.bind(this))}.bind(this)},bIsVisible:true,bCurrentState:true};return t.addUserAction(e)};H.prototype._createDialogContent=function(){this._createHistoryEnabledSwitch();this._createHistoryEnabledLabel();this._createDeleteHistoryButton();this._createDeleteHistoryLabel();this._createSaveButton();this._createCancelButton()};H.prototype._createLayouts=function(){this._oHistoryEnabledLayout=new _({alignItems:"Center",items:[this._oHistoryEnabledLabel,this._oHistoryEnabledSwitch]});this._oDeleteHistoryLayout=new l({alignItems:"Center",items:[this._oDeleteHistoryLabel,this._oDeleteHistoryButton]});this._oDialogLayout=new u({items:[this._oHistoryEnabledLayout,this._oDeleteHistoryLayout]}).addStyleClass("sapUiSmallMargin")};H.prototype._createDialog=function(){this._oDialog=new a(s.getHistoryPrefix()+"optOutDialog",{title:this._oRB.getText("HISTORY_SETTING_TITLE"),content:[this._oDialogLayout],buttons:[this._oSaveButton,this._oCancelButton]});this._oDialog.attachAfterClose(this._onOptOutDialogAfterClose,this)};H.prototype._createHistoryEnabledSwitch=function(){this._oHistoryEnabledSwitch=new h};H.prototype._createHistoryEnabledLabel=function(){this._oHistoryEnabledLabel=new y({text:this._oRB.getText("HISTORY_SETTING_ENABLE_TRACKING_DESCRIPTION")}).addStyleClass("sapUiSmallMarginEnd")};H.prototype._createDeleteHistoryButton=function(){this._oDeleteHistoryButton=new c({busyIndicatorDelay:0,text:this._oRB.getText("HISTORY_SETTING_DELETE_BUTTON")});this._oDeleteHistoryButton.attachPress(this._onDeleteHistoryPress,this)};H.prototype._createDeleteHistoryLabel=function(){this._oDeleteHistoryLabel=new y({text:this._oRB.getText("HISTORY_SETTING_DELETE_DESCRIPTION")}).addStyleClass("sapUiSmallMarginEnd")};H.prototype._createSaveButton=function(){this._oSaveButton=new c({text:this._oRB.getText("HISTORY_SETTING_SAVE")});this._oSaveButton.attachPress(this._onSavePress,this)};H.prototype._createCancelButton=function(){this._oCancelButton=new c({text:this._oRB.getText("HISTORY_SETTING_CANCEL")});this._oCancelButton.attachPress(this._onCancelPress,this)};H.prototype._onOptOutDialogAfterClose=function(){this._oDialog.destroy()};H.prototype._onDeleteHistoryPress=function(t){var e=t.getSource();e.setBusy(true);this._oHistoryGlobalDataService.deleteHistory().then(function(){e.setBusy(false)})};H.prototype._onSavePress=function(){r.confirm(this._oRB.getText("HISTORY_SETTING_CONFIRM"),{onClose:function(t){if(t=="CANCEL"){return}this._oHistoryGlobalDataService.setHistoryEnabled(this._oHistoryEnabledSwitch.getState()).then(function(){window.location.reload()})}.bind(this)})};H.prototype._onCancelPress=function(){this._oDialog.close()};H.prototype.exit=function(){if(this._oDialog){this._oDialog.destroy();this._oDialog=null}this._oRB=null;this._oHistoryEnabledSwitch=null;this._oHistoryEnabledLabel=null;this._oDeleteHistoryButton=null;this._oDeleteHistoryLabel=null;this._oSaveButton=null;this._oCancelButton=null;this._oDialogLayout=null;this._oHistoryEnabledLayout=null;this._oDeleteHistoryLayout=null};return{createOptOutSettingPage:function(){if(n.getAppInfo().homePage===true){return}if(!p){p=new H}if(!p._oUserActionPromise){p._oUserActionPromise=p._createOptOutUserProfileEntry()}else{p._oUserActionPromise.then(function(){p._oUserActionPromise=p._createOptOutUserProfileEntry()})}return p}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryValuesProvider", ["sap/ui/base/EventProvider","sap/base/util/values","./Constants","./HistoryGlobalDataService","./HistoryAppDataService"],function(t,e,o,i,n){"use strict";var a=t.extend("sap.ui.comp.providers.HistoryValuesProvider",{metadata:{library:"sap.ui.comp",events:{fieldUpdated:{parameters:{fieldData:{type:"Array"}}}}},constructor:function(e,o){t.apply(this,arguments);this._initialize(e,o)}});a.prototype._initialize=function(t,e){this._oControl=t;this._sFieldName=e};a.prototype._getHistoryGlobalDataService=function(){return i.getInstance()};a.prototype._getHistoryAppDataService=function(){return n.getInstance()};a.prototype.attachChangeListener=function(){if(this._oControl.isA("sap.m.MultiInput")){this._oControl.attachTokenUpdate(this._onMultiInputChange,this);return}if(this._oControl.isA("sap.m.MultiComboBox")){this._oControl.attachSelectionChange(this._onMultiComboBoxChange,this);return}if(this._oControl.isA("sap.m.Input")){this._oControl.attachSuggestionItemSelected(this._suggestionItemSelected,this);return}if(this._oControl.isA("sap.m.ComboBox")){this._oControl.attachChange(this._onComboBoxChange,this);return}};a.prototype._detachChangeListener=function(){if(this._oControl.isA("sap.m.MultiInput")){this._oControl.detachTokenUpdate(this._onMultiInputChange,this);return}if(this._oControl.isA("sap.m.MultiComboBox")){this._oControl.detachSelectionChange(this._onMultiComboBoxChange,this);return}if(this._oControl.isA("sap.m.Input")){this._oControl.detachSuggestionItemSelected(this._suggestionItemSelected,this);return}if(this._oControl.isA("sap.m.ComboBox")){this._oControl.detachChange(this._onComboBoxChange,this);return}};a.prototype._onMultiInputChange=function(t){var e=t.getParameter("type"),o=t.getParameter("addedTokens");if(e==="added"){var i=o.reduce(function(t,e){var o=e.data("row");if(o){return t.concat(o)}return t},[]);this.setFieldData(i)}};a.prototype._onMultiComboBoxChange=function(t){var e=t.getParameter("selected"),o=t.getParameter("changedItem");if(e&&o){var i=o.getBindingContext("list").getObject();this._processSingleValueControl(i)}};a.prototype._suggestionItemSelected=function(t){var e=sap.ui.getCore().byId(t.getSource().getSelectedRow());if(e){var o=e.getBindingContext("list").getObject();this._processSingleValueControl(o)}};a.prototype._onComboBoxChange=function(t){var e=t.getParameter("value"),o=t.getParameter("newValue"),i=t.getSource().getSelectedItem();if(e&&o&&i){var n=i.getBindingContext("list").getObject();this._processSingleValueControl(n)}};a.prototype._processSingleValueControl=function(t){if(t){this.setFieldData([t])}};a.prototype._processDateValues=function(t){return Object.keys(t).reduce(function(e,o){if(typeof t[o]==="object"&&Object.prototype.toString.call(t[o])==="[object Date]"){e[o]="/Date("+t[o].getTime()+")/"}else{e[o]=t[o]}return e},{})};a.prototype._getDistinct=function(t){var o={},i=[];t.forEach(function(t){var n=e(t).join();if(!o[n]){i.push(t);o[n]=true}},this);return i};a.prototype._getItemId=function(t){if(!t){return null}var e=t.lastIndexOf("(");return t.slice(e)};a.prototype.getFieldData=function(){return this._getHistoryAppDataService().getFieldData(this._sFieldName)};a.prototype.setFieldData=function(t){t=t.reduce(function(t,e){var i=this._getItemId(e.__metadata&&e.__metadata.id);e=Object.assign({},e);if(i){e=Object.assign({__ui5_id:i},e)}delete e.__metadata;delete e[o.getSuggestionsGroupPropertyName()];e=this._processDateValues(e);t.push(e);return t}.bind(this),[]);return this._getHistoryAppDataService().getFieldData(this._sFieldName).then(function(e){var i=o.getMaxHistoryItems(),n=this._getDistinct(t.concat(e));n=n.slice(0,i);this.fireEvent("fieldUpdated",{fieldData:n});return this._getHistoryAppDataService().setFieldData(this._sFieldName,n)}.bind(this))};a.prototype.getHistoryEnabled=function(){return this._getHistoryGlobalDataService().getHistoryEnabled()};a.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this._oControl){this._detachChangeListener();this._oControl=null}this._sFieldName="";this._oDataReadyPromise=null};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/Utils", function(){"use strict";return{getAppInfo:function e(){var t=sap.ushell.Container.getService("AppLifeCycle"),i=t.getCurrentApplication(),n,a,p,f={};if(i){n=i.componentInstance;f.homePage=i.homePage}if(n){a=n.getMetadata()}if(a){p=a.getManifest()}if(p){f.id=p["sap.app"].id}return f}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/library", ["sap/ui/core/Core","sap/ui/core/library","sap/m/library"],function(a,e,t){"use strict";var i=sap.ui.getCore().initLibrary({name:"sap.ui.comp",version:"1.108.14",dependencies:["sap.ui.core","sap.m"],designtime:"sap/ui/comp/designtime/library.designtime",types:["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartchart.SelectionMode","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smartfield.CriticalityRepresentationType","sap.ui.comp.smartfield.TextInEditModeSource","sap.ui.comp.smartfield.Importance","sap.ui.comp.TextArrangementType","sap.ui.comp.smarttable.TableType","sap.ui.comp.smarttable.ExportType","sap.ui.comp.smartlist.ListType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType","sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation","sap.ui.comp.smartfilterbar.SelectOptionSign","sap.ui.comp.smartfilterbar.DisplayBehaviour","sap.ui.comp.smartform.SmartFormValidationMode"],interfaces:["sap.ui.comp.smartform.SmartFormLayout","sap.ui.comp.IFormGroupElement"],controls:["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartLineMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smartmicrochart.SmartDeltaMicroChart","sap.ui.comp.smartmicrochart.SmartRadialMicroChart","sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart","sap.ui.comp.smartmicrochart.SmartComparisonMicroChart","sap.ui.comp.smartmicrochart.SmartColumnMicroChart","sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart","sap.ui.comp.smartmicrochart.SmartMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartlist.SmartList","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2","sap.ui.comp.transport.TransportDialog","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement"],elements:["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SemanticGroupElement","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem","sap.ui.comp.navpopover.NavigationContainer","sap.ui.comp.smartvariants.SmartVariantManagementAdapter"],extensions:{flChangeHandlers:{"sap.ui.comp.smartform.SmartForm":"sap/ui/comp/smartform/flexibility/SmartForm","sap.ui.comp.smartform.Group":{hideControl:"default",unhideControl:"default",renameGroup:"sap/ui/comp/smartform/flexibility/changes/RenameGroup",addField:"sap/ui/comp/smartform/flexibility/changes/AddField",addFields:"sap/ui/comp/smartform/flexibility/changes/AddFields",addMultiEditField:"sap/ui/comp/smartmultiedit/flexibility/changes/AddMultiEditFields"},"sap.ui.comp.smartform.GroupElement":{hideControl:"default",unhideControl:"sap/ui/comp/smartform/flexibility/changes/UnhideControl",renameField:"sap/ui/comp/smartform/flexibility/changes/RenameField"},"sap.ui.comp.navpopover.NavigationContainer":{addLink:{changeHandler:"sap/ui/comp/navpopover/flexibility/changes/AddLink",layers:{USER:true}},removeLink:{changeHandler:"sap/ui/comp/navpopover/flexibility/changes/RemoveLink",layers:{USER:true}}},"sap.ui.comp.smartfield.SmartField":"sap/ui/comp/smartfield/flexibility/SmartField","sap.ui.comp.smarttable.SmartTable":{ToolbarContentMove:"sap/ui/comp/smarttable/flexibility/ToolbarContentMove"}},"sap.ui.support":{publicRules:true}}})||sap.ui.comp;i.ANALYTICAL_PARAMETER_PREFIX="$Parameter.";i.STANDARD_VARIANT_NAME="STANDARD";i.smartform=i.smartform||{};i.smartform.inheritCostomDataToFields=function(a){var e=a.getKey();var t={startsWith:{strings:["sap.ui.fl"],compareFunction:function(a){return e.startsWith(a)}},wholeString:{strings:["sap-ui-custom-settings"],compareFunction:function(a){return e==a}}};var i=true;Object.keys(t).forEach(function(a){if(i&&t[a].strings.some(t[a].compareFunction)){i=false;return true}});return i};i.TextArrangementType={TextFirst:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TextLast:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TextSeparate:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate",TextOnly:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"};i.smartchart=i.smartchart||{};i.smartchart.SelectionMode={Multi:"MULTIPLE",Single:"SINGLE",None:"NONE"};i.smartfield=i.smartfield||{};i.smartfield.ControlType={auto:"auto",dropDownList:"dropDownList",input:"input",datePicker:"datePicker",checkBox:"checkBox",selection:"selection"};i.smartfield.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly",TrueFalse:"TrueFalse",OnOff:"OnOff",YesNo:"YesNo"};i.smartfield.JSONType={String:"String",Date:"Date",Float:"Float",Integer:"Integer",Boolean:"Boolean",DateTime:"DateTime"};i.smartfield.ControlContextType={None:"",ResponsiveTable:"responsiveTable",Form:"form",Table:"table",SmartFormGrid:"smartFormGrid"};i.smartfield.ControlProposalType={None:"",ObjectNumber:"ObjectNumber",ObjectIdentifier:"ObjectIdentifier"};i.smartfield.CriticalityRepresentationType={WithoutIcon:"WithoutIcon",WithIcon:"WithIcon"};i.smarttable=i.smarttable||{};i.smarttable.TableType={Table:"Table",ResponsiveTable:"ResponsiveTable",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable"};i.smarttable.InfoToolbarBehavior={Auto:"Auto",On:"On",Off:"Off"};i.smartfield.TextInEditModeSource={None:"None",NavigationProperty:"NavigationProperty",ValueList:"ValueList",ValueListNoValidation:"ValueListNoValidation",ValueListWarning:"ValueListWarning"};i.smartfield.Importance={High:"High",Medium:"Medium",Low:"Low"};i.smarttable.ExportType={GW:"GW",UI5Client:"UI5Client",UI5ClientPDF:"UI5ClientPDF"};i.smartlist=i.smartlist||{};i.smartlist.ListType={List:"List",Tree:"Tree"};i.personalization=i.personalization||{};i.personalization.ResetType={ResetFull:"ResetFull",ResetPartial:"ResetPartial"};i.personalization.AggregationRole={Dimension:"Dimension",Measure:"Measure",NotDimeasure:"NotDimeasure"};i.personalization.ChangeType={Unchanged:"Unchanged",ModelChanged:"ModelChanged",TableChanged:"TableChanged"};i.personalization.TableType={ResponsiveTable:"ResponsiveTable",Table:"Table",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable",ChartWrapper:"ChartWrapper",SelectionWrapper:"SelectionWrapper"};i.personalization.ColumnType={ResponsiveColumn:"ResponsiveColumn",TableColumn:"TableColumn",ColumnWrapper:"ColumnWrapper"};i.smartfilterbar=i.smartfilterbar||{};i.smartfilterbar.FilterType={auto:"auto",single:"single",multiple:"multiple",interval:"interval",searchExpression:"searchExpression"};i.smartfilterbar.ControlType={auto:"auto",input:"input",dropDownList:"dropDownList",date:"date",dateTimePicker:"dateTimePicker"};i.smartfilterbar.MandatoryType={auto:"auto",mandatory:"mandatory",notMandatory:"notMandatory"};i.smartfilterbar.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly"};i.smartfilterbar.SelectOptionSign={I:"I",include:"I",E:"E",exclude:"E"};i.navpopover=i.navpopover||{};i.navpopover.ChangeHandlerType={addLink:"addLink",removeLink:"removeLink",moveLink:"moveLink"};i.smartvariants=i.smartvariants||{};i.smartvariants.ChangeHandlerType={addFavorite:"addFavorite",removeFavorite:"removeFavorite"};i.valuehelpdialog=i.valuehelpdialog||{};i.valuehelpdialog.ValueHelpRangeOperation={BT:"BT",EQ:"EQ",Contains:"Contains",StartsWith:"StartsWith",EndsWith:"EndsWith",LT:"LT",LE:"LE",GT:"GT",GE:"GE",Initial:"Initial",Empty:"Empty"};i.smartform.SmartFormValidationMode={Standard:"Standard",Async:"Async"};i.smartform.Importance={High:"High",Medium:"Medium",Low:"Low"};i.filterbar=i.filterbar||{};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/ContactDetailsController", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/layout/form/SimpleForm","sap/m/Title","sap/m/Label","sap/m/Text","sap/m/Image","sap/m/Link","sap/ui/base/ManagedObjectObserver","sap/ui/comp/odata/MetadataAnalyser","sap/base/Log","sap/ui/layout/library","sap/ui/core/library","sap/base/util/merge"],function(e,t,r,n,o,i,a,s,p,u,d,l,c,f){"use strict";var m=c.TitleLevel;var h=l.form.SimpleFormLayout;var v=t.extend("sap.ui.comp.navpopover.ContactDetailsController",{metadata:{library:"sap.ui.comp"}});v.prototype.init=function(){this._oObserver=null};v.prototype.exit=function(){if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}};v.prototype.getBindingPath4ContactAnnotation=function(e,t,r){if(t===undefined||t===null||!e){return Promise.resolve(null)}if(!this.getModel()){return Promise.resolve(null)}if(!this.getModel().getMetaModel()){return Promise.resolve(null)}var n=this.getModel().getMetaModel();return n.loaded().then(function(){var o;try{n.getMetaContext(e)}catch(t){d.error("sap.ui.comp.navpopover.ContactDetailsController.getBindingPath4ContactAnnotation: binding path '"+e+"' is not valid. Error has been caught: "+t);return null}try{o="/"+t+"('"+r+"')";n.getMetaContext(o);return o}catch(e){}try{o=t?e+"/"+t:e;n.getMetaContext(o);return o}catch(r){d.error("sap.ui.comp.navpopover.ContactDetailsController.getBindingPath4ContactAnnotation: the path of sContactAnnotationPath '"+e+"/"+t+"' is not valid. Error has been caught: "+r);return null}})};v.prototype.getContactDetailsAnnotation=function(e){if(!e){return null}var t=new u(this.getModel());var r=t.getContactAnnotation(e);if(!r){return null}return r};v.prototype.getContactDetailsContainers=function(e){var t=this.getContactDetailsAnnotation(e);if(!t){return[]}var o=[];var i=[];var a=[];var s;this._oObserver=new p(function(e){if(e.type==="property"&&e.name==="visible"){var t=false;for(var r=1;r<s.getContent().length;r++){if(s.getContent()[r].getLabelFor&&s.getContent()[r].getLabelFor()){continue}if(s.getContent()[r].getVisible()){t=true}}s.setVisible(t)}});var u=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.addProperty2ExpandAndSelect("photo",t,e,i,a);this._addPhoto("photo",t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("fn",t,e,i,a);this._addLabeledText("fn",u.getText("POPOVER_CONTACT_SECTION_NAME"),t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("role",t,e,i,a);this._addLabeledText("role",u.getText("POPOVER_CONTACT_SECTION_ROLE"),t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("title",t,e,i,a);this._addLabeledText("title",u.getText("POPOVER_CONTACT_SECTION_JOBTITLE"),t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("org",t,e,i,a);this._addLabeledText("org",u.getText("POPOVER_CONTACT_SECTION_DEPARTMENT"),t,e,o,this._oObserver);this._addEmails(t,e,i,a,o,this._oObserver);this._addTels(t,e,i,a,o,this._oObserver);this._addAddresses(t,e,i,a,o,this._oObserver);if(!o.length){return[]}o.splice(0,0,new n({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_CONTACT_SECTION_TITLE"),level:m.H2}));s=new r({maxContainerCols:1,editable:false,layout:h.ResponsiveGridLayout,content:o});this._requestData(s,e,i,a);return[s]};v.prototype._addPhoto=function(e,t,r,n,o){if(!t[e]){return}var i=r+"/"+t[e].Path;if(this.isPropertyHidden(i)){return}var s=new a({src:{path:i},visible:{path:i,formatter:function(e){return!!e}},decorative:false});s.addStyleClass("sapUiIcon");s.addStyleClass("navigationPopoverThumbnail");o.observe(s,{properties:["visible"]});n.push(s)};v.prototype._addLabeledText=function(e,t,r,n,a,s){if(!r[e]){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new i({text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new o({text:t,labelFor:u.getId()});s.observe(u,{properties:["visible"]});a.push(d);a.push(u)};v.prototype._addEmails=function(e,t,r,n,o,i){if(!e.email||!e.email.length){return}var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var s=f([],e.email);s.filter(function(e){return!e.processed&&e.type&&(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1||e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1)}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("address",e,t,r,n);this._addLabeledEmail("address",a.getText("POPOVER_CONTACT_SECTION_EMAIL"),e,t,o,i);e.processed=true},this)};v.prototype._addTels=function(e,t,r,n,o,i){if(!e.tel||!e.tel.length){return}var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var s=f([],e.tel);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/work")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_PHONE"),e,t,o,i);e.processed=true},this);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/cell")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_MOBILE"),e,t,o,i);e.processed=true},this);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/fax")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_FAX"),e,t,o,i);e.processed=true},this);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_PHONE"),e,t,o,i);e.processed=true},this)};v.prototype._addAddresses=function(e,t,r,n,o,i){if(!e.adr||!e.adr.length){return}var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var s=f([],e.adr);s.filter(function(e){return!e.processed&&e.type&&(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1||e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1)}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return 1}return 0}).forEach(function(e){this._addLabeledAddress(a.getText("POPOVER_CONTACT_SECTION_ADR"),e,t,r,n,o,i);e.processed=true},this)};v.prototype._addLabeledAddress=function(e,t,r,n,a,s,p){var u=[];["street","code","locality","region","country"].forEach(function(e){this.addProperty2ExpandAndSelect(e,t,r,n,a);var o;if(t[e]){o=r+"/"+t[e].Path}u.push(o&&!this.isPropertyHidden(o)?{path:o}:{path:"$notExisting"})},this);if(!u.length){return}var d=new i({text:{parts:u,formatter:function(e,t,r,n,o){var i=[];if(e){i.push(e)}if(t&&r){i.push(t+" "+r)}else{if(t){i.push(t)}if(r){i.push(r)}}if(n){i.push(n)}if(o){i.push(o)}return i.join(", ")}},visible:{parts:u,formatter:function(e,t,r,n,o){return!!(e||t||r||n||o)}}});var l=new o({text:e,labelFor:d.getId()});p.observe(d,{properties:["visible"]});s.push(l);s.push(d)};v.prototype._addLabeledTel=function(e,t,r,n,i,a){if(!r[e]||!n){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new s({href:{path:p,formatter:function(e){return e?"tel:"+e:e}},text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new o({text:t,labelFor:u.getId()});a.observe(u,{properties:["visible"]});i.push(d);i.push(u)};v.prototype._addLabeledEmail=function(e,t,r,n,i,a){if(!r[e]||!n){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new s({href:{path:p,formatter:function(e){return e?"mailto:"+e:e}},text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new o({text:t,labelFor:u.getId()});a.observe(u,{properties:["visible"]});i.push(d);i.push(u)};v.prototype.addProperty2ExpandAndSelect=function(e,t,r,n,o){if(!t[e]||!r){return}var i=r+"/"+t[e].Path;if(!i){return}if(i.indexOf("/")!==0){throw"sap.ui.comp.navpopover.ContactDetailsController.addProperty2ExpandAndSelect: the path of sBindingPathOfProperty '"+i+"' is not valid."}var a=i.split("/");a.shift();a.shift();var s=a.join("/");if(s){o.push(s)}a.pop();var p=a.join("/");if(!p){return}var u=n.filter(function(e){return e===p});if(!u.length){n.push(p)}};v.prototype.isPropertyHidden=function(e){var t;if(!this.getModel()){d.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the model does not exist");return false}if(!this.getModel().getMetaModel()){d.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the model should be the ODataModel");return false}try{t=this.getModel().getMetaModel().getMetaContext(e)}catch(t){d.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the path of property path '"+e+"' is not valid. Error has been caught: "+t);return false}var r=t.getProperty(t.getPath());return u.isHidden(r)};v.prototype._requestData=function(e,t,r,n){var o={};if(r.length){o.expand=r.join(",")}if(n.length){o.select=n.join(",")}var i="/"+t.split("/")[1];e.bindContext({path:i,parameters:o,events:{change:function(){e.invalidate()}}})};return v});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Factory", ["sap/ui/comp/library"],function(e){"use strict";var a={getService:function(e){switch(e){case"CrossApplicationNavigation":return sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");case"URLParsing":return sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("URLParsing");default:return null}}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/FakeFlpConnector", ["sap/ui/thirdparty/jquery","./Factory"],function(jQuery,e){"use strict";function t(){}t.enableFakeConnector=function(r){if(t.getServiceReal){return}t.getServiceReal=e.getService;e.getService=t._createFakeService(r)};t._createFakeService=function(e){return function(r){switch(r){case"CrossApplicationNavigation":return{hrefForExternal:function(e){if(!e||!e.target||!e.target.shellHash){return null}return e.target.shellHash},getDistinctSemanticObjects:function(){var t=[];for(var r in e){t.push(r)}var n=jQuery.Deferred();setTimeout(function(){n.resolve(t)},0);return n.promise()},getLinks:function(t){var r=[];if(!Array.isArray(t)){e[t.semanticObject]?r=e[t.semanticObject].links:r=[]}else{t.forEach(function(t){e[t[0].semanticObject]?r.push([e[t[0].semanticObject].links]):r.push([[]])})}var n=jQuery.Deferred();setTimeout(function(){n.resolve(r)},0);return n.promise()}};case"URLParsing":return{parseShellHash:function(t){var r=function(e){var r=e.filter(function(e){return e.intent===t});return r[0]};for(var n in e){var i=r(e[n].links);if(i){return{semanticObject:n,action:i.action}}}return{semanticObject:null,action:null}}};default:return t.getServiceReal(r)}}};t.disableFakeConnector=function(){if(t.getServiceReal){e.getService=t.getServiceReal;t.getServiceReal=undefined}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/FlexConnector", ["sap/ui/comp/library","sap/ui/comp/navpopover/flexibility/changes/AddLink","sap/ui/comp/navpopover/flexibility/changes/RemoveLink","sap/base/Log"],function(t,e,n,a){"use strict";var i=t.navpopover.ChangeHandlerType;return{createAndSaveChangesForControl:function(t,e,n){if(!t.length&&!e.length){return Promise.resolve()}return this._createChangesForControl(e.concat(t),n).then(function(t){return this._saveChangesForControl(n,t)}.bind(this),function(t){return Promise.reject(t)})},_getControlPersonalizationWriteAPI:function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(t){sap.ui.require(["sap/ui/fl/write/api/ControlPersonalizationWriteAPI"],function(e){t(e)})})})},discardChangesForControl:function(t){return this._getControlPersonalizationWriteAPI().then(function(e){return e.reset({selectors:[t]})})},_saveChangesForControl:function(t,e){return this._getControlPersonalizationWriteAPI().then(function(n){return n.save({selector:t,changes:e})})},_createChangesForControl:function(t,e){if(!t.length){return[]}var n=[];t.forEach(function(t){var a={selectorElement:e,changeSpecificData:{changeType:t.visible?i.addLink:i.removeLink,content:t,isUserDependent:true}};n.push(a)});return this._getControlPersonalizationWriteAPI().then(function(t){return t.add({changes:n})})},activateApplyChangeStatistics:function(){var t=this;this.aStatistics=[];var a=function(e,n){if(t.aStatistics.findIndex(function(t){return t.stableId===n.getId()&&t.changeId===e.getId()})<0){var a=n.getAvailableActions().find(function(t){return t.getKey()===e.getContent().key});t.aStatistics.push({stableId:n.getId(),changeId:e.getId(),layer:e.getLayer(),key:e.getContent().key,text:a?a.getText():"",changeType:e.getChangeType()})}};var i=function(e){t.aStatistics=t.aStatistics.filter(function(t){return t.layer!==e})};var r=e.applyChange.bind(e);e.applyChange=function(t,e,n){a(t,e);r(t,e,n)};var o=n.applyChange.bind(n);n.applyChange=function(t,e,n){a(t,e);o(t,e,n)};var s=e.discardChangesOfLayer.bind(e);e.discardChangesOfLayer=function(t,e){i(t);s(t,e)};var c=n.discardChangesOfLayer.bind(n);n.discardChangesOfLayer=function(t,e){i(t);c(t,e)}},_formatStatistic:function(t){var e=t.layer;switch(t.layer){case"VENDOR":e=""+e;break;case"CUSTOMER":e="        "+e;break;case"USER":e="                "+e;break;default:e=""+e}var n;switch(t.changeType){case i.addLink:n="On";break;case i.removeLink:n="Off";break;default:n=""}return{formattedLayer:e,formattedValue:n}},printStatisticAll:function(){if(!this.aStatistics){a.info("Please activate with sap.ui.comp.navpopover.FlexConnector.activateApplyChangeStatistics()");return}var t=this;a.info("idx - VENDOR ------------ CUSTOMER ----------- USER --------------------------------------");this.aStatistics.forEach(function(e,n){var i=t._formatStatistic(e);a.info(n+" "+e.stableId+" "+i.formattedLayer+" '"+e.text+"' "+i.formattedValue)})}}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/LinkData", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var i=t.extend("sap.ui.comp.navpopover.LinkData",{metadata:{library:"sap.ui.comp",properties:{text:{type:"string",defaultValue:null},href:{type:"string",defaultValue:null},internalHref:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null},description:{type:"string",defaultValue:undefined},visible:{type:"boolean",defaultValue:true},key:{type:"string",defaultValue:undefined},press:{type:"object",defaultValue:null},isSuperiorAction:{type:"boolean"},visibleChangedByUser:{type:"boolean"}}}});i.prototype.getJson=function(){return{key:this.getKey(),href:this.getHref(),internalHref:this.getInternalHref(),text:this.getText(),target:this.getTarget(),description:this.getDescription(),visible:this.getVisible(),press:this.getPress(),isSuperiorAction:this.getIsSuperiorAction()}};i.convert2Json=function(e){return e.map(function(e){return e.getJson()})};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Log", ["sap/ui/base/Object","sap/ui/thirdparty/jquery"],function(t,jQuery){"use strict";var e=t.extend("sap.ui.comp.navpopover.Log",{constructor:function(){this.reset()}});e.prototype.reset=function(){this._oLog={semanticObjects:[],intents:[]};return this};e.prototype.createSemanticObjectStructure=function(t){this._oLog.semanticObjects[t]={attributes:{},intents:[]}};e.prototype.addIntent=function(t){this._oLog.intents.push(t);return this};e.prototype.addSemanticObjectAttribute=function(t,e,n){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}this._oLog.semanticObjects[t].attributes[e]=n;return this};e.prototype.addSemanticObjectIntent=function(t,e){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}this._oLog.semanticObjects[t].intents.push(e);return this};e.prototype.updateSemanticObjectAttributes=function(t,e,n){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}var i,r;var o=Object.keys(n);for(var s in n){if(this._oLog.semanticObjects[t].attributes[s]){i=this._oLog.semanticObjects[t].attributes[s].transformations;r=i[i.length-1];if(n[s]!==r["value"]){this._oLog.semanticObjects[t].attributes[s].transformations.push({value:n[s],description:" Value of the attribute has been changed in an event handler.",reason:" Is changed in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."})}}else{this.addSemanticObjectAttribute(t,s,{transformations:[{value:n[s],description:" The attribute has been added in an event handler.",reason:" Is added in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."}]})}}for(var a in e){if(o.indexOf(a)<0&&this._oLog.semanticObjects[t].attributes[a]){this._oLog.semanticObjects[t].attributes[a].transformations.push({value:undefined,description:" The attribute has been removed in an event handler.",reason:" Is removed in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."})}}return this};e.prototype.getFormattedText=function(){var t=function(t){return typeof t==="string"?"'"+t+"'":t};var e=function(e,n){var i={value:" "+n+" : ",description:""};e.forEach(function(e,n){i.value=i.value+(n>0?"    ":"")+t(e["value"]);i.description=i.description+"   "+e["description"]+"\n";if(e["reason"]){i.description=i.description+"   "+e["reason"]+"\n"}});return i};var n=function(t){var e="";t.forEach(function(t){e+=" '"+t.text+"' : "+t.intent+"\n"});return e};var i=function(t){try{var e=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=="undefined"){var n=window.Intl.Collator(e,{numeric:true});t.sort(function(t,e){return n.compare(t,e)})}else{t.sort(function(t,n){return t.localeCompare(n,e,{numeric:true})})}}catch(t){}};var r="";for(var o in this._oLog.semanticObjects){r=r+"\n"+" "+o+"\n";if(jQuery.isEmptyObject(this._oLog.semanticObjects[o].attributes)){r+="   No semantic attributes available for semantic object "+o+". Please be aware "+"that without semantic attributes no URL parameters can be created.\n"}else{var s=Object.keys(this._oLog.semanticObjects[o].attributes);i(s);for(var a=0;a<s.length;a++){var c=s[a];var u=e(this._oLog.semanticObjects[o].attributes[c].transformations,c);r+=u.value+"\n";r+=u.description}}if(this._oLog.semanticObjects[o].intents.length){r+="\nIntents returned by FLP for semantic object "+o+":\n";r+=n(this._oLog.semanticObjects[o].intents)}}if(this._oLog.intents.length){r+="\nIntents returned by event handler:\n";r+=n(this._oLog.intents)}return r};return e});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationContainer", ["sap/m/Link","sap/ui/core/Control","sap/m/VBox","sap/m/HBox","sap/m/Button","sap/m/Title","sap/m/Image","sap/m/Text","sap/ui/layout/form/SimpleForm","./Factory","./LinkData","sap/ui/model/json/JSONModel","./Util","sap/ui/layout/HorizontalLayout","sap/ui/layout/VerticalLayout","sap/ui/layout/library","sap/ui/comp/personalization/Util","sap/ui/base/ManagedObjectObserver","sap/m/FlexItemData","sap/ui/model/BindingMode","sap/m/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/SelectionWrapper","sap/ui/comp/personalization/ColumnWrapper","sap/base/Log","sap/ui/comp/navpopover/flexibility/changes/AddLink","sap/ui/core/CustomData"],function(e,t,i,n,a,o,r,s,l,p,u,v,c,g,h,f,d,b,y,m,A,C,_,P,k,I,L){"use strict";var x=f.form.SimpleFormLayout;var N=A.FlexJustifyContent;var S=A.ButtonType;var M=i.extend("sap.ui.comp.navpopover.NavigationContainer",{metadata:{library:"sap.ui.comp",properties:{mainNavigationId:{type:"string",group:"Misc",defaultValue:null},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false},control:{type:"sap.ui.core.Control",multiple:false}},events:{navigate:{},beforePopoverOpen:{},afterPopoverClose:{}}},renderer:{apiVersion:2}});M.prototype.init=function(){i.prototype.init.call(this);var e=new v({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,target:undefined},availableActions:[],enableAvailableActionsPersonalization:undefined,extraContent:undefined,initialAvailableActions:[]});e.setDefaultBindingMode(m.TwoWay);e.setSizeLimit(1e3);this.setModel(e,"$sapuicompNavigationContainer");this._oObserver=new b(this._observeChanges.bind(this));this._oAvailableActionsObserver=new b(this._observeAvailableActionsChanges.bind(this));this._oAvailableActionsObserver.observe(this,{aggregations:["availableActions"]});this.oPersonalizationController=null};M.prototype.applySettings=function(){i.prototype.applySettings.apply(this,arguments);this._createContent()};M.prototype.exit=function(e){if(this._getInternalModel()){this._getInternalModel().destroy()}if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}if(this._oAvailableActionsObserver){this._oAvailableActionsObserver.disconnect();this._oAvailableActionsObserver=null}this._oDefaultExtraConent=null;this._oSeparator=null};M.prototype.openSelectionDialog=function(e,t,i,n,a,o){this.fireBeforePopoverOpen();return this._getFlexRuntimeInfoAPI().then(function(n){return n.waitForChanges({element:this}).then(function(){return new Promise(function(n){var r=this._getInternalModel();var s=c.getStorableAvailableActions(r.getProperty("/initialAvailableActions"));var l=c.getStorableAvailableActions(r.getProperty("/availableActions")).map(function(e){return{columnKey:e.key,visible:e.visible}});var p=new _({press:function(e){this._onLinkPress(e)}.bind(this),columns:s.map(function(t){return new P({label:t.text,selected:t.visible,href:e?undefined:t.href,internalHref:e?undefined:t.internalHref,target:t.target,description:t.description,customData:new L({key:"p13nData",value:{columnKey:t.key}})})})});p._container=this;if(!this.oPersonalizationController){this.oPersonalizationController=new C({resetToInitialTableState:true,table:p,setting:{selection:{visible:true,payload:{callbackSaveChanges:function(e){var t=e&&e.selection&&e.selection.selectionItems||[];if(i){i(t.map(function(e){return{key:e.columnKey,visible:e.visible}}));return Promise.resolve(true)}var n=[];var a=[];t.forEach(function(e){if(e.visible===true){n.push({key:e.columnKey,visible:e.visible})}else{a.push({key:e.columnKey,visible:e.visible})}});return M._saveChanges(n,a,this).then(function(){return true})}.bind(this)}}},dialogConfirmedReset:function(){M._discardChanges(this)}.bind(this),dialogAfterClose:function(){this.fireAfterPopoverClose();n()}.bind(this)})}this.oPersonalizationController.setPersonalizationData({selection:{selectionItems:l}});this.oPersonalizationController.openDialog({contentWidth:"28rem",contentHeight:"35rem",styleClass:""+a,showReset:t,selection:{visible:true}}).then(function(){var e=this.oPersonalizationController._oDialog;if(o){o.addDependent(e)}n()}.bind(this))}.bind(this))}.bind(this))}.bind(this))};M._discardChanges=function(e){return new Promise(function(t){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(i){return i.discardChangesForControl(e).then(function(){return t(true)},function(e){k.error("Changes could not be discarded in LRep: "+e);return t(false)})})})})};M._saveChanges=function(e,t,i){return new Promise(function(n){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(a){return a.createAndSaveChangesForControl(e,t,i).then(function(){return n(true)},function(e){k.error("Changes could not be saved in LRep: "+e);return n(false)})})})})};M.prototype.getDirectLink=function(){var e=this._getInternalModel();if(e.getProperty("/extraContent")){return null}if(e.getProperty("/mainNavigationLink/href")&&!e.getProperty("/availableActions").length){return this._oHeaderArea.getItems()[0]}if(e.getProperty("/availableActions").length===1&&!e.getProperty("/mainNavigationLink/href")){return this._oActionArea.getItems()[0].getItems()[0]}return null};M.prototype.hasContent=function(){var e=this._getInternalModel();return!!e.getProperty("/mainNavigationLink/href")||!!e.getProperty("/availableActions").length||!!e.getProperty("/extraContent")};M.prototype.setExtraContent=function(e){this.setAssociation("extraContent",e);if(!e){return this}var t=this._getInternalModel();if(t.getProperty("/extraContent")){this.removeItem(1)}if(typeof e==="string"){e=sap.ui.getCore().byId(e)}this.insertItem(e,1);t.setProperty("/extraContent",e);return this};M.prototype.setMainNavigationId=function(e){this.setProperty("mainNavigationId",e,true);var t=this._getInternalModel();if(typeof e==="string"){t.setProperty("/mainNavigationLink/title",e)}return this};M.prototype.setMainNavigation=function(e){this.setAggregation("mainNavigation",e,true);if(!e){return this}var t=this._getInternalModel();if(e.getHref()){t.setProperty("/mainNavigationLink/href",e.getHref());t.setProperty("/mainNavigationLink/internalHref",e.getInternalHref());t.setProperty("/mainNavigationLink/target",e.getTarget())}if(!t.getProperty("/mainNavigationLink/title")&&t.getProperty("/mainNavigationLink/title")!==""){t.setProperty("/mainNavigationLink/title",e.getText())}t.setProperty("/mainNavigationLink/subtitle",e.getDescription());return this};M.prototype.setEnableAvailableActionsPersonalization=function(e){this.setProperty("enableAvailableActionsPersonalization",e,true);this._getInternalModel().setProperty("/enableAvailableActionsPersonalization",e);return this};M.prototype.onAfterRenderingActionForm=function(){var e=this._getInternalModel();var t=e.getProperty("/extraContent")?e.getProperty("/extraContent").$()[0]:undefined;if(t&&t.scrollHeight>t.clientHeight){this.setFitContainer(false).setJustifyContent(N.Start)}};M.prototype._getFlexRuntimeInfoAPI=function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})};M.prototype._createContent=function(){this.addStyleClass("navigationPopover");this._oHeaderArea=this._createHeaderArea();this._oDefaultExtraConent=new l({layout:x.ResponsiveGridLayout,content:[new o({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_MSG_NO_CONTENT")})]});this._oDefaultExtraConent.addStyleClass("navigationPopoverDefaultExtraContent");this._oSeparator=new i({visible:false});this._oSeparator.addStyleClass("navigationPopoverSeparator");this._oActionArea=new i({items:{path:"/availableActions",templateShareable:false,factory:function(t,n){var a=new e({visible:"{visible}",text:"{text}",href:"{href}",target:"{target}",press:n.getProperty("press")});var o=new L({key:"internalHref",value:"{internalHref}"});a.addCustomData(o);this._oObserver.observe(a,{bindings:["visible"],properties:["visible"]});return new i({visible:"{visible}",layoutData:new y({styleClass:n.getProperty("description")?"navigationPopoverAvailableLinkGroup":"navigationPopoverAvailableLinkWithoutGroup"}),items:[a,new s({visible:"{visible}",text:"{description}"})]})}.bind(this)}});this._oActionArea.addEventDelegate({onAfterRendering:this.onAfterRenderingActionForm.bind(this)});this._oActionArea.addStyleClass("navigationPopoverAvailableLinks");this._oPersonalizationButton=new n({visible:{parts:[{path:"/enableAvailableActionsPersonalization"}],formatter:function(e){return!!e}},justifyContent:"End",items:new a({type:S.Transparent,text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_DEFINE_LINKS"),press:function(e){this.openSelectionDialog(false,true,undefined,true,undefined,e.getSource())}.bind(this)})});this._oPersonalizationButton.addStyleClass("navigationPopoverPersonalizationButton");this.setFitContainer(true);this.setJustifyContent(N.Start);this.addItem(this._oHeaderArea).addItem(this._getInternalModel().getProperty("/extraContent")||this._oDefaultExtraConent).addItem(this._oSeparator).addItem(this._oActionArea).addItem(this._oPersonalizationButton);this._oHeaderArea.setModel(this._getInternalModel());this._oSeparator.setModel(this._getInternalModel());this._oActionArea.setModel(this._getInternalModel());this._oPersonalizationButton.setModel(this._getInternalModel())};M.prototype._createHeaderArea=function(){var e=this._createTitle();var t=this._createSubTitle();var n=new i({items:[e,t],visible:{path:"/mainNavigationLink/title",formatter:function(e){return!!e}}});n.addStyleClass("navigationPopoverTitleH1");n.addStyleClass("navigationPopoverHeader");return n};M.prototype._createSubTitle=function(){var e=new s({text:{path:"/mainNavigationLink/subtitle"},visible:{path:"/mainNavigationLink/subtitle",formatter:function(e){return!!e}}});return e};M.prototype._createTitle=function(){var t=new e({href:{path:"/mainNavigationLink/href"},text:{path:"/mainNavigationLink/title"},target:{path:"/mainNavigationLink/target"},visible:{path:"/mainNavigationLink/title",formatter:function(e){return!!e}},enabled:{path:"/mainNavigationLink/href",formatter:function(e){return!!e}},press:this._onLinkPress.bind(this)});var i=new L({key:"internalHref",value:"{/mainNavigationLink/internalHref}"});t.addCustomData(i);t.addStyleClass("sapFontHeader5Size");this._oObserver.observe(t,{bindings:["visible"],properties:["visible"]});return t};M.prototype._getControl=function(){var e=this.getAssociation("control");if(typeof e==="string"){e=sap.ui.getCore().byId(e)}return e};M.prototype._onLinkPress=function(e){var t=e.getId()==="press"?e.getSource():e.getParameters().getSource();if(t.getTarget()!=="_blank"){e.preventDefault();this.fireNavigate({text:t.getText(),href:t.getHref(),internalHref:t.data("internalHref")})}};M.prototype._getComponent=function(){var e=this.getComponent();if(typeof e==="string"){e=sap.ui.getCore().getComponent(e)}return e};M.prototype._observeAvailableActionsChanges=function(e){var t;if(e.object.isA("sap.ui.comp.navpopover.NavigationContainer")){switch(e.name){case"availableActions":t=this._getInternalModel();var i=e.child?[e.child]:e.children;i.forEach(function(i){switch(e.mutation){case"insert":if(!i||!i.isA("sap.ui.comp.navpopover.LinkData")){return}i.setPress(this._onLinkPress.bind(this));this._oAvailableActionsObserver.observe(i,{properties:["visible"]});t.setProperty("/initialAvailableActions/"+this.indexOfAvailableAction(i)+"/",i.getJson());t.setProperty("/availableActions/"+this.indexOfAvailableAction(i)+"/",i.getJson());break;case"remove":k.error("Deletion of AvailableActions is not supported");break;default:k.error("Mutation '"+e.mutation+"' is not supported jet.")}}.bind(this));break;default:k.error("The '"+e.name+"' of NavigationContainer is not supported yet.")}}else if(e.object.isA("sap.ui.comp.navpopover.LinkData")){switch(e.name){case"visible":var n=e.object;t=this._getInternalModel();var a=-1;t.getProperty("/availableActions").some(function(e,t){if(n.getKey()===e.key){a=t;return true}});if(a<0){k.error("The available action with key '"+n.getKey()+"' does not exist in availableActions.")}if(n.getVisibleChangedByUser()){t.setProperty("/availableActions/"+a+"/visible",n.getVisible())}else{t.setProperty("/initialAvailableActions/"+a+"/visible",n.getVisible());t.setProperty("/availableActions/"+a+"/visible",n.getVisible())}break;default:k.error("The '"+e.name+"' of LinkData is not supported yet.")}}};M.prototype._observeChanges=function(e){if((e.type==="property"||e.type==="binding")&&e.name==="visible"){var t=this._getInternalModel().getProperty("/availableActions");var i=t.filter(function(e){return e.visible===true});this._oSeparator.setVisible(i.length>0||!!this._getInternalModel().getProperty("/enableAvailableActionsPersonalization"));this._oActionArea.setVisible(i.length>0);if(this.hasContent()&&!this._getInternalModel().getProperty("/extraContent")){this._oDefaultExtraConent.setVisible(false)}}};M.prototype._getInternalModel=function(){return this.getModel("$sapuicompNavigationContainer")};return M});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationPopover", ["sap/m/Link","sap/m/ResponsivePopover","sap/m/Button","sap/m/Title","sap/m/Image","sap/m/Text","sap/m/VBox","sap/m/HBox","./Factory","./LinkData","sap/ui/model/json/JSONModel","sap/ui/base/ManagedObjectObserver","sap/m/FlexItemData","sap/ui/model/BindingMode","sap/ui/Device","sap/m/library","sap/base/Log","sap/ui/core/CustomData"],function(t,e,n,i,a,o,r,s,l,p,h,g,u,v,c,d,f,b){"use strict";var y=d.PlacementType;var m=d.FlexJustifyContent;var A=d.ButtonType;var P=e.extend("sap.ui.comp.navpopover.NavigationPopover",{metadata:{library:"sap.ui.comp",properties:{semanticObjectName:{type:"string",group:"Misc",defaultValue:null},semanticAttributes:{type:"object",group:"Misc",defaultValue:null},appStateKey:{type:"string",group:"Misc",defaultValue:null},mainNavigationId:{type:"string",group:"Misc",defaultValue:null},availableActionsPersonalizationText:{type:"string",group:"Misc",defaultValue:undefined}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{source:{type:"sap.ui.core.Control",multiple:false},extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false}},events:{targetsObtained:{},navigate:{parameters:{text:{type:"string"},href:{type:"string"}}},availableActionsPersonalizationPress:{}}},renderer:{apiVersion:2}});P.prototype.init=function(){e.prototype.init.call(this);var t=new h({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,target:undefined},ownNavigation:undefined,availableActions:[],availableActionsPersonalizationText:undefined,extraContent:undefined});t.setDefaultBindingMode(v.TwoWay);t.setSizeLimit(1e3);this.setModel(t,"$sapuicompNavigationPopover");this._bUseExternalContent=false;this.addStyleClass("navigationPopover");this.setContentWidth("380px");this.setHorizontalScrolling(false);this.setShowHeader(c.system.phone);this.setPlacement(y.Auto);this._oObserver=null};P.prototype.applySettings=function(t){if(t&&t.customData&&t.customData.getProperty("key")==="useExternalContent"){this._bUseExternalContent=true}this._createContent();e.prototype.applySettings.apply(this,arguments)};P.prototype.exit=function(t){if(this._getInternalModel()){this._getInternalModel().destroy()}if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}e.prototype.exit.apply(this,arguments)};P.prototype.retrieveNavTargets=function(){f.warning("sap.ui.comp.navpopover.NavigationPopover#retrieveNavTargets called. This function is deprecated since UI5 version 1.42!");var t=l.getService("CrossApplicationNavigation");var e=l.getService("URLParsing");if(!t||!e){f.error("Service 'CrossApplicationNavigation' could not be obtained");this.fireTargetsObtained();return}var n=this;this.setMainNavigation(null);this.setOwnNavigation(null);this.removeAllAvailableActions();var i=t.getLinks({semanticObject:this.getSemanticObjectName(),params:this.getSemanticAttributes(),appStateKey:this.getAppStateKey(),ui5Component:this._getComponent(),sortResultOnTexts:true});i.done(function(i){if(!i||!i.length){n.fireTargetsObtained();return}var a=t.hrefForExternal();if(a&&a.indexOf("?")!==-1){a=a.split("?")[0]}i.forEach(function(t){if(t.intent.indexOf(a)===0){n.setOwnNavigation(new p({href:t.intent,text:t.text}));return}var i=e.parseShellHash(t.intent);if(i.action&&i.action==="displayFactSheet"){n.setMainNavigation(new p({href:t.intent,text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_FACTSHEET")}));return}n.addAvailableAction(new p({href:t.intent,text:t.text}))});n.fireTargetsObtained()});i.fail(function(){f.error("'retrieveNavTargets' failed")})};P.prototype.show=function(t){var e=t||this._getControl();if(!e){f.error("no source assigned");return}this.openBy(e)};P.prototype.getDirectLink=function(){if(this._bUseExternalContent){return this.getContent()[0].getDirectLink()}var t=this._getInternalModel();if(t.getProperty("/extraContent")){return null}if(t.getProperty("/mainNavigationLink/href")&&!t.getProperty("/availableActions").length){return this._oHeaderArea.getItems()[0]}if(t.getProperty("/availableActions").length===1&&!t.getProperty("/mainNavigationLink/href")){return this._oActionArea.getItems()[0].getItems()[0]}return null};P.prototype.hasContent=function(){if(this._bUseExternalContent){return this.getContent()[0].hasContent()}var t=this._getInternalModel();return!!t.getProperty("/mainNavigationLink/href")||!!t.getProperty("/availableActions").length||!!t.getProperty("/extraContent")};P.prototype.setMainNavigationId=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setProperty("mainNavigationId",t,true);var e=this._getInternalModel();if(typeof t==="string"){e.setProperty("/mainNavigationLink/title",t)}return this};P.prototype.setAvailableActionsPersonalizationText=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setProperty("availableActionsPersonalizationText",t,true);var e=this._getInternalModel();e.setProperty("/availableActionsPersonalizationText",t);return this};P.prototype.setExtraContent=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var e=this._getInternalModel();if(e.getProperty("/extraContent")){this._getContentContainer().removeItem(1)}if(typeof t==="string"){t=sap.ui.getCore().byId(t)}this._getContentContainer().insertItem(t,1);this.setAssociation("extraContent",t);e.setProperty("/extraContent",t);return this};P.prototype.setMainNavigation=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setAggregation("mainNavigation",t,true);if(!t){return this}var e=this._getInternalModel();if(t.getHref()){e.setProperty("/mainNavigationLink/href",t.getHref());e.setProperty("/mainNavigationLink/internalHref",t.getInternalHref());e.setProperty("/mainNavigationLink/target",t.getTarget())}if(!e.getProperty("/mainNavigationLink/title")&&e.getProperty("/mainNavigationLink/title")!==""){e.setProperty("/mainNavigationLink/title",t.getText())}e.setProperty("/mainNavigationLink/subtitle",t.getDescription());return this};P.prototype.addAvailableAction=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.addAggregation("availableActions",t);if(!t){return this}t.setPress(this._onLinkPress.bind(this));var e=this._getInternalModel();e.setProperty("/availableActions/"+this.indexOfAvailableAction(t)+"/",t.getJson());return this};P.prototype.insertAvailableAction=function(t,e){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.insertAggregation("availableActions",t,e);if(!t){return this}t.setPress(this._onLinkPress.bind(this));var n=this._getInternalModel();this.getAvailableActions().forEach(function(t,e){n.setProperty("/availableActions/"+e+"/",t.getJson())});return this};P.prototype.removeAvailableAction=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var e=this.indexOfAvailableAction(t);if(e>-1){var n=this._getInternalModel();n.getData().availableActions.splice(e,1);n.refresh(true)}t=this.removeAggregation("availableActions",t);return t};P.prototype.removeAllAvailableActions=function(){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var t=this.removeAllAggregation("availableActions");var e=this._getInternalModel();e.setProperty("/availableActions",[]);e.refresh(true);return t};P.prototype.onAfterRenderingActionForm=function(){var t=this._getInternalModel();var e=t.getProperty("/extraContent")?t.getProperty("/extraContent").$()[0]:undefined;if(e&&e.scrollHeight>e.clientHeight){this._getContentContainer().setFitContainer(false).setJustifyContent(m.Start)}};P.prototype._createContent=function(){if(this._bUseExternalContent){return}var e=this;var i=new t({href:{path:"/mainNavigationLink/href"},text:{path:"/mainNavigationLink/title"},target:{path:"/mainNavigationLink/target"},visible:{path:"/mainNavigationLink/title",formatter:function(t){return!!t}},enabled:{path:"/mainNavigationLink/href",formatter:function(t){return!!t}},press:this._onLinkPress.bind(this)});var a=new b({key:"internalHref",value:"/mainNavigationLink/internalHref"});i.addCustomData(a);i.addStyleClass("sapFontHeader5Size");var l=new o({text:{path:"/mainNavigationLink/subtitle"},visible:{path:"/mainNavigationLink/subtitle",formatter:function(t){return!!t}}});this._oHeaderArea=new r({items:[i,l],visible:{path:"/mainNavigationLink/title",formatter:function(t){return!!t}}});this._oHeaderArea.addStyleClass("navigationPopoverTitleH1");this._oHeaderArea.addStyleClass("navigationPopoverHeader");this._oHeaderArea.setModel(this._getInternalModel());this._oObserver=new g(function(t){if(t.type==="property"&&t.name==="visible"){var e=this._getInternalModel().getProperty("/availableActions").filter(function(t){return t.visible===true});p.setVisible(e.length>0||this._getInternalModel().getProperty("/enableAvailableActionsPersonalization"));this._oActionArea.setVisible(e.length>0)}}.bind(this));var p=new r;p.setModel(this._getInternalModel());p.addStyleClass("navigationPopoverSeparator");this._oActionArea=new r({items:{path:"/availableActions",templateShareable:false,factory:function(e,n){var i=new t({visible:"{visible}",text:"{text}",href:"{href}",target:"{target}",press:n.getProperty("press")});var a=new b({key:"internalHref",value:"{internalHref}"});i.addCustomData(a);this._oObserver.observe(i,{properties:["visible"]});return new r({visible:"{visible}",layoutData:new u({styleClass:n.getProperty("description")?"navigationPopoverAvailableLinkGroup":"navigationPopoverAvailableLinkWithoutGroup"}),items:[i,new o({visible:"{visible}",text:"{description}"})]})}.bind(this)}});this._oActionArea.addEventDelegate({onAfterRendering:this.onAfterRenderingActionForm.bind(this)});this._oActionArea.addStyleClass("navigationPopoverAvailableLinks");this._oActionArea.setModel(this._getInternalModel());this._oPersonalizationButton=new s({visible:{parts:[{path:"/enableAvailableActionsPersonalization"}],formatter:function(t){return!!t}},justifyContent:"End",items:new n({type:A.Transparent,text:{path:"/availableActionsPersonalizationText"},press:function(){e.fireAvailableActionsPersonalizationPress()}})});this._oPersonalizationButton.setModel(this._getInternalModel());this._oPersonalizationButton.addStyleClass("navigationPopoverPersonalizationButton");var h=new r({fitContainer:true,justifyContent:m.Start,items:[this._oHeaderArea]});if(this._getInternalModel().getProperty("/extraContent")){h.addItem(this._getInternalModel().getProperty("/extraContent"))}h.addItem(p).addItem(this._oActionArea).addItem(this._oPersonalizationButton);this.addContent(h)};P.prototype._onLinkPress=function(t){this.fireNavigate({text:t.getSource().getText(),href:t.getSource().getHref(),internalHref:t.getSource().data("internalHref")})};P.prototype._getControl=function(){var t=this.getAssociation("source");if(typeof t==="string"){t=sap.ui.getCore().byId(t)}return t};P.prototype._getComponent=function(){var t=this.getComponent();if(typeof t==="string"){t=sap.ui.getCore().getComponent(t)}return t};P.prototype._getContentContainer=function(){return this.getContent()[0]};P.prototype._getInternalModel=function(){return this.getModel("$sapuicompNavigationPopover")};return P});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationPopoverHandler", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/base/ManagedObject","./SemanticObjectController","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/ui/core/Control","./Factory","./NavigationPopover","./Util","sap/m/VBox","./LinkData","sap/m/MessageBox","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","./NavigationContainer","./ContactDetailsController","./Log","sap/ui/core/InvisibleText","sap/ui/core/CustomData","sap/base/Log","sap/base/util/isPlainObject","sap/ui/core/Component","sap/base/util/merge","sap/base/strings/whitespaceReplacer"],function(jQuery,t,e,i,n,a,o,r,s,l,c,p,u,g,v,d,f,m,b,h,y,P,N,C,A){"use strict";var S=e.extend("sap.ui.comp.navpopover.NavigationPopoverHandler",{metadata:{library:"sap.ui.comp",properties:{semanticObject:{type:"string",defaultValue:null},additionalSemanticObjects:{type:"string[]",defaultValue:[]},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},contactAnnotationPath:{type:"string",defaultValue:undefined},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true},beforeNavigationCallback:{type:"function"}},aggregations:{_popover:{type:"sap.ui.comp.navpopover.NavigationPopover",multiple:false,visibility:"hidden"}},associations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}}});S.prototype.init=function(){this._oPopover=null;this._oContactDetailsController=new f;var t=new n({semanticObject:undefined,semanticAttributes:undefined,appStateKey:undefined,mainNavigationId:undefined,navigationTarget:{mainNavigation:undefined,enableAvailableActionsPersonalization:undefined,extraContent:undefined},availableActions:[]});t.setDefaultBindingMode(a.TwoWay);t.setSizeLimit(1e3);this.setModel(t,"$sapuicompNavigationPopoverHandler");this._oLog=y.getLevel()>=y.Level.INFO?new m:undefined};S.prototype.applySettings=function(t){e.prototype.applySettings.apply(this,arguments);this._setSemanticAttributes(this._calculateSemanticAttributes(null))};S.prototype.openPopover=function(t){var e=this;return this._getPopover().then(function(i){var n=i.getDirectLink();if(n){e._fireInnerNavigate({text:n.getText(),href:n.getHref(),internalHref:n.data("internalHref")});e._destroyPopover();return}i.show(t)})};S.prototype.getSemanticObjectValue=function(){var t=this._getSemanticAttributes();if(t){return t[this.getSemanticObject()][this.getSemanticObject()]}return undefined};S.prototype.getNavigationPopoverStableId=function(){var t=sap.ui.getCore().byId(this.getControl());if(!t){y.error("NavigationPopoverHandler: Stable ID could not be determined because the control is undefined");return undefined}var e=this._getComponent(t);if(!e){y.error("NavigationPopoverHandler: Stable ID could not be determined because the app component is not defined for control '"+t.getId()+"'");return undefined}var i=this.getModel("$sapuicompNavigationPopoverHandler").getProperty("/semanticObject");if(!i){y.error("NavigationPopoverHandler: Stable ID could not be determined because no default semantic object is defined");return undefined}var n=[i].concat(this.getAdditionalSemanticObjects());l.sortArrayAlphabetical(n);var a=n.join("--");return e.createId("sapuicompnavpopoverNavigationPopover---"+a)};S.prototype.updateBindingContext=function(){var t=this.getBindingContext("$sapuicompNavigationPopoverHandler");o.prototype.updateBindingContext.apply(this,arguments);var e=this.getBindingContext("$sapuicompNavigationPopoverHandler");if(e&&e!==t){this._setSemanticAttributes(this._calculateSemanticAttributes(null));this._destroyPopover()}};S.prototype.setSemanticObject=function(t){this._destroyPopover();this.setProperty("semanticObject",t);this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/semanticObject",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype._setSemanticAttributes=function(t){this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/semanticAttributes",t)};S.prototype._getSemanticAttributes=function(){return this.getModel("$sapuicompNavigationPopoverHandler").getProperty("/semanticAttributes")};S.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t);this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/navigationTarget/enableAvailableActionsPersonalization",t);return this};S.prototype.setFieldName=function(t){this.setProperty("fieldName",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.setControl=function(t){this.setAssociation("control",t);this.setModel(t.getModel());this._destroyPopover();this._updateSemanticObjectController();this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.setMapFieldToSemanticObject=function(t){this.setProperty("mapFieldToSemanticObject",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.setSemanticObjectController=function(t){this._updateSemanticObjectController(t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.exit=function(){this._oContactDetailsController.destroy();this._destroyPopover();if(this.getSemanticObjectController()){this.getSemanticObjectController().unregisterControl(this)}if(this.getModel("$sapuicompNavigationPopoverHandler")){this.getModel("$sapuicompNavigationPopoverHandler").destroy()}};S.prototype._initModel=function(){var t=this;var e;var i=this.getSemanticObject();var n=this.getAdditionalSemanticObjects();var a=l.getContactAnnotationPath(this,this.getSemanticObjectController());var o=sap.ui.getCore().byId(this.getControl());if(!o){y.error("sap.ui.comp.navpopover.NavigationPopoverHandler: No control provided, popover cannot be attached.")}var r=o&&o.getBindingContext()?o.getBindingContext().getPath():null;if(!r){y.warning("sap.ui.comp.navpopover.NavigationPopoverHandler: Binding Context is null. Please be aware that without binding context no semantic attributes can be calculated. Without semantic attributes no URL parameters can be created.")}var s=this.getModel();var c=this._getComponent(o);var u=o&&o.getId();var g,v,d;if(this._oLog){this._oLog.reset()}return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return l.retrieveSemanticObjectMapping(t.getFieldName(),s,r)}).then(function(n){t._setSemanticAttributes(t._calculateSemanticAttributes(n,t._oLog));e=t._getSemanticAttributes();return t._fireBeforePopoverOpens(e,i,u,t._oLog)}).then(function(a){e=a.semanticAttributes;t._setSemanticAttributes(e);v=t.getSemanticObjectValue();g=o&&o._getTextOfDom&&o._getTextOfDom()||t.getSemanticObjectValue();t.getModel("$sapuicompNavigationPopoverHandler").setProperty("/appStateKey",a.appStateKey);return l.retrieveNavigationTargets(i,n,a.appStateKey,c,e,g,t.getFieldName(),s,r,t._oLog)}).then(function(e){d=e;t._oContactDetailsController.setModel(s);return t._oContactDetailsController.getBindingPath4ContactAnnotation(r,a,v)}).then(function(n){var a=t._oContactDetailsController.getContactDetailsContainers(n);return t._fireNavigationTargetsObtained(g,i,e,u,a,d,t._oLog)}).then(function(e){e.availableActions.forEach(function(e){if(e.getHref()){e.setInternalHref(e.getHref());e.setHref(t._convertToExternal(e.getHref()))}if(e.getText()){e.setText(A(e.getText()))}});if(e.mainNavigationId){e.mainNavigationId=A(e.mainNavigationId)}if(e.mainNavigation){if(!e.mainNavigation.getDescription()){e.mainNavigation.setDescription(t.getSemanticObjectLabel())}else{e.mainNavigation.setDescription(A(e.mainNavigation.getDescription()))}if(e.mainNavigation.getText()){e.mainNavigation.setText(A(e.mainNavigation.getText()))}}if(e.mainNavigation&&e.mainNavigation.getHref()){e.mainNavigation.setInternalHref(e.mainNavigation.getHref());e.mainNavigation.setHref(t._convertToExternal(e.mainNavigation.getHref()))}var i=t.getModel("$sapuicompNavigationPopoverHandler");i.setProperty("/mainNavigationId",e.mainNavigationId);i.setProperty("/navigationTarget/mainNavigation",e.mainNavigation);i.setProperty("/navigationTarget/extraContent",e.extraContent);i.setProperty("/availableActions",t._updateVisibilityOfAvailableActions(p.convert2Json(e.availableActions)));i.setProperty("/navigationTarget/enableAvailableActionsPersonalization",t._getEnableAvailableActionsPersonalization(i.getProperty("/availableActions")));if(y.getLevel()>=y.Level.TRACE){y.info("sap.ui.comp.NavigationPopoverHandler: calculation of semantic attributes\n---------------------------------------------\nBelow you can see detailed information regarding semantic attributes which have been calculated for one or more semantic objects defined in a SmartLink control. Semantic attributes are used to create the URL parameters. Additionally you can see all links containing the URL parameters.\n"+t._getLogFormattedText())}})};S.prototype._initPopover=function(){var t=this;return this._initModel().then(function(){var e=t.getModel("$sapuicompNavigationPopoverHandler");var i=t._createPopover();i.setModel(e,"$sapuicompNavigationPopoverHandler");var n=sap.ui.getCore().byId(t.getControl());if(n){n.addDependent(i)}return i})};S.prototype._initNavigationContainer=function(){var t=this;return this._initModel().then(function(){var e=t.getModel("$sapuicompNavigationPopoverHandler");var i=t._createNavigationContainer();i.setModel(e,"$sapuicompNavigationPopoverHandler");var n=sap.ui.getCore().byId(t.getControl());if(n){n.addDependent(i)}return i})};S.prototype._getPopover=function(){if(!this._oPopover){return this._initPopover()}else{return Promise.resolve(this._oPopover)}};S.prototype._getNavigationContainer=function(){return this._initNavigationContainer().then(function(t){return t})};S.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};S.prototype._createPopover=function(){if(this._oPopover){return this._oPopover}var t=this._createNavigationContainer();var e=new b({text:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}"});this._oPopover=new s({customData:new h({key:"useExternalContent"}),content:[t,e],ariaLabelledBy:e,title:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}",semanticObjectName:"{$sapuicompNavigationPopoverHandler>/semanticObject}",semanticAttributes:"{$sapuicompNavigationPopoverHandler>/semanticAttributes}",appStateKey:"{$sapuicompNavigationPopoverHandler>/appStateKey}",source:this.getControl(),beforeClose:function(){this.removeAllContent().forEach(function(t){t.destroy()})},afterClose:this._destroyPopover.bind(this)});this.setAggregation("_popover",this._oPopover);return this._oPopover};S.prototype._createNavigationContainer=function(){var t=this.getNavigationPopoverStableId();if(!t){y.error("NavigationPopoverHandler: Due to undefined stable ID the button of action personalization is set to disabled")}if(sap.ui.getCore().byId(t)){y.error("Duplicate ID '"+t+"'. The instance of NavigationContainer should be destroyed first in order to avoid duplicate creation of NavigationContainer with stable ID.");throw"Duplicate ID"}var e=this.getModel("$sapuicompNavigationPopoverHandler");return new d(t,{mainNavigationId:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}",mainNavigation:e.getProperty("/navigationTarget/mainNavigation"),availableActions:{path:"$sapuicompNavigationPopoverHandler>/availableActions",templateShareable:false,template:new p({key:"{$sapuicompNavigationPopoverHandler>key}",href:"{$sapuicompNavigationPopoverHandler>href}",internalHref:"{$sapuicompNavigationPopoverHandler>internalHref}",text:"{$sapuicompNavigationPopoverHandler>text}",target:"{$sapuicompNavigationPopoverHandler>target}",description:"{$sapuicompNavigationPopoverHandler>description}",visible:"{$sapuicompNavigationPopoverHandler>visible}"})},extraContent:e.getProperty("/navigationTarget/extraContent")?e.getProperty("/navigationTarget/extraContent").getId():undefined,component:this._getComponent(sap.ui.getCore().byId(this.getControl())),enableAvailableActionsPersonalization:"{$sapuicompNavigationPopoverHandler>/navigationTarget/enableAvailableActionsPersonalization}",beforePopoverOpen:function(){if(this._oPopover){this._oPopover.setModal(true)}}.bind(this),afterPopoverClose:function(){if(this._oPopover){this._oPopover.setModal(false)}}.bind(this),navigate:this._onNavigate.bind(this),control:this.getControl()})};S.prototype._convertToExternal=function(t){var e=r.getService("CrossApplicationNavigation");if(!e){return t}return e.hrefForExternal({target:{shellHash:t}},this._getComponent())};S.prototype._fireBeforePopoverOpens=function(t,e,i,n){var a=this;return new Promise(function(o){var r={semanticAttributes:t,appStateKey:undefined};if(!a.hasListeners("beforePopoverOpens")){o(r);return}var s=function(t){var e=Object.keys(t).filter(function(e){return!jQuery.isEmptyObject(t[e])});return!!e.length};a.fireBeforePopoverOpens({originalId:i,semanticObject:e,semanticAttributes:!jQuery.isEmptyObject(t[e])?t[e]:null,semanticAttributesOfSemanticObjects:s(t)?t:null,setSemanticAttributes:function(t,i){i=i||e;r.semanticAttributes=r.semanticAttributes||{};if(n){n.updateSemanticObjectAttributes(i,r.semanticAttributes[i],t)}r.semanticAttributes[i]=t},setAppStateKey:function(t){r.appStateKey=t},open:function(){return o(r)}})})};S.prototype._fireNavigationTargetsObtained=function(t,e,i,n,a,o,r){var s=this;return new Promise(function(l){var u={mainNavigationId:t,mainNavigation:o.mainNavigation,availableActions:o.availableActions,ownNavigation:o.ownNavigation,extraContent:a.length?new c({items:a}):undefined};if(!s.hasListeners("navigationTargetsObtained")){l(u);return}s.fireNavigationTargetsObtained({mainNavigation:o.mainNavigation,actions:o.availableActions,ownNavigation:o.ownNavigation,popoverForms:a,semanticObject:e,semanticAttributes:i?i[e]:i,originalId:n,show:function(t,e,i,n){if(arguments.length>0&&!(typeof t==="string"||e instanceof p||Array.isArray(i))&&n===undefined){n=i;i=e;e=t;t=undefined}if(t!==undefined&&t!==null){u.mainNavigationId=t}if(e!==undefined){u.mainNavigation=e;if(r&&e){r.addIntent({text:e.getText(),intent:e.getHref()})}}if(i){i.forEach(function(t){if(t.getKey()===undefined){y.error("'key' attribute of 'availableAction' '"+t.getText()+"' is undefined. Links without 'key' can not be persisted.");y.warning("The 'visible' attribute of 'availableAction' '"+t.getText()+"' is set to 'true'");t.setVisible(true)}if(r&&t){r.addIntent({text:t.getText(),intent:t.getHref()})}});u.availableActions=i}if(n){u.extraContent=n}return l(u)}})})};S.prototype._onNavigate=function(t){var e=t.getParameters();this._fireInnerNavigate({text:e.text,href:e.href,internalHref:e.internalHref})};S.prototype._fireInnerNavigate=function(t){var e=sap.ui.getCore().byId(this.getControl());var i=this.getSemanticObject();var n=this._getSemanticAttributes();if(this.getAdditionalSemanticObjects().length>0){var a=this.getAdditionalSemanticObjects().find(function(e){return t.href.includes(e)});if(a){i=a}}var o={text:t.text,href:t.href,originalId:e?e.getId():undefined,semanticObject:i,semanticAttributes:n?n[i]:n};if(this.getBeforeNavigationCallback()){this.getBeforeNavigationCallback()(C({},o)).then(function(e){if(e===true){o.internalHref=t.internalHref;this.fireInnerNavigate(o);if(!this.getSemanticObjectController()){l.navigate(t.internalHref)}}}.bind(this))}else{o.internalHref=t.internalHref;this.fireInnerNavigate(o);if(!this.getSemanticObjectController()){l.navigate(t.internalHref)}}};S.prototype._getComponent=function(t){if(!t){return null}var e=t.getParent();while(e){if(e instanceof N){if(e&&e.getAppComponent){e=e.getAppComponent()}return e}e=e.getParent()}return N.get(N.getOwnerIdFor(t))};S.prototype.getAppComponent=function(){return this._getComponent(sap.ui.getCore().byId(this.getControl()))};S.prototype._getBindingContextObject=function(){var t=sap.ui.getCore().byId(this.getControl());var e=this.getBindingContext()||t&&t.getBindingContext();return e?e.getObject(e.getPath()):null};S.prototype._getLogFormattedText=function(){return this._oLog?this._oLog.getFormattedText():"No logging data available"};S.prototype._calculateSemanticAttributes=function(t,e){var i=this._getBindingContextObject();var n=this.getFieldName();var a=this;var o=["",this.getSemanticObject()].concat(this.getAdditionalSemanticObjects());var r={};o.forEach(function(o){r[o]={};var s=a._getMappingRules(o,t,i);for(var l in i){var c=null,p=null;if(e&&o){c={transformations:[]};e.addSemanticObjectAttribute(o,l,c)}if(i[l]===undefined||i[l]===null){if(c){c.transformations.push({value:i[l],description:" Undefined and null values have been removed in NavigationPopoverHandler."})}continue}if(P(i[l])){if(c){c.transformations.push({value:i[l],description:" Plain objects has been removed in NavigationPopoverHandler."})}continue}var u=s[l];if(c&&l!==u){p=t?{value:undefined,description:" The attribute "+l+" has been renamed to "+u+" in NavigationPopoverHandler.",reason:" A com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation is defined for semantic object "+o+" with source attribute "+l+" and target attribute "+u+". You can modify the annotation if the mapping result is not what you expected."}:{value:undefined,description:" The attribute "+l+" has been renamed to "+u+" in NavigationPopoverHandler.",reason:" The property mapFieldToSemanticObject is set to true. Attribute "+l+" is mapped to "+u+". (semantic object is "+a.getSemanticObject()+", field name is "+a.getFieldName()+"). If this is not what you expected, you can set the property to false or define a com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation."}}var g=i[l];if(r[o][u]){if(i[n]){if(u===s[a.getFieldName()]){g=i[n]}else{y.error("The attribute "+l+" can not be renamed to the attribute "+u+" due to a clash situation. This can lead to wrong navigation later on.")}}}r[o][u]=g;if(c){c.transformations.push({value:i[l],description:" The attribute "+l+" with the value "+i[l]+" is taken from the binding context in NavigationPopoverHandler."});if(p){c.transformations.push(p);e.addSemanticObjectAttribute(o,u,{transformations:[{value:g,description:" The attribute "+u+" with the value "+g+" has been added due to a mapping rule regarding the attribute "+l+" in NavigationPopoverHandler."}]})}}}});return r};S.prototype._getMappingRules=function(t,e,i){var n=this.getMapFieldToSemanticObject();if(this.getSemanticObjectController()&&this.getSemanticObjectController().getMapFieldToSemanticObject()!==undefined){n=this.getSemanticObjectController().getMapFieldToSemanticObject()}var a;var o={};if(e){for(a in e[t]){if(typeof e[t][a]==="string"){o[a]=e[t][a]}}}else if(n){if(this.getSemanticObjectController()){var r=this.getSemanticObjectController().getFieldSemanticObjectMap();for(a in r){o[a]=r[a]}}if(this.getFieldName()&&this.getSemanticObject()){o[this.getFieldName()]=this.getSemanticObject()}}for(a in i){if(!o.hasOwnProperty(a)){o[a]=a}}return o};S.prototype._updateSemanticObjectController=function(t){var e=this.getProperty("semanticObjectController");var i=sap.ui.getCore().byId(this.getControl());t=t||this.getSemanticObjectController()||this._getSemanticObjectControllerOfControl(i);if(t&&i&&t.isControlRegistered(i)){t.unregisterControl(this)}if(t!==e&&e){e.unregisterControl(this)}this.setProperty("semanticObjectController",t);if(t&&!t.isControlRegistered(i)){t.registerControl(this)}};S.prototype._getSemanticObjectControllerOfControl=function(t){if(!t){return undefined}var e;var i=t.getParent();while(i){if(i.getSemanticObjectController){e=i.getSemanticObjectController();if(e){this.setSemanticObjectController(e);break}}i=i.getParent()}return e};S.prototype._updateVisibilityOfAvailableActions=function(t){if(!this._getEnableAvailableActionsPersonalization(t)){return t}var e=l.getStorableAvailableActions(t);var i=e.some(function(t){return!!t.isSuperiorAction});e.forEach(function(e){if(t.length>10){e.visible=false}if(i){e.visible=false}if(e.isSuperiorAction){e.visible=true}});if(t.every(function(t){return!t.visible})){if(t[0]){t[0].visible=true}if(t[1]){t[1].visible=true}if(t[2]){t[2].visible=true}}return t};S.prototype._getEnableAvailableActionsPersonalization=function(t){var e=l.getStorableAvailableActions(t);if(e.length===0){return false}var i=this.getEnableAvailableActionsPersonalization();if(this.getSemanticObjectController()&&this.getSemanticObjectController().getEnableAvailableActionsPersonalization()&&this.getSemanticObjectController().getEnableAvailableActionsPersonalization()[this.getFieldName()]!==undefined){i=this.getSemanticObjectController().getEnableAvailableActionsPersonalization()[this.getFieldName()]}return i};return S});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/RTAHandler", ["sap/ui/comp/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","./Util","sap/ui/comp/navpopover/flexibility/changes/AddLink","sap/ui/comp/navpopover/flexibility/changes/RemoveLink","./Factory"],function(e,n,o,t,i,r,a){"use strict";var p=e.navpopover.ChangeHandlerType;var c={};c.isSettingsAvailable=function(){return!!a.getService("CrossApplicationNavigation")};c.getStableElements=function(e){if(!e||!e.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")){return null}var n=e.getNavigationPopoverStableId();if(!n){return null}var o=e.getAppComponent();if(!o){return null}return[{id:n,appComponent:o}]};c.execute=function(e,n,o){return new Promise(function(n,t){if(!e||!e.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")){t(new Error("oNavigationPopoverHandler is not of supported type sap.ui.comp.navpopover.NavigationPopoverHandler"));return}if(!e.getNavigationPopoverStableId()){t(new Error("StableId is not defined. SemanticObject="+e.getSemanticObject()));return}var i=e.getAppComponent();if(!i){t(new Error("AppComponent is not defined. oControl="+e.getControl()));return}e._getNavigationContainer().then(function(e){var t=[];var r=[];var a=function(o){var a=e.getId();t=o.filter(function(e){return e.visible===true}).map(function(e){return{selectorControl:{id:a,controlType:"sap.ui.comp.navpopover.NavigationContainer",appComponent:i},changeSpecificData:{changeType:p.addLink,content:e}}});r=o.filter(function(e){return e.visible===false}).map(function(e){return{selectorControl:{id:a,controlType:"sap.ui.comp.navpopover.NavigationContainer",appComponent:i},changeSpecificData:{changeType:p.removeLink,content:e}}});n(t.concat(r))};e.openSelectionDialog(true,false,a,false,o,undefined).then(function(){e.destroy()})})})};return c},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SemanticObjectController", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/core/Element","./Factory","sap/ui/model/json/JSONModel","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/BindingMode","sap/base/Log","sap/base/util/merge","./Util"],function(jQuery,t,e,i,n,a,o,r,s,c){"use strict";var p=e.extend("sap.ui.comp.navpopover.SemanticObjectController",{metadata:{library:"sap.ui.comp",properties:{ignoredFields:{type:"string",group:"Misc",defaultValue:null},prefetchNavigationTargets:{type:"boolean",group:"Misc",defaultValue:false},fieldSemanticObjectMap:{type:"object",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null},contactAnnotationPaths:{type:"object",defaultValue:null},enableAvailableActionsPersonalization:{type:"object",defaultValue:null},mapFieldToSemanticObject:{type:"boolean"},forceLinkRendering:{type:"object",defaultValue:null},beforeNavigationCallback:{type:"function"},replaceSmartLinkNavigationTargetsObtained:{type:"boolean",defaultValue:false}},events:{navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}},prefetchDone:{parameters:{semanticObjects:{type:"object"}}}}}});p.oSemanticObjects={};p.oNavigationTargetActions={};p.bHasPrefetchedDistinctSemanticObjects=false;p.bHasPrefetchedNavigationTargetActions=false;p.oPromise=null;p.oPromiseActions=null;p.prototype.init=function(){p.prefetchDistinctSemanticObjects();this._proxyOnBeforePopoverOpens=this._onBeforePopoverOpens.bind(this);this._proxyOnTargetsObtained=this._onTargetsObtained.bind(this);this._proxyOnNavigate=this._onNavigate.bind(this);this._aRegisteredControls=[]};p.prototype.isControlRegistered=function(t){return this._aRegisteredControls.indexOf(t)>-1};p.prototype.registerControl=function(t){if(!t||!(t.isA("sap.ui.comp.navpopover.SmartLink")||t.isA("sap.ui.comp.navpopover.NavigationPopoverHandler"))){r.warning("sap.ui.comp.navpopover.SemanticObjectController: "+(t&&t.getMetadata?t.getMetadata():"parameter")+" is neither of SmartLink nor of NavigationPopoverHandler instance");return}if(this.isControlRegistered(t)){return}if(t.attachBeforePopoverOpens){t.attachBeforePopoverOpens(this._proxyOnBeforePopoverOpens)}if(t.attachNavigationTargetsObtained){t.attachNavigationTargetsObtained(this._proxyOnTargetsObtained)}if(t.attachInnerNavigate){t.attachInnerNavigate(this._proxyOnNavigate)}this._aRegisteredControls.push(t)};p.prototype.unregisterControl=function(t){if(!t){return}if(!this.isControlRegistered(t)){return}if(t.detachBeforePopoverOpens){t.detachBeforePopoverOpens(this._proxyOnBeforePopoverOpens)}if(t.detachNavigationTargetsObtained){t.detachNavigationTargetsObtained(this._proxyOnTargetsObtained)}if(t.detachInnerNavigate){t.detachInnerNavigate(this._proxyOnNavigate)}this._aRegisteredControls.splice(this._aRegisteredControls.indexOf(t),1)};p.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t,true);return this};p.prototype._onBeforePopoverOpens=function(t){var e=t.getParameters();if(this.hasListeners("beforePopoverOpens")){this.fireBeforePopoverOpens({semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,semanticAttributesOfSemanticObjects:e.semanticAttributesOfSemanticObjects,setSemanticAttributes:e.setSemanticAttributes,setAppStateKey:e.setAppStateKey,originalId:e.originalId,open:e.open})}else{e.open()}};p.prototype._onTargetsObtained=function(t){var e=t.getParameters();if(!this.hasListeners("navigationTargetsObtained")){e.show();return}this.fireNavigationTargetsObtained({mainNavigation:e.mainNavigation,actions:e.actions,ownNavigation:e.ownNavigation,popoverForms:e.popoverForms,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,originalId:e.originalId,show:e.show})};p.prototype._onNavigate=function(t){if(t){var e=t.getParameters();var i={text:e.text,href:e.href,originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes};if(this.getBeforeNavigationCallback()&&!t.getSource().getBeforeNavigationCallback()){this.getBeforeNavigationCallback()(s({},i)).then(function(t){if(t===true){this.fireNavigate(e);c.navigate(e.internalHref)}}.bind(this))}else{this.fireNavigate(e);c.navigate(e.internalHref)}}};p.prototype.setIgnoredState=function(t){if(t&&t.isA("sap.ui.comp.navpopover.SmartLink")){t._updateEnabled()}};p.prototype.setIgnoredFields=function(t){this.setProperty("ignoredFields",t);this._aRegisteredControls.forEach(function(t){if(t._updateEnabled){t._updateEnabled()}});return this};p.prototype.setPrefetchNavigationTargets=function(t){this.setProperty("prefetchNavigationTargets",t);if(t!==true){return this}r.error("sap.ui.comp.navpopover.SemanticObjectController: Please be aware that in case of a large amount of semantic objects the performance may suffer significantly and the received links will be created out of context");var e=this;p.getDistinctSemanticObjects().then(function(t){p.getNavigationTargetActions(t).then(function(t){e.firePrefetchDone({semanticObjects:t})})});return this};p.prototype.getFieldSemanticObjectMap=function(){var t=this.getProperty("fieldSemanticObjectMap");if(t){return t}if(!this.getEntitySet()){r.warning("sap.ui.comp.navpopover.SemanticObjectController: FieldSemanticObjectMap is not set on SemanticObjectController, retrieval without EntitySet not possible");return null}var e=new a(this.getModel());t=e.getFieldSemanticObjectMap(this.getEntitySet());if(t){this.setProperty("fieldSemanticObjectMap",t,true)}return t};p.prototype.getEntitySet=function(){var t=this.getProperty("entitySet");if(t){return t}var e=this.getParent();while(e){if(e.getEntitySet){t=e.getEntitySet();if(t){this.setProperty("entitySet",t,true);break}}e=e.getParent()}return t};p.prototype.hasSemanticObjectLinks=function(t){return p.hasDistinctSemanticObject([t],p.oSemanticObjects)};p.prefetchDistinctSemanticObjects=function(){p.getJSONModel();if(!p.bHasPrefetchedDistinctSemanticObjects){p.getDistinctSemanticObjects()}};p.getDistinctSemanticObjects=function(){if(p.bHasPrefetchedDistinctSemanticObjects){return Promise.resolve(p.oSemanticObjects)}if(!p.oPromise){p.oPromise=new Promise(function(t){var e=i.getService("CrossApplicationNavigation");if(!e){r.error("sap.ui.comp.navpopover.SemanticObjectController: Service 'CrossApplicationNavigation' could not be obtained");p.bHasPrefetchedDistinctSemanticObjects=true;t({});return}e.getDistinctSemanticObjects().then(function(e){e.forEach(function(t){p.oSemanticObjects[t]={}});var i=p.getJSONModel();i.setProperty("/distinctSemanticObjects",p.oSemanticObjects);p.bHasPrefetchedDistinctSemanticObjects=true;return t(p.oSemanticObjects)},function(){r.error("sap.ui.comp.navpopover.SemanticObjectController: getDistinctSemanticObjects() of service 'CrossApplicationNavigation' failed");p.bHasPrefetchedDistinctSemanticObjects=true;return t({})})})}return p.oPromise};p.getNavigationTargetActions=function(t){if(p.bHasPrefetchedNavigationTargetActions){return Promise.resolve(p.oNavigationTargetActions)}if(!p.oPromiseLinks){p.oPromiseLinks=new Promise(function(e){var n=i.getService("CrossApplicationNavigation");var a=i.getService("URLParsing");if(!n||!a){r.error("sap.ui.comp.navpopover.SemanticObjectController: Service 'CrossApplicationNavigation' or 'URLParsing' could not be obtained");p.bHasPrefetchedNavigationTargetActions=true;e({});return}var o=Object.keys(t);var s=o.map(function(t){return[{semanticObject:t}]});n.getLinks(s).then(function(t){o.forEach(function(e,i){p.oNavigationTargetActions[e]=[];t[i][0].forEach(function(t){var i=a.parseShellHash(t.intent);if(i&&i.semanticObject===e){p.oNavigationTargetActions[e].push(i.action)}})});var i=p.getJSONModel();i.setProperty("/navigationTargetActions",p.oNavigationTargetActions);p.bHasPrefetchedNavigationTargetActions=true;return e(p.oNavigationTargetActions)},function(){r.error("sap.ui.comp.navpopover.SemanticObjectController: getLinks() of service 'CrossApplicationNavigation' failed");p.bHasPrefetchedNavigationTargetActions=true;return e({})})})}return p.oPromiseLinks};p.hasDistinctSemanticObject=function(t,e){return t.some(function(t){return!!e[t]})};p.getJSONModel=function(){var t=sap.ui.getCore().getModel("$sapuicompSemanticObjectController_DistinctSemanticObjects");if(t&&!jQuery.isEmptyObject(t.getData())){return t}t=new n({distinctSemanticObjects:{}});t.setDefaultBindingMode(o.OneTime);t.setSizeLimit(1e3);sap.ui.getCore().setModel(t,"$sapuicompSemanticObjectController_DistinctSemanticObjects");return t};p.destroyDistinctSemanticObjects=function(){p.oSemanticObjects={};p.oNavigationTargetActions={};p.oPromise=null;p.oPromiseActions=null;p.bHasPrefetchedDistinctSemanticObjects=false;p.bHasPrefetchedNavigationTargetActions=false;var t=sap.ui.getCore().getModel("$sapuicompSemanticObjectController_DistinctSemanticObjects");if(t){t.destroy()}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLink", ["sap/ui/base/ManagedObject","sap/m/Link","./LinkData","sap/ui/core/Control","./SemanticObjectController","./NavigationPopoverHandler","sap/ui/model/json/JSONModel","sap/ui/comp/personalization/Util","./Util","sap/base/Log","./SmartLinkRenderer"],function(t,e,i,n,a,o,r,s,l,p){"use strict";var c=e.extend("sap.ui.comp.navpopover.SmartLink",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/navpopover/SmartLink.designtime",properties:{semanticObject:{type:"string",defaultValue:null},additionalSemanticObjects:{type:"string[]",defaultValue:[]},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},createControlCallback:{type:"object",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},contactAnnotationPath:{type:"string",defaultValue:undefined},ignoreLinkRendering:{type:"boolean",defaultValue:false},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true},forceLinkRendering:{type:"boolean",defaultValue:false},uom:{type:"string",defaultValue:undefined},beforeNavigationCallback:{type:"function"}},aggregations:{innerControl:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}}});c.prototype.getInnerControlValue=function(){if(this._isRenderingInnerControl()){var t=this._getInnerControl();if(t){if(t.getText){return t.getText()}if(t.getValue){return t.getValue()}}}return this.getText()};c.prototype.getNavigationPopoverHandler=function(){return this._createNavigationPopoverHandler()};c.prototype.init=function(){a.prefetchDistinctSemanticObjects();this._oNavigationPopoverHandler=null;this.attachPress(this._onLinkPressed);this.addStyleClass("sapUiCompSmartLink")};c.prototype.applySettings=function(e){t.prototype.applySettings.apply(this,arguments);this._updateEnabled()};c.prototype.updateBindingContext=function(){n.prototype.updateBindingContext.apply(this,arguments);this.setHref(null);this.setTarget(null);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setBindingContext(this.getBindingContext())}};c.prototype._getTextOfDom=function(){if(!this.getDomRef()){return""}if(this.$().find("span").length===2){return this.$().find("span")[0].textContent+this.$().find("span")[1].textContent}else{return this.$()[0].textContent}};c.prototype.setText=function(t){if(this._isRenderingInnerControl()){this.setProperty("text",t,true)}else{e.prototype.setText.call(this,t)}return this};c.prototype.setMapFieldToSemanticObject=function(t){this.setProperty("mapFieldToSemanticObject",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setMapFieldToSemanticObject(t)}return this};c.prototype.setSemanticObject=function(t){this.setProperty("semanticObject",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setSemanticObject(t)}this._updateEnabled();return this};c.prototype.setAdditionalSemanticObjects=function(t){this.setProperty("additionalSemanticObjects",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setAdditionalSemanticObjects(t)}this._updateEnabled();return this};c.prototype.setBeforeNavigationCallback=function(t){this.setProperty("beforeNavigationCallback",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setBeforeNavigationCallback(t)}return this};c.prototype.setContactAnnotationPath=function(t){this.setProperty("contactAnnotationPath",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setContactAnnotationPath(t)}this._updateEnabled();return this};c.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setEnableAvailableActionsPersonalization(t)}return this};c.prototype.setIgnoreLinkRendering=function(t){this.setProperty("ignoreLinkRendering",t);this._updateEnabled();return this};c.prototype.setFieldName=function(t){this.setProperty("fieldName",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setFieldName(t)}this._updateEnabled();return this};c.prototype.setSemanticObjectController=function(t){if(t&&!t.isA("sap.ui.comp.navpopover.SemanticObjectController")){p.warning("Warning: setSemanticObjectController() has to be an object of sap.ui.comp.navpopover.SemanticObjectController instances",this);return this}var e=this.getProperty("semanticObjectController");if(e===t){return this}if(e){e.unregisterControl(this)}this.setProperty("semanticObjectController",t,true);if(t){if(this.hasListeners("navigationTargetsObtained")&&t.getReplaceSmartLinkNavigationTargetsObtained()&&t.hasListeners("navigationTargetsObtained")){this.mEventRegistry.navigationTargetsObtained.forEach(function(t){this.detachNavigationTargetsObtained(t.fFunction)}.bind(this))}t.registerControl(this);if(!this.getBeforeNavigationCallback()){this.setBeforeNavigationCallback(t.getBeforeNavigationCallback())}}if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setSemanticObjectController(t)}this._updateEnabled();return this};c.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);if(!this.getSemanticObjectController()){var t=this._getSemanticObjectControllerOfParent();if(t){this.setSemanticObjectController(t)}}};c.prototype.exit=function(){if(this.getSemanticObjectController()){this.getSemanticObjectController().unregisterControl(this)}if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.destroy();this._oNavigationPopoverHandler=null}};c.prototype._handlePress=function(t){if(this.getUom()&&t.target.localName==="span"){var i=this.getDomRef()?this.getDomRef():t.target.parentElement;t.target=i}e.prototype._handlePress.apply(this,arguments)};c.prototype._onLinkPressed=function(t){this._createNavigationPopoverHandler().openPopover()};c.prototype._createNavigationPopoverHandler=function(){if(!this._oNavigationPopoverHandler){if(!this.getFieldName()){var t=this.getBinding("text");var e;if(t){if(t.getBindings){e=t.getBindings()[0].getPath()}else{e=t.getPath()}}this.setFieldName(e)}this._oNavigationPopoverHandler=new o({semanticObject:this.getSemanticObject(),semanticObjectLabel:this.getSemanticObjectLabel(),additionalSemanticObjects:this.getAdditionalSemanticObjects(),semanticObjectController:this.getSemanticObjectController(),fieldName:this.getFieldName(),mapFieldToSemanticObject:this.getMapFieldToSemanticObject(),contactAnnotationPath:this.getContactAnnotationPath(),enableAvailableActionsPersonalization:this.getEnableAvailableActionsPersonalization(),control:this,beforePopoverOpens:this._onBeforePopoverOpens.bind(this),navigationTargetsObtained:this._onNavigationTargetsObtained.bind(this),innerNavigate:this._onInnerNavigate.bind(this),beforeNavigationCallback:this.getBeforeNavigationCallback()});this._oNavigationPopoverHandler.setModel(this.getModel());this._oNavigationPopoverHandler.isPopupAdaptationAllowed=function(){return false}}return this._oNavigationPopoverHandler};c.prototype._onNavigationTargetsObtained=function(t){var e=t.getParameters();if(!this.hasListeners("navigationTargetsObtained")){e.show();return}this.fireNavigationTargetsObtained({mainNavigation:e.mainNavigation,actions:e.actions,ownNavigation:e.ownNavigation,popoverForms:e.popoverForms,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,originalId:e.originalId,show:e.show})};c.prototype._onBeforePopoverOpens=function(t){var e=t.getParameters();if(!this.hasListeners("beforePopoverOpens")){e.open();return}this.fireBeforePopoverOpens({originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,semanticAttributesOfSemanticObjects:e.semanticAttributesOfSemanticObjects,setSemanticAttributes:e.setSemanticAttributes,setAppStateKey:e.setAppStateKey,open:e.open})};c.prototype._onInnerNavigate=function(t){var e=t.getParameters();if(!this.hasListeners("innerNavigate")){return}this.fireInnerNavigate({text:e.text,href:e.href,internalHref:e.internalHref,originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes})};c.prototype._isRenderingInnerControl=function(){return this.getIgnoreLinkRendering()&&this._getInnerControl()!==null};c.prototype._getInnerControl=function(){var t=this.getAggregation("innerControl");if(t){return t}var e=this.getCreateControlCallback();if(e){t=e();this.setAggregation("innerControl",t,true);return t}return null};c.prototype._getSemanticObjectControllerOfParent=function(){var t;var e=this.getParent();while(e){if(e.getSemanticObjectController){t=e.getSemanticObjectController();if(t){this.setSemanticObjectController(t);break}}e=e.getParent()}return t};c.prototype._updateEnabled=function(){var t=this;return a.getDistinctSemanticObjects().then(function(e){if(t.getSemanticObjectController()&&s.createArrayFromString(t.getSemanticObjectController().getIgnoredFields()).indexOf(t.getFieldName())>-1){t.setEnabled(false);return}if(t.getIgnoreLinkRendering()===true){t.setEnabled(false);return}if(l.getForceLinkRendering(t,t.getSemanticObjectController())){t.setEnabled(true);return}if(!a.hasDistinctSemanticObject(t.getAdditionalSemanticObjects().concat(t.getSemanticObject()),e)&&l.getContactAnnotationPath(t,t.getSemanticObjectController())===undefined){t.setEnabled(false);return}t.setEnabled(true)})};c.prototype.getAccessibilityInfo=function(){var t=this.getEnabled()?e.prototype.getAccessibilityInfo.apply(this,arguments):{description:this.getText()||this.getHref()||""};if(this.getUom()&&t.description&&t.description!==""&&!t.description.includes(this.getUom())){t.description+=this.getUom()}return t};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLinkRenderer", ["sap/ui/core/Renderer","sap/m/LinkRenderer","sap/base/strings/whitespaceReplacer"],function(e,t,n){"use strict";var r=e.extend(t);r.apiVersion=2;r.render=function(e,n){var r=true;if(n.getIgnoreLinkRendering()){var a=n._getInnerControl();if(a){e.openStart("div",n);e.openEnd();e.renderControl(a);e.close("div");r=false}}if(r){if(!n.getAriaLabelledBy()||Array.isArray(n.getAriaLabelledBy())&&n.getAriaLabelledBy().length==0){n.addAriaLabelledBy(n)}t.render.apply(this,arguments)}};r.writeText=function(e,t){var r=n(t.getText());if(!t.getUom()){e.text(r);return}e.openStart("span");e.openEnd();e.text(r);e.close("span");e.openStart("span");e.style("display","inline-block");e.style("min-width","2.5em");e.style("width","3.0em");e.style("text-align","start");e.openEnd();e.text(t.getUom());e.close("span")};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Util", ["sap/ui/comp/library","./Factory","./LinkData","sap/base/Log"],function(e,t,n,i){"use strict";var r={getContactAnnotationPath:function(e,t){var n=e?e.getContactAnnotationPath():undefined;if(n===undefined&&t&&t.getContactAnnotationPaths()&&t.getContactAnnotationPaths()[e.getFieldName()]!==undefined){n=t.getContactAnnotationPaths()[e.getFieldName()]}return n},getForceLinkRendering:function(e,t){if(!e){return undefined}return e.getForceLinkRendering()||!!(t&&t.getForceLinkRendering()&&t.getForceLinkRendering()[e.getFieldName()])},getStorableAvailableActions:function(e){return e?e.filter(function(e){return e&&e.key!==undefined}):[]},sortArrayAlphabetical:function(e){var t;try{t=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=="undefined"){var n=window.Intl.Collator(t,{numeric:true});e.sort(function(e,t){return n.compare(e,t)})}else{e.sort(function(e,n){return e.localeCompare(n,t,{numeric:true})})}}catch(e){}},retrieveNavigationTargets:function(e,r,a,o,c,s,u,l,v,f){var m={mainNavigation:undefined,ownNavigation:undefined,availableActions:[]};var p=t.getService("CrossApplicationNavigation");var g=t.getService("URLParsing");if(!p||!g){i.error("Service 'CrossApplicationNavigation' or 'URLParsing' could not be obtained");return Promise.resolve(m)}var b=[e].concat(r);var d=b.map(function(e){return[{semanticObject:e,params:c?c[e]:undefined,appStateKey:a,ui5Component:o,sortResultsBy:"text"}]});var h;return new Promise(function(e){p.getLinks(d).then(function(t){return e(t)})}).then(function(e){h=e;return h&&h.length?this.retrieveSemanticObjectUnavailableActions(u,l,v):Promise.resolve({})}.bind(this)).then(function(e){if(!h||!h.length){return Promise.resolve(m)}var t=p.hrefForExternal();if(t&&t.indexOf("?")!==-1){t=t.split("?")[0]}if(t){t+="?"}var i=function(t,n){return!!e&&!!e[t]&&e[t].indexOf(n)>-1};h[0][0].forEach(function(e){var r=g.parseShellHash(e.intent);var a=r.semanticObject&&r.action?r.semanticObject+"-"+r.action:undefined;var o=e.tags&&e.tags.indexOf("superiorAction")>-1;if(e.intent.indexOf(t)===0){var c=new n({key:a,href:e.intent,visible:true,isSuperiorAction:o});c.setText(e.text);m.ownNavigation=c;return}if(r.action&&r.action==="displayFactSheet"&&!i(r.semanticObject,r.action)){m.mainNavigation=new n({key:a,href:e.intent,text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_FACTSHEET"),visible:true,isSuperiorAction:o});if(f){f.addSemanticObjectIntent(r.semanticObject,{text:e.text,intent:e.intent})}return}if(!i(r.semanticObject,r.action)){var s=new n({key:a,href:e.intent,visible:true,isSuperiorAction:o});s.setText(e.text);m.availableActions.push(s);if(f){f.addSemanticObjectIntent(r.semanticObject,{text:e.text,intent:e.intent})}}});if(!m.mainNavigation&&typeof s==="string"){var r=new n({visible:true});r.setText(s);m.mainNavigation=r}var a=[];for(var o=1;o<b.length;o++){a=a.concat(h[o][0])}a.forEach(function(e){var t=g.parseShellHash(e.intent);if(i(t.semanticObject,t.action)){return}var r=e.tags&&e.tags.indexOf("superiorAction")>-1;var a=new n({key:t.semanticObject&&t.action?t.semanticObject+"-"+t.action:undefined,href:e.intent,visible:true,isSuperiorAction:r});a.setText(e.text);m.availableActions.push(a);if(f){f.addSemanticObjectIntent(t.semanticObject,{text:e.text,intent:e.intent})}});return Promise.resolve(m)})},retrieveSemanticObjectMapping:function(e,t,n){return this._getEntityTypeAnnotationOfProperty(e,t,n).then(function(e){if(!e){return Promise.resolve(null)}if(!e[0]["com.sap.vocabularies.Common.v1.SemanticObjectMapping"]){return Promise.resolve(null)}var t=this._getSemanticObjectMappingsOfProperty(e[0],this._getSemanticObjectsOfProperty(e[0]));var n={};for(var i in t){n[t[i].name]=t[i].mapping}return Promise.resolve(n)}.bind(this))},retrieveSemanticObjectUnavailableActions:function(e,t,n){return this._getEntityTypeAnnotationOfProperty(e,t,n).then(function(e){if(!e){return Promise.resolve(null)}if(!e[0]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){return Promise.resolve(null)}var t=this._getSemanticObjectUnavailableActionsOfProperty(e[0],this._getSemanticObjectsOfProperty(e[0]));var n={};for(var i in t){n[t[i].name]=t[i].unavailableActions}return Promise.resolve(n)}.bind(this))},oNavigationPromise:undefined,navigate:function(e){if(e.indexOf("#")===0&&sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getServiceAsync){var t=this;if(!t.oNavigationPromise){t.oNavigationPromise=sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(n){n.toExternal({target:{shellHash:e.substring(1)}});t.oNavigationPromise=undefined})}}else{window.location.href=e}},_getEntityTypeAnnotationOfProperty:function(e,t,n){if(!e){return Promise.resolve(null)}if(!t||!t.getMetaModel()){return Promise.resolve(null)}var r=t.getMetaModel();return r.loaded().then(function(){var t;try{t=r.getMetaContext(n)}catch(e){i.error("sap.ui.comp.navpopover.Util._getEntityTypeAnnotationOfProperty: binding path '"+n+"' is not valid. Error has been caught: "+e);return Promise.resolve(null)}if(!t){return Promise.resolve(null)}var a=t.getProperty(t.getPath());if(!a.property){return Promise.resolve(null)}var o=a.property.filter(function(t){return t.name===e});if(o.length!==1){return Promise.resolve(null)}return Promise.resolve(o)})},_getSemanticObjectsOfProperty:function(e){var t={};for(var n in e){var i=n.split("#")[0];var r=n.split("#")[1]||"";if(i.startsWith("com.sap.vocabularies.Common.v1.SemanticObject")&&i.endsWith("com.sap.vocabularies.Common.v1.SemanticObject")){t[r]={name:e[n]["String"],mapping:undefined}}}return t},_getSemanticObjectMappingsOfProperty:function(e,t){var n=function(e){var t={};if(Array.isArray(e)){e.forEach(function(e){t[e.LocalProperty.PropertyPath]=e.SemanticObjectProperty.String})}return t};for(var i in e){var r=i.split("#")[0];var a=i.split("#")[1]||"";if(r.startsWith("com.sap.vocabularies.Common.v1.SemanticObjectMapping")&&r.endsWith("com.sap.vocabularies.Common.v1.SemanticObjectMapping")){if(t[a]){t[a].mapping=n(e[i])}}}return t},_getSemanticObjectUnavailableActionsOfProperty:function(e,t){var n=function(e){var t=[];if(Array.isArray(e)){e.forEach(function(e){t.push(e.String)})}return t};for(var i in e){var r=i.split("#")[0];var a=i.split("#")[1]||"";if(r.startsWith("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")&&r.endsWith("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")){if(t[a]){t[a].unavailableActions=n(e[i])}}}return t}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/flexibility/changes/AddLink", ["sap/base/util/isEmptyObject","sap/base/Log"],function(e,t){"use strict";var n={};n.applyChange=function(n,r,i){var o=n.getContent();if(e(o)){t.error("Change does not contain sufficient information to be applied");return false}var a=r.getAvailableActions().filter(function(e){return e.getKey()===o.key});if(a.length!==1){t.error("Item with key "+o.key+" not found in the availableAction aggregation");return false}i.modifier.setProperty(a[0],"visibleChangedByUser",n.getLayer()==="USER");i.modifier.setProperty(a[0],"visible",o.visible);n.setRevertData({name:o.name,value:!o.visible});return true};n.completeChangeContent=function(t,n,r){if(e(n.content)){throw new Error("oSpecificChangeInfo.content should be filled")}if(!n.content.key){throw new Error("In oSpecificChangeInfo.content.key attribute is required")}if(n.content.visible!==true){throw new Error("In oSpecificChangeInfo.content.select attribute should be 'true'")}t.setContent(n.content)};n.revertChange=function(n,r,i){var o=n.getContent();if(e(o)){t.error("Change does not contain sufficient information to be applied");return false}var a=r.getAvailableActions().filter(function(e){return e.getKey()===o.key});if(a.length!==1){t.error("Item with key "+o.key+" not found in the availableAction aggregation");return false}i.modifier.setProperty(a[0],"visibleChangedByUser",n.getLayer()==="USER");i.modifier.setProperty(a[0],"visible",n.getRevertData().value);n.setRevertData({name:o.name,value:!o.visible});return true};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/flexibility/changes/RemoveLink", ["sap/base/util/isEmptyObject","sap/base/Log"],function(e,t){"use strict";var n={};n.applyChange=function(n,r,i){var o=n.getContent();if(e(o)){t.error("Change does not contain sufficient information to be applied");return false}var a=r.getAvailableActions().filter(function(e){return e.getKey()===o.key});if(a.length!==1){t.error("Item with key "+o.key+" not found in the availableAction aggregation");return false}i.modifier.setProperty(a[0],"visibleChangedByUser",n.getLayer()==="USER");i.modifier.setProperty(a[0],"visible",o.visible);n.setRevertData({name:o.name,value:!o.visible});return true};n.completeChangeContent=function(t,n,r){if(e(n.content)){throw new Error("oSpecificChangeInfo.content should be filled")}if(!n.content.key){throw new Error("In oSpecificChangeInfo.content.key attribute is required")}if(n.content.visible!==false){throw new Error("In oSpecificChangeInfo.content.select attribute should be 'false'")}t.setContent(n.content)};n.revertChange=function(n,r,i){var o=n.getContent();if(e(o)){t.error("Change does not contain sufficient information to be applied");return false}var a=r.getAvailableActions().filter(function(e){return e.getKey()===o.key});if(a.length!==1){t.error("Item with key "+o.key+" not found in the availableAction aggregation");return false}i.modifier.setProperty(a[0],"visibleChangedByUser",n.getLayer()==="USER");i.modifier.setProperty(a[0],"visible",n.getRevertData().value);return true};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CalendarMetadata", [],function(){"use strict";var a={"com.sap.vocabularies.Common.v1.IsCalendarDate":true,"com.sap.vocabularies.Common.v1.IsCalendarHalfyear":true,"com.sap.vocabularies.Common.v1.IsCalendarMonth":true,"com.sap.vocabularies.Common.v1.IsCalendarQuarter":true,"com.sap.vocabularies.Common.v1.IsCalendarWeek":true,"com.sap.vocabularies.Common.v1.IsCalendarYear":true,"com.sap.vocabularies.Common.v1.IsCalendarYearMonth":true,"com.sap.vocabularies.Common.v1.IsCalendarYearQuarter":true,"com.sap.vocabularies.Common.v1.IsCalendarYearWeek":true};var e={isCalendarValue:function(e){return this._isMatching(e,a)},isYear:function(a){return this._isDefaultTrue(a["com.sap.vocabularies.Common.v1.IsCalendarYear"])},isYearWeek:function(a){return this._isDefaultTrue(a["com.sap.vocabularies.Common.v1.IsCalendarYearWeek"])},isYearMonth:function(a){return this._isDefaultTrue(a["com.sap.vocabularies.Common.v1.IsCalendarYearMonth"])},isYearQuarter:function(a){return this._isDefaultTrue(a["com.sap.vocabularies.Common.v1.IsCalendarYearQuarter"])},_isMatching:function(a,e){var r=false;for(var o in e){if(this._isDefaultTrue(a[o])){r=true;break}}return r},_isDefaultTrue:function(a){if(a){return a.Bool?a.Bool!=="false":true}return false}};return e});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ChartMetadata", [],function(){"use strict";var a={"com.sap.vocabularies.UI.v1.ChartType/Column":"column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnDual":"dual_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual":"dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual100":"100_dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/Bar":"bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarDual":"dual_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual":"dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual100":"100_dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Area":"area","com.sap.vocabularies.UI.v1.ChartType/AreaStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/AreaStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/HorizontalArea":"bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Line":"line","com.sap.vocabularies.UI.v1.ChartType/LineDual":"dual_line","com.sap.vocabularies.UI.v1.ChartType/Combination":"combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStacked":"stacked_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationDual":"dual_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStackedDual":"dual_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStacked":"horizontal_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/Pie":"pie","com.sap.vocabularies.UI.v1.ChartType/Donut":"donut","com.sap.vocabularies.UI.v1.ChartType/Scatter":"scatter","com.sap.vocabularies.UI.v1.ChartType/Bubble":"bubble","com.sap.vocabularies.UI.v1.ChartType/Radar":"line","com.sap.vocabularies.UI.v1.ChartType/HeatMap":"heatmap","com.sap.vocabularies.UI.v1.ChartType/TreeMap":"treemap","com.sap.vocabularies.UI.v1.ChartType/Waterfall":"waterfall","com.sap.vocabularies.UI.v1.ChartType/Bullet":"bullet","com.sap.vocabularies.UI.v1.ChartType/VerticalBullet":"vertical_bullet","com.sap.vocabularies.UI.v1.ChartType/HorizontalWaterfall":"horizontal_waterfall","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationDual":"dual_horizontal_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStackedDual":"dual_horizontal_stacked_combination"};var e={"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1":"axis1","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis2":"axis2","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis3":"axis3","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis4":"axis4"};var r={"com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category":"category","com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series":"series","com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category2":"category2"};var o=["AcceptanceRangeLowValue","AcceptanceRangeHighValue","ToleranceRangeLowValue","ToleranceRangeHighValue","DeviationRangeLowValue","DeviationRangeHighValue"];var i={mCriticalityType:{},mImprovementDirectionType:{},getChartType:function(e){return a[e]},getAnnotationChartType:function(e){for(var r in a){if(a[r]===e){return r}}},getMeasureRole:function(a){return e[a]},getAnnotationMeasureRole:function(a){for(var r in e){if(e[r]===a){return r}}},getDimensionRole:function(a){return r[a]},getAnnotationDimensionRole:function(a){for(var e in r){if(r[e]===a){return e}}},getCriticalityThresholds:function(){return o},calculateConstantValue:function(a){var e=a?a.Decimal||a.Int||a.String:undefined;return Number(e)},calculateValue:function(a){var e=a?a.Decimal||a.Int||a.String:undefined;return e},getValueCriticality:function(a){return a["com.sap.vocabularies.UI.v1.ValueCriticality"]||null},getCriticalityType:function(a){return i.mCriticalityType[a]},getImprovementDirectionType:function(a){return i.mImprovementDirectionType[a]},feedWithChartLibrary:function(a){if(!i.chartLibrary){i.chartLibrary=a;var e=a.coloring.CriticalityType;var r=a.coloring.ImprovementDirectionType;i.mCriticalityType={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":e.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":e.Negative,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":e.Critical,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":e.Positive};i.mImprovementDirectionType={"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Target":r.Target,"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Maximize":r.Maximize,"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Minimize":r.Minimize}}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CriticalityMetadata", [],function(){"use strict";var i={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":0,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":1,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":2,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":3,0:0,1:1,2:2,3:3};var t={0:"None",1:"Error",2:"Warning",3:"Success"};var r={0:null,1:"sap-icon://error",2:"sap-icon://alert",3:"sap-icon://sys-enter-2"};var a={getCriticalityState:function(r){if(typeof r==="string"){r=i[r]}return t[r]},getCriticalityIcon:function(t){if(typeof t==="string"){t=i[t]}return r[t]},getShowCriticalityIcon:function(i){return i==="com.sap.vocabularies.UI.v1.CriticalityRepresentationType/WithoutIcon"?false:true}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/FiscalFormat", ["sap/ui/base/Object","sap/ui/core/LocaleData"],function(t,e){"use strict";var r=t.extend("sap.ui.comp.odata.FiscalFormat",{metadata:{library:"sap.ui.comp"},constructor:function(r,o){t.call(this,r,o);var a,s,n,i,p=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale(),f=e.getInstance(p),u=sap.ui.getCore().getConfiguration().getFormatSettings().getCustomLocaleData(),l=/(m|y)(?:.*)(\W)(m|y)/i,m=u["dateFormats-short"];this.oFormatOptions=o;if(this.oFormatOptions.format.length>4){a="yM"}else if(this.oFormatOptions.format==="PPP"){a="M"}else{a=this.oFormatOptions.format}if(m&&a==="yM"){i=m.match(l).splice(1).join("");if(i){s=i}}else{s=f.getCustomDateTimePattern(a,this.oFormatOptions.calendarType)}s=s.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(this.oFormatOptions.format.length>4){s=s.replace(/y+/i,this.oFormatOptions.format.slice(0,this.oFormatOptions.format.lastIndexOf("Y")+1));s=s.replace(/m+/i,this.oFormatOptions.format.slice(this.oFormatOptions.format.lastIndexOf("Y")+1))}else if(this.oFormatOptions.format==="PPP"){s="PPP"}n=this.parseCldrDatePattern(s);this.oFormatOptions.pattern=n.length>1?s:"";this._setFormatRegex(n);this._setParseRegex(n);this._setValidationRegex(n)}});r.getDateInstance=function(t){return new r(null,t)};r.prototype.getPattern=function(){return this.oFormatOptions.pattern};r.prototype.getRegExPattern=function(){return this.sFormatRegExPattern};r.prototype.getTemplate=function(){return this.sFormatRegExGroups};r.prototype._setFormatRegex=function(t){var e=[],r=[],o,a,s,n,i;for(i=0;i<t.length;i++){o=t[i];a=o.symbol||"";s=this.oSymbols[a].format;if(a===""){r[i]=o.value}else if(a==="y"||a==="Y"){e.unshift("("+s.source+")");r[i]="$"+1}else{e.push("("+s.source+")");n=t.some(function(t){return t.symbol==="y"||t.symbol==="Y"});r[i]=n?"$"+2:"$"+1}}this.sFormatRegExPattern=new RegExp(e.join(""));this.sFormatRegExGroups=r.join("")};r.prototype._setParseRegex=function(t){var e,r,a,s,n,i=[],p={},f=0;for(s=0;s<t.length;s++){e=t[s];r=e.symbol||"";a=this.oSymbols[r].parse;if(r===""){i.push("\\D+?")}else{i.push("("+a.source+")");n=++f;p[n]=e}}this.sParseRegExPattern=new RegExp("^"+i.join("")+"$");this.fnParseRegExReplacer=function(){var t,e,r=[];for(var a in p){t=p[a];e=arguments[a];if(e.length<t.digits){if(t.symbol==="y"||t.symbol==="Y"){e=o(e)}else{e=e.padStart(t.digits,"0")}}if(t.symbol==="y"||t.symbol==="Y"){r.unshift(e)}else{r.push(e)}}return r.join("")}};r.prototype._setValidationRegex=function(t){var e,r,o,a,s=[];for(e=0;e<t.length;e++){r=t[e];o=r.symbol||"";a=this.oSymbols[o].format;if(o===""){continue}else if(o==="y"||o==="Y"){s.unshift(a.source)}else{s.push(a.source)}}this.sValidationRegExPattern=new RegExp("^("+s.join(")(")+")$")};r.prototype.parseCldrDatePattern=function(t){var e,r,o,a,s=[];for(e=0;e<t.length;e++){r=t[e];if(o!==r){a={}}else{a.digits+=1;continue}if(typeof this.oSymbols[r]==="undefined"){a.value=r;a.type="text"}else{a.symbol=r;a.digits=1}o=r;s.push(a)}return s};r.prototype.format=function(t){if(t==null){return""}return t.replace(this.sFormatRegExPattern,this.sFormatRegExGroups)};r.prototype.parse=function(t){if(t){return t.replace(this.sParseRegExPattern,this.fnParseRegExReplacer)}return null};r.prototype.validate=function(t){return this.sValidationRegExPattern.test(t)};r.oRegexFormatPatterns={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/371|370|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/};r.oRegexParsePatterns={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/};r.prototype.oSymbols={"":"",y:{format:r.oRegexFormatPatterns.year,parse:r.oRegexParsePatterns.year},Y:{format:r.oRegexFormatPatterns.year,parse:r.oRegexParsePatterns.year},P:{format:r.oRegexFormatPatterns.period,parse:r.oRegexParsePatterns.period},W:{format:r.oRegexFormatPatterns.week,parse:r.oRegexParsePatterns.week},d:{format:r.oRegexFormatPatterns.day,parse:r.oRegexParsePatterns.day},Q:{format:r.oRegexFormatPatterns.quarter,parse:r.oRegexParsePatterns.quarter},q:{format:r.oRegexFormatPatterns.quarter,parse:r.oRegexParsePatterns.quarter}};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this._oAnnotationValidationRegexPattern){this._oAnnotationValidationRegexPattern=null}};function o(t){var e,r=Number.parseInt(t),o=(new Date).getUTCFullYear(),a=Math.floor(o/100);e=a*100+r-o;if(t.length===3){r+=Math.floor((a-1)/10)*1e3}else if(e<-70){r+=(a+1)*100}else if(e<30){r+=a*100}else{r+=(a-1)*100}return r}return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/FiscalMetadata", [],function(){"use strict";var a={isFiscalValue:function(a){for(var o=0;o<this.aAnnotations.length;o++){if(this.isTermDefaultTrue(a[this.aAnnotations[o]])){return true}}return false},isFiscalYear:function(a){return this.isTermDefaultTrue(a["com.sap.vocabularies.Common.v1.IsFiscalYear"])},isFiscalYearPeriod:function(a){return this.isTermDefaultTrue(a["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"])},getFiscalAnotationType:function(a){for(var o=0;o<this.aAnnotations.length;o++){var s=a[this.aAnnotations[o]];if(s&&s.Bool!=="false"){return this.aAnnotations[o]}}return null},isTermDefaultTrue:function(a){if(a){return a.Bool?a.Bool!=="false":true}return false},updateViewMetadata:function(a){var o=this.getFiscalAnotationType(a);if(o==="com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"||o==="com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"||o==="com.sap.vocabularies.Common.v1.IsFiscalYearWeek"){a.maxLength=(parseInt(a.maxLength)+1).toString()}return a},aAnnotations:["com.sap.vocabularies.Common.v1.IsFiscalYear","com.sap.vocabularies.Common.v1.IsFiscalPeriod","com.sap.vocabularies.Common.v1.IsFiscalYearPeriod","com.sap.vocabularies.Common.v1.IsFiscalQuarter","com.sap.vocabularies.Common.v1.IsFiscalYearQuarter","com.sap.vocabularies.Common.v1.IsFiscalWeek","com.sap.vocabularies.Common.v1.IsFiscalYearWeek","com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"]};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/MetadataAnalyser", ["./ODataType","sap/ui/comp/odata/FiscalMetadata","sap/ui/model/odata/AnnotationHelper","sap/m/library","sap/base/Log"],function(e,t,i,n,a){"use strict";var o={"com.sap.vocabularies.Common.v1.FilterExpressionType/SingleInterval":"interval","com.sap.vocabularies.Common.v1.FilterExpressionType/MultiValue":"multi-value","com.sap.vocabularies.Common.v1.FilterExpressionType/SingleValue":"single-value"};var r={"com.sap.vocabularies.UI.v1.SelectionRangeOptionType/EQ":"EQ","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/BT":"BT","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/CP":"CP","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/LE":"LE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/GE":"GE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NE":"NE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NB":"NB","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NP":"NP","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/GT":"GT","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/LT":"LT"};var s={"com.sap.vocabularies.UI.v1.SelectionRangeSignType/I":"I","com.sap.vocabularies.UI.v1.SelectionRangeSignType/E":"E"};var l=n.P13nConditionOperation;var u=function(e){if(typeof e==="object"){this.oModel=e}else{this._sResourceRootUri=e}this._oMetadata=null;if(!this.oModel&&this._sResourceRootUri){a.error("Analyzing metadata cannot be done without an ODataModel!");return}if(this.oModel){this._oMetaModel=this.oModel.getMetaModel()}if(this._oMetaModel){this._oMetadata=this._oMetaModel.getProperty("/")}if(this._oMetadata&&this._oMetadata.dataServices){this._oSchemaDefinition=this._oMetadata.dataServices.schema[0]}};u.hierarchyType={nodeFor:1,nodeExternalKeyFor:2,parentNodeFor:3,levelFor:4,drillStateFor:5,nodeDescendantCountFor:6};u.prototype.getNamespace=function(){if(this._oSchemaDefinition){return this._oSchemaDefinition.namespace}};u.prototype.getSchemaDefinition=function(){return this._oSchemaDefinition};u.prototype.getEntityContainerAttribute=function(e){var t=null,i;if(this._oMetaModel&&e){if(e.indexOf("sap:")<0){e="sap:"+e}i=this._oMetaModel.getODataEntityContainer();t=i[e]||null}return t};u.prototype.getEntityLabelByEntityTypeName=function(e){var t=this._getEntityDefinition(e),i,n="";if(t){i=t["com.sap.vocabularies.Common.v1.Label"];if(i&&i.String){n=i.String}}return n};u.prototype._getEntityDefinition=function(e){var t=null;if(e){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e))}return t};u.prototype._getComplexTypeDefinition=function(e){var t=null;if(e){t=this._oMetaModel.getODataComplexType(this._getFullyQualifiedNameForEntity(e))}return t};u.prototype._getNameOfPropertyUsingComplexType=function(e,t){var i=this.getNamespace();if(e&&t&&i){var n=i+"."+t;var a=this._getEntityDefinition(e);if(a){var o=a.property;if(o&&o.length){var r=0;for(r=0;r<o.length;r++){var s=o[r];if(s&&s.type===n){return s.name}}}}}return null};u.prototype.removeNamespace=function(e){var t,i=e;if(e){t=e.lastIndexOf(".")+1}if(t>0){i=e.substring(t)}return i};u.prototype.getEntityTypeNameFromEntitySetName=function(e){var t=null,i=null;if(this._oMetaModel){t=this._oMetaModel.getODataEntitySet(e);if(t){i=t.entityType}}return i};u.prototype.getEntitySetNameFromEntityTypeName=function(e){var t,i,n,a,o,r;if(this._oMetaModel&&e){t=this._getFullyQualifiedNameForEntity(e);i=this._oMetaModel.getODataEntityContainer();if(i&&t){n=i.entitySet;o=n.length;for(a=0;a<o;a++){r=n[a];if(r.entityType===t){break}r=null}if(r){return r.name}}}return null};u.prototype.getKeysByEntitySetName=function(e){var t=null,i=null;if(!this._oMetaModel){return undefined}i=this.getEntityTypeNameFromEntitySetName(e);if(i){t=this.getKeysByEntityTypeName(i)}return t};u.prototype.getKeysByEntityTypeName=function(e){var t=null,i=null,n,a=0,o=null;if(!this._oMetaModel){return undefined}o=this._getEntityDefinition(e);if(o){if(o.key){i=o.key.propertyRef;if(i){a=i.length;t=[];for(n=0;n<a;n++){t.push(i[n].name)}}}}return t};u.prototype.getFieldsByEntitySetName=function(e){var t=null,i,n=null;if(!this._oMetaModel){return undefined}i=this._oMetaModel.getODataEntitySet(e);if(i){n=i.entityType}if(n){t=this.getFieldsByEntityTypeName(n);this._enrichEntitySetMetadata(t,i)}return t};u.prototype._enrichEntitySetMetadata=function(e,t){var i,n,a,o,r,s;a=this._getNonSortableFields(t);o=this._getNonFilterableFields(t);r=this._getRequiredFilterFields(t);s=this._getFilterExpressionRestriction(t);i=e.length;while(i--){n=e[i];n.sortable=!(a.indexOf(n.name)>-1);n.filterable=!(o.indexOf(n.name)>-1);n.requiredFilterField=r.indexOf(n.name)>-1;n.filterRestriction=s[n.name]}};u.prototype._extractPropertyPathsFromAnnotation=function(e,t){var i=[],n,a,o;if(e&&t){n=e[t]}if(n){a=n.length;while(a--){o=n[a].PropertyPath;if(o){i.push(o)}}}return i};u.prototype._getNonSortableFields=function(e){var t;if(e){t=e["Org.OData.Capabilities.V1.SortRestrictions"]}return this._extractPropertyPathsFromAnnotation(t,"NonSortableProperties")};u.prototype._getNonFilterableFields=function(e){var t;if(e){t=e["Org.OData.Capabilities.V1.FilterRestrictions"]}return this._extractPropertyPathsFromAnnotation(t,"NonFilterableProperties")};u.prototype._getRequiredFilterFields=function(e){var t;if(e){t=e["Org.OData.Capabilities.V1.FilterRestrictions"]}return this._extractPropertyPathsFromAnnotation(t,"RequiredProperties")};u.prototype._getFilterExpressionRestriction=function(e){var t={},i,n,a,r,s;if(e){var l=e["Org.OData.Capabilities.V1.FilterRestrictions"];if(l){i=l["FilterExpressionRestrictions"];if(i){for(var u=0;u<i.length;u++){r=i[u].Property;s=i[u].AllowedExpressions;if(s&&s.String){switch(s.String){case"SingleValue":t[r.PropertyPath]="single-value";break;case"MultiValue":t[r.PropertyPath]="multi-value";break;case"SingleRange":t[r.PropertyPath]="interval";break;case"SearchExpression":t[r.PropertyPath]="search-expression";break;default:}}}}}if(i==undefined){i=e["com.sap.vocabularies.Common.v1.FilterExpressionRestrictions"];if(i){n=i.length;while(n--){a=i[n];if(a){r=a.Property;s=a.AllowedExpressions;if(r&&s&&r.PropertyPath&&s.EnumMember){t[r.PropertyPath]=o[s.EnumMember]}}}}}}return t};u.prototype._isFilterable=function(e,t){var i,n=true;if(t){i=this._getNonFilterableFields(t);n=!(i.indexOf(e.name)>-1)}if(n){n=!(e["sap:filterable"]==="false")}return n};u.isHiddenFilter=function(e){return!!e["com.sap.vocabularies.UI.v1.HiddenFilter"]&&u.isTermDefaultTrue(e["com.sap.vocabularies.UI.v1.HiddenFilter"])};u.isHidden=function(e){return!!e["com.sap.vocabularies.UI.v1.Hidden"]&&u.isTermDefaultTrue(e["com.sap.vocabularies.UI.v1.Hidden"])};u.prototype.getFieldsByEntityTypeName=function(e){var t;if(!this._oMetaModel){return undefined}t=this._getEntityDefinition(e);return this._getFieldsByEntityDefinition(t)};u.prototype.getFieldsByComplexTypeName=function(e,t){var i;if(!this._oMetaModel){return undefined}i=this._getComplexTypeDefinition(e);return this._getFieldsByEntityDefinition(i,t)};u.prototype.getAllEntityTypeNames=function(){if(!this._oMetaModel){return undefined}var e=this._oSchemaDefinition;if(e.entityType&&e.entityType.length>0){var t=0;var i=[];for(t=0;t<e.entityType.length;t++){i.push(e.entityType[t].name)}return i}return null};u.prototype.getFieldSemanticObjectMap=function(e){var t=this.getFieldsByEntitySetName(e);if(!t){return null}var i={},n,a=t.length;for(n=0;n<a;n++){var o=t[n];var r=this.getSemanticObjectAnnotation(o.fullName);if(r&&r.semanticObject){i[o.name]=r.semanticObject}}return i};u.prototype._getFieldsByEntityDefinition=function(e,t){var i=null,n=null,a=0,o=0,r,s;if(e){n=e.property}if(n){i=[];o=n.length;for(a=0;a<o;a++){r=n[a];if(r){s=this._parseV4PropertyAnnotations(r,e,t);this._determineHierarchyInformation(s,r);this._determineFilterAndSortInformation(s,r,null);i.push(s)}}}return i};u.prototype.getPropertyContextByPath=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=e.split("/");i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);n=t[1];a=this._oMetaModel.getODataProperty(i,n,true);if(a){o=this._oMetaModel.createBindingContext(a)}}return o};u.getDisplayFormat=function(e){var t=e["sap:display-format"];if(t){return t}};u.isCalendarDate=function(e){return u.isPropertyStringType(e)&&u.isTermDefaultTrue(e["com.sap.vocabularies.Common.v1.IsCalendarDate"])};u.isFiscalDate=function(e){return t.isFiscalValue(e)};u.getTimezonePropertyPath=function(e){if(e["type"]!=="Edm.DateTimeOffset"){return undefined}var t=e["com.sap.vocabularies.Common.v1.Timezone"];return t?t.Path:undefined};u.hasValueListRelevantQualifiers=function(e){var t=false;if(e&&e["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"]){t=true}return t};u.getAggregationRole=function(e){if(e["com.sap.vocabularies.Analytics.v1.Dimension"]){return"dimension"}if(e["com.sap.vocabularies.Analytics.v1.Measure"]){return"measure"}return undefined};u.getLinkDisplayFormat=function(e){if(u.isEmailAddress(e)){return"EmailAddress"}if(u.isPhoneNumber(e)){return"PhoneNumber"}if(u.isURL(e)){return"URL"}return""};u.getValueListMode=function(e){if(u.isValueListWithFixedValues(e)){return"fixed-values"}var t=e["sap:value-list"];if(t){return t}return""};u.isTermTrue=function(e){return!!e&&e.Bool==="true"};u.isPropertyStringType=function(e){return!!e&&e.type==="Edm.String"};u.isTermDefaultTrue=function(e){if(e){return e.Bool?e.Bool!=="false":true}return false};u.isNullable=function(e){return!(e&&e.nullable==="false")};u.isSkippingMeasuredQuantityCheck=function(e){var t="com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity";return u.isTermTrue(e[t])};u.isDigitSequence=function(e){return u.isPropertyStringType(e)&&u.isTermDefaultTrue(e["com.sap.vocabularies.Common.v1.IsDigitSequence"])};u.isUpperCase=function(e){return u.isPropertyStringType(e)&&u.isTermDefaultTrue(e["com.sap.vocabularies.Common.v1.IsUpperCase"])};u.isEmailAddress=function(e){return u.isPropertyStringType(e)&&u.isTermDefaultTrue(e["com.sap.vocabularies.Communication.v1.IsEmailAddress"])};u.isPhoneNumber=function(e){return u.isPropertyStringType(e)&&u.isTermDefaultTrue(e["com.sap.vocabularies.Communication.v1.IsPhoneNumber"])};u.isURL=function(e){return u.isPropertyStringType(e)&&(u.isTermDefaultTrue(e["Org.OData.Core.V1.IsURL"])||u.isTermDefaultTrue(e["Org.OData.Core.V1.IsUrl"]))};u.isValueList=function(e){var t="com.sap.vocabularies.Common.v1.ValueList";return!!(e&&(e["sap:value-list"]||e[t]))};u.isRecommendationList=function(e){return!!(e&&e["com.sap.vocabularies.UI.v1.RecommendationList"])};u.isValueListWithFixedValues=function(e){var t="com.sap.vocabularies.Common.v1.ValueListWithFixedValues";return u.isTermTrue(e[t])};u.hasImportance=function(e){return!!(e&&e["com.sap.vocabularies.UI.v1.Importance"])};u.prototype._parseProperty=function(e,t,i){var n=this._parseV4PropertyAnnotations(e,t,i);this._determineHierarchyInformation(n,e);this._determineFilterAndSortInformation(n,e,null);return n};u.prototype._parseV4PropertyAnnotations=function(e,t,i){var n=Object.assign({},e);var a=e["com.sap.vocabularies.Common.v1.Label"];if(a){n.fieldLabel=a.String}a=e["com.sap.vocabularies.Common.v1.QuickInfo"];if(a){n.quickInfo=a.String}n.displayFormat=u.getDisplayFormat(e);n.isDigitSequence=u.isDigitSequence(e);n.isURL=u.isURL(e);n.isEmailAddress=u.isEmailAddress(e);n.isPhoneNumber=u.isPhoneNumber(e);n.isUpperCase=u.isUpperCase(e);n.isCalendarDate=u.isCalendarDate(e);n.isFiscalDate=u.isFiscalDate(e);n.timezone=u.getTimezonePropertyPath(e);n.aggregationRole=u.getAggregationRole(e);a=e["Org.OData.Measures.V1.ISOCurrency"];if(a){n.isCurrencyField=true;n.isMeasureField=true;n.unit=a.Path}a=e["Org.OData.Measures.V1.Unit"];if(a){n.isMeasureField=true;n.unit=a.Path}a=e["com.sap.vocabularies.Common.v1.Text"];if(a){n.description=a.Path;n.displayBehaviour=this.getTextArrangementValue(a)}else if(e["com.sap.vocabularies.UI.v1.TextArrangement"]){n.displayBehaviour=this.getTextArrangementValue(e)}a=e["com.sap.vocabularies.UI.v1.IsImageURL"]||e["com.sap.vocabularies.UI.v1.IsImageUrl"];n.isImageURL=u.isTermDefaultTrue(a);n.entityName=t.name;n.parentPropertyName=i;n.fullName=this._getFullyQualifiedNameForField(e.name,t);a=e["com.sap.vocabularies.Common.v1.FieldControl"];n.visible=!(a&&(a.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"||a.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Inapplicable"));n.visible=n.visible&&!u.isHidden(e);n.hiddenFilter=u.isHiddenFilter(e);if(e["defaultValue"]!==undefined){n.defaultPropertyValue=e["defaultValue"]}a=e["com.sap.vocabularies.Common.v1.FilterDefaultValue"];if(a){n.defaultFilterValue=this._getDefaultValues(e.type,a,e)}return n};u.prototype._determineHierarchyInformation=function(e,t){var i={field:null,type:null};if(t["sap:hierarchy-node-for"]!=null){i.field=t["sap:hierarchy-node-for"];i.type=u.hierarchyType.nodeFor}if(t["sap:hierarchy-node-external-key-for"]!=null){i.field=t["sap:hierarchy-node-external-key-for"];i.type=u.hierarchyType.nodeExternalKeyFor}if(t["sap:hierarchy-parent-node-for"]!=null){i.field=t["sap:hierarchy-parent-node-for"];i.type=u.hierarchyType.parentNodeFor}if(t["sap:hierarchy-level-for"]!=null){i.field=t["sap:hierarchy-level-for"];i.type=u.hierarchyType.levelFor}if(t["sap:hierarchy-drill-state-for"]!=null){i.field=t["sap:hierarchy-drill-state-for"];i.type=u.hierarchyType.drillStateFor}if(t["sap:hierarchy-node-descendant-count-for"]!=null){i.field=t["sap:hierarchy-node-descendant-count-for"];i.type=u.hierarchyType.nodeDescendantCountFor}if(i.type!=null){e.hierarchy=i}};u.prototype._determineFilterAndSortInformation=function(e,t,i){if(i){this._enrichEntitySetMetadata([e],i)}if(e.filterable==undefined||e.filterable){e.filterable=t["sap:filterable"]!=="false"}if(!e.filterRestriction&&t["sap:filter-restriction"]){e.filterRestriction=t["sap:filter-restriction"]}if(!e.requiredFilterField){e.requiredFilterField=t["sap:required-in-filter"]==="true"}if(e.sortable==undefined||e.sortable){e.sortable=t["sap:sortable"]!=="false"}};u.prototype._getDefaultValues=function(t,i,n){var o=null,r=e.getDefaultValueTypeName(t);if(i[r]){o=i[r]}else{a.error("default value for "+n.name+" expected through the property "+r)}return o};u.prototype.extractNavigationPropertyField=function(e,t){var i,n,a,o,r,s,l,u=null;if(t&&e){i="/"+t+"/";o=e.split("/");r=o.pop();s=o.join("/");if(s&&r){n=this._oMetaModel.getMetaContext(i+s);if(n){l=this._oMetaModel.getProperty(n.getPath())}}if(l){a=this._oMetaModel.getODataProperty(l,r)}if(a){u=this._parseV4PropertyAnnotations(a,l,s);u.name=e;var p=this._oMetaModel.getODataEntitySet(t);this._determineFilterAndSortInformation(u,a,p);u.name=a.name}}return u};u.prototype.getAllFilterableFieldNamesByEntityTypeName=function(e){var t,i,n,a,o,r,s;r=[];t=this.getAllFilterableFieldsByEntityTypeName(e);if(t&&t.length){n=t.length;for(i=0;i<n;i++){s=t[i];if(s.fields&&s.fields.length){o=s.fields.length;for(a=0;a<o;a++){r.push(s.fields[a].name)}}}}return r};u.prototype._getAllFilterableFieldsByEntity=function(e,t,i,n){var a=[],o,r,s,l,u,p,f,c;if(!this._oMetaModel||!e){return undefined}if(t){r=this._oMetaModel.getODataEntitySet(e);if(r){o=this._getEntityDefinition(r.entityType)}}else{o=this._getEntityDefinition(e)}if(o){a.push(this._getFilterableFieldsFromEntityDefinition(o,undefined,r));s=this._getFilterableAssociations(o,r);for(l in s){if(!n||n.indexOf(l)>-1){c=s[l];if(t){u=this._oMetaModel.getODataAssociationSetEnd(o,l);if(u.entitySet){f=this._oMetaModel.getODataEntitySet(u.entitySet)}}p=this._getEntityDefinition(c);if(p){if(i&&p["sap:semantics"]==="parameters"){continue}a.push(this._getFilterableFieldsFromEntityDefinition(p,l,f))}}}}return a};u.prototype._getAllFilterableFieldsByEntityForAllEndpoints=function(e,t,i,n){var a=[],o,r,s,l,u,p,f,c;if(!this._oMetaModel||!e){return undefined}if(t){r=this._oMetaModel.getODataEntitySet(e);if(r){o=this._getEntityDefinition(r.entityType)}}else{o=this._getEntityDefinition(e)}if(o){a.push(this._getFilterableFieldsFromEntityDefinition(o,undefined,r));s=this._getAssociations(o,r,true,true);for(l in s){if(!n||n.indexOf(l)>-1){c=s[l];if(t){u=this._oMetaModel.getODataAssociationSetEnd(o,l);if(u.entitySet){f=this._oMetaModel.getODataEntitySet(u.entitySet)}}p=this._getEntityDefinition(c);if(p){if(i&&p["sap:semantics"]==="parameters"){continue}a.push(this._getFilterableFieldsFromEntityDefinition(p,l,f))}}}}return a};u.prototype.getAllFilterableFieldsByEntitySetName=function(e,t,i){if(!this._oMetaModel){return undefined}return this._getAllFilterableFieldsByEntity(e,true,t,i)};u.prototype.getAllFilterableFieldsByEntityTypeName=function(e){if(!this._oMetaModel){return undefined}return this._getAllFilterableFieldsByEntity(e)};u.prototype._getFilterableFieldsFromEntityDefinition=function(e,t,i){var n={},o=[],r=[],s=null,l,u,p,f=null;if(!this._oMetaModel||!e){return undefined}if(!i){a.error("mandatory parameter 'oEntitySet' not set or null.")}else{l=e["com.sap.vocabularies.Common.v1.Label"];if(l){n.groupLabel=l.String}n.groupEntitySetName=i.name;n.groupEntityTypeName=e.name;n.groupName=t;s=this._getFieldsByEntityDefinition(e,t);if(i){this._enrichEntitySetMetadata(s,i)}p=s.length;for(u=0;u<p;u++){f=s[u];if(f.filterable){if(f.visible){f.groupEntitySet=n.groupEntitySetName;f.groupEntityType=n.groupEntityTypeName;o.push(f)}else{r.push(f)}}}}n.fields=o;n.hiddenFields=r;return n};u.prototype._getFullyQualifiedNameForField=function(e,t){var i,n,a=e;if(t){i=t.namespace;n=t.name}if(i&&n){a=i+"."+n+"/"+e}return a};u.prototype.getFieldNameByFullyQualifiedFieldName=function(e){var t,i;t=this.removeNamespace(e);i=t.indexOf("/");t=t.substring(i+1);return t};u.prototype._getFilterableAssociations=function(e,t){return this._getAssociations(e,t,true,false)};u.prototype._getAssociations=function(e,t,i,n){var a={},o=null,r=null,s,l=0,p=null;if(!this._oMetaModel||!e){return undefined}o=e.navigationProperty;if(o&&o.length){l=o.length;for(s=0;s<l;s++){r=o[s];if(i){if(!this._isFilterable(r,t)||u.isHiddenFilter(r)){continue}}p=this._oMetaModel.getODataAssociationEnd(e,r.name);if(!p||p.type===e.namespace+"."+e.name){continue}if(n||p.multiplicity==="1"||p.multiplicity==="0..1"){if(a[r.name]===undefined){a[r.name]=p.type}}}}return a};u.prototype.getParametersByEntitySetName=function(e){var t,i,n,a,o,r,s,l,u,p,f;f=this._oMetaModel.getODataEntitySet(e);if(f){u=this._getEntityDefinition(f.entityType)}i=this._getAssociations(u,null,false,false);for(a in i){r=i[a];l=this._oMetaModel.getODataAssociationSetEnd(u,a);if(l.entitySet){p=this._getEntityDefinition(r);if(p){if(p["sap:semantics"]==="parameters"&&p.key){t={entitySetName:l.entitySet,parameters:[],navPropertyName:""};for(var c=0;c<p.key.propertyRef.length;c++){t.parameters.push(p.key.propertyRef[c].name)}n=this._getAssociations(p,null,false,true);for(o in n){s=n[o];if(s===f.entityType){t.navPropertyName=o;break}}return t}}}}return null};u.prototype.getValueListAnnotationLazy=function(e,t){var i,n,a,o,r={additionalAnnotations:[],additionalAnnotationsWithPVQualifier:[]},s,l,p,f,c;o=new Promise(function(o,m){if(e&&this._oMetaModel){f=this.getPropertyContextByPath(e);p=e.split("/");l=p[1];if(f){i=f.getObject&&f.getObject();if(t&&u.hasValueListRelevantQualifiers(i)){a=this.oModel.getContext(t);n=this.getODataRelevantValueLists(f,a)}else{n=this._oMetaModel.getODataValueLists(f)}n.then(function(e){for(c in e){s={annotation:e[c]};if(s.annotation){this._enrichValueHelpAnnotation(s,l);if(!s.annotation["PresentationVariantQualifier"]){if(!c){r.primaryValueListAnnotation=s}else{r.additionalAnnotations.push(s)}s.qualifier=c}else{if(!c){r.primaryValueListAnnotationWithPVQualifier=s}else{s.qualifier=c;r.additionalAnnotationsWithPVQualifier.push(s)}}}}if(!r.primaryValueListAnnotation){r.primaryValueListAnnotation=r.additionalAnnotations.shift()}o(r)}.bind(this),m);return}}m()}.bind(this));return o};u.prototype.getODataRelevantValueLists=function(e,t){return this._oMetaModel.getODataValueLists(e).then(function(i){var n,a={},o=this._getODataValueListRelevantQualifiers(e,t),r=Array.isArray(o)&&o.length>0;for(n in i){if(r&&o.indexOf(n)!==-1){a[n]=i[n]}}return a}.bind(this))};u.prototype._getODataValueListRelevantQualifiers=function(e,t){var i,n=t.getModel(),a=e.getObject(),o=a["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"];if(Array.isArray(o)&&n!==undefined){i=o.filter(function e(i){var a,o,r,s,l=false,u=i["If"],p=i["String"];if(p||p===""){l=true}else if(this._isBooleanStatement(u)){o=u[0]["Path"];s=n.getObject(o,t);if(s===true){l=true}}else if(u){a=u[0]["Eq"];o=a[0]["Path"];r=a[1]["String"];s=n.getObject(o,t);if(r===s){l=true}}return l}.bind(this)).map(function e(t){var i,n=t["If"],a=t["String"];if(a||a===""){i=a}else if(n){i=n[1]&&n[1]["String"]}return i})}return i};u.prototype._isBooleanStatement=function(e){var t=false;if(e&&e[0]&&e[0]["Eq"]===undefined&&e[0]["Path"]!==undefined){t=true}return t};u.prototype.getValueListAnnotationForFunctionImport=function(e,t){var i={additionalAnnotations:[]},n,a;for(a in e){n={annotation:e[a]};if(n.annotation){this._enrichValueHelpAnnotation(n,t);if(!a){i.primaryValueListAnnotation=n}else{n.qualifier=a;i.additionalAnnotations.push(n)}}}return i};u.prototype.getValueListAnnotation=function(e){var t={additionalAnnotations:[]},i,n,a,o,r,s;if(e&&this._oMetaModel){a=e.split("/");o=this._oMetaModel.getODataEntityType(a[0])||this._oMetaModel.getODataComplexType(a[0]);r=this._oMetaModel.getODataProperty(o,a[1]);if(r){n=r.name;for(var l in r){if(l==="com.sap.vocabularies.Common.v1.ValueList"||l.indexOf("com.sap.vocabularies.Common.v1.ValueList#")>-1){s=null;i={annotation:r[l]};a=l.split("#");if(a.length===2){s=a[1]}if(i.annotation){this._enrichValueHelpAnnotation(i,n);if(!s){t.primaryValueListAnnotation=i}else{i.qualifier=s;t.additionalAnnotations.push(i)}}}}}}return t};u.prototype._getRecommendationListAnnotation=function(e){var t=e.split("/"),i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]),n=t[1],a=this._oMetaModel.getODataProperty(i,n,true),o=this._oMetaModel.createBindingContext(a),r=o.getObject();return r["com.sap.vocabularies.UI.v1.RecommendationList"]};u.prototype._enrichValueHelpAnnotation=function(e,t){var i,n,a,o=[],r,s={},l={},p={},f,c,m,y=[],d=[],h,g,v,M,b,_,F=0,S=0,T=0,D=0,P,E=[],O=[];if(e&&e.annotation){i=e.annotation;if(i){n=i["SearchSupported"];e.isSearchSupported=n?n.Bool==="true":false;n=i["CollectionPath"];if(n){e.valueListEntitySetName=n.String;if(this._oMetaModel){a=this._oMetaModel.getODataEntitySet(e.valueListEntitySetName)}if(a){e.valueListEntityName=a.entityType;e.semantics=a["sap:semantics"];o=this.getKeysByEntitySetName(a.name);y=this.getFieldsByEntitySetName(a.name)}}n=i["Label"];if(n){e.valueListTitle=n.String}h=i["Parameters"];if(y&&h){F=h.length}for(S=0;S<F;S++){_=h[S];v=undefined;M=undefined;b=undefined;g=_["ValueListProperty"];if(g){v=g.String}g=_["LocalDataProperty"];if(g){M=g.PropertyPath}g=_["Constant"];if(g){b=g[Object.keys(g)[0]]}f=false;if(_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"){f=true}c=false;if(_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterOut"){c=true}m=false;if(_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterConstant"){m=true}if(_.InitialValueIsSignificant&&_.InitialValueIsSignificant.Bool==="true"&&_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"){O.push(v)}if(f){s[M]=v}if(c){l[M]=v}if(m){p[v]=b}if(c||_.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly"){D=y.length;while(D--){if(y[D].name===v){d.push(y[D]);break}}}if(!r&&c&&M===t){r=v}if(u.hasImportance(_)&&this._getImportanceAnnotation(_)==="High"){for(T=0;T<y.length;T++){P=y[T];if(P.name===v){E.push(P);break}}}}}e.inParams=s;e.outParams=l;e.constParams=p;e.fields=y;e.valueListFields=d;e.aHighImportanceFields=E;e.keys=o;e.keyField=r;e.descriptionField=this.getDescriptionFieldName(e.keyField,e.valueListEntitySetName);e.deprecationCodeField=this.getDeprecationCodeFieldName(y);e.aInitialValueIsSignificantFields=O}};u.prototype._enrichRecommendationListAnnotation=function(e){var t={},i=[],n,a;t.annotation=e;a=e["CollectionPath"];if(a){t.path=a.String}a=e["RankProperty"];if(a){t.rankProperty=a.String}a=e["Binding"];if(a){i=a}if(this._oMetaModel&&t.path){n=this._oMetaModel.getODataEntitySet(t.path)}if(n){t.entityName=n.name;t.keys=this.getKeysByEntitySetName(n.name);t.fields=this.getFieldsByEntitySetName(n.name);t.rankField=t.fields.filter(function(e){return e.name===t.rankProperty})}i=i.map(function(e){var i=0;while(i<t.fields.length){if(t.fields[i].name===e.RecommendationListProperty.String){return t.fields[i]}i++}return false});t.fieldsToDisplay=i.concat(t.rankField);return t};u.prototype.getDescriptionFieldName=function(e,t){var i,n=0,a,o,r;if(typeof e==="object"){o=e}else{i=this.getFieldsByEntitySetName(t);if(i){a=i.length;for(n=0;n<a;n++){o=i[n];if(o.name===e){break}o=null}}}if(o&&o["com.sap.vocabularies.Common.v1.Text"]){r=o["com.sap.vocabularies.Common.v1.Text"].Path}return r};u.prototype.getDeprecationCodeFieldName=function(e){var t=0,i,n,a;for(t=0,i=e.length;t<i;t++){n=e[t];if(u.isTermDefaultTrue(n["com.sap.vocabularies.CodeList.v1.IsConfigurationDeprecationCode"])){a=n.name;break}}return a};u.prototype.getIsSearchSupported=function(e){var t=false,i;if(e){i=e.SearchSupported;if(i&&i.Bool==="true"){t=true}}return t};u.prototype.getValueListSemantics=function(e){var t,i,n;if(e){t=e["CollectionPath"]?e["CollectionPath"].String:undefined}if(t){i=this._oMetaModel.getODataEntitySet(t);if(i){n=i["sap:semantics"]}}return n};u.prototype.getLineItemAnnotation=function(e,t){var i,n,a,o;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(e);if(i){n="com.sap.vocabularies.UI.v1.LineItem";if(t){n+="#"+t}a=i[n];if(a){o={annotation:a};this._enrichAnnotationWithUIDataField(o,a)}}}return o};u.prototype.isSemanticAggregation=function(e){var t;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);if(t){return t["sap:semantics"]==="aggregate"}}return false};u.prototype.getPresentationVariantAnnotation=function(e,t){var i,n,a,o,r,s,l,u,p;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(e);if(i){n="com.sap.vocabularies.UI.v1.PresentationVariant";if(t){n+="#"+t}a=i[n];if(a){s={annotation:a,requestAtLeastFields:[],sortOrderFields:[],groupByFields:[],maxItems:undefined};if(a.Visualizations){o=a.Visualizations.length;for(r=0;r<o;r++){p=a.Visualizations[r].AnnotationPath;if(!l&&(p==="@com.sap.vocabularies.UI.v1.LineItem"||p.indexOf("@com.sap.vocabularies.UI.v1.LineItem#")>-1)){l=i[p.substring(1)];s.lineItemAnnotation={annotation:l};this._enrichAnnotationWithUIDataField(s.lineItemAnnotation,l)}else if(!u&&(p==="@com.sap.vocabularies.UI.v1.Chart"||p.indexOf("@com.sap.vocabularies.UI.v1.Chart#")>-1)){u=i[p.substring(1)];s.chartAnnotation={annotation:u,semantics:i["sap:semantics"]};this._enrichChartAnnotation(s.chartAnnotation,u)}if(l&&u){break}}}if(a.RequestAtLeast){o=a.RequestAtLeast.length;for(r=0;r<o;r++){s.requestAtLeastFields.push(a.RequestAtLeast[r].PropertyPath)}}if(a.SortOrder){o=a.SortOrder.length;for(r=0;r<o;r++){s.sortOrderFields.push({name:a.SortOrder[r].Property.PropertyPath,descending:a.SortOrder[r].Descending?a.SortOrder[r].Descending.Bool==="true":false})}}if(a.GroupBy){o=a.GroupBy.length;for(r=0;r<o;r++){s.groupByFields.push(a.GroupBy[r].PropertyPath)}}if(a.MaxItems){s.maxItems=a.MaxItems.Int}}}}return s};u.prototype._getPresentationVariantQualifierForVHD=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);i="com.sap.vocabularies.UI.v1.PresentationVariant";for(o in t){if(o.indexOf(i+"#")>-1){a=o.split("#");if(a.length===2){n=a[1]}}}}return n||""};u.prototype._enrichChartAnnotation=function(e,t){var i,n,a;if(e&&t){e.measureFields=[];e.dimensionFields=[];e.measureAttributes={};e.dimensionAttributes={};if(t.ChartType&&t.ChartType.EnumMember){e.chartType=t.ChartType.EnumMember}if(t.Measures){n=t.Measures.length;for(i=0;i<n;i++){e.measureFields.push(t.Measures[i].PropertyPath)}}if(t.MeasureAttributes){n=t.MeasureAttributes.length;for(i=0;i<n;i++){a=t.MeasureAttributes[i];if(a.Measure){e.measureAttributes[a.Measure.PropertyPath]={role:a.Role?a.Role.EnumMember:null,dataPoint:a.DataPoint?a.DataPoint.AnnotationPath:null}}}}if(t.Dimensions){n=t.Dimensions.length;for(i=0;i<n;i++){e.dimensionFields.push(t.Dimensions[i].PropertyPath)}}if(t.DimensionAttributes){n=t.DimensionAttributes.length;for(i=0;i<n;i++){a=t.DimensionAttributes[i];if(a.Dimension){e.dimensionAttributes[a.Dimension.PropertyPath]={role:a.Role?a.Role.EnumMember:null,hierarchyLevel:a.HierarchyLevel?a.HierarchyLevel.Int:0}}}}}};u.prototype.getChartAnnotation=function(e,t){var i,n,a,o;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(e);if(i){o="com.sap.vocabularies.UI.v1.Chart";if(t){o+="#"+t}n=i[o];if(n){a={annotation:n,semantics:i["sap:semantics"]};this._enrichChartAnnotation(a,n)}}}return a};u.prototype.getDataPointAnnotation=function(e){var t,i,n,a,o,r={};if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);if(t){for(i in t){if(i==="com.sap.vocabularies.UI.v1.DataPoint"||i.indexOf("com.sap.vocabularies.UI.v1.DataPoint#")>-1){n=null;o=t[i];a=i.split("#");if(a.length===2){n=a[1]}if(o){if(n){if(!r.additionalAnnotations){r.additionalAnnotations={}}r.additionalAnnotations[n]=o}else{r.primaryAnnotation=o}}}}}}return r};u.prototype.getFieldGroupAnnotation=function(e){var t,i,n,a,o,r,s=[];if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){for(var l in t){if(l==="com.sap.vocabularies.UI.v1.FieldGroup"||l.indexOf("com.sap.vocabularies.UI.v1.FieldGroup#")>-1){i=null;o=t[l];n=l.split("#");if(n.length===2){i=n[1]}if(o){r={annotation:o};if(i){r.groupName=i}a=o["Label"];if(a){r.groupLabel=a.String}a=o["Data"];if(a){this._enrichAnnotationWithUIDataField(r,a)}s.push(r)}}}}}return s};u.prototype.getFieldGroupsByFilterFacetsAnnotation=function(e){var t,i,n,a,o,r=this.getFieldGroupAnnotation(e);o=r;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){for(var s in t){if(s==="com.sap.vocabularies.UI.v1.FilterFacets"||s.indexOf("com.sap.vocabularies.UI.v1.FilterFacets#")>-1){o=[];a=t[s];if(a){for(var l=0;l<a.length;l++){i=a[l].Target.AnnotationPath.split("#");if(i.length===2){n=i[1]}if(n){r.some(function(e){if(e.groupName===n){if(a[l].Label){e.groupLabel=a[l].Label.String}o.push(e);return true}return false})}}}}}}}return o};u.prototype._enrichAnnotationWithUIDataField=function(e,t){var i=[],n={},a={},o={},r={},s={},l,u,p,f=0,c=0;if(e&&t){f=t.length;i=[];a={};for(c=0;c<f;c++){p=t[c];if(p&&(p.RecordType==="com.sap.vocabularies.UI.v1.DataField"||p.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")){u=null;l=p["Value"];if(l){u=l.Path}if(u){i.push(u);l=p["Url"];if(l){n[u]=this._extractURLInfo(l)}l=p["Label"];if(l&&l.String){a[u]=l.String}o[u]=this._getImportanceAnnotation(p);l=p["Criticality"];if(l){r[u]=this._extractCriticalityInfo(l,p)}s[u]=this._getWidthAnnotation(p)}}}e.fields=i;e.urlInfo=n;e.labels=a;e.importance=o;e.criticality=r;e.width=s}};u.prototype._extractCriticalityInfo=function(e,t){var i,n;if(e.Path||e.EnumMember){i={};i["path"]=e.Path;i["criticalityType"]=e.EnumMember;n=t["CriticalityRepresentation"];if(n){if(n.Path){i["criticalityRepresentationPath"]=n.Path}else if(n.EnumMember){i["criticalityRepresentationType"]=n.EnumMember}}}return i};u.prototype._extractURLInfo=function(e){var t,n,a,o;if(e){if(e.Apply&&e.Apply.Name==="odata.fillUriTemplate"){t={urlTarget:undefined,parameters:[]};if(!this._oDummyAnnotationHelperContext){this._oDummyAnnotationHelperContext=this._oMetaModel.createBindingContext("/")}if(this._oDummyAnnotationHelperContext){t.urlTarget=i.format(this._oDummyAnnotationHelperContext,e)}n=e.Apply.Parameters;a=n&&n.length?n.length:0;while(a--){o=n[a];if(o&&o.Type==="LabeledElement"&&o.Value&&o.Value.Path){t.parameters.push(o.Value.Path)}}}else if(e.Path){t={urlPath:e.Path}}}return t};u.prototype.updateDataFieldDefault=function(e){var t=e&&e["com.sap.vocabularies.UI.v1.DataFieldDefault"],i;if(t&&(t.RecordType==="com.sap.vocabularies.UI.v1.DataField"||t.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")){i=t["Label"];if(i&&i.String){e.label=i.String}i=t["Criticality"];if(i){e.criticalityInfo=this._extractCriticalityInfo(i,t)}i=t["Url"];if(i){e.urlInfo=this._extractURLInfo(i)}e.width=this._getWidthAnnotation(t);e.importance=this._getImportanceAnnotation(t)}};u.prototype.getSelectionVariantAnnotationList=function(e){var t,i,n,a=[],o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){for(var r in t){if(r==="com.sap.vocabularies.UI.v1.SelectionVariant"||r.indexOf("com.sap.vocabularies.UI.v1.SelectionVariant#")>-1){n="";i=t[r];o=r.split("#");if(o.length===2){n=o[1]}if(i){a.push({qualifier:n,annotation:i})}}}}}return a};u.prototype.getSelectionPresentationVariantAnnotationList=function(e){var t,i,n,a,o,r,s,l=null,u=null,p=null,f=[],c;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntitySet(e);if(i){n=this._oMetaModel.getODataEntityType(i.entityType)}t=[i,n];var m=function(e,t){return t.filter(function(t){return t.qualifier===e})[0]};var y=this.getEntityTypeNameFromEntitySetName(e);var d=this;t.forEach(function(e){if(e){for(var t in e){if(t==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"||t.indexOf("com.sap.vocabularies.UI.v1.SelectionPresentationVariant#")>-1){o="";a=e[t];c=t.split("#");if(c.length===2){o=c[1]}if(a){l=null;if(a.Text&&a.Text.String){l=a.Text.String}if(a.SelectionVariant&&a.SelectionVariant.Path){s=a.SelectionVariant.Path;r="";c=s.split("#");if(c.length===2){r=c[1]}if(n[s.substring(1)]){var i=m(r,d.getSelectionVariantAnnotationList(y));u={qualifier:r,annotation:i?i.annotation:undefined}}}if(a.PresentationVariant&&a.PresentationVariant.Path){s=a.PresentationVariant.Path;r="";c=s.split("#");if(c.length===2){r=c[1]}if(n[s.substring(1)]){p={qualifier:r,annotation:d.getPresentationVariantAnnotation(y,r)}}}f.push({qualifier:o,text:l,annotation:a,selectionVariant:u,presentationVariant:p})}}}}})}return f};u.prototype.getSelectionFieldsAnnotation=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){i=t["com.sap.vocabularies.UI.v1.SelectionFields"];if(i){o={annotation:i,selectionFields:[]};n=i.length;for(a=0;a<n;a++){o.selectionFields.push(i[a].PropertyPath)}}}}return o};u.prototype.getSemanticKeyAnnotation=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);if(t){i=t["com.sap.vocabularies.Common.v1.SemanticKey"];if(i){o={annotation:i,semanticKeyFields:[]};n=i.length;for(a=0;a<n;a++){o.semanticKeyFields.push(i[a].PropertyPath)}}}}return o};u.resolveEditableFieldFor=function(e){var t=e&&e["com.sap.vocabularies.Common.v1.EditableFieldFor"];return t&&t.PropertyPath};u.isPotentiallySensitive=function(e){return this.isTermTrue(e["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"])};u.prototype._getImportanceAnnotation=function(e){var t=null,i;i=e["com.sap.vocabularies.UI.v1.Importance"];if(i){t=i.EnumMember}switch(t){case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";case"com.sap.vocabularies.UI.v1.ImportanceType/Low":return"Low";default:return"High"}};u.prototype._getWidthAnnotation=function(e){var t=null,i,n,a=/\d*\.?\d+(px|em|rem)/gi;i=e["com.sap.vocabularies.HTML5.v1.CssDefaults"];if(i){n=i.width;if(n&&n.String&&a.test(n.String)){t=n.String}}return t};u.prototype.getTextArrangementValue=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){if(typeof e==="string"){e=this._getFullyQualifiedNameForEntity(e);t=e.split("/");if(t.length>1){i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);n=this._oMetaModel.getODataProperty(i,t[1])}else{n=this._oMetaModel.getODataEntityType(e)||this._oMetaModel.getODataComplexType(e)}}else{n=e}if(n){a=n["com.sap.vocabularies.UI.v1.TextArrangement"]}if(a){switch(a.EnumMember){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst":o="descriptionAndId";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":o="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":o="idOnly";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly":o="descriptionOnly";break;default:o=undefined;break}}}return o};u.prototype.getSemanticObjectAnnotation=function(e){var t,i,n,a;if(e&&this._oMetaModel){t=e.split("/");i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);n=this._oMetaModel.getODataProperty(i,t[1]);if(n){a=n["com.sap.vocabularies.Common.v1.SemanticObject"]}return this._prepareSemanticObjectAnnotationFromProperty(a)}return null};u.prototype.getSemanticObjectsFromAnnotation=function(e){if(!e||!this._oMetaModel){return null}var t=e.split("/");var i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);return u.getSemanticObjectsFromProperty(this._oMetaModel.getODataProperty(i,t[1]))};u.getSemanticObjectsFromProperty=function(e){var t={defaultSemanticObject:undefined,additionalSemanticObjects:[]};for(var i in e){if(i==="com.sap.vocabularies.Common.v1.SemanticObject"){t.defaultSemanticObject=e[i]["String"]}else if(i.startsWith("com.sap.vocabularies.Common.v1.SemanticObject#")){t.additionalSemanticObjects.push(e[i]["String"])}}return t.defaultSemanticObject||t.additionalSemanticObjects.length>0?t:undefined};u.prototype.getSemanticObjectAnnotationFromProperty=function(e){var t;if(e){t=e["com.sap.vocabularies.Common.v1.SemanticObject"];return this._prepareSemanticObjectAnnotationFromProperty(t)}return null};u.prototype._prepareSemanticObjectAnnotationFromProperty=function(e){var t,i;if(e){t=e["String"];if(t){i={annotation:e};i.semanticObject=t}}return i};u.prototype.getContactAnnotation=function(e){var t=this._oMetaModel.getMetaContext(e);var i=t.getProperty(t.getPath());return i["com.sap.vocabularies.Communication.v1.Contact"]};u.prototype._getFullyQualifiedNameForEntity=function(e){var t,i;if(!e){return undefined}if(e.indexOf(".")>-1){return e}t=this.getNamespace();if(t&&!(e.indexOf(t)>-1)){i=t+"."+e}else{i=e}return i};u.prototype.getMultiUnitBehaviorEnabled=function(){var e=this._oMetaModel&&this._oMetaModel.getODataEntityContainer();return u.isTermDefaultTrue(e&&e["com.sap.vocabularies.Common.v1.ApplyMultiUnitBehaviorForSortingAndFiltering"])};u.prototype.getPDFSupportedAnnotation=function(){var e=this._oMetaModel&&this._oMetaModel.getODataEntityContainer(true);var t=this._oMetaModel.getObject(e+"/com.sap.vocabularies.PDF.v1.Features");var i={};for(var n in t){var a=t[n];if(a.Bool){i[n]=a.Bool==="true"}else if(a.String){i[n]=a.String}else if(a.Int){i[n]=parseInt(a.Int)}}return t?i:undefined};u.getSelectionRangeOptionType=function(e){return r[e]};u.getSelectionRangeSignType=function(e){return s[e]};u.hasTextArrangementAnnotation=function(e){if(e["com.sap.vocabularies.UI.v1.TextArrangement"]||e["com.sap.vocabularies.Common.v1.Text"]&&e["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]){return true}return false};u._getSearchExpressionTypeOperations=function(){var e={},t=u._getSearchExpressionType();e[t]=u._getSearchExpressionRangeOperationsKeys();return e};u._getSearchExpressionRangeOperationsKeys=function(){return[l.Contains,l.StartsWith,l.EndsWith]};u._getSearchExpressionType=function(){return"string"};u.prototype.destroy=function(){this.oModel=null;this._oMetaModel=null;this._oMetadata=null;this._oSchemaDefinition=null;this._sResourceRootUri=null;this.bIsDestroyed=true;this._oDummyAnnotationHelperContext=null};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataModelUtil", ["sap/ui/model/odata/v2/ODataModel"],function(e){"use strict";var t={handleModelInit:function(t,a,n){var i=false,o;if(t&&!t._bMetaModelLoadAttached&&a){o=t.getModel();if(o){if(o.getMetadata()&&o instanceof e){i=true}else if(o.bLoadMetadataAsync||o.getServiceMetadata&&!o.getServiceMetadata()){i=true}t._bMetaModelLoadAttached=true;if(i&&o.getMetaModel()&&o.getMetaModel().loaded){var r=!!n;if(!r){return o.getMetaModel().loaded().then(a.bind(t))}else{return this._waitForFlexChanges(o,t,a,n)}}else{a.apply(t)}}}return Promise.resolve()},_waitForFlexChanges:function(e,t,a,n){return this._getFlexRuntimeInfoAPI().then(function(i){return this._flexRuntimeInfoAPIHandler(i,e,t,a,n)}.bind(this))},_getFlexRuntimeInfoAPI:function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})},_flexRuntimeInfoAPIHandler:function(e,t,a,n,i){var o;if(!e.isFlexSupported({element:a})){o=Promise.resolve()}else if(typeof i==="boolean"){o=e.waitForChanges({element:a})}else{o=e.waitForChanges({complexSelectors:i})}return Promise.all([t.getMetaModel().loaded(),o]).then(n.bind(a))}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataModelUtilSync", ["sap/ui/comp/odata/ODataModelUtil","sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(e,t){"use strict";var a=Object.create(e,{_waitForFlexChanges:{value:function(e,a,i,n){return this._flexRuntimeInfoAPIHandler(t,e,a,i,n)}}});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataType", ["sap/ui/model/odata/type/Boolean","sap/ui/model/odata/type/Byte","sap/ui/model/odata/type/DateTime","sap/ui/model/odata/type/DateTimeOffset","sap/ui/model/odata/type/Decimal","sap/ui/model/odata/type/Double","sap/ui/model/odata/type/Single","sap/ui/model/odata/type/Guid","sap/ui/model/odata/type/Int16","sap/ui/model/odata/type/Int32","sap/ui/model/odata/type/Int64","sap/ui/model/odata/type/SByte","sap/ui/model/odata/type/String","sap/ui/model/odata/type/Time","sap/ui/comp/odata/type/StringDate","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/NumericText"],function(e,t,a,m,d,i,u,n,o,r,l,p,E,s,y,f,D){"use strict";var c={"Edm.Boolean":e,"Edm.Byte":t,"Edm.DateTime":a,"Edm.DateTimeOffset":m,"Edm.Decimal":d,"Edm.Double":i,"Edm.Float":u,"Edm.Guid":n,"Edm.Int16":o,"Edm.Int32":r,"Edm.Int64":l,"Edm.SByte":p,"Edm.Single":u,"Edm.String":E,"Edm.Time":s};var T={"Edm.Boolean":"Bool","Edm.Byte":"Int","Edm.DateTime":"Date","Edm.DateTimeOffset":"DateTimeOffset","Edm.Decimal":"Decimal","Edm.Double":"Float","Edm.Float":"Float","Edm.Guid":"Guid","Edm.Int16":"Int","Edm.Int32":"Int","Edm.Int64":"Int","Edm.SByte":"Int","Edm.Single":"Float","Edm.String":"String","Edm.Time":"TimeOfDay"};var I={"Edm.Byte":true,"Edm.Decimal":true,"Edm.Double":true,"Edm.Float":true,"Edm.Int16":true,"Edm.Int32":true,"Edm.Int64":true,"Edm.SByte":true,"Edm.Single":true};var g={"Edm.DateTime":true,"Edm.DateTimeOffset":true,"Edm.Time":true};var S={getType:function(e,t,a,m){var d=null,i;if(m){if(typeof m==="boolean"||m.isCalendarDate){return new y(t)}if(m.isFiscalDate){return new f(t,a,{anotationType:m.fiscalType})}if(a&&a.isDigitSequence){return new D(t,a)}}i=c[e];if(i){d=new i(t,a)}return d},isNumeric:function(e){return I[e]?true:false},isDateOrTime:function(e){return g[e]?true:false},getDefaultValueTypeName:function(e){return T[e]},getTypeName:function(e){if(e.indexOf("Edm.")===0){return e.substring(4)}return e}};return S},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/SideEffects", [],function(){"use strict";var e=function(){};e.prototype.getSideEffects=function(e,t,r){var i={};if(r){if(e){if(r.entitySet){i.entitySet=this._getForPath(r.entitySet,e)}if(r.entityType){i.entityType=this._getForPath(r.entityType,e)}}if(t&&r.complexType){i.complexType=this._getForPath(r.complexType,t)}}return i};e.prototype._getForPath=function(e,t){var r,i,o={};for(r in e){if(r.indexOf&&r.indexOf("com.sap.vocabularies.Common.v1.SideEffects")===0){i=e[r];if(this._checkSourceProperties(i,t)){o[r]=i}if(this._checkSourceEntities(i,t)){o[r]=i}}}return o};e.prototype._checkSourceProperties=function(e,t){var r,i;if(e.SourceProperties){i=e.SourceProperties.length;for(r=0;r<i;r++){if(e.SourceProperties[r].PropertyPath===t){return true}}}return false};e.prototype._checkSourceEntities=function(e,t){var r,i;if(e.SourceEntities&&e.SourceEntities.Collection){i=e.SourceEntities.Collection.length;for(r=0;r<i;r++){if(e.SourceEntities.Collection[r].NavigationPropertyPath===t){return true}}}else if(e.SourceEntities&&Array.isArray(e.SourceEntities)){i=e.SourceEntities.length;for(r=0;r<i;r++){if(e.SourceEntities[r].NavigationPropertyPath===t){return true}}}return false};e.prototype.destroy=function(){};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/FiscalDate", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/smartfield/type/String","sap/ui/comp/odata/type/NumericText","sap/ui/comp/odata/FiscalFormat","sap/ui/model/ValidateException"],function(a,e,t,o,r,s){"use strict";var i=t.extend("sap.ui.comp.odata.type.FiscalDate",{constructor:function(a,s,c){t.call(this,a,s);if(this.oConstraints&&this.oConstraints.isDigitSequence){o.call(this,a,s)}this.sAnotationType=c.anotationType;this.formatter=r.getDateInstance(Object.assign({format:i.oDateFormats[c.anotationType],calendarType:e.CalendarType.Gregorian},a))}});i.prototype.parseValue=function(a){if(a===""){return null}if(this.oConstraints&&this.oConstraints.isDigitSequence){return this.formatter.parse(o.prototype.parseValue.apply(this,arguments))}return this.formatter.parse(t.prototype.parseValue.apply(this,arguments))};i.prototype.formatValue=function(a){var e;if(this.oConstraints&&this.oConstraints.isDigitSequence){var r=Array.from(arguments),s=true;r.push(s);e=o.prototype.formatValue.apply(this,r)}else{e=t.prototype.formatValue.apply(this,arguments)}if(e===null){return null}return this.formatter.format(e)};i.prototype.validateValue=function(a){try{t.prototype.validateValue.apply(this,arguments)}catch(e){if(!this.formatter.validate(a)){throw new s(this.getErrorMessage(this.sAnotationType))}}if(a===null){return}if(!this.formatter.validate(a)){throw new s(this.getErrorMessage(this.sAnotationType))}};i.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this.formatter){this.formatter.destroy();this.formatter=null}};i.prototype.getErrorMessage=function(e){var t;this.iFullYear=this.iFullYear||(new Date).getFullYear().toString();switch(e){case"com.sap.vocabularies.Common.v1.IsFiscalYear":t=this.iFullYear;break;case"com.sap.vocabularies.Common.v1.IsFiscalPeriod":t="001";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearPeriod":t=this.iFullYear+"001";break;case"com.sap.vocabularies.Common.v1.IsFiscalQuarter":t="1";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearQuarter":t=this.iFullYear+"1";break;case"com.sap.vocabularies.Common.v1.IsFiscalWeek":t="01";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearWeek":t=this.iFullYear+"01";break;case"com.sap.vocabularies.Common.v1.IsDayOfFiscalYear":t="1";break;case"com.sap.vocabularies.Common.v1.IsFiscalYearVariant":break;default:t=this.iFullYear}return a.getLibraryResourceBundle("sap.ui.comp").getText("FISCAL_VALIDATION_FAILS",[this.formatValue(t,"string")])};i.oDateFormats={"com.sap.vocabularies.Common.v1.IsFiscalYear":"YYYY","com.sap.vocabularies.Common.v1.IsFiscalPeriod":"PPP","com.sap.vocabularies.Common.v1.IsFiscalYearPeriod":"YYYYPPP","com.sap.vocabularies.Common.v1.IsFiscalQuarter":"Q","com.sap.vocabularies.Common.v1.IsFiscalYearQuarter":"YYYYQ","com.sap.vocabularies.Common.v1.IsFiscalWeek":"WW","com.sap.vocabularies.Common.v1.IsFiscalYearWeek":"YYYYWW","com.sap.vocabularies.Common.v1.IsDayOfFiscalYear":"d","com.sap.vocabularies.Common.v1.IsFiscalYearVariant":""};i.prototype.getName=function(){return"sap.ui.comp.odata.type.FiscalDate"};i.prototype.getFormatter=function(){return this.formatter};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/NumericText", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/smartfield/type/String"],function(t,e,o){"use strict";var r=o.extend("sap.ui.comp.odata.type.NumericText",{constructor:function(t,e){o.call(this,t,e);this.oCustomRegex=new RegExp("^[0]*$")}});r.prototype.parseValue=function(t,e,r){if(this.oCustomRegex.test(t)&&!r){if(typeof this.oFieldControl==="function"){this.oFieldControl(t,e)}if(this.oFormatOptions&&this.oFormatOptions.parseKeepsEmptyString){return""}return null}return o.prototype.parseValue.apply(this,arguments)};r.prototype.formatValue=function(t,e,r){if(this.oCustomRegex.test(t)){if(r){return"0"}return null}return o.prototype.formatValue.apply(this,arguments)};r.prototype.getName=function(){return"sap.ui.comp.odata.type.NumericText"};r.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments)};return r});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/StringDate", ["sap/ui/core/library","sap/ui/model/SimpleType","sap/ui/core/format/DateFormat","sap/ui/model/ValidateException"],function(t,e,a,r){"use strict";var i=e.extend("sap.ui.comp.odata.type.StringDate",{constructor:function(r){e.apply(this,[r]);this.sName="sap.ui.comp.odata.type.StringDate";r=Object.assign({},r,{UTC:false});this.displayFormatter=a.getDateInstance(r);this.parseFormatter=a.getDateInstance({UTC:false,pattern:"yyyyMMdd",calendarType:t.CalendarType.Gregorian,strictParsing:true})}});i.prototype.parseValue=function(t,e){if(t===""){t=null}if(t!=null&&t!=""){var a=e==="string"?this.parseFormatter.parse(t,true):t;t=this.parseFormatter.format(a)}return t};i.prototype.formatValue=function(t,e){if(t===null||t===undefined||t==""){return null}if(!(t instanceof Date)){t=this.parseFormatter.parse(t)}if(e==="string"){return this.displayFormatter.format(t)}return t};i.prototype.validateValue=function(t){if(t!=null){var e=this.parseFormatter.parse(t);if(!e){throw new r(t+" is not a valid date")}}};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanel", ["sap/m/P13nConditionPanel","sap/m/library","sap/ui/core/library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/ui/core/ListItem","sap/ui/model/odata/type/Boolean","sap/ui/model/type/String","sap/ui/model/odata/type/String","sap/ui/model/type/Date","sap/ui/model/type/Time","sap/ui/model/odata/type/DateTime","sap/ui/model/type/Float","sap/ui/layout/Grid","sap/ui/layout/GridData","sap/m/Button","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/Text","sap/m/SearchField","sap/m/CheckBox","sap/m/ComboBox","sap/m/Select","sap/m/Label","sap/m/Input","sap/m/DatePicker","sap/m/TimePicker","sap/m/DateTimePicker","sap/base/Log","sap/ui/thirdparty/jquery","sap/ui/comp/odata/type/StringDate","sap/ui/comp/p13n/P13nOperationsHelper","sap/m/P13nConditionPanelRenderer","sap/ui/model/json/JSONModel","sap/ui/model/Sorter"],function(e,t,i,a,n,o,s,r,l,d,p,u,g,c,h,y,f,m,_,S,v,C,I,T,F,b,x,L,O,V,D,k,E,P,M,jQuery,K,w,N,A,B){"use strict";var G=t.ButtonType,R=t.P13nConditionOperation,H=t.P13nConditionOperationType,U=i.ValueState,z=[R.BT,R.EQ,R.LE,R.LT,R.GE,R.GT,R.NotBT,R.NotEQ,R.NotLE,R.NotLT,R.NotGE,R.NotGT],j=i.InvisibleMessageMode;var X=e.extend("sap.ui.comp.p13n.P13nConditionPanel",{metadata:{library:"sap.ui.comp.p13n",properties:{defaultOperation:{type:"string",group:"Misc",defaultValue:null}}},renderer:N.renderer});X.prototype.init=function(){this._oRbComp=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");e.prototype.init.apply(this);this._oOperationsHelper=new w};X.prototype.onBeforeRendering=function(){if(!this._oInvisibleMessage){this._oInvisibleMessage=r.getInstance()}};X.prototype.setOperations=function(e,t,i){var a=i?H.Exclude:H.Include;t=t||"default";if(this._oTypeOperations[t]===undefined){this._oTypeOperations[t]={}}this._oTypeOperations[t][a]=e;this._updateAllOperations()};X._createKeyFieldTypeInstance=function(e){var t;if(!e.typeInstance){switch(e.type){case"boolean":e.typeInstance=new u;break;case"numc":if(!(e.formatSettings&&e.formatSettings.isDigitSequence)){M.error("sap.m.P13nConditionPanel","NUMC type support requires isDigitSequence==true!");e.formatSettings=Object.assign({},e.formatSettings,{isDigitSequence:true})}t=e.formatSettings;if(e.maxLength){t=Object.assign({},t,{maxLength:e.maxLength})}if(!t.maxLength){M.error("sap.m.P13nConditionPanel","NUMC type suppport requires maxLength!")}e.typeInstance=new c({},t);break;case"date":e.typeInstance=new h(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"time":e.typeInstance=new y(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"datetime":e.typeInstance=new f(Object.assign({},e.formatSettings,{strictParsing:true}),{displayFormat:"Date"});var i=e.typeInstance;if(!i.oFormat){i.formatValue(new Date,"string")}if(i.oFormat){i.oFormat.oFormatOptions.UTC=false}break;case"stringdate":e.typeInstance=new K(Object.assign({},e.formatSettings,{strictParsing:true}));break;case"numeric":if(e.precision||e.scale){t={};if(e.precision){t["maxIntegerDigits"]=parseInt(e.precision)}if(e.scale){t["maxFractionDigits"]=parseInt(e.scale)}}e.typeInstance=new m(t);break;default:var a=e.formatSettings;if(e.maxLength){a=Object.assign({},a,{maxLength:e.maxLength})}e.typeInstance=new g({},a);break}}};X.prototype.setKeyFields=function(e){this._aKeyFields=e;this._aKeyFields.forEach(function(e){X._createKeyFieldTypeInstance(e)},this);this._updateKeyFieldItems(this._oConditionsGrid,true);this._updateAllConditionsEnableStates();this._createAndUpdateAllKeyFields();this._updateAllOperations();this._updateConditionFields()};X.prototype.setValues=function(e,t){t=t||"default";this._oTypeValues[t]=e};X.prototype.addOperation=function(e,t,i){var a=i?H.Exclude:H.Include;t=t||"default";if(this._oTypeOperations[t]===undefined){this._oTypeOperations[t]={}}if(this._oTypeOperations[t][a]===undefined){this._oTypeOperations[t][a]=[]}this._oTypeOperations[t][a].push(e);this._updateAllOperations()};X.prototype.getOperations=function(e,t){var i,a,n,o;e=e||"default";if(t!==undefined){i=t?H.Exclude:H.Include;o=this._oTypeOperations[e]&&this._oTypeOperations[e][i]||[]}else{a=this._oTypeOperations[e]&&this._oTypeOperations[e][H.Include]||[];n=this._oTypeOperations[e]&&this._oTypeOperations[e][H.Exclude]||[];o=a.concat(n)}return o};X.prototype._updatePaginatorToolbar=function(){if(this._sConditionType!=="Filter"||this.getMaxConditions()!=="-1"){return}var e=this._aConditionKeys.length;var t=1+Math.floor(Math.max(0,e-1)/this._iConditionPageSize);var i=1+Math.floor(this._iFirstConditionIndex/this._iConditionPageSize);var a=this.getParent();if(!this._oPaginatorToolbar){if(e>this._iConditionPageSize){this._createPaginatorToolbar();this.insertAggregation("content",this._oPaginatorToolbar,0);this._onGridResize()}else{if(a&&a.getMetadata().getName()==="sap.m.Panel"){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=a.getHeaderText()}}return}}this._oPrevButton.setEnabled(this._iFirstConditionIndex>0);this._oNextButton.setEnabled(this._iFirstConditionIndex+this._iConditionPageSize<e);if(a&&a.setHeaderToolbar){if(!a.getHeaderToolbar()){this.removeAggregation("content",this._oPaginatorToolbar);a.setHeaderToolbar(this._oPaginatorToolbar);a.attachExpand(function(e){this._setToolbarElementVisibility(e.getSource().getExpanded()&&this._bPaginatorButtonsVisible)}.bind(this))}}if(a&&a.getMetadata().getName()==="sap.m.Panel"){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=a.getHeaderText()}var n=this._sOrgHeaderText+(e>0?" ("+e+")":"");this._oHeaderText.setText(n)}else{this._oHeaderText.setText(e+" Conditions")}this._oPageText.setText(i+"/"+t);this._bPaginatorButtonsVisible=this._bPaginatorButtonsVisible||t>1;this._setToolbarElementVisibility(this._bPaginatorButtonsVisible);if(i>t){this._iFirstConditionIndex-=Math.max(0,this._iConditionPageSize);this._clearConditions();this._fillConditions()}var o=0;this._oConditionsGrid.getContent().forEach(function(e){if(e.select.getSelected()){o++}},this);if(t==i&&e-this._iFirstConditionIndex>o){this._clearConditions();this._fillConditions()}};X.prototype._setToolbarElementVisibility=function(e){this._oPrevButton.setVisible(e);this._oNextButton.setVisible(e);this._oPageText.setVisible(e);this._oFilterField.setVisible(false);this._setLayoutVisible(this._oAddButton,e);this._setLayoutVisible(this._oRemoveAllButton,e)};X.prototype._unregisterResizeHandler=function(){if(this._sContainerResizeListener){l.deregister(this._sContainerResizeListener);this._sContainerResizeListener=null}};X.prototype._registerResizeHandler=function(){if(this.getContainerQuery()){this._sContainerResizeListener=l.register(this._oConditionsGrid,this._onGridResize.bind(this));this._onGridResize()}};X.prototype._handleRemoveCondition=function(e,t){var i=e.getContent().indexOf(t);this._removeCondition(e,t);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(i>=0){i=Math.min(i,e.getContent().length-1);var t=e.getContent()[i];setTimeout(function(){t.remove.focus()})}this._updatePaginatorToolbar();this._oInvisibleMessage.announce(this._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_CONDITION_REMOVED"),j.Polite)};X.prototype._getCurrentKeyFieldItem=function(e){if(e.getSelectedKey&&e.getSelectedKey()){var t=e.getSelectedKey();var i=this._aKeyFields;for(var a in i){var n=i[a];if(n.key===t){return n}}}return null};X.prototype._createConditionRow=function(e,t,i,a,n){var o,s=this,r=new A;if(a===undefined){a=e.getContent().length}var l=new _({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:1,vSpacing:0,containerQuery:this.getContainerQuery()}).data("_key",i);for(var d in this._aConditionsFields){var p;var u=this._aConditionsFields[d];switch(u["Control"]){case"CheckBox":p=new x({enabled:false,layoutData:new S({span:u["Span"+this._sConditionType]})});this._setLayoutVisible(p,false);if(u["ID"]==="showIfGrouped"){p.setEnabled(true);p.setText(u["Label"]);p.attachSelect(function(){s._changeField(l)});p.setSelected(t?t.showIfGrouped:true)}else{if(t){p.setSelected(true);p.setEnabled(true)}}break;case"ComboBox":if(u["ID"]==="keyField"){p=new L({width:"100%",ariaLabelledBy:this._oInvisibleTextField});var g=p.setSelectedKey.bind(p);p.setSelectedKey=function(e){g(e);var t=s.getValidationExecutor();if(t){t()}};var c=p.setSelectedItem.bind(p);p.setSelectedItem=function(e){c(e);var t=s.getValidationExecutor();if(t){t()}};p.setLayoutData(new S({span:u["Span"+this._sConditionType]}));this._fillKeyFieldListItems(p,this._aKeyFields);if(p.attachSelectionChange){p.attachSelectionChange(function(t){var i=s.getValidationExecutor();if(i){i()}s._handleSelectionChangeOnKeyField(e,l)})}if(p.attachChange){p.attachChange(function(t){l.keyField.close();s._handleChangeOnKeyField(e,l)})}if(p.setSelectedItem){if(t){p.setSelectedKey(t.keyField);this._aKeyFields.forEach(function(e,i){var a=e.key;if(a===undefined){a=e}if(t.keyField===a){p.setSelectedItem(p.getItems()[i])}},this)}else{if(this.getUsePrevConditionSetting()&&!this.getAutoReduceKeyFieldItems()){if(a>0&&!i&&n){o=e.getContent()[a-1];if(o.keyField.getSelectedKey()){p.setSelectedKey(o.keyField.getSelectedKey())}else{if(!p.getSelectedItem()&&p.getItems().length>0){p.setSelectedItem(p.getItems()[0])}}}else{this._aKeyFields.some(function(e,t){if(e.isDefault){p.setSelectedItem(p.getItems()[t]);return true}if(!p.getSelectedItem()&&e.type!=="boolean"){p.setSelectedItem(p.getItems()[t])}},this);if(!p.getSelectedItem()&&p.getItems().length>0){p.setSelectedItem(p.getItems()[0])}}}else{this._aKeyFields.forEach(function(e,t){if(e.isDefault){p.setSelectedItem(p.getItems()[t])}},this)}}}}if(u["ID"]==="operation"){p=new L({width:"100%",ariaLabelledBy:this._oInvisibleTextOperator,layoutData:new S({span:u["Span"+this._sConditionType]})});p.addEventDelegate({onmouseup:function(){if(!this.isOpen()){this.showItems()}}},p);p.setFilterFunction(function(){return true});p.setModel(r);p.attachChange(function(t){s._validateOperationValue(t);s._handleChangeOnOperationField(e,l)});l[u["ID"]]=p;this._updateOperationItems(e,l);var h=this._getCurrentKeyFieldItem(l.keyField),y=this._getRelevantOperations(h);if(t){var f=this.getCurrentOparation(t);y.some(function(e){if(f===e){p.setSelectedKey(e);return true}},this)}else{if(this.getUsePrevConditionSetting()){if(a>0&&i===null){var o=e.getContent()[a-1],m=o.operation.getSelectedKey()||y[0];p.setSelectedKey(m)}else{if(this.getDefaultOperation()){p.setSelectedKey(this.getDefaultOperation())}else{p.setSelectedKey(y[0])}}}}}if(p.getSelectedItem&&p.getSelectedItem()&&p.getMetadata()._sUIDToken!=="box"){p.setTooltip(p.getSelectedItem().getTooltip())}break;case"TextField":var v=this._getCurrentKeyFieldItem(l.keyField);p=this._createValueField(v,u,l);p.oTargetGrid=e;if(p.addAriaDescribedBy){p.addAriaDescribedBy(this._oInvisibleTextOperatorInputValue)}if(t&&t[u["ID"]]!==undefined){var C=t[u["ID"]];if(p instanceof O){if(typeof C==="boolean"){p.setSelectedIndex(C?2:1)}}else if(C!==null&&l.oType){if(typeof C==="string"&&l.oType.getName()==="sap.ui.comp.odata.type.StringDate"){p.setValue(C)}else{var I=l&&l.operation&&z.indexOf(l.operation.getSelectedKey())!==-1;if(typeof C==="string"&&["String","sap.ui.model.odata.type.String","sap.ui.model.odata.type.Decimal"].indexOf(l.oType.getName())==-1){try{C=l.oType.parseValue(C,"string",I);p.setValue(l.oType.formatValue(C,"string",I))}catch(e){M.error("sap.m.P13nConditionPanel","Value '"+C+"' does not have the expected type format for "+l.oType.getName()+".parseValue()")}}else{p.setValue(l.oType.formatValue(C,"string",I));if(p.isA("sap.m.ComboBox")){if(C===""){p.getModel().attachEventOnce("batchRequestCompleted",function(e){e.setSelectedItem(e.getItems()[0])}.bind(null,p))}else{p.setSelectedKey(C)}}}}}else{p.setValue(C)}}break;case"Label":p=new V({text:u["Text"]+":",visible:this.getShowLabel(),layoutData:new S({span:u["Span"+this._sConditionType]})}).addStyleClass("conditionLabel");p.oTargetGrid=e;break}l[u["ID"]]=p;l.addContent(p)}this._addButtons(l,e);e.insertContent(l,a);this._updateOperationItems(e,l);this._changeOperationValueFields(e,l);this._updateAllConditionsEnableStates();this._updateConditionButtons(e);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(this._sLayoutMode){this._updateLayout({name:this._sLayoutMode})}if(t){var T=this._getFormatedConditionText(t.operation,t.value1,t.value2,t.exclude,t.keyField,t.showIfGrouped);t._oGrid=l;t.value=T;this._oConditionsMap[i]=t}var F=l.operation.getSelectedKey();if(F==="BT"&&l.value1.setMinDate&&l.value2.setMaxDate){var b=l.value1.getDateValue();var D=l.value2.getDateValue();this._updateMinMaxDate(l,b,D)}else{this._updateMinMaxDate(l,null,null)}return l};X.prototype._fillOperationListItems=function(e,t,i){var a={items:[]};if(i==="_STRING_"||i==="_TEXT_"){i=""}if(i==="_TIME_"||i==="_DATETIME_"){i="_DATE_"}if(i==="_BOOLEAN_"||i==="_NUMC_"){i=""}e.destroyItems();if(t&&t.length>0){t.forEach(function(e){var t=this._oRb.getText("CONDITIONPANEL_OPTION"+i+e,null,true);if(t===undefined||t.startsWith("CONDITIONPANEL_OPTION")){t=this._oRb.getText("CONDITIONPANEL_OPTION"+e)}a.items.push({key:e,text:t,sorter:this._oOperationsHelper.isExcludeType(e)?this._oRbComp.getText("VALUEHELPDLG_EXCLUDE"):this._oRbComp.getText("VALUEHELPDLG_INCLUDE"),tooltip:t})}.bind(this));e.getModel().setData(a);e.bindAggregation("items",{path:"/items",sorter:new B("sorter",true,true),template:new p({key:"{key}",text:"{text}"})})}};X.prototype._validateOperationValue=function(e){var t=e.getSource(),i=t.getSelectedKey(),a=t.getValue();if(!i&&a){t.setValueState(U.Error);t.setValueStateText(this._oRbComp.getText("VALUEHELPDLG_VALUE_NOT_EXIST",a))}else{t.setValueState(U.None)}};X.prototype._fillKeyFieldListItems=function(e,t){e.destroyItems();for(var i in t){var a=t[i];e.addItem(new p({key:a.key,text:a.text,tooltip:a.tooltip}))}this._setLayoutVisible(e,e.getItems().length>1)};X.prototype._updateOperationItems=function(e,t){var i=this._getCurrentKeyFieldItem(t.keyField);var a=i&&i.type||"";var n=t.operation;var o=n.getSelectedItem();var s=this._getRelevantOperations(i);this._fillOperationListItems(n,s,a?"_"+a.toUpperCase()+"_":"");if(o&&n.getItemByKey(o.getKey())){n.setSelectedKey(o.getKey())}else{n.setSelectedItem(n.getItems()[1])}this._sConditionType="Filter";if(s[0]===R.Ascending||s[0]===R.Descending){this._sConditionType="Sort"}if(s[0]===R.GroupAscending||s[0]===R.GroupDescending){this._sConditionType="Group"}this._adjustValue1Span(t)};X.prototype._updateKeyFieldItems=function(e,t,i,a){var n=e.getContent().length;var o;var s={};if(!t){for(o=0;o<n;o++){var r=e.getContent()[o].keyField;var l=r.getSelectedKey();if(l!=null&&l!==""){s[l]=true}}}for(o=0;o<n;o++){var r=e.getContent()[o].keyField;var d=e.getContent()[o].select;var u=r.getSelectedKey();var g=0;var c=this._aKeyFields;if(r!==a){if(i){g=c.length-1}else{r.destroyItems()}for(g;g<c.length;g++){var h=c[g];if(h.key==null||h.key===""||!s[h.key]||h.key===u){r.addItem(new p({key:h.key,text:h.text,tooltip:h.tooltip}))}}this._setLayoutVisible(r,r.getItems().length>1)}if(u){r.setSelectedKey(u)}else if(r.getItems().length>0){r.setSelectedItem(r.getItems()[0])}if(!d.getSelected()){this._aKeyFields.some(function(e,t){if(e.isDefault){r.setSelectedItem(r.getItems()[t]);return true}if(!r.getSelectedItem()){if(e.type!=="boolean"){r.setSelectedItem(r.getItems()[t])}}},this)}if(r.getSelectedItem()){r.setTooltip(r.getSelectedItem().getTooltip())}}};X.prototype._adjustValue1Span=function(e){if(this._sConditionType==="Filter"&&e.value1&&e.operation){var t=e.operation;var i=this._aConditionsFields[5]["Span"+this._sConditionType];var a=t.getSelectedKey();if(a!==R.BT&&a!==R.NotBT){i=this._aKeyFields.length>1?"L5 M11 S10":"XL8 L8 M8 S10"}var n=e.value1.getLayoutData();if(n.getSpan()!==i){n.setSpan(i)}}};X.prototype._changeField=function(e,t){var i=e.keyField.getSelectedKey();if(e.keyField.getSelectedItem()){e.keyField.setTooltip(e.keyField.getSelectedItem().getTooltip())}else{e.keyField.setTooltip(null)}var a=e.operation.getSelectedKey();var n=this._oOperationsHelper.isExcludeType(a);a=n?this._oOperationsHelper.getCorrespondingIncludeOperation(a):a;if(e.operation.getSelectedItem()){e.operation.setTooltip(e.operation.getSelectedItem().getTooltip())}else{e.operation.setTooltip(null)}var o=function(e,t,i){var a,n,o=e.getParent();if(e.getDateValue&&!e.isA("sap.m.TimePicker")&&t.getName()!=="sap.ui.comp.odata.type.StringDate"){n=e.getDateValue();if(t&&n){if(i&&i.getParameter("valid")||e.isValidValue()){a=t.formatValue(n,"string")}else{a=""}}}else{a=this._getValueTextFromField(e);n=a;if(t&&t.getName()==="sap.ui.comp.odata.type.StringDate"){a=t.formatValue(n,"string")}else if(t&&a){try{var s=o&&o.operation&&z.indexOf(o.operation.getSelectedKey())!==-1;n=t.parseValue(a,"string",s);var r=this._getCurrentKeyFieldItem(o.keyField);if(r&&r.type==="numc"&&!s&&n===null){a=t.formatValue(n,"string",s);e.setValue(a)}t.validateValue(n);if(e.isA("sap.m.ComboBox")&&!e.getSelectedKey()||i&&e.getId()==i.getSource().getId()&&o.operation.getSelectedKey()===R.BT&&(this._isInvalidFiscalRange(o)||this._isFieldNumeric(o)&&this._isInvalidRange(o))){a=""}}catch(e){M.error("sap.m.P13nConditionPanel","not able to parse value "+a+" with type "+t.getName());a=""}}}return[n,a]}.bind(this);var s=o(e.value1,e.oType,t);var r=s[0],l=s[1];s=o(e.value2,e.oType,t);var d=s[0],p=s[1];if(this._hasSecondValue(a)){this._updateMinMaxDate(e,r,d)}else{this._updateMinMaxDate(e,null,null)}var u=this._getCurrentKeyFieldItem(e.keyField);if(u&&u.type==="numc"){if([R.Contains,R.EndsWith].indexOf(a)!=-1){r=e.oType.formatValue(r,"string")}}var g=e.showIfGrouped.getSelected();var c=e.select;var h="";var y;if(i===""||i==null){i=null;y=this._getKeyFromConditionGrid(e);this._removeConditionFromMap(y);this._enableCondition(e,false);var f=this._getIndexOfCondition(e);if(c.getSelected()){c.setSelected(false);c.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:y,index:f,operation:"remove",newData:null});this._bIgnoreSetConditions=false}return}this._enableCondition(e,true);h=this._getFormatedConditionText(a,l,p,n,i,g);var m={value:h,exclude:n,operation:a,keyField:i,value1:r,value2:this._hasSecondValue(a)?d:null,showIfGrouped:g};y=this._getKeyFromConditionGrid(e);if(h!==""||e.value1.isA("sap.m.ComboBox")){c.setSelected(true);c.setEnabled(true);var _="update";if(!this._oConditionsMap[y]){_="add"}this._oConditionsMap[y]=m;if(_==="add"){this._aConditionKeys.splice(this._getIndexOfCondition(e),0,y)}e.data("_key",y);this.fireDataChange({key:y,index:this._getIndexOfCondition(e),operation:_,newData:m})}else if(this._oConditionsMap[y]!==undefined){this._removeConditionFromMap(y);e.data("_key",null);var f=this._getIndexOfCondition(e);if(c.getSelected()){c.setSelected(false);c.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:y,index:f,operation:"remove",newData:null});this._bIgnoreSetConditions=false}}this._updatePaginatorToolbar()};X.prototype._getConditions=function(e){return{index:this._iConditions,key:this._createConditionKey(),exclude:this._oOperationsHelper.isExcludeType(e.oOperation),operation:e.oOperation,keyField:e.oKeyField,value1:e.oPastedValue,value2:null}};X.prototype._isFieldNumeric=function(e){var t=this._getCurrentKeyFieldItem(e.keyField),i=t.type;return!!(i==="numc"||i==="numeric")};X.prototype._isFiscalField=function(e){var t=this._getCurrentKeyFieldItem(e.keyField);return t.typeInstance&&t.typeInstance.isA("sap.ui.comp.odata.type.FiscalDate")};X.prototype._isInvalidRange=function(e){var t=e.value1.getValue(),i=e.value2.getValue();return!!(t&&i&&Number(e.oType.parseValue(t,"string"))>Number(e.oType.parseValue(i,"string")))};X.prototype._isInvalidFiscalRange=function(e){var t,i,a,n,o=e.value1.getValue(),s=e.value2.getValue(),r=this._getCurrentKeyFieldItem(e.keyField),l=r.typeInstance&&r.typeInstance.sAnotationType;if(!this._isFiscalField(e)||!o||!s){return false}if(l==="com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"||l==="com.sap.vocabularies.Common.v1.IsFiscalYearQuarter"||l==="com.sap.vocabularies.Common.v1.IsFiscalYearWeek"){if(o.indexOf("/")!==-1&&s.indexOf("/")!==-1){t=o.split("/")[0];a=s.split("/")[0];i=o.split("/")[1];n=s.split("/")[1];return i===n?t>a:i>n}}else{return parseFloat(o)>parseFloat(s)}};X.prototype._validateAndFormatFieldValue=function(e){var t=e.oSource;var i=t.getParent();var a;var n=this._oRbComp.getText("VALUEHELPVALDLG_FIELD_RANGE_MESSAGE"),o=i&&i.operation&&z.indexOf(i.operation.getSelectedKey())!==-1;if(t.getDateValue&&e){a=e.getParameter("value");var s=e.getParameter("valid");this._makeFieldValid(t,s);return}else{a=t.getValue&&t.getValue()}if(!i){return}if(this.getDisplayFormat()==="UpperCase"&&a){a=a.toUpperCase();t.setValue(a)}if(i.oType&&a){try{var r=i.oType.parseValue(a,"string",o);i.oType.validateValue(r);this._makeFieldValid(t,true);a=i.oType.formatValue(r,"string",o);t.setValue(a);if(i.operation.getSelectedKey()===R.BT){if(this._isFieldNumeric(i)&&this._isInvalidRange(i,e)||this._isInvalidFiscalRange(i,e)){this._makeFieldValid(t,false,n)}else{this._makeFieldValid(i.value1,true);this._makeFieldValid(i.value2,true)}}}catch(e){var l=e.message;this._makeFieldValid(t,false,l)}}else{this._makeFieldValid(t,true)}};X.prototype._changeOperationValueFields=function(t,i){e.prototype._changeOperationValueFields.apply(this,arguments);var a=i.getContent().length,n=i.remove,o=i.indexOfContent(n),s=a-1;if(o!==s){i.insertContent(n,s)}};X.prototype._updateLayout=function(e){};X.prototype._updateConditionFields=function(){this._aConditionsFields=this._createConditionsFields()};X.prototype._addButtons=function(e,t){var i=this;var a=new v({type:G.Transparent,icon:n.getIconURI("decline"),tooltip:this._oRb.getText("CONDITIONPANEL_REMOVE"+(this._sAddRemoveIconTooltipKey?"_"+this._sAddRemoveIconTooltipKey:"")+"_TOOLTIP"),press:function(){i._handleRemoveCondition(this.oTargetGrid,e)},layoutData:new S({span:"XL1 L1 M1 S1"})});a.oTargetGrid=t;e.addContent(a);e["remove"]=a;var o=new v({text:this._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_ADD"),press:function(){i._handleAddCondition(this.oTargetGrid,e,true)},layoutData:new S({span:"XL2 L3 M3 S3",indent:"XL9 L8 M8 S7",linebreak:true}),ariaDescribedBy:i._oInvisibleTextOperatorAddButton});o.oTargetGrid=t;o.addStyleClass("conditionAddBtnFloatRight");o.addStyleClass("conditionAddBtnMarginTop");e.addContent(o);e["add"]=o};X.prototype.getCurrentOparation=function(e){return e.exclude?this._oOperationsHelper.getCorrespondingExcludeOperation(e.operation):e.operation};X.prototype._hasSecondValue=function(t){return e.prototype._hasSecondValue.apply(this,arguments)||t===R.NotBT};X.prototype._hasNoValues=function(t){return e.prototype._hasNoValues.apply(this,arguments)||t===R.NotEmpty};X.prototype._createConditionsFields=function(){return[{ID:"select",Label:"",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"CheckBox",Value:""},{ID:"keyFieldLabel",Text:"Sort By",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"keyField",Label:"",SpanFilter:"L3 M5 S10",SpanSort:"L5 M5 S12",SpanGroup:"L4 M4 S12",Control:"ComboBox"},{ID:"operationLabel",Text:"Sort Order",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"operation",Label:"",SpanFilter:this._aKeyFields.length>1?"L3 M6 S10":"XL3 L3 M3 S10",SpanSort:o.system.phone?"L5 M5 S8":"L5 M5 S9",SpanGroup:"L2 M5 S10",Control:"ComboBox"},{ID:"value1",Label:this._sFromLabelText,SpanFilter:this._aKeyFields.length>1?"L3 M10 S10":"XL4 L4 M4 S10",SpanSort:"L3 M10 S10",SpanGroup:"L3 M10 S10",Control:"TextField",Value:""},{ID:"value2",Label:this._sToLabelText,SpanFilter:this._aKeyFields.length>1?"L2 M10 S10":"XL4 L4 M4 S10",SpanSort:"L2 M10 S10",SpanGroup:"L2 M10 S10",Control:"TextField",Value:""},{ID:"showIfGrouped",Label:this._sShowIfGroupedLabelText,SpanFilter:"L1 M10 S10",SpanSort:"L1 M10 S10",SpanGroup:"L3 M4 S9",Control:"CheckBox",Value:"false"}]};X.prototype._getSecondValueNegativeIndex=function(){return 2};X.prototype._getConditionsGridAtPosition=function(e){var t=this._oConditionsGrid.getContent();if(e>=t.length){return null}return t[e]};X.prototype._getConditionsCount=function(){var e=this._oConditionsGrid.getContent();return e.length};X.prototype.fireDataChange=function(e){var t,i=e.newData;if(i){t=i.operation;i.operation=this._oOperationsHelper.isExcludeType(t)?this._oOperationsHelper.getCorrespondingIncludeOperation(t):t}return a.prototype.fireEvent.call(this,"dataChange",e)};X.prototype._makeFieldValid=function(e,t,i,a){if(a){var n=e.getSelectedItem();if(!n){e.setValueState(U.Error)}else{e.setValueState(U.None)}}else if(t){e.setValueState(U.None);e.setValueStateText("")}else{e.setValueState(U.Warning);e.setValueStateText(i?i:this._sValidationDialogFieldMessage)}};X.prototype._getRelevantOperations=function(e){var t,i=e&&e.typeInstance,a=i&&e.typeInstance.oConstraints&&e.typeInstance.oConstraints.isDigitSequence,n=i&&(e.typeInstance.sAnotationType==="com.sap.vocabularies.Common.v1.IsFiscalPeriod"||e.typeInstance.sAnotationType==="com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"),o=a&&n?"numcFiscal":e&&e.type,s=e&&e.type&&this.getOperations(o);if(e&&e.operations){t=e.operations}else if(Array.isArray(s)&&s.length>0){t=s}else{t=this.getOperations("default")}return t};X.prototype._handleComboBoxChangeEvent=function(e,t){var i=t.getSource();this._makeFieldValid(i,true,undefined,true);if(i.getValueState()===U.None){this._changeField(e)}};X.prototype._createValueField=function(e,t,i){var a,n,o=this,s={value:t["Value"],width:"100%",placeholder:t["Label"],change:function(e){o._validateAndFormatFieldValue(e);o._changeField(i,e)},layoutData:new S({span:t["Span"+this._sConditionType]})};if(e&&e.typeInstance){var r=e.typeInstance;n=this._findConfig(r,"ctrl");if(n==="DateTimePicker"&&r.getMetadata().getName()==="sap.ui.model.odata.type.DateTime"){if(!(r.oConstraints&&r.oConstraints.isDateOnly)){M.error("sap.m.P13nConditionPanel","sap.ui.model.odata.type.DateTime without displayFormat = Date is not supported!");r.oConstraints=Object.assign({},r.oConstraints,{isDateOnly:true})}n="DatePicker"}i.oType=r;if(n=="select"){var l=[];var p=e.values||this._oTypeValues[n]||["",r.formatValue(false,"string"),r.formatValue(true,"string")];p.forEach(function(e,t){l.push(new d({key:t.toString(),text:e.toString()}))});s={width:"100%",items:l,change:function(){o._changeField(i);o._makeFieldValid(a,true)},layoutData:new S({span:t["Span"+this._sConditionType]})};a=new O(s)}else if(n=="TimePicker"){if(r.oFormatOptions&&r.oFormatOptions.style){s.displayFormat=r.oFormatOptions.style}a=new E(s)}else if(n=="DateTimePicker"){if(r.oFormatOptions&&r.oFormatOptions.style){s.displayFormat=r.oFormatOptions.style}a=new P(s)}else if(n==="DatePicker"){if(r.oFormatOptions){s.displayFormat=r.oFormatOptions.style||r.oFormatOptions.pattern;if(r.isA("sap.ui.comp.odata.type.StringDate")){s.valueFormat="yyyyMMdd"}}a=new k(s)}else{var u=this.data("dropdownFields");a=new D(s);if(u){for(var g=0;g<u.length;g++){if(u[g].name===e.key){s={width:"100%",items:[],change:this._handleComboBoxChangeEvent.bind(this,i),layoutData:new S({span:t["Span"+this._sConditionType]})};a=new L(s);break}}}if(this._fSuggestCallback){e=this._getCurrentKeyFieldItem(i.keyField);if(e&&e.key){var c=this._fSuggestCallback(a,e.key);if(c){a._oSuggestProvider=c}}}}}else{i.oType=null;a=new D(s)}if(n!=="boolean"&&n!=="enum"&&a){a.onpaste=function(e){var t;if(window.clipboardData){t=window.clipboardData.getData("Text")}else{t=e.originalEvent.clipboardData.getData("text/plain")}var i=e.srcControl.getParent();var a=t.split(/\r\n|\r|\n/g);if(a&&a[a.length-1].trim()===""){a.pop()}var n=i.operation;var s=n.getSelectedKey();if(a&&a.length>1&&s!=="BT"){setTimeout(function(){var e=a?a.length:0;var t=o._getCurrentKeyFieldItem(i.keyField);var n=i.operation;for(var s=0;s<e;s++){if(o._aConditionKeys.length>=o._getMaxConditionsAsNumber()){break}var r=a[s].trim();if(r){var l;if(t.typeInstance){try{l=t.typeInstance.parseValue(r,"string");t.typeInstance.validateValue(l)}catch(e){M.error("sap.m.P13nConditionPanel.onPaste","not able to parse value "+r+" with type "+t.typeInstance.getName());r="";l=null}if(!l){continue}}var d={index:o._iConditions,key:o._createConditionKey(),exclude:o.getExclude()||o._oOperationsHelper.isExcludeType(n.getSelectedKey()),operation:n.getSelectedKey(),keyField:t.key,value1:l,value2:null};o._addCondition2Map(d);o.fireDataChange({key:d.key,index:d.index,operation:"add",newData:d})}}o._clearConditions();o._fillConditions()},0)}}}if(e&&e.maxLength&&a.setMaxLength){var h=-1;if(typeof e.maxLength==="string"){h=parseInt(e.maxLength)}if(typeof e.maxLength==="number"){h=e.maxLength}if(h>0&&(!a.getShowSuggestion||!a.getShowSuggestion())){a.setMaxLength(h)}}return a};X.prototype._enableCondition=function(e,t){var i=this._getCurrentKeyFieldItem(e.keyField);i&&i.type==="boolean"?e.operation.setEnabled(false):e.operation.setEnabled(t);e.value1.setEnabled(t);e.value2.setEnabled(t);e.showIfGrouped.setEnabled(t)};X.prototype._getValueTextFromField=function(e){if(e instanceof O){return e.getSelectedItem()?e.getSelectedItem().getText():""}if(e.isA("sap.m.ComboBox")){return e.getSelectedItem()?e.getSelectedItem().getKey():""}return e.getValue()};return X});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nFilterPanel", ["sap/m/P13nFilterPanel","sap/ui/comp/p13n/P13nConditionPanel","sap/m/Panel","sap/m/library","sap/m/P13nFilterItem","sap/ui/comp/p13n/P13nOperationsHelper","sap/m/P13nFilterPanelRenderer"],function(e,t,i,n,o,a,s){"use strict";var r=n.P13nPanelType,l=n.P13nConditionOperation;var p=e.extend("sap.ui.comp.p13n.P13nFilterPanel",{metadata:{library:"sap.ui.comp.p13n",properties:{maxIncludes:{type:"string",group:"Misc",defaultValue:"-1"},maxExcludes:{type:"string",group:"Misc",defaultValue:"-1"},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},defaultOperation:{type:"string",group:"Misc",defaultValue:null}}},renderer:s.renderer});p.prototype.setConditions=function(e){this._oConditionPanel.setConditions(e);return this};p.prototype.getConditions=function(){return this._oConditionPanel.getConditions()};p.prototype.setContainerQuery=function(e){this.setProperty("containerQuery",e);this._oConditionPanel.setContainerQuery(e);return this};p.prototype.setLayoutMode=function(e){this.setProperty("layoutMode",e);this._oConditionPanel.setLayoutMode(e);return this};p.prototype.validateConditions=function(){return this._oConditionPanel.validateConditions()};p.prototype.removeInvalidConditions=function(){this._oConditionPanel.removeInvalidConditions()};p.prototype.removeValidationErrors=function(){this._oConditionPanel.removeValidationErrors()};p.prototype.setIncludeOperations=function(e,t){t=t||"default";this._aIncludeOperations[t]=e;if(this._oConditionPanel){this._oConditionPanel.setOperations(this._aIncludeOperations[t],t)}};p.prototype.getIncludeOperations=function(e){if(this._oConditionPanel){return this._oConditionPanel.getOperations(e,false)}};p.prototype.setExcludeOperations=function(e,t){t=t||"default";this._aExcludeOperations[t]=e;if(this._oConditionPanel){this._oConditionPanel.setOperations(this._aExcludeOperations[t],t,true)}};p.prototype.getExcludeOperations=function(e){if(this._oConditionPanel){return this._oConditionPanel.getOperations(e,true)}};p.prototype.setKeyFields=function(e,t){this._aKeyFields=e;if(this._oConditionPanel){e.some(function(e){if(e.isDefault){this._oConditionPanel.setAutoAddNewRow(true)}}.bind(this));this._oConditionPanel.setKeyFields(e)}};p.prototype.setMaxConditions=function(e){this.setProperty("maxConditions",e);if(this._oConditionPanel){this._oConditionPanel.setMaxConditions(e)}return this};p.prototype.setMaxIncludes=function(e){this.setProperty("maxIncludes",e);this._updateIncludeOperations();return this};p.prototype.setMaxExcludes=function(e){this.setProperty("maxExcludes",e);this._updateExcludeOperations();return this};p.prototype._updatePanel=function(){};p.prototype.setDefaultOperation=function(e){this.setProperty("defaultOperation",e);if(this._oConditionPanel){this._oConditionPanel.setDefaultOperation(e)}return this};p.prototype.init=function(){this.setType(r.filter);this.setTitle(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("FILTERPANEL_TITLE"));this._aKeyFields=[];this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.m");this._aIncludeOperations={};this._aExcludeOperations={};this._oPanel=new i({expanded:true,expandable:false,width:"auto"}).addStyleClass("sapMFilterPadding");this._oConditionPanel=new t({maxConditions:this.getMaxConditions(),alwaysShowAddIcon:false,layoutMode:this.getLayoutMode(),dataChange:this._handleDataChange(),defaultOperation:this.getDefaultOperation()});this._oConditionPanel._sAddRemoveIconTooltipKey="FILTER";this._oPanel.addContent(this._oConditionPanel);this.addAggregation("content",this._oPanel);if(!this._oOperationsHelper){this._oOperationsHelper=new a}this._updateOperations()};p.prototype.onBeforeRendering=function(){var e=[],t,i,n=this.getEnableEmptyOperations();if(this._bUpdateRequired){this._bUpdateRequired=false;var o=this.getMessageStrip();if(o){o.addStyleClass("sapUiResponsiveMargin");this.insertAggregation("content",o,0)}t=[];i=(this.getBindingInfo("items")||{}).model;var a=function(e,t,i){var n=i.getBinding(e),o;if(n&&t){return t.getObject()[n.getPath()]}o=i.getMetadata();return o.hasProperty(e)?o.getProperty(e).get(i):o.getAggregation(e).get(i)};this.getItems().forEach(function(o){var s=o.getBindingContext(i),r,l,p;if(o.getBinding("key")){s.getObject()[o.getBinding("key").getPath()]=o.getKey()}t.push(r={key:o.getColumnKey(),text:a("text",s,o),tooltip:a("tooltip",s,o),maxLength:a("maxLength",s,o),type:a("type",s,o),typeInstance:a("typeInstance",s,o),formatSettings:a("formatSettings",s,o),precision:a("precision",s,o),scale:a("scale",s,o),isDefault:a("isDefault",s,o),values:a("values",s,o)});if(n){l=o.getNullable();p={};Object.keys(r).forEach(function(e){p[e]=r[e]});e.push(p);this._enhanceFieldOperationsWithEmpty(r,l);this._modifyFieldOperationsBasedOnMaxLength(p)}this._modifyFieldOperationsBasedOnMaxLength(r)},this);this.setKeyFields(t,e);var s=[];i=(this.getBindingInfo("filterItems")||{}).model;this.getFilterItems().forEach(function(e){var t=e.getBindingContext(i);if(e.getBinding("key")&&t){t.getObject()[e.getBinding("key").getPath()]=e.getKey()}s.push({key:e.getKey(),keyField:a("columnKey",t,e),operation:a("operation",t,e),value1:a("value1",t,e),value2:a("value2",t,e),exclude:a("exclude",t,e)})});this.setConditions(s)}};p.prototype._updateOperations=function(){this._updateIncludeOperations();this._updateExcludeOperations()};p.prototype._updateIncludeOperations=function(){if(this.getMaxIncludes()==="0"){this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations([],e)}.bind(this))}else{this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations(this._oOperationsHelper.getIncludeOperationsByType(e),e)}.bind(this))}};p.prototype._updateExcludeOperations=function(){if(this.getMaxExcludes()==="0"){this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations([],e)}.bind(this))}else{this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations(this._oOperationsHelper.getExcludeOperationsByType(e),e)}.bind(this))}};p.prototype._modifyFieldOperationsBasedOnMaxLength=function(e){var t;if(e.maxLength===1||e.maxLength==="1"){t=e.operations?e.operations:this._oConditionPanel.getOperations(e.type);e.operations=[];t.forEach(function(t){if([l.Contains,l.StartsWith,l.EndsWith].indexOf(t)===-1){e.operations.push(t)}},this)}};p.prototype._enhanceFieldOperationsWithEmpty=function(e,t){var i,n,o=e&&e.typeInstance&&e.typeInstance.oConstraints&&e.typeInstance.oConstraints.isDigitSequence,a=e&&e.typeInstance&&(e.typeInstance.sAnotationType==="com.sap.vocabularies.Common.v1.IsFiscalPeriod"||e.typeInstance.sAnotationType==="com.sap.vocabularies.Common.v1.IsFiscalYearPeriod");if(["string","stringdate","guid"].indexOf(e.type)>-1||["date","datetime"].indexOf(e.type)>-1&&t&&!(o&&a)&&!this.bIsSingleIntervalRange){i=this._oConditionPanel.getOperations(e.type,false).slice();n=this._oConditionPanel.getOperations(e.type,true).slice();if(i.length===0){i=this._oConditionPanel.getOperations("default",false)}if(n.length===0){n=this._oConditionPanel.getOperations("default",true)}if(i.indexOf(l.Empty)===-1&&this.getMaxIncludes()!=="0"){i.push(l.Empty)}if(n.indexOf(l.NotEmpty)===-1&&this.getMaxExcludes()!=="0"){n.push(l.NotEmpty)}if(!Array.isArray(e.operations)){e.operations=[]}e.operations=e.operations.concat(i).concat(n)}};p.prototype._handleDataChange=function(){var e=this;return function(t){var i=t.getParameter("newData"),n=t.getParameter("operation"),a=t.getParameter("key"),s=t.getParameter("index"),r;switch(n){case"update":r=e.getFilterItems()[s];if(r){r.setExclude(i.exclude);r.setColumnKey(i.keyField);r.setOperation(i.operation);r.setValue1(i.value1);r.setValue2(i.value2)}e.fireUpdateFilterItem({key:a,index:s,filterItemData:r});e.fireFilterItemChanged({reason:"updated",key:a,index:s,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});break;case"add":if(s>=0){s++}r=new o({columnKey:i.keyField,exclude:i.exclude,operation:i.operation});r.setValue1(i.value1);r.setValue2(i.value2);e._bIgnoreBindCalls=true;e.fireAddFilterItem({key:a,index:s,filterItemData:r});e.fireFilterItemChanged({reason:"added",key:a,index:s,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});e._bIgnoreBindCalls=false;break;case"remove":e._bIgnoreBindCalls=true;e.fireRemoveFilterItem({key:a,index:s});e.fireFilterItemChanged({reason:"removed",key:a,index:s});e._bIgnoreBindCalls=false;break;default:throw"Operation'"+n+"' is not supported yet"}e._notifyChange()}};p.prototype.getConditionPanel=function(){return this._oConditionPanel};p.prototype.setInnerTitle=function(e){this._oPanel&&this._oPanel.setHeaderText(e)};p.prototype.setSuggestCallback=function(e){if(this._oConditionPanel){this._oConditionPanel.setSuggestCallback(e)}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nOperationsHelper", ["sap/m/P13nOperationsHelper","sap/m/library"],function(t,o){"use strict";var e=o.P13nConditionOperation;var n="Not";var N=function(){t.apply(this,arguments);this.init();this.oIncludeOperations.numcFiscal=[e.EQ,e.BT,e.LT,e.LE,e.GT,e.GE]};N.prototype=Object.create(t.prototype);N.prototype.oIncludeOperationsOptinal={optinal:[e.Empty]};N.prototype.oExcludeOperationsDefault={default:[e.NotEQ]};N.prototype.oExcludeOperationsExtended={default:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],string:[e.NotContains,e.NotEQ,e.NotBT,e.NotStartsWith,e.NotEndsWith,e.NotLT,e.NotLE,e.NotGT,e.NotGE],date:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],time:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],datetime:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numeric:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numc:[e.NotContains,e.NotEQ,e.NotBT,e.NotEndsWith,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numcFiscal:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],boolean:[e.NotEQ]};N.prototype.oExcludeOperationsOptional={optinal:[e.NotEmpty]};N.prototype.isExcludeType=function(t){return i(t,this.oExcludeOperationsExtended)||i(t,this.oExcludeOperationsOptional)};N.prototype.getCorrespondingExcludeOperation=function(t){return n+t};N.prototype.getCorrespondingIncludeOperation=function(t){return t.slice(n.length)};function i(t,o){var e,n,N,i,r=false;for(n in o){N=o[n];for(e=0;e<N.length;e++){i=N[e];if(i===t){r=true;break}}if(r){break}}return r}return N},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/BaseController", ["sap/ui/base/ManagedObject","sap/ui/comp/library","./Util","./ColumnHelper","sap/base/Log","sap/ui/mdc/p13n/P13nBuilder","sap/ui/model/json/JSONModel"],function(t,e,n,o,a,i,r){"use strict";var s=t.extend("sap.ui.comp.personalization.BaseController",{metadata:{abstract:true,library:"sap.ui.comp",properties:{type:{type:"string",defaultValue:null},itemType:{type:"string",defaultValue:null},ignoreColumnKeys:{type:"object",defaultValue:[]},additionalIgnoreColumnKeys:{type:"object",defaultValue:[]},stableColumnKeys:{type:"string[]",defaultValue:[]},columnHelper:{type:"sap.ui.comp.personalization.ColumnHelper",defaultValue:null},columnKeys:{type:"string[]",defaultValue:[]},tableType:{type:"string",defaultValue:null},messageStrip:{type:"sap.m.MessageStrip"}},associations:{table:{type:"sap.ui.core.Control",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterPotentialModelChange:{parameters:{json:{type:"object"}}}}}});s.prototype.exit=function(){if(this.getModel()){this.getModel().destroy()}if(this._oAdaptationModel){this._oAdaptationModel.destroy();this._oAdaptationModel=null;this.oPanel=null}};s.prototype.setModelFunction=function(){var t=this;return function(){if(!this.getModel("$sapmP13nPanel")){this.setModel(t.getInternalModel(),"$sapmP13nPanel")}}};s.prototype.setTable=function(t){this.setAssociation("table",t);this.setTableType(n.getTableType(this.getTable()));return this};s.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=sap.ui.getCore().byId(t)}return t};s.prototype.getColumnMap=function(){return this.getColumnHelper().getColumnMap()};s.prototype.createControlDataStructure=function(t){t=t||[];var e={};e[this.getType()]={};e[this.getType()][this.getItemType()]=t;return e};s.prototype.createColumnKeysStructure=function(t){t=t||[];var e={};e[this.getType()]={};e[this.getType()][this.getItemType()]=t.map(function(t){return{columnKey:t}});return e};s.prototype.checkConsistency=function(){var t=this.getColumnMap();this.getIgnoreColumnKeys().some(function(e){if(t[e]&&t[e].getVisible()){throw"The provided 'ignoreColumnKeys' for '"+this.getType()+"' are inconsistent. No columns specified as ignored is allowed to be visible."}},this);var e=this.getColumnKeys();Object.keys(t).forEach(function(t){if(e.indexOf(t)<0){throw"The provided 'columnKeys' and columns are inconsistent. For the column '"+t+"' no entry in 'columnKeys' exists."}});var n=this.getStableColumnKeys();n.forEach(function(e,n){if(t[e].getIndex()!=n){throw"The provided 'stableColumnKeys' are inconsistens. Please provide 'stableColumnKeys' by ascending indices of the columns, starting from index 0."}})};s.prototype.initializeInternalModel=function(t){["controlDataInitial","controlDataBase","controlData","alreadyKnownRuntimeData","alreadyKnownPersistentData"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,{})}t.setProperty("/"+e+"/"+this.getType(),this.createControlDataStructure()[this.getType()])},this);["ignoreData"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,{})}t.setProperty("/"+e+"/"+this.getType(),this.createColumnKeysStructure()[this.getType()])},this);["persistentDataChangeType","persistentDeltaDataChangeType"].forEach(function(n){if(!t.getProperty("/"+n)){t.setProperty("/"+n,{})}t.setProperty("/"+n+"/"+this.getType(),e.personalization.ChangeType.Unchanged);t.setProperty("/"+n+"/"+this.getType(),e.personalization.ChangeType.Unchanged)},this);["controlDataReduce","transientData","beforeOpenData","variantDataInitial"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,undefined)}});this.setModel(t,"$sapuicomppersonalizationBaseController")};s.prototype._extendPropertyWithControlDataStructure=function(t){var e=this.getInternalModel();if(e.getProperty("/"+t)){return}e.setProperty("/"+t,{});e.setProperty("/"+t+"/"+this.getType(),this.createControlDataStructure()[this.getType()])};s.prototype.getInternalModel=function(){return this.getModel("$sapuicomppersonalizationBaseController")};s.prototype.calculateIgnoreData=function(){var t=this.getIgnoreColumnKeys().concat(this.getAdditionalIgnoreColumnKeys());t=t.filter(function(e,n){return t.indexOf(e)===n});var e=this.createColumnKeysStructure(t);this.setIgnoreData2Model(e)};s.prototype.calculateControlData=function(){var t=n.copy(this.getControlDataBase());this._deselectIgnoreDataFromJson(t);this.setControlData2Model(t)};s.prototype.calculateControlDataReduce=function(){var t=n.copy(this.getControlDataBase());this._removeIgnoreDataFromJson(t);this.setControlDataReduce2Model(t)};s.prototype.calculateTransientData=function(t){t=n.copy(t);this._removeIgnoreDataFromJson(t);this.setTransientData2Model(t)};s.prototype.calculatePersistentChangeTypesFromJson=function(t,n){var o=this.getPersistentDeltaDataChangeType();var a=this.getUnionData(this.getControlDataInitial(),t);o[this.getType()]=this.getChangeType(a,this.getAlreadyKnownPersistentData());this.setPersistentDeltaDataChangeType(o);o=this.getPersistentDataChangeType();if(n===e.personalization.ResetType.ResetFull){o[this.getType()]=this.getChangeType(t,this.getControlDataInitial())}else if(n===e.personalization.ResetType.ResetPartial){o[this.getType()]=this.getChangeType(t,this.getVariantDataInitial())}this.setPersistentDataChangeType(o)};s.prototype._removeIgnoreDataFromJson=function(t){if(!this.getIgnoreData()[this.getType()]){return}this.getIgnoreData()[this.getType()][this.getItemType()].forEach(function(e){var o=n.getIndexByKey("columnKey",e.columnKey,t[this.getType()][this.getItemType()]);if(o>-1){t[this.getType()][this.getItemType()].splice(o,1)}},this)};s.prototype._deselectIgnoreDataFromJson=function(t){if(!this.getIgnoreData()[this.getType()]){return}this.getIgnoreData()[this.getType()][this.getItemType()].forEach(function(e){var o=n.getIndexByKey("columnKey",e.columnKey,t[this.getType()][this.getItemType()]);if(o>-1){this.handleIgnore(t,o)}},this)};s.prototype.updateControlDataBaseFromJson=function(t){var e=this.getIgnoreData();var o=n.copy(this.getControlDataBase());var a=n.copy(this.getControlDataBase());var i=n.copy(t);o[this.getType()][this.getItemType()]=this.getControlDataBase()[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])>-1},this);i[this.getType()][this.getItemType()]=t[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])<0},this);a[this.getType()][this.getItemType()]=i[this.getType()][this.getItemType()];if(this.getType()==="columns"){if(a[this.getType()][this.getItemType()].length!==i[this.getType()][this.getItemType()].length){throw"the updated columns are inconsistent with 'controlDataBase'"}a[this.getType()][this.getItemType()].some(function(t){if(n.getIndexByKey("columnKey",t.columnKey,i[this.getType()][this.getItemType()])<0){throw"the columnKey '"+t.columnKey+"' is not contained in 'controlDataBase'"}},this)}var r=n.copy(this.getControlDataBase());r[this.getType()][this.getItemType()]=a[this.getType()][this.getItemType()].concat(o[this.getType()][this.getItemType()]);Object.keys(r[this.getType()]).forEach(function(e){if(!Array.isArray(r[this.getType()][e])){r[this.getType()][e]=t[this.getType()][e]}},this);this.setControlDataBase2Model(r);this.fireAfterPotentialModelChange({json:r})};s.prototype.extendControlDataInitial=function(t){this._extendData("controlDataInitial",t)};s.prototype.extendControlDataBase=function(t){this._extendData("controlDataBase",t)};s.prototype.extendVariantDataInitial=function(t){this._extendData("variantDataInitial",t)};s.prototype.extendAlreadyKnownRuntimeData=function(t){this._extendData("alreadyKnownRuntimeData",t)};s.prototype.extendAlreadyKnownPersistentData=function(t){this._extendData("alreadyKnownPersistentData",t)};s.prototype._extendData=function(t,e){if(!e||!e[this.getType()]||!this._getInternalModelData(t)){return}var o=n.copy(e);var a=this.getInternalModel();Object.keys(o[this.getType()]).forEach(function(e){if(Array.isArray(o[this.getType()][e])){o[this.getType()][e].forEach(function(o){var i=this._getInternalModelData(t)[this.getType()][e];if(n.getIndexByKey("columnKey",o.columnKey,i)>-1){throw"columnKey '"+o.columnKey+"' does already exist in internal model"}a.setProperty("/"+t+"/"+this.getType()+"/"+e+"/"+i.length+"/",o)},this);return}a.setProperty("/"+t+"/"+this.getType()+"/"+e+"/",o[this.getType()][e])},this)};s.prototype.setControlDataInitial2Model=function(t){this._setModelData("controlDataInitial",t)};s.prototype.setControlDataBase2Model=function(t){this._setModelData("controlDataBase",t)};s.prototype.setControlData2Model=function(t){this._setModelData("controlData",t)};s.prototype.setAlreadyKnownRuntimeData2Model=function(t){this._setModelData("alreadyKnownRuntimeData",t)};s.prototype.setAlreadyKnownPersistentData2Model=function(t){this._setModelData("alreadyKnownPersistentData",t)};s.prototype.setVariantDataInitial2Model=function(t){this._extendPropertyWithControlDataStructure("variantDataInitial");this._setModelData("variantDataInitial",t)};s.prototype.setIgnoreData2Model=function(t){this._setModelData("ignoreData",t)};s.prototype.setPersistentDataChangeType=function(t){this._setModelData("persistentDataChangeType",t)};s.prototype.setPersistentDeltaDataChangeType=function(t){this._setModelData("persistentDeltaDataChangeType",t)};s.prototype.setControlDataReduce2Model=function(t){this._extendPropertyWithControlDataStructure("controlDataReduce");this._setModelData("controlDataReduce",t)};s.prototype.setTransientData2Model=function(t){this._extendPropertyWithControlDataStructure("transientData");this._setModelData("transientData",t)};s.prototype.setBeforeOpenData2Model=function(t){this._extendPropertyWithControlDataStructure("beforeOpenData");this._setModelData("beforeOpenData",t)};s.prototype._setModelData=function(t,e){this.getInternalModel().setProperty("/"+t+"/"+this.getType(),e?n.copy(e)[this.getType()]:undefined)};s.prototype.getControlDataInitial=function(){return this._getInternalModelData("controlDataInitial")};s.prototype.getControlDataBase=function(){return this._getInternalModelData("controlDataBase")};s.prototype.getControlData=function(){return this._getInternalModelData("controlData")};s.prototype.getAlreadyKnownRuntimeData=function(){return this._getInternalModelData("alreadyKnownRuntimeData")};s.prototype.getAlreadyKnownPersistentData=function(){return this._getInternalModelData("alreadyKnownPersistentData")};s.prototype.getVariantDataInitial=function(){return this._getInternalModelData("variantDataInitial")};s.prototype.getIgnoreData=function(){return this._getInternalModelData("ignoreData")};s.prototype.getPersistentDataChangeType=function(){return this._getInternalModelData("persistentDataChangeType")};s.prototype.getPersistentDeltaDataChangeType=function(){return this._getInternalModelData("persistentDeltaDataChangeType")};s.prototype.getControlDataReduce=function(){return this._getInternalModelData("controlDataReduce")};s.prototype.getTransientData=function(){return this._getInternalModelData("transientData")};s.prototype.getBeforeOpenData=function(){return this._getInternalModelData("beforeOpenData")};s.prototype.isEqualAdditionalIgnoreColumnKeys=function(t){var e=this.getAdditionalIgnoreColumnKeys();if(e.length!==t.length){return false}return!e.some(function(e){return t.indexOf(e)<0})};s.prototype._getInternalModelData=function(t){return this.getInternalModel().getProperty("/"+t)};s.prototype.determineMissingColumnKeys=function(t){if(!t||!t[this.getType()]||!t[this.getType()][this.getItemType()]){return this.createColumnKeysStructure()}var e=this.getColumnMap();var o=this.getIgnoreData();var a=t[this.getType()][this.getItemType()].filter(function(t){return!e[t.columnKey]}).filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,o[this.getType()][this.getItemType()])<0},this).map(function(t){return t.columnKey});return this.createColumnKeysStructure(a)};s.prototype.extractIgnoreDataFromJson=function(t){if(!t||!t[this.getType()]||!t[this.getType()][this.getItemType()]){return null}var e=this.getIgnoreData();var o=t[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])>-1},this);return o.length?this.createControlDataStructure(o):null};s.prototype.getTable2Json=function(t){var e=this.createControlDataStructure();var n=this.getColumnMap();var o=this.getColumnKeys();t[this.getType()][this.getItemType()].forEach(function(t){var i=n[t.columnKey];if(!i){a.warning("Column with columnKey '"+t.columnKey+"' does not exist.");return}var r=this.getColumn2Json(i,t.columnKey,o.indexOf(t.columnKey));if(r){e[this.getType()][this.getItemType()].push(r)}},this);this.getAdditionalData2Json(e,this.getTable());return e};s.prototype.getTable2JsonTransient=function(t){var e=this.createControlDataStructure();var o=this.getColumnMap();var a,i;var r;t[this.getType()][this.getItemType()].forEach(function(t){var n=false;if(this.getType()==="columns"){this.getStableColumnKeys().forEach(function(e){if(e==t.columnKey){n=true}})}var s=o[t.columnKey];if(!s||n){return}if(s.isA("sap.ui.table.Column")){if(!s.getLabel()){throw"The column '"+t.columnKey+"' should have a 'label' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getLabel().getText();r=s.getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getTooltip_Text()}if(s.isA("sap.m.Column")){if(!s.getHeader()){throw"The column '"+t.columnKey+"' should have a 'header' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getHeader().getText();r=s.getHeader().getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getHeader().getTooltip_Text()}if(s.isA("sap.ui.comp.personalization.ColumnWrapper")){if(!s.getLabel()){throw"The column '"+t.columnKey+"' should have a 'label' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getLabel();r=s.getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getTooltip_Text()}var l=this.getColumn2JsonTransient(s,t.columnKey,a,i);if(l){e[this.getType()][this.getItemType()].push(l)}},this);n.sortItemsByText(e[this.getType()][this.getItemType()],"text");return e};s.prototype.getColumn2Json=function(t,e,n){};s.prototype.getAdditionalData2Json=function(t,e){};s.prototype.getColumn2JsonTransient=function(t,e){};s.prototype.handleIgnore=function(t,e){};s.prototype.fixConflictWithIgnore=function(t,e){};s.prototype.syncJson2Table=function(t){};s.prototype.getPanel=function(){};s.prototype.getAdaptationUI=function(){return this.oPanel&&!this.oPanel.bIsDestroyed?this.oPanel:null};s.prototype.retrieveAdaptationUI=function(t){return this.getPanel(t)};s.prototype.getAdaptationData=function(){var t=this.getTransientData();var e=this.getInternalModel().getProperty("/controlDataReduce");var n=e[this.getType()][this.getItemType()].reduce(function(t,e,n){t[e.columnKey]=Object.assign({},e);t[e.columnKey].position=n;return t},{});var o=[];t[this.getType()][this.getItemType()].forEach(function(t,e){o.push(this._transformAdaptationData(n[t.columnKey],t))}.bind(this));this._sortAdaptationData(o);return o};s.prototype._transformAdaptationData=function(t,e){return{position:t?t.position:-1,name:e.columnKey,label:e.text,tooltip:e.tooltip}};s.prototype._sortAdaptationData=function(t){i.sortP13nData({visible:"visible",position:"position"},t)};s.prototype._getPresenceAttribute=function(){return"visible"};s.prototype._getP13nBuilder=function(){return i};s.prototype.getChangeType=function(t,e){};s.prototype.getChangeData=function(t,e){};s.prototype.getUnionData=function(t,e){};s.prototype.getResetWarningText=function(){return undefined};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ChartWrapper", ["sap/ui/core/Element","sap/ui/comp/library","./ColumnWrapper","sap/ui/core/CustomData"],function(e,t,a,r){"use strict";var o=t.personalization.AggregationRole;var n=e.extend("sap.ui.comp.personalization.ChartWrapper",{constructor:function(t,a){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{externalFilters:{type:"sap.m.P13nFilterItem[]",defaultValue:[]}},aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}},associations:{chart:{type:"sap.chart.Chart",multiple:false}},events:{externalFiltersSet:{parameters:{filters:{type:"sap.m.P13nFilterItem[]"}}}}}});n.prototype.getChartObject=function(){var e=this.getAssociation("chart");if(typeof e==="string"){e=sap.ui.getCore().byId(e)}return e};n.prototype.getModel=function(){return this.getChartObject().getModel()};n.prototype.getDomRef=function(){var e=this.getChartObject();return e&&e.getDomRef()};n.createChartWrapper=function(e,t,l){var i;var s={};e.getDimensions().forEach(function(t){i=t.data("p13nData");s[i.columnKey]=new a({label:t.getLabel(),tooltip:t.getTooltip(),selected:e.getVisibleDimensions().indexOf(t.getName())>-1,aggregationRole:o.Dimension,role:t.getRole()?t.getRole():t.getMetadata().getProperty("role").getDefaultValue(),sorted:i.sorted,sortOrder:i.sortOrder,customData:new r({key:"p13nData",value:i}),hierarchyLevel:i.hierarchyLevel,chart:e})});e.getMeasures().forEach(function(t){i=t.data("p13nData");s[i.columnKey]=new a({label:t.getLabel(),tooltip:t.getTooltip(),selected:e.getVisibleMeasures().indexOf(t.getName())>-1,aggregationRole:o.Measure,role:t.getRole()?t.getRole():t.getMetadata().getProperty("role").getDefaultValue(),sorted:i.sorted,sortOrder:i.sortOrder,customData:new r({key:"p13nData",value:i}),chart:e})});if(t){t.forEach(function(t){s[t.columnKey]=new a({label:t.label,tooltip:t.tooltip,selected:false,aggregationRole:o.NotDimeasure,sorted:t.sorted,sortOrder:t.sortOrder,customData:new r({key:"p13nData",value:t}),chart:e});if(!s[t.columnKey].getParent()){e.addDependent(s[t.columnKey])}})}return new n({chart:e,columns:l.map(function(e){return s[e]})})};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnHelper", ["sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","./Util","./ColumnWrapper"],function(jQuery,e,o,t){"use strict";var n=e.extend("sap.ui.comp.personalization.ColumnHelper",{constructor:function(o,t){e.apply(this,arguments)},metadata:{properties:{callbackOnSetVisible:{type:"object",defaultValue:null},callbackOnSetSummed:{type:"object",defaultValue:null},callbackOnSetGrouped:{type:"object",defaultValue:null}}}});n.prototype.init=function(){this._oColumnKey2ColumnMap={};this._oColumnKeyIsMonkeyPatched={}};n.prototype.exit=function(){this._oColumnKey2ColumnMap=null;this._oColumnKeyIsMonkeyPatched=null};n.prototype.addColumns=function(e){if(!e){return}e.forEach(function(e){this._addColumnToMap(o.getColumnKey(e),e)},this);this._checkConsistencyOfColumns(this._oColumnKey2ColumnMap)};n.prototype.addColumnMap=function(e){if(!e){return}for(var o in e){this._addColumnToMap(o,e[o])}this._checkConsistencyOfColumns(this._oColumnKey2ColumnMap)};n.prototype.getColumnMap=function(){return this._oColumnKey2ColumnMap};n.prototype._checkConsistencyOfColumns=function(e){if(jQuery.isEmptyObject(e)){return}var t=Object.keys(e)[0];var n=!!o._getCustomProperty(e[t],"columnKey");for(var u in e){if(n!==!!o._getCustomProperty(e[u],"columnKey")){throw"The table instance contains some columns for which a columnKey is provided, some for which a columnKey is not provided."}}};n.prototype._addColumnToMap=function(e,o){if(this._oColumnKey2ColumnMap[e]){throw"Duplicate 'columnKey': The column '"+o.getId()+"' and column '"+this._oColumnKey2ColumnMap[e]+"' have same 'columnKey' "+e}if(!this._oColumnKey2ColumnMap[e]){this._oColumnKey2ColumnMap[e]=o;this._monkeyPatchColumn(o,e)}};n.prototype._monkeyPatchColumn=function(e,o){if(e instanceof t){return}if(this._oColumnKeyIsMonkeyPatched[o]){return}this._oColumnKeyIsMonkeyPatched[o]=true;var n=this.getCallbackOnSetVisible();var u=e.setVisible.bind(e);var i=function(e){if(n){n(e,o)}u(e)};e.setVisible=i;if(e.setSummed){var a=this.getCallbackOnSetSummed();var l=e.setSummed.bind(e);var s=function(o){if(a){a(o,e)}l(o)};e.setSummed=s}if(e.isA("sap.ui.table.AnalyticalColumn")){var c=this.getCallbackOnSetGrouped();if(typeof c==="function"){var m=e.setGrouped.bind(e);var r=function(o,t){if(!t&&c){c(o,e)}m(o)};e.setGrouped=r}}};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnWrapper", ["sap/ui/core/Element","sap/ui/comp/personalization/Util"],function(e,t){"use strict";var a=e.extend("sap.ui.comp.personalization.ColumnWrapper",{constructor:function(t,a){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{label:{type:"string"},tooltip:{type:"string"},selected:{type:"boolean",defaultValue:false},aggregationRole:{type:"sap.ui.comp.personalization.AggregationRole"},role:{type:"string"},href:{type:"string",defaultValue:null},internalHref:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null},press:{type:"object",defaultValue:null},sorted:{type:"boolean",defaultValue:false},sortOrder:{type:"string",defaultValue:"Ascending"},hierarchyLevel:{type:"int",defaultValue:0},description:{type:"string",defaultValue:null}},associations:{chart:{type:"sap.chart.Chart",multiple:false}}}});a.prototype.getVisible=function(){var e=this.getAssociation("chart");if(typeof e==="string"){e=sap.ui.getCore().byId(e)}var a=e.getVisibleDimensions().concat(e.getVisibleMeasures());var i=t.getColumnKey(this);return a.indexOf(i)>-1};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnsController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/base/util/merge"],function(e,t,n,i,o){"use strict";var l=e.extend("sap.ui.comp.personalization.ColumnsController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.columns);this.setItemType(t.P13nPanelType.columns+"Items")},metadata:{properties:{triggerModelChangeOnColumnInvisible:{type:"boolean",group:"Misc",defaultValue:false}},events:{afterColumnsModelDataChange:{}}}});l.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()===n.personalization.TableType.ResponsiveTable){var i=t.findElements(false,function(e){return e.isA("sap.m.plugins.ColumnResizer")})[0];if(i){i.detachColumnResize(this._onColumnResize,this);i.attachColumnResize(this._onColumnResize,this)}}else if(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this);t.attachColumnMove(this._onColumnMove,this);t.attachColumnVisibility(this._onColumnVisibility,this);t.attachColumnResize(this._onColumnResize,this)}this._monkeyPatchTable(t)};l.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,index:n,visible:e.getVisible(),width:e.getWidth?e.getWidth():undefined,total:e.getSummed?e.getSummed():undefined}};l.prototype.getAdditionalData2Json=function(e,t){e.columns.fixedColumnCount=t&&t.getFixedColumnCount?t.getFixedColumnCount():undefined};l.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,tooltip:i!==n?i:undefined}};l.prototype.handleIgnore=function(e,t){e.columns.columnsItems[t].visible=false};l.prototype.syncJson2Table=function(e){var t=this.getTable();var i=this.getColumnMap();this.fireBeforePotentialTableChange();if(this.getTable()&&(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable)){this._applyChangesToUiTableType(t,e,i)}else if(this.getTableType()===n.personalization.TableType.ResponsiveTable){this._applyChangesToMTableType(t,e,i)}this.fireAfterPotentialTableChange()};l.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();var n=function(e,n,o){var l=i.getIndexByKey("columnKey",e,t.columns.columnsItems);if(l<0){l=t.columns.columnsItems.length;t.columns.columnsItems.splice(l,0,{columnKey:e})}t.columns.columnsItems[l][n]=o};this.getControlDataInitial().columns.columnsItems.filter(function(e){return e.visible===true}).forEach(function(e){n(e.columnKey,"visible",false)});if(e.Visualizations&&e.Visualizations.length){var o=e.Visualizations.filter(function(e){return e.Type==="LineItem"});if(o.length){o[0].Content.forEach(function(e,t){n(e.Value,"visible",true);n(e.Value,"index",t)},this)}var l=e.Visualizations.filter(function(e){return e.Type==="ColumnWidth"});if(l.length){l[0].Content.forEach(function(e){n(e.Value,"width",e.Width)},this)}}if(e.Total&&e.Total.length){e.Total.forEach(function(e){n(e,"total",true)})}return t};l.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.columns||!t.columns.columnsItems||!t.columns.columnsItems.length){return}var n=t.columns.columnsItems.filter(function(e){return!!e.total});if(n.length){e.Total=n.map(function(e){return e.columnKey})}var i=t.columns.columnsItems.filter(function(e){return!!e.visible});if(i.length){if(!e.Visualizations){e.Visualizations=[]}i.sort(this._sortByIndex);e.Visualizations.push({Type:"LineItem",Content:i.map(function(e){return{Value:e.columnKey,Label:undefined}})})}var o=t.columns.columnsItems.filter(function(e){return!!e.width});if(o.length){if(!e.Visualizations){e.Visualizations=[]}e.Visualizations.push({Type:"ColumnWidth",Content:o.map(function(e){return{Value:e.columnKey,Width:e.width}})})}};l.prototype._onColumnMove=function(e){var t=e.getParameter("newPos");var n=i.getColumnKey(e.getParameter("column"));var o=this.getControlData();var l=i.getIndexByKey("columnKey",n,o.columns.columnsItems);if(l<0||t<0||l>o.columns.columnsItems.length-1||t>o.columns.columnsItems.length-1){return}this.fireBeforePotentialTableChange();var s=o.columns.columnsItems.splice(l,1);o.columns.columnsItems.splice(t,0,s[0]);var a=-1;o.columns.columnsItems.forEach(function(e){if(e.index!==undefined){e.index=++a}});this.updateControlDataBaseFromJson(o);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};l.prototype._onColumnVisibility=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.getParameter("column")),"visible",e.getParameter("newVisible"));this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};l.prototype._onColumnTotal=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.column),"total",e.isSummed);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};l.prototype._onColumnResize=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.getParameter("column")),"width",e.getParameter("width"));this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};l.prototype._onColumnFixedCount=function(e){this.fireBeforePotentialTableChange();var t=this.getControlData();this.getInternalModel().setProperty("/controlData/columns/fixedColumnCount",e);this.updateControlDataBaseFromJson(t);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};l.prototype._updateInternalModel=function(e,t,n){if(!e||!t){return}var o=this.getControlData();var l=i.getIndexByKey("columnKey",e,o.columns.columnsItems);if(l<0){throw"No entry found in 'controlDataBase' for columnKey '"+e+"'"}this.getInternalModel().setProperty("/controlData/columns/columnsItems/"+l+"/"+t,n);this.updateControlDataBaseFromJson(o)};l.prototype.getPanel=function(e){var t=e&&e.visibleItemsThreshold?e.visibleItemsThreshold:-1;return new Promise(function(e){sap.ui.require(["sap/m/P13nColumnsPanel","sap/m/P13nItem","sap/m/P13nColumnsItem"],function(n,i,o){return e(new n({visibleItemsThreshold:t,items:{path:"$sapmP13nPanel>/transientData/columns/columnsItems",template:new i({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},columnsItems:{path:"$sapmP13nPanel>/controlDataReduce/columns/columnsItems",template:new o({columnKey:"{$sapmP13nPanel>columnKey}",index:"{$sapmP13nPanel>index}",visible:"{$sapmP13nPanel>visible}",width:"{$sapmP13nPanel>width}",total:"{$sapmP13nPanel>total}"})},beforeNavigationTo:this.setModelFunction(),changeColumnsItems:function(e){if(!e.getParameter("items")){return}var t=this.getControlDataReduce();t.columns.columnsItems=e.getParameter("items");this.setControlDataReduce2Model(t);this._enhanceForStableKeys(this.getControlDataInitial(),t);this.fireAfterPotentialModelChange({json:t})}.bind(this)}))}.bind(this))}.bind(this))};l.prototype._swapIndexes=function(e,t){var n=e.index;e.index=t.index;t.index=n};l.prototype._quickSortPartition=function(e,t,n){var i,o=t,l=e[n];for(i=t;i<=n-1;i++){if(e[i].index<l.index){if(i!==o){this._swapIndexes(e[o],e[i])}o++}}this._swapIndexes(e[o],l);return o};l.prototype._quickSort=function(e,t,n){var i,o,l,s=[t,n];while(s[s.length-1]>=0){l=s.pop();o=s.pop();i=this._quickSortPartition(e,o,l);if(i-1>o){s.push(o);s.push(i-1)}if(i+1<l){s.push(i+1);s.push(l)}}};l.prototype._sortIndexesByOrder=function(e){var t=e.findIndex(function(e){return!Number.isInteger(e.index)}),n=t===-1?e.length-1:t-1;if(n>0){this._quickSort(e,0,n)}};l.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/m/p13n/SelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("fieldsui.COLUMNS")});i.setP13nData(n);i._oListControl.setMultiSelectMode("Default");this.oPanel=i;var o;i.attachChange(function(e){o=e.getSource().getP13nData().map(function(e,t){var i={columnKey:e.name,visible:e.visible,width:e.width,total:e.total};i.index=n[t].position;return i});this._sortAdaptationData(o);this._sortIndexesByOrder(o);var t=this.getControlDataReduce();t.columns.columnsItems=o;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:this._enhanceForStableKeys(this.getControlDataInitial(),t)})}.bind(this));e(i)}.bind(this))}.bind(this))};l.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);i.visible=t.visible;i.position=t.index;i.width=t.width;i.total=t.total;return i};l.prototype._sortByIndex=function(e,t){if(e.index!==undefined&&t.index===undefined){return-1}if(t.index!==undefined&&e.index===undefined){return 1}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0};l.prototype._applyChangesToUiTableType=function(e,t,n){var i=null;var o={};var l=this;var s=function(e,t){e.forEach(function(e){o[e.columnKey]=e});e.sort(l._sortByIndex);var n=e.map(function(e){return e.columnKey});t.forEach(function(e,t){if(n.indexOf(e)<0){n.splice(t,0,e)}});return n};var a=function(e,t){var n=o[e];if(n&&n.visible!==undefined&&t.getVisible()!==n.visible){t.setVisible(n.visible,true)}};var u=function(t,n,i){var o=e.indexOfColumn(i);var l=t;if(l!==undefined&&o!==l){if(o>-1){e.removeColumn(i,true)}e.insertColumn(i,l,true)}};var r=function(e,t){var n=o[e];if(n&&n.width!==undefined&&t.getWidth()!==n.width){t.setWidth(n.width,true)}};var m=function(e,t){var n=o[e];if(n&&n.total!==undefined&&t.getSummed&&t.getSummed()!==n.total){t.setSummed(n.total,true)}};if(t.columns.columnsItems.length){var c=s(t.columns.columnsItems,this.getColumnKeys());c.forEach(function(e,t){i=n[e];if(i){a(e,i);u(t,e,i);r(e,i);m(e,i)}})}var f=t.columns.fixedColumnCount||0;if(e.getFixedColumnCount&&e.getFixedColumnCount()!==f){e.setFixedColumnCount(f,true)}};l.prototype._applyChangesToMTableType=function(e,t,n){var i=false;var o=function(e,t){var n=e.index;if(n!==undefined){t.setOrder(n,true);i=true}};var l=function(e,t){if(e.visible!==undefined&&t.getVisible()!==e.visible){t.setVisible(e.visible,true);i=true}};var s=function(e,t){if(e.width!==undefined&&t.getWidth()!==e.width){t.setWidth(e.width)}};if(t.columns.columnsItems.length){t.columns.columnsItems.sort(function(e,t){if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0});t.columns.columnsItems.forEach(function(e){var t=n[e.columnKey];if(t){o(e,t);l(e,t);s(e,t)}},this)}if(i){e.invalidate()}};l.prototype.getChangeType=function(e,t){var i=this.getChangeData(e,t);var o=this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTriggerModelChangeOnColumnInvisible();if(i){var l=n.personalization.ChangeType.TableChanged;i.columns.columnsItems.some(function(e){if(e.visible||e.visible===false&&o){l=n.personalization.ChangeType.ModelChanged;return true}if(e.total===false||e.total===true){l=n.personalization.ChangeType.ModelChanged;return true}});return l}return n.personalization.ChangeType.Unchanged};l.prototype.getChangeData=function(e,t){if(!t||!t.columns||!t.columns.columnsItems){return null}var n={columns:i.copy(e.columns)};var o=true;o=e.columns.fixedColumnCount===t.columns.fixedColumnCount;e.columns.columnsItems.some(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.columns.columnsItems);if(!i.semanticEqual(e,n)){o=false;return true}});if(o){return null}var l=[];n.columns.columnsItems.forEach(function(e,n){var o=i.getArrayElementByKey("columnKey",e.columnKey,t.columns.columnsItems);if(i.semanticEqual(e,o)){l.push(e);return}for(var s in e){if(s==="columnKey"||!o){if(o&&o[s]===undefined){delete e[s]}else{continue}}if(e[s]===o[s]){delete e[s]}}if(Object.keys(e).length<2){l.push(e)}});l.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.columns.columnsItems);n.columns.columnsItems.splice(t,1)});if(n.columns.fixedColumnCount===0){delete n.columns.fixedColumnCount}return n};l.prototype._sortArrayByPropertyName=function(e,t,n){var i=[];if(n===null||n===undefined){n=false}if(e&&e.length>0&&t!==undefined&&t!==null&&t!==""){if(n){i=o([],e)}else{i=e}i.sort(function(e,n){var i=e[t];var o=n[t];if(i<o||i!==undefined&&o===undefined){return-1}if(i>o||i===undefined&&o!==undefined){return 1}return 0})}return i};l.prototype.getUnionData=function(e,t){if(!t||!t.columns||!t.columns.columnsItems){return i.copy(e)}var n=i.copy(t);Object.keys(e.columns).forEach(function(t){if(Array.isArray(e.columns[t])){e.columns[t].forEach(function(e){var o=i.getArrayElementByKey("columnKey",e.columnKey,n.columns[t]);if(!o){n.columns[t].push(e);return}if(o.visible===undefined&&e.visible!==undefined){o.visible=e.visible}if(o.width===undefined&&e.width!==undefined){o.width=e.width}if(o.total===undefined&&e.total!==undefined){o.total=e.total}if(o.index===undefined&&e.index!==undefined){o.index=e.index}});return}if(n.columns[t]===undefined&&e.columns[t]!==undefined){n.columns[t]=e.columns[t]}},this);return n};l.prototype._enhanceForStableKeys=function(e,t){if(this.getStableColumnKeys().length>0&&this._checkFillRequired(e,t)){var n=this._getFilledArray(e,t);t.columns.columnsItems=n}return t};l.prototype._checkFillRequired=function(e,t){var n=t.columns.columnsItems.reduce(function(e,t){e[t.columnKey]=t;return e},{});var i=e.columns.columnsItems.some(function(e){return!n[e.columnKey]});return i};l.prototype._getFilledArray=function(e,t){var n=[];var i=e.columns.columnsItems.reduce(function(e,t){e[t.columnKey]=t;return e},{});for(var o=0;o<t.columns.columnsItems.length;o++){var l=t.columns.columnsItems[o];if(i[l.columnKey]){var s=l.index?l.index+this.getStableColumnKeys().length:o+this.getStableColumnKeys().length;i[l.columnKey]=l;i[l.columnKey].index=s}}Object.keys(i).forEach(function(e){n.push(i[e])});return n};l.prototype.fixConflictWithIgnore=function(e,t){if(!e||!e.columns||!e.columns.columnsItems||!t||!t.columns||!t.columns.columnsItems||!t.columns.columnsItems.length){return e}this._sortArrayByPropertyName(e.columns.columnsItems,"index");var n=false;t.columns.columnsItems.forEach(function(t){var o=i.getIndexByKey("columnKey",t.columnKey,e.columns.columnsItems);if(o<0||e.columns.columnsItems[o].index===undefined){return}if(o+1<=e.columns.columnsItems.length-1&&e.columns.columnsItems[o+1].index===e.columns.columnsItems[o].index||o-1>=0&&e.columns.columnsItems[o-1].index===e.columns.columnsItems[o].index){n=true}if(o+1<=e.columns.columnsItems.length-1&&e.columns.columnsItems[o+1].index===e.columns.columnsItems[o].index){var l=e.columns.columnsItems.splice(o,1);e.columns.columnsItems.splice(o+1,0,l[0])}});if(n){var o=-1;e.columns.columnsItems.forEach(function(e){if(e.index!==undefined){e.index=++o}})}};l.prototype.isColumnSelected=function(e,t){var n=i.getIndexByKey("columnKey",t,e.columnsItems);return n>-1?e.columnsItems[n].visible:false};l.prototype._monkeyPatchTable=function(e){if(this.getTableType()!==n.personalization.TableType.AnalyticalTable&&this.getTableType()!==n.personalization.TableType.Table&&this.getTableType()!==n.personalization.TableType.TreeTable){return}var t=this;var i=e.setFixedColumnCount.bind(e);var o=function(e,n){t._onColumnFixedCount(e);i(e,n)};if(e.setFixedColumnCount.toString()===o.toString()){return}e.setFixedColumnCount=o};l.prototype.exit=function(){e.prototype.exit.apply(this,arguments);var t=this.getTable();if(this.getTable()&&(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable)){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this)}};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Controller", ["sap/base/Log","sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/m/library","sap/ui/comp/library","./ColumnsController","./FilterController","./GroupController","./SortController","./DimeasureController","./SelectionController","./Util","./ChartWrapper","./SelectionWrapper","./ColumnHelper","sap/m/MessageStrip","sap/m/P13nDialog","./Validator","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/model/BindingMode"],function(t,jQuery,e,n,i,a,o,r,s,l,h,u,g,p,c,C,_,f,d,y,D){"use strict";var m=e.extend("sap.ui.comp.personalization.Controller",{constructor:function(t,n){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",interfaces:["sap.ui.mdc.p13n.AdaptationProvider"],properties:{setting:{type:"object",defaultValue:{}},resetToInitialTableState:{type:"boolean",defaultValue:true},columnKeys:{type:"string[]",defaultValue:[]}},associations:{table:{type:"object",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterP13nModelDataChange:{parameters:{persistentData:{type:"object"},persistentDataChangeType:{type:"sap.ui.comp.personalization.ChangeType"},runtimeDeltaData:{type:"object"},runtimeDeltaDataChangeType:{type:"sap.ui.comp.personalization.ChangeType"}}},requestColumns:{parameters:{columnKeys:{type:"string"}}},dialogAfterClose:{parameters:{cancel:{type:"boolean"}}},dialogAfterOpen:{},dialogConfirmedReset:{}}}});m.prototype.applySettings=function(t){e.prototype.applySettings.apply(this,arguments);this._initialize()};m.prototype._initialize=function(){this._bInitCalled=true;var t=this.getTable();if(!t){throw"The table instance should be passed into constructor."}this._createSettingCurrent(this.getSetting());var e=t.getColumns();if(!this.getColumnKeys().length){this.setProperty("columnKeys",u.getColumnKeys(e),true)}var n=this._createInternalModel(this.getColumnKeys());this._callControllers(this._oSettingCurrent,"initializeInternalModel",n);this._oColumnHelper=new c({callbackOnSetVisible:this._onSetVisible.bind(this),callbackOnSetSummed:this._onSetSummed.bind(this),callbackOnSetGrouped:t.fireGroup?this._onSetGrouped.bind(this):null});this._oColumnHelper.addColumns(e);this._callControllers(this._oSettingCurrent,"setColumnHelper",this._oColumnHelper);this._callControllers(this._oSettingCurrent,"setTriggerModelChangeOnColumnInvisible");this._callControllers(this._oSettingCurrent,"setTable",t);this._callControllers(this._oSettingCurrent,"setColumnKeys",this.getColumnKeys());this._callControllers(this._oSettingCurrent,"setIgnoreColumnKeys");this._callControllers(this._oSettingCurrent,"setStableColumnKeys");this._callControllers(this._oSettingCurrent,"checkConsistency");this._callControllers(this._oSettingCurrent,"calculateIgnoreData");var i=m._getOrderedColumnKeys(this._oColumnHelper.getColumnMap(),this.getColumnKeys());this._extendModelStructure(i);this._callControllers(this._oSettingCurrent,"calculateControlData");this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent()};m.prototype.init=function(){this._oDialog=null;this._bInitCalled=false;this._bSuspend=false;this._bUnconfirmedResetPressed=false;this._oColumnHelper=null;this._oSettingCurrent={}};m.prototype.setSetting=function(t){if(this._bInitCalled){throw"The setting instance should be passed only into constructor."}t=this.validateProperty("setting",t);this.setProperty("setting",t,true);return this};m.prototype.setResetToInitialTableState=function(t){if(this._bInitCalled){throw"The resetToInitialTableState property should be passed only into constructor."}t=this.validateProperty("resetToInitialTableState",t);this.setProperty("resetToInitialTableState",t,true);return this};m.prototype.setColumnKeys=function(e){if(this._bInitCalled){throw"The columnKeys array should be passed only into constructor."}e=this.validateProperty("columnKeys",e);var n=e.filter(function(n,i){var a=e.indexOf(n,i+1)>-1;if(a){t.warning("The provided columnKeys is inconsistent as columnKey "+n+" is not unique and therefore the duplicate entry is deleted from columnKeys.")}return!a});this.setProperty("columnKeys",n,true);return this};m.prototype.setTable=function(t){if(this._bInitCalled){throw"The table instance should be passed only into constructor."}this.setAssociation("table",t);return this};m.prototype._createSettingCurrent=function(t){var e=u.getTableType(this.getTable());var a,o;switch(e){case i.personalization.TableType.ChartWrapper:a=[n.P13nPanelType.dimeasure,n.P13nPanelType.sort,n.P13nPanelType.filter];break;case i.personalization.TableType.SelectionWrapper:a=[n.P13nPanelType.selection];break;default:a=[n.P13nPanelType.columns,n.P13nPanelType.sort,n.P13nPanelType.filter,n.P13nPanelType.group]}for(o in t){if(t[o].visible===false&&a.indexOf(o)>-1){a.splice(a.indexOf(o),1)}if(t[o].visible===true&&a.indexOf(o)<0){a.push(o)}}a.forEach(function(e){this._oSettingCurrent[e]={visible:true,controller:t[e]&&t[e].controller?t[e].controller:this._controllerFactory(e),payload:t[e]&&t[e].payload?t[e].payload:undefined,ignoreColumnKeys:t[e]&&t[e].ignoreColumnKeys?t[e].ignoreColumnKeys:[],triggerModelChangeOnColumnInvisible:t[e]&&t[e].triggerModelChangeOnColumnInvisible?t[e].triggerModelChangeOnColumnInvisible:undefined,createMessageStrip:t[e]&&t[e].createMessageStrip?t[e].createMessageStrip:undefined};if(e=="columns"){this._oSettingCurrent.columns.stableColumnKeys=t.stableColumnKeys}},this)};m.prototype._mixSetting=function(t,e){if(!e){return t}if(e.useAvailablePanels){return Object.assign(t,e)}for(var n in e){if(e[n].visible===true&&t[n]&&t[n].visible===true){e[n].controller=t[n].controller;e[n].payload=e[n].payload||t[n].payload}}return e};m.prototype.openLegacyDialog=function(t){this._suspendTable();this._prepareDialogUi();var e=this._mixSetting(this._oSettingCurrent,t);this._bCancelPressed=false;this._oDialog=new _(this.getId()+"-P13nDialog",{stretch:y.system.phone,showReset:t&&t.showReset!==undefined?t.showReset:true,showResetEnabled:{path:"$sapuicomppersonalizationBaseController>/isDirty"},initialVisiblePanelType:this._oInitialVisiblePanelType,validationExecutor:function(){var t=u.getTableType(this.getTable());var n=this._oColumnHelper.getColumnMap();var i=this._callControllers(e,"getUnionData",this._getControlDataInitial(),this._getControlDataReduce());return f.checkGroupAndColumns(t,e,n,i,[]).then(function(n){var i=this._callControllers(e,"getUnionData",this._getControlDataBase(),this._getControlDataReduce());var a=this._callControllers(e,"getUnionData",this._getControlDataInitial(),i);var o=this._callControllers(e,"getChangeData",a,this._getAlreadyKnownPersistentData());return f.checkSaveChanges(t,e,o,n)}.bind(this)).then(function(n){return f.checkChartConsistency(t,e,i,n)}).then(function(t){return t})}.bind(this)});this._oDialog.setModel(this._getInternalModel(),"$sapuicomppersonalizationBaseController");this._oDialog.toggleStyleClass("sapUiSizeCompact",!!jQuery(this.getTable().getDomRef()).closest(".sapUiSizeCompact").length);if(t&&t.contentWidth){this._oDialog.setContentWidth(t.contentWidth)}if(t&&t.contentHeight){this._oDialog.setContentHeight(t.contentHeight)}if(t&&t.styleClass){this._oDialog.addStyleClass(t.styleClass)}this._callControllers(this._oSettingCurrent,"setMessageStrip");var n=this._callControllers(e,"getPanel");var i=[];for(var a in n){if(n[a]){i.push(n[a])}}Promise.all(i).then(function(t){t.forEach(function(t){this._oDialog.addPanel(t)},this);this._oDialog.attachOk(this._handleDialogOk,this);this._oDialog.attachCancel(this._handleDialogCancel,this);this._oDialog.attachReset(this._handleDialogReset,this);this._oDialog.attachAfterClose(this._handleDialogAfterClose,this);this._oDialog.isPopupAdaptationAllowed=function(){return false};this._oDialog.setEscapeHandler(function(){this._handleDialogCancel().bind(this)}.bind(this));this._oDialog.open();this.fireDialogAfterOpen()}.bind(this))};m.prototype.getUISettings=function(){var t=this._oUISetting;var e=this._callControllers(t,"retrieveAdaptationUI");var n={resetEnabled:t.showReset,contentHeight:t.contentHeight,contentWidth:t.contentWidth};var i=[];var a=Object.keys(e);var o=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");var r={columns:o.getText("p13nDialog.TAB_Column"),dimeasure:o.getText("p13nDialog.TAB_Chart"),filter:o.getText("p13nDialog.TAB_Filter"),sort:o.getText("p13nDialog.TAB_Sort"),group:o.getText("p13nDialog.TAB_Group"),selection:o.getText("info.SELECTION_DIALOG_ALIGNEDTITLE")};var s=this._callControllers(t,"getResetWarningText");a.forEach(function(t){var a=r[t];var o=e[t];n[t]={resetEnabled:true,adaptationUI:o instanceof Promise?o:Promise.resolve(),reset:{warningText:s[t]},containerSettings:{title:a,tabText:a,contentHeight:n.contentHeight,contentWidth:n.contentWidth}};i.push(e[t])},this);Promise.all(i).then(function(t){this._callControllers(this._oSettingCurrent,"setModelFunction")}.bind(this));return n};m.prototype.initAdaptation=function(){return Promise.resolve()};m.prototype.reset=function(e,n){this._resetMessageStrip();return new Promise(function(n){this.resetPersonalization();this._syncDialogUi();this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",this._getControlDataBase());for(var i in this._oSettingCurrent){var a=this._oSettingCurrent[i].controller;if(a&&a.getAdaptationUI()&&a.getAdaptationUI().setP13nData){a.getAdaptationUI().setP13nData(a.getAdaptationData())}}return new Promise(function(n){if(e){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(i){return i.discardChangesForControl(e._container).then(function(){n(true)},function(e){t.error("Changes could not be discarded in LRep: "+e);n(false)})})})}else{n(false)}}).then(function(){this._syncDialogUi();for(var t in this._oSettingCurrent){var e=this._oSettingCurrent[t].controller;if(e&&e.getAdaptationUI()&&e.getAdaptationUI().setP13nData){e.getAdaptationUI().setP13nData(e.getAdaptationData())}}n()}.bind(this))}.bind(this))};m.prototype.validateP13n=function(t,e,n){var i=u.getTableType(this.getTable());var a=this._oColumnHelper.getColumnMap();var o=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),this._getControlDataReduce());return f.checkGroupAndColumns(i,this._oSettingCurrent,a,o,[]).then(function(t){return f.checkChartConsistency(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){return f.checkVisibleItemsThreshold(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){if(t.length>0){t.forEach(function(t){for(var e in this._oSettingCurrent){var n=this._oSettingCurrent[e].controller;if(t.panelTypes.indexOf(e)>-1&&n){n.getAdaptationUI().setMessageStrip(new C({type:t.messageType,text:t.messageText}))}}}.bind(this))}else{this._resetMessageStrip()}}.bind(this))};m.prototype.preparePersonalization=function(){this._prepareDialogUi()};m.prototype.openDialog=function(t){this._suspendTable();this._prepareDialogUi();this._oUISetting=this._mixSetting(this._oSettingCurrent,t);this._callControllers(this._oSettingCurrent,"setMessageStrip");var e=Object.keys(this._getControllers());var n=Object.assign([],e);if(t&&t.useAvailablePanels!==true){var i=Object.keys(t);e.forEach(function(t,e){if(i.indexOf(t)<0){n.splice(n.indexOf(t),1)}})}return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(t,e){sap.ui.require(["sap/ui/comp/personalization/UIManager"],function(e){t(e)},e)})}).then(function(e){if(!this._oUIManager){this._oUIManager=new e(this)}return this._oUIManager.show(this.getTable(),n).then(function(e){if(e.getCustomHeader()){var i=e.getCustomHeader().getContentRight()[0];if(i){i.bindProperty("enabled",{model:"$sapmP13nPanel",path:"/isDirty",formatter:function(t){return!!t}})}}e.getButtons()[1].attachPress(this._handleDialogCancel,this);e.attachAfterClose(this._handleDialogAfterClose,this);e.setEscapeHandler(function(t){this._handleDialogCancel();t.resolve()}.bind(this));if(n.length>1&&this._sActivePanel){e.getContent()[0].switchView(this._sActivePanel)}if(t&&t.styleClass){e.addStyleClass(t.styleClass)}e.setModel(this._getInternalModel(),"$sapmP13nPanel");this._oDialog=e;this.fireDialogAfterOpen();return e}.bind(this))}.bind(this))};m.prototype.addColumns=function(t){var e=this.getTable();Object.keys(t).forEach(function(n){if(!t[n].getParent()){e.addDependent(t[n])}});this._oColumnHelper.addColumnMap(t)};m.prototype.getDataSuiteFormatSnapshot=function(){this._callControllers(this._oSettingCurrent,"calculateControlData");var t={};this._callControllers(this._oSettingCurrent,"getDataSuiteFormatSnapshot",t);return t};m.prototype.setDataSuiteFormatSnapshot=function(t,e,n){if(n){u.convertSelectOptions(t,this._oColumnHelper.getColumnMap());u.convertFilters(e,this._oColumnHelper.getColumnMap())}var i=this._callControllers(this._oSettingCurrent,"getDataSuiteFormat2Json",t);this._setRuntimeAndPersonalizationData(i,e)};m.prototype.setPersonalizationDataAsDataSuiteFormat=function(t,e){if(e){u.convertSelectOptions(t,this._oColumnHelper.getColumnMap())}var n=this._callControllers(this._oSettingCurrent,"getDataSuiteFormat2Json",t);this._setRuntimeAndPersonalizationData(n,n)};m.prototype.setPersonalizationData=function(t,e){if(e){u.convertFilters(t,this._oColumnHelper.getColumnMap())}this._setRuntimeAndPersonalizationData(t,t)};m.prototype._resetFilters=function(t){var e,n,i,a=this._oSettingCurrent&&this._oSettingCurrent.filter&&this._oSettingCurrent.filter.controller,o=this._getVariantData()&&this._getVariantData().filter&&this._getVariantData().filter.filterItems,r=this._getControlDataInitial()&&this._getControlDataInitial().filter&&this._getControlDataInitial().filter.filterItems;if(a){n=a.oFilterProvider;i=a.oMDCFilterPanel}if(n&&i&&this._oDialog&&this._oDialog.isOpen()){if(t){if(!this._getControlDataInitial()){n.clear();e=e.map(function(t){t.active=false;return t});i.setP13nData(e)}else{this._resetToState(r,n,a,i)}}else{this._resetToState(o,n,a,i)}}};m.prototype._resetToState=function(t,e,n,i){var a,o,r,s,l,h,u,g=i.getP13nData();if(g&&t){for(a=0;a<g.length;a++){s=g[a];h=s.name;s.active=false;l=e._getFieldMetadata(h);e._createInitialModelForField({},l);u=n._getControlByName(h);if(u&&u.setValue){u.setValue(null)}for(o=0;o<t.length;o++){r=t[o];if(r.columnKey===h){s.active=true;break}}}i.setP13nData(g);n._updateFilterData(t)}};m.prototype.resetPersonalization=function(t){t=this._determineResetType(t);if(t===i.personalization.ResetType.ResetFull){this._resetFull();this._resetFilters(true)}else{this._resetPartial();this._resetFilters(false)}this._setRuntimeAndPersonalizationData(this._getControlDataBase(),this._getVariantData())};m.prototype.addToSettingIgnoreColumnKeys=function(t){if(this._isEqualAdditionalIgnoreColumnKeys(t)){return this}this._callControllers(this._oSettingCurrent,"setAdditionalIgnoreColumnKeys",t);this._callControllers(this._oSettingCurrent,"calculateIgnoreData");this._requestMissingColumnsWithoutIgnore(this._getControlDataBase());this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent();return this};m.prototype._handleDialogReset=function(){this._bUnconfirmedResetPressed=true;var t=this._determineResetType();if(t===i.personalization.ResetType.ResetFull){this._resetFull()}else{this._resetPartial()}this._syncDialogUi()};m.prototype._handleDialogOk=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.detachOk(this._handleDialogOk,this)}if(this._bUnconfirmedResetPressed){this.fireDialogConfirmedReset()}setTimeout(function(){this._postDialogUi(this._getControlDataReduce());this._syncTableUi();var t=function(t){var e=false;for(var n in this._oSettingCurrent){e=e||t.getParameter("runtimeDeltaDataChangeType")[n]==="ModelChanged";if(e){break}}var i=!e;this._resumeTable(i)};this.attachEventOnce("afterP13nModelDataChange",t,this);this._fireChangeEvent()}.bind(this),0);if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.close()}};m.prototype.handleP13n=function(){return new Promise(function(t){var e=this._oDialog.getContent()[0];if(e.isA("sap.m.p13n.Container")){this._sActivePanel=e.getCurrentViewKey()}var n=u.getTableType(this.getTable());var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataBase(),this._getControlDataReduce());var a=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),i);var o=this._callControllers(this._oSettingCurrent,"getChangeData",a,this._getAlreadyKnownPersistentData());this._handleDialogOk(true);return f.checkSaveChanges(n,this._oSettingCurrent,o,[]).then(function(){t()})}.bind(this))};m.prototype._handleDialogCancel=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.detachCancel(this._handleDialogCancel,this)}setTimeout(function(){this._postDialogUi(this._getBeforeOpenData());this._resumeTable(false);this._callControllers(this._oSettingCurrent,"calculateControlData")}.bind(this),0);this._bCancelPressed=true;if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.close()}};m.prototype._handleDialogAfterClose=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oInitialVisiblePanelType=this._oDialog.getVisiblePanel()?this._oDialog.getVisiblePanel().getType():this._getInitialVisiblePanelType()}this._bUnconfirmedResetPressed=false;this.fireDialogAfterClose({cancel:this._bCancelPressed});if(this._oDialog){this._oDialog.destroy();this._oDialog=null}};m.prototype._getInitialVisiblePanelType=function(){for(var t in this._oSettingCurrent){return t}};m.prototype._suspendTable=function(){if(u.getTableBaseType(this.getTable())===i.personalization.TableType.Table){this._bSuspend=true}};m.prototype._resumeTable=function(t){t=t===undefined?true:t;var e=this.getTable();if(this._bSuspend){if(e){if(t){e.invalidate()}}this._bSuspend=false}};m.prototype._requestMissingColumnsWithoutIgnore=function(t){var e=this._callControllers(this._oSettingCurrent,"determineMissingColumnKeys",t);var n=u.getUnionOfColumnKeys(e);if(!n.length){return[]}this.fireRequestColumns({columnKeys:n});return n};m.prototype._extendModelStructure=function(t){if(!t.length){return}var e=this._callControllers(this._oSettingCurrent,"createColumnKeysStructure",t);var n=this._callControllers(this._oSettingCurrent,"getTable2Json",e);this._callControllers(this._oSettingCurrent,"extendControlDataInitial",n);this._callControllers(this._oSettingCurrent,"extendVariantDataInitial",n);this._callControllers(this._oSettingCurrent,"extendControlDataBase",n);this._callControllers(this._oSettingCurrent,"extendAlreadyKnownRuntimeData",n);this._callControllers(this._oSettingCurrent,"extendAlreadyKnownPersistentData",n)};m.prototype._setRuntimeAndPersonalizationData=function(t,e){t=t===null?{}:t;if(!this._sanityCheck(t)){return}e=e===null?{}:e;if(!this._sanityCheck(e)){return}this._setVariantData(e);this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));var n=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),e);this._callControllers(this._oSettingCurrent,"setVariantDataInitial2Model",n);var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),t);this._callControllers(this._oSettingCurrent,"fixConflictWithIgnore",i,this._getIgnoreData());this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",i);for(var a in this._oSettingCurrent){this._calculateChangeType(a,i)}this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent()};m.prototype._prepareDialogUi=function(){var t=this._callControllers(this._oSettingCurrent,"createColumnKeysStructure",this.getColumnKeys());this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",this._getControlDataBase());this._callControllers(this._oSettingCurrent,"calculateControlDataReduce");var e=this._callControllers(this._oSettingCurrent,"getTable2JsonTransient",t);this._callControllers(this._oSettingCurrent,"calculateTransientData",e);this._callControllers(this._oSettingCurrent,"calculatePropertyInfo",e)};m.prototype._postDialogUi=function(t){this._callControllers(this._oSettingCurrent,"updateControlDataBaseFromJson",t);this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",undefined);this._callControllers(this._oSettingCurrent,"setControlDataReduce2Model",undefined);this._callControllers(this._oSettingCurrent,"setTransientData2Model",undefined)};m.prototype._syncDialogUi=function(){this._callControllers(this._oSettingCurrent,"calculateControlDataReduce")};m.prototype._syncTableUi=function(){this._callControllers(this._oSettingCurrent,"calculateControlData");this._callControllers(this._oSettingCurrent,"syncJson2Table",this._getControlData())};m.prototype._resetFull=function(){this._setVariantData(undefined);this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",this._getControlDataInitial())};m.prototype._resetPartial=function(){this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",this._getVariantDataInitial())};m.prototype._calculateChangeType=function(t,e){var n={};n[t]=this._oSettingCurrent[t];this._callControllers(n,"calculatePersistentChangeTypesFromJson",e,this._determineResetType());var a=this._getPersistentDataChangeType();var o=false;for(t in this._oSettingCurrent){if(a[t]!==i.personalization.ChangeType.Unchanged){o=true}}this._setIsDirty(o)};m.prototype._fireChangeEvent=function(t){var e={};var n=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),this._getControlData());e.runtimeDeltaDataChangeType=this._callControllers(this._oSettingCurrent,"getChangeType",n,this._getAlreadyKnownRuntimeData());e.persistentDeltaDataChangeType=this._getPersistentDeltaDataChangeType();e.persistentDataChangeType=this._getPersistentDataChangeType();if(!u.hasChangedType(e.runtimeDeltaDataChangeType)&&!u.hasChangedType(e.persistentDeltaDataChangeType)){return}var i=this._callControllers(this._oSettingCurrent,"getChangeData",n,this._getAlreadyKnownRuntimeData());e.runtimeDeltaData=u.removeEmptyProperty(u.copy(i));var a=this._callControllers(this._oSettingCurrent,"getChangeData",this._getControlDataBase(),this._getControlDataInitial());e.persistentData=u.removeEmptyProperty(a);this._callControllers(this._oSettingCurrent,"setAlreadyKnownRuntimeData2Model",this._getControlData());this._callControllers(this._oSettingCurrent,"setAlreadyKnownPersistentData2Model",this._getControlDataBase());delete e.persistentDeltaDataChangeType;this.fireAfterP13nModelDataChange(e)};m.prototype._onSetVisible=function(t,e){if(t){var n=u.getUnionOfAttribute(this._oSettingCurrent,"ignoreColumnKeys");if(n.indexOf(e)>-1){throw"The provided 'ignoreColumnKeys' are inconsistent. No column specified as ignored is allowed to be visible. "+this}}};m.prototype._onSetSummed=function(t,e){this._oSettingCurrent.columns.controller._onColumnTotal({column:e,isSummed:t})};m.prototype._onSetGrouped=function(t,e){this._oSettingCurrent.group.controller._setGroup(t,e)};m.prototype._getArgumentsByType=function(t,e){var n=[],i=null;if(t&&t.length&&e){t.forEach(function(t){if(t&&t[e]&&typeof t[e]!=="function"){i={};i[e]=t[e];n.push(i)}else{n.push(t)}})}return n};m.prototype._callControllers=function(t,e){var n,i,a;var o={},r=Array.prototype.slice.call(arguments,2);for(var s in t){n=i=a=null;n=t[s];i=n.controller;if(!i||!n.visible||!i[e]){continue}a=this._getArgumentsByType(r,s);if(e==="getPanel"||e==="retrieveAdaptationUI"){a.push(n.payload)}else if(e==="setIgnoreColumnKeys"){a.push(n.ignoreColumnKeys)}else if(e==="setTriggerModelChangeOnColumnInvisible"){a.push(n.triggerModelChangeOnColumnInvisible)}if(e==="setStableColumnKeys"&&s=="columns"){a.push(t.columns.stableColumnKeys)}if(e==="setMessageStrip"&&n.createMessageStrip){var l=n.createMessageStrip();a.push(l)}var h=i[e].apply(i,a);if(h!==null&&h!==undefined&&h[s]!==undefined){o[s]=h[s]}else{o[s]=h}}return o};m.prototype._sanityCheck=function(t){return true};m.prototype._createInternalModel=function(t){var e=new d;e.setDefaultBindingMode(D.TwoWay);e.setSizeLimit(1e4);this.setModel(e,"$sapuicomppersonalizationBaseController");return e};m.prototype._getInternalModel=function(){return this.getModel("$sapuicomppersonalizationBaseController")};m.prototype._getInternalModelData=function(t){return this._getInternalModel().getProperty("/"+t)};m.prototype._getControlDataInitial=function(){return this._getInternalModelData("controlDataInitial")};m.prototype._getControlDataBase=function(){return this._getInternalModelData("controlDataBase")};m.prototype._getIgnoreData=function(){return this._getInternalModelData("ignoreData")};m.prototype._getPersistentDataChangeType=function(){return this._getInternalModelData("persistentDataChangeType")};m.prototype._getPersistentDeltaDataChangeType=function(){return this._getInternalModelData("persistentDeltaDataChangeType")};m.prototype._getControlData=function(){return this._getInternalModelData("controlData")};m.prototype._getControlDataReduce=function(){return this._getInternalModelData("controlDataReduce")};m.prototype._getTransientData=function(){return this._getInternalModelData("transientData")};m.prototype._getAlreadyKnownRuntimeData=function(){return this._getInternalModelData("alreadyKnownRuntimeData")};m.prototype._getAlreadyKnownPersistentData=function(){return this._getInternalModelData("alreadyKnownPersistentData")};m.prototype._getVariantDataInitial=function(){return this._getInternalModelData("variantDataInitial")};m.prototype._getBeforeOpenData=function(){return this._getInternalModelData("beforeOpenData")};m.prototype._setVariantData=function(t){this._getInternalModel().setProperty("/variantData",t?u.copy(t):undefined)};m.prototype._setIsDirty=function(t){this._getInternalModel().setProperty("/isDirty",t)};m.prototype._getVariantData=function(){return this._getInternalModel().getProperty("/variantData")};m.prototype._getControllers=function(){var t={};Object.keys(this._oSettingCurrent).forEach(function(e){var n=this._oSettingCurrent[e];if(n.hasOwnProperty("controller")){t[e]=n}}.bind(this));return t};m.prototype._controllerFactory=function(t){var e=this;switch(t){case n.P13nPanelType.columns:return new a({afterColumnsModelDataChange:function(){var t=this.mEventRegistry.afterColumnsModelDataChange[0].fFunction;this.detachAfterColumnsModelDataChange(t);e._syncTableUi();this.attachAfterColumnsModelDataChange(t);e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.sort:return new s({afterSortModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.filter:return new o({afterFilterModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.group:return new r({afterGroupModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.dimeasure:return new l({afterDimeasureModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.selection:return new h({afterSelectionModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});default:throw"Panel type '"+t+"' is not valid"}};m.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=sap.ui.getCore().byId(t)}return t};m._getOrderedColumnKeys=function(t,e){var n=Object.keys(t);return e.reduce(function(t,e){if(n.indexOf(e)>-1){t.push(e)}return t},[])};m.prototype.exit=function(){var t;this._resumeTable(false);if(this._oDialog){this._oDialog.destroy();this._oDialog=null}if(this._oUIManager){this._oUIManager.destroy();this._oUIManager=null}this._oUISetting=null;this._callControllers(this._oSettingCurrent,"destroy");for(t in this._oSettingCurrent){this._oSettingCurrent[t]=null}this._oSettingCurrent=null;this._oColumnHelper=null};m.prototype._determineResetType=function(t){t=t||(this.getResetToInitialTableState()?i.personalization.ResetType.ResetFull:i.personalization.ResetType.ResetPartial);if(t===i.personalization.ResetType.ResetFull||this._getVariantData()===undefined){return i.personalization.ResetType.ResetFull}return i.personalization.ResetType.ResetPartial};m.prototype._isEqualAdditionalIgnoreColumnKeys=function(t){var e=this._callControllers(this._oSettingCurrent,"isEqualAdditionalIgnoreColumnKeys",t);var n=true;for(var i in e){n=n&&e[i]}return n};m.prototype._resetMessageStrip=function(t){for(var e in this._oSettingCurrent){var n=this._oSettingCurrent[e].controller;if(n&&n.getAdaptationUI()&&n.getAdaptationUI().isA("sap.m.p13n.BasePanel")){n.getAdaptationUI().setMessageStrip(undefined)}}};m.SyncReason={ResetFull:14,ResetPartial:15,NewModelDataMixedWithVariant:7};return m});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/DimeasureController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/comp/odata/ChartMetadata","sap/m/MessageStrip"],function(e,t,i,a,n,r){"use strict";var o=e.extend("sap.ui.comp.personalization.DimeasureController",{constructor:function(i,a){e.apply(this,arguments);this.setType(t.P13nPanelType.dimeasure);this.setItemType(t.P13nPanelType.dimeasure+"Items");this.CHARTLAYOUT_AXIS1="axis1";this.CHARTLAYOUT_AXIS2="axis2";this.CHARTLAYOUT_AXIS3="axis3";this.CHARTLAYOUT_CATEGORY="category";this.CHARTLAYOUT_CATEGORY2="category2";this.CHARTLAYOUT_SERIES="series"},metadata:{events:{afterDimeasureModelDataChange:{}}}});o.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()!==i.personalization.TableType.ChartWrapper){throw"The provided object is incorrect. 'oTable' has to be an instance of sap.ui.comp.personalization.ChartWrapper. "}var a=t.getChartObject();a.detachDrilledDown(this._onDrilledDown,this);a.attachDrilledDown(this._onDrilledDown,this);a.detachDrilledUp(this._onDrilledUp,this);a.attachDrilledUp(this._onDrilledUp,this);this._monkeyPatchTable(a)};o.prototype._monkeyPatchTable=function(e){var t=this;var i=e.setChartType.bind(e);var a=function(e){i(e);t._onSetChartType(e)};if(e.setChartType.toString()===a.toString()){return}e.setChartType=a};o.prototype._onSetChartType=function(e){var t=this.getControlData();if(!e||e===t.dimeasure.chartTypeKey){return}this.fireBeforePotentialTableChange();t.dimeasure.chartTypeKey=e;this.updateControlDataBaseFromJson(t);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};o.prototype._onDrilledDown=function(e){this.fireBeforePotentialTableChange();this._addVisibleDimensions(e.getParameter("dimensions")||[]);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};o.prototype._addVisibleDimensions=function(e){if(!e.length){return}var t=this.getControlData();var n=t.dimeasure.dimeasureItems.filter(function(t){return t.visible&&t.aggregationRole===i.personalization.AggregationRole.Dimension&&e.indexOf(t.columnKey)<0}).reduce(function(e,t){return t.columnKey},"");e.forEach(function(e){var i=a.getIndexByKey("columnKey",n,t.dimeasure.dimeasureItems)+1;var r=a.getIndexByKey("columnKey",e,t.dimeasure.dimeasureItems);n=e;if(r<0||i<0||r>t.dimeasure.dimeasureItems.length-1||i>t.dimeasure.dimeasureItems.length-1){return}var o=t.dimeasure.dimeasureItems.splice(r,1);o[0].visible=true;t.dimeasure.dimeasureItems.splice(i,0,o[0]);var s=-1;t.dimeasure.dimeasureItems.forEach(function(e){if(e.index!==undefined){e.index=++s}});this.updateControlDataBaseFromJson(t)},this)};o.prototype._onDrilledUp=function(e){this.fireBeforePotentialTableChange();var t=this.getControlData();var i=e.getParameter("dimensions")||[];i.forEach(function(e){var i=a.getArrayElementByKey("columnKey",e,t.dimeasure.dimeasureItems);if(!i){throw"No entry found in 'controlDataBase' for columnKey '"+e+"'"}i.visible=false;this.updateControlDataBaseFromJson(t)},this);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};o.prototype.getColumn2Json=function(e,t,i){if(!a.isAggregatable(e)){return null}return{columnKey:t,index:i,visible:e.getVisible(),role:e.getRole(),aggregationRole:e.getAggregationRole()}};o.prototype.getAdditionalData2Json=function(e,t){var i=t.getChartObject();e.dimeasure.chartTypeKey=i.getChartType()};o.prototype.getColumn2JsonTransient=function(e,t,i,n){if(!a.isAggregatable(e)){return null}return{columnKey:t,text:i,tooltip:n!==i?n:undefined,aggregationRole:e.getAggregationRole()}};o.prototype.handleIgnore=function(e,t){e.dimeasure.dimeasureItems[t].visible=false};o.prototype.syncJson2Table=function(e){var t=this.getTable().getChartObject();var n=function(e,t,i,n){var r=a.copy(e);r.sort(o._sortByIndex);var s=[];r.forEach(function(e){if(e.visible===true){s.push(e.columnKey);var t=n(e.columnKey);if(t){t.setRole(e.role)}}});if(JSON.stringify(s)!==JSON.stringify(t)){i(s,true)}};this.fireBeforePotentialTableChange();var r=e.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Dimension});var s=e.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Measure});var u=t.getVisibleDimensions();n(r,u,t.setVisibleDimensions.bind(t),t.getDimensionByName.bind(t));var l=t.getVisibleMeasures();n(s,l,t.setVisibleMeasures.bind(t),t.getMeasureByName.bind(t));t.setChartType(e.dimeasure.chartTypeKey);this.fireAfterPotentialTableChange()};o.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();var r=function(e,i,n){var r=a.getIndexByKey("columnKey",e,t.dimeasure.dimeasureItems);if(r<0){r=t.dimeasure.dimeasureItems.length;t.dimeasure.dimeasureItems.splice(r,0,{columnKey:e})}t.dimeasure.dimeasureItems[r][i]=n};this.getControlDataInitial().dimeasure.dimeasureItems.filter(function(e){return e.visible===true}).forEach(function(e){r(e.columnKey,"visible",false)});if(e.Visualizations&&e.Visualizations.length){var o=e.Visualizations.filter(function(e){return e.Type==="Chart"});if(o.length){var s=0;if(o[0].Content.Dimensions.length){s=o[0].Content.Dimensions.length;o[0].Content.Dimensions.forEach(function(e,t){var s=a.getArrayElementByKey("Dimension",e,o[0].Content.DimensionAttributes);r(e,"visible",true);r(e,"index",t);if(s&&s.Role){r(e,"role",n.getDimensionRole(s.Role))}r(e,"aggregationRole",i.personalization.AggregationRole.Dimension)},this)}if(o[0].Content.Measures.length){o[0].Content.Measures.forEach(function(e,t){var u=a.getArrayElementByKey("Measure",e,o[0].Content.MeasureAttributes);r(e,"visible",true);r(e,"index",s+t);if(u&&u.Role){r(e,"role",n.getMeasureRole(u.Role))}r(e,"aggregationRole",i.personalization.AggregationRole.Measure)},this)}}t.dimeasure.chartTypeKey=n.getChartType(o[0].Content.ChartType)}return t};o.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.dimeasure||!t.dimeasure.dimeasureItems||!t.dimeasure.dimeasureItems.length){return}var a=t.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Dimension}).filter(function(e){return e.visible===true});var r=t.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Measure}).filter(function(e){return e.visible===true});if(a.length||r.length){if(!e.Visualizations){e.Visualizations=[]}e.Visualizations.push({Type:"Chart",Content:{ChartType:n.getAnnotationChartType(t.dimeasure.chartTypeKey),Dimensions:a.sort(function(e,t){return e.index-t.index}).map(function(e){return e.columnKey}),DimensionAttributes:a.sort(function(e,t){return e.index-t.index}).map(function(e){return{Dimension:e.columnKey,Role:n.getAnnotationDimensionRole(e.role)}}),Measures:r.sort(function(e,t){return e.index-t.index}).map(function(e){return e.columnKey}),MeasureAttributes:r.sort(function(e,t){return e.index-t.index}).map(function(e){return{Measure:e.columnKey,Role:n.getAnnotationMeasureRole(e.role)}})}})}};o.prototype.getPanel=function(e){if(!a.hasAggregatableColumns(this.getColumnMap())){return null}var t=e&&e.availableChartTypes?e.availableChartTypes:[];return new Promise(function(e){sap.ui.require(["sap/m/P13nDimMeasurePanel","sap/m/P13nItem","sap/m/P13nDimMeasureItem","sap/ui/core/ResizeHandler"],function(i,n,r,o){var s=new i({availableChartTypes:t,chartTypeKey:"{$sapmP13nPanel>/controlDataReduce/dimeasure/chartTypeKey}",items:{path:"$sapmP13nPanel>/transientData/dimeasure/dimeasureItems",template:new n({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}",aggregationRole:"{$sapmP13nPanel>aggregationRole}"})},dimMeasureItems:{path:"$sapmP13nPanel>/controlDataReduce/dimeasure/dimeasureItems",template:new r({columnKey:"{$sapmP13nPanel>columnKey}",index:"{$sapmP13nPanel>index}",visible:"{$sapmP13nPanel>visible}",role:"{$sapmP13nPanel>role}"})},beforeNavigationTo:this.setModelFunction(),changeChartType:function(e){var t=this.getControlDataReduce();t.dimeasure.chartTypeKey=e.getParameter("chartTypeKey");this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this),changeDimMeasureItems:function(e){if(!e.getParameter("items")){return}var t=e.getParameter("items");var i=this.getControlDataReduce();i.dimeasure.dimeasureItems.forEach(function(e){var i=a.getArrayElementByKey("columnKey",e.columnKey,t);if(!i){return}e.index=i.index;e.visible=i.visible;e.role=i.role});this.setControlDataReduce2Model(i);this.fireAfterPotentialModelChange({json:i})}.bind(this)});o.deregister(s._sContainerResizeListener);return e(s)}.bind(this))}.bind(this))};o.prototype.getChartTypeLayoutConfig=function(){if(this._aChartTypeLayout){return this._aChartTypeLayout}var e=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];var t=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];var i=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_CATEGORY2];var a=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_AXIS3,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];this._aChartTypeLayout=[{key:"column",allowedLayoutOptions:e},{key:"bar",allowedLayoutOptions:e},{key:"line",allowedLayoutOptions:e},{key:"combination",allowedLayoutOptions:e},{key:"pie",allowedLayoutOptions:e},{key:"donut",allowedLayoutOptions:e},{key:"dual_column",allowedLayoutOptions:t},{key:"dual_bar",allowedLayoutOptions:t},{key:"dual_line",allowedLayoutOptions:t},{key:"stacked_bar",allowedLayoutOptions:e},{key:"scatter",allowedLayoutOptions:t},{key:"bubble",allowedLayoutOptions:a},{key:"heatmap",allowedLayoutOptions:i},{key:"bullet",allowedLayoutOptions:e},{key:"vertical_bullet",allowedLayoutOptions:e},{key:"dual_stacked_bar",allowedLayoutOptions:t},{key:"100_stacked_bar",allowedLayoutOptions:e},{key:"stacked_column",allowedLayoutOptions:e},{key:"dual_stacked_column",allowedLayoutOptions:t},{key:"100_stacked_column",allowedLayoutOptions:e},{key:"dual_combination",allowedLayoutOptions:t},{key:"dual_horizontal_combination",allowedLayoutOptions:t},{key:"dual_horizontal_combination",allowedLayoutOptions:t},{key:"dual_stacked_combination",allowedLayoutOptions:t},{key:"dual_horizontal_stacked_combination",allowedLayoutOptions:t},{key:"stacked_combination",allowedLayoutOptions:e},{key:"100_dual_stacked_bar",allowedLayoutOptions:e},{key:"100_dual_stacked_column",allowedLayoutOptions:e},{key:"horizontal_stacked_combination",allowedLayoutOptions:e},{key:"waterfall",allowedLayoutOptions:i},{key:"horizontal_waterfall",allowedLayoutOptions:i}];return this._aChartTypeLayout};o.prototype._getTimeseriesSpecificPanelLayout=function(e){if(e.includes("timeseries")){var t=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];this._aChartTypeLayoutTimeseries=[{key:"timeseries_scatter",allowedLayoutOptions:t}];var i=this._aChartTypeLayoutTimeseries.find(function(t){return t.key===e});if(i){return i}else{var a=e.replace("timeseries_","");return this.getChartTypeLayoutConfig().find(function(e){return e.key===a})}}return undefined};o.prototype.retrieveAdaptationUI=function(e){function t(e,t){if(!e.hasOwnProperty("index")||!t.hasOwnProperty("index")){return 0}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0}var i;var n=new Promise(function(e,t){i=e});sap.ui.require(["sap/ui/mdc/p13n/panels/ChartItemPanel"],function(e){var n,o=this.getControlDataReduce().dimeasure.chartTypeKey;var s=[{kind:"Dimension"},{kind:"Measure"}];if(o.includes("timeseries")){n=this._getTimeseriesSpecificPanelLayout(o)}if(!n){n=this.getChartTypeLayoutConfig().find(function(e){return e.key===o})}if(!n){var u=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_AXIS3,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_CATEGORY2,this.CHARTLAYOUT_SERIES];n={key:o,allowedLayoutOptions:u}}n.templateConfig=s;var l=new e({panelConfig:n,changeItems:function(e){if(!e.getParameter("items")){return}var t=e.getParameter("items");var i=this.getControlDataReduce();i.dimeasure.dimeasureItems.forEach(function(e){var i=a.getArrayElementByKey("columnKey",e.columnKey,t);if(!i){return}e.index=i.index;e.visible=i.visible;e.role=i.role});this.setControlDataReduce2Model(i);this.fireAfterPotentialModelChange({json:i})}.bind(this)});var d=this.getAdaptationData().sort(t);l.setP13nData(d);this.oPanel=l;if(o==="heatmap"||o==="timeseries_heatmap"){var m=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");l.setMessageStrip(new r({text:m.getText("chart.PERSONALIZATION_DIALOG_MEASURE_WARNING"),type:"Warning"}))}i(l)}.bind(this));return n};o.prototype._transformAdaptationData=function(t,i){var a=e.prototype._transformAdaptationData.apply(this,arguments);a.visible=t.visible;a.role=t.role;a.kind=t.aggregationRole;a.index=t.index;return a};o.prototype._isDimMeasureItemEqual=function(e,t){if(!e&&!t){return true}if(e&&!t){if(e.index===-1&&e.visible===false){return true}return false}if(t&&!e){if(t.index===-1&&t.visible===false){return true}return false}for(var i in e){if(t[i]===undefined||e[i]!==t[i]){return false}}return true};o.prototype._isSemanticEqual=function(e,t){if(e.dimeasure.chartTypeKey!==t.dimeasure.chartTypeKey){return false}var i=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){if(e.index<t.index){return-1}else if(e.index>t.index){return 1}else{return 0}}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var n=a.copy(e.dimeasure.dimeasureItems).sort(i);var r=a.copy(t.dimeasure.dimeasureItems).sort(i);var o=true;n.some(function(e,t){if(!this._isDimMeasureItemEqual(e,r[t])){o=false;return true}},this);return o};o.prototype.getChangeType=function(e,t){if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return i.personalization.ChangeType.Unchanged}return this._isSemanticEqual(e,t)?i.personalization.ChangeType.Unchanged:i.personalization.ChangeType.ModelChanged};o.prototype.getChangeData=function(e,t){if(!e||!e.dimeasure||!e.dimeasure.dimeasureItems){return this.createControlDataStructure()}if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return{chartTypeKey:e.dimeasure.chartTypeKey,dimeasure:a.copy(e.dimeasure)}}if(!this._isSemanticEqual(e,t)){return{chartTypeKey:e.dimeasure.chartTypeKey,dimeasure:a.copy(e.dimeasure)}}return null};o.prototype.getUnionData=function(e,t){if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return a.copy(e)}var i=a.copy(t);Object.keys(e.dimeasure).forEach(function(t){if(Array.isArray(e.dimeasure[t])){e.dimeasure[t].forEach(function(e){var n=a.getArrayElementByKey("columnKey",e.columnKey,i.dimeasure[t]);if(!n){i.dimeasure[t].push(e);return}if(n.visible===undefined&&e.visible!==undefined){n.visible=e.visible}if(n.role===undefined&&e.role!==undefined){n.role=e.role}if(n.index===undefined&&e.index!==undefined){n.index=e.index}if(n.aggregationRole===undefined&&e.aggregationRole!==undefined){n.aggregationRole=e.aggregationRole}});return}if(i.dimeasure[t]===undefined&&e.dimeasure[t]!==undefined){i.dimeasure[t]=e.dimeasure[t]}},this);return i};o._sortByIndex=function(e,t){if(e.index!==undefined&&t.index===undefined){return-1}if(t.index!==undefined&&e.index===undefined){return 1}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0};o.prototype.isChartConsistent=function(e){var t=this.getTable();if(!t){return Promise.resolve(true)}var i=t.getChartObject();if(!i){return Promise.resolve(true)}return sap.ui.getCore().loadLibrary("sap.chart",{async:true}).then(function(){try{var t=sap.ui.require("sap/chart/library");var a=t.api.getChartTypeLayout(e.dimeasure.chartTypeKey,i.getDimensions(),i.getMeasures());return a.errors.length===0}catch(e){return false}})};o.prototype.exit=function(){e.prototype.exit.apply(this,arguments);var t=this.getTable();if(t){var i=t.getChartObject();if(i){i.detachDrilledDown(this._onDrilledDown,this);i.detachDrilledUp(this._onDrilledUp,this)}}};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/FilterController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/comp/filterbar/VariantConverterTo","sap/ui/comp/filterbar/VariantConverterFrom","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProvider","sap/ui/mdc/p13n/panels/FilterPanel","sap/base/util/UriParameters","sap/ui/comp/util/FormatUtil","sap/ui/core/library"],function(e,t,i,a,r,l,n,o,s,u,p,f){"use strict";var d=f.ValueState;var m=i.smartfilterbar.FilterType;var h=e.extend("sap.ui.comp.personalization.FilterController",{constructor:function(i,a){e.apply(this,arguments);this.setType(t.P13nPanelType.filter);this.setItemType(t.P13nPanelType.filter+"Items");this._aDropdownFields=[];this.aFilterItems=[];this._aSFBMultiInputs=[];this._aFilterPanelFields=[];this._aCustomColumnKeysWithSlash=[];this.aSFBControlConfig=[]},metadata:{events:{afterFilterModelDataChange:{}}}});h.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments)};h.prototype.getColumn2Json=function(e,t,r){if(this.getTableType()!==i.personalization.TableType.AnalyticalTable&&this.getTableType()!==i.personalization.TableType.Table&&this.getTableType()!==i.personalization.TableType.TreeTable){return null}if(!a.isFilterable(e)){return null}if(!e.getFiltered||e.getFiltered&&!e.getFiltered()){return null}return{columnKey:t,exclude:false,operation:e.getFilterOperator(),value1:e.getFilterValue(),value2:""}};h.prototype.getColumn2JsonTransient=function(e,t,r,l){if(!a.isFilterable(e)){return null}var n;if(this.getTableType()===i.personalization.TableType.AnalyticalTable||this.getTableType()===i.personalization.TableType.Table||this.getTableType()===i.personalization.TableType.TreeTable){if(a.getColumnType(e)==="boolean"){n=a._getCustomProperty(e,"values")}return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:a._getCustomProperty(e,"maxLength"),precision:a._getCustomProperty(e,"precision"),scale:a._getCustomProperty(e,"scale"),type:a.getColumnType(e),typeInstance:a._getCustomProperty(e,"typeInstance"),values:n,nullable:a._getCustomProperty(e,"nullable")}}if(this.getTableType()===i.personalization.TableType.ResponsiveTable){if(a.getColumnType(e)==="boolean"){n=a._getCustomProperty(e,"values")}return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:a._getCustomProperty(e,"maxLength"),precision:a._getCustomProperty(e,"precision"),scale:a._getCustomProperty(e,"scale"),type:a.getColumnType(e),typeInstance:a._getCustomProperty(e,"typeInstance"),values:n,nullable:a._getCustomProperty(e,"nullable")}}if(this.getTableType()===i.personalization.TableType.ChartWrapper){return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:a._getCustomProperty(e,"maxLength"),precision:a._getCustomProperty(e,"precision"),scale:a._getCustomProperty(e,"scale"),type:a.getColumnType(e),typeInstance:a._getCustomProperty(e,"typeInstance"),values:n,nullable:a._getCustomProperty(e,"nullable")}}};h.prototype.handleIgnore=function(e,t){e.sort.sortItems.splice(t,1)};h.prototype.syncJson2Table=function(e){var t=this.getColumnMap();var a=n({},t);this.fireBeforePotentialTableChange();if(this.getTableType()===i.personalization.TableType.AnalyticalTable||this.getTableType()===i.personalization.TableType.Table||this.getTableType()===i.personalization.TableType.TreeTable){e.filter.filterItems.forEach(function(e){var i=t[e.columnKey];if(i){if(!i.getFiltered()){i.setFiltered(true)}delete a[e.columnKey]}});for(var r in a){var l=a[r];if(l&&l.getFiltered()){l.setFiltered(false)}}}this.fireAfterPotentialTableChange()};h.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();if(!e.SelectOptions||!e.SelectOptions.length){return t}t.filter.filterItems=e.SelectOptions.map(function(e){var t=l.convertOption(e.Ranges[0].Option,e.Ranges[0].Low);return{columnKey:e.PropertyName,exclude:e.Ranges[0].Sign==="E",operation:t.op,value1:t.v,value2:e.Ranges[0].High}});return t};h.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.filter||!t.filter.filterItems||!t.filter.filterItems.length){return}t.filter.filterItems.forEach(function(t){var i=r.addRangeEntry(e,t.columnKey);r.addRanges(i,[t])})};h.prototype._getFilterPropertyFromColumn=function(e){var t,i,a,r=this._getColumnByKey(e);if(!r){a=this.getColumnMap();r=a&&a[e]}if(r){if(r.getFilterProperty){i=r.getFilterProperty()}t=r.data("p13nData");if(t&&!i){i=t["filterProperty"]}}return i};h.prototype._createFilterFieldControl=function(e){if(e.conditionType){e.control=e.conditionType.initializeFilterItem()}else if(!e.control&&e.fCreateControl){e.fCreateControl(e);delete e.fCreateControl}};h.prototype._getControlDataReduceFilterItems=function(){var e=this.getControlDataReduce();return e&&e.filter&&e.filter.filterItems};h.prototype._updateControlDataReduce=function(e){var t=this.getControlDataReduce();if(!e||!(t&&t.filter&&t.filter.filterItems)){return}e.reverse();t.filter.filterItems=e;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})};h.prototype._getColumnByKey=function(e){var t,i,a,r,l,n=this.getTable();if(n){t=n.getColumns();a=t.length;for(r=0;r<a;r++){i=t[r];l=i.data("p13nData");if(l&&l.columnKey===e){return i}}}return null};h.prototype._getIsCustomColumn=function(e){var t=this._getColumnByKey(e),i=t&&t.data("p13nData");return!i?false:!i.typeInstance};h.prototype._getFilterQueryPanelParameter=function(){return new u(window.location.search).getAll("sap-ui-xx-filterQueryPanel")[0]==="true"};h.prototype.getPanel=function(e){if(!a.hasFilterableColumns(this.getColumnMap())){return null}if(e&&e.column){var t=a.getColumnKey(e.column);if(t){var i=this.getTransientData();i.filter.filterItems.forEach(function(e){e["isDefault"]=e.columnKey===t})}}var r=this.getTable(),l=this._getSmartFilterBar();if(l&&l._oFilterProvider){this._aDropdownFields=l._oFilterProvider._aFilterBarDropdownFieldMetadata}else if(r&&r.oParent&&r.oParent._oTableProvider&&r.oParent._oTableProvider._aTableViewMetadata){this._aDropdownFields=r.oParent._oTableProvider._aTableViewMetadata.filter(function(e){return e.hasFixedValues})}return new Promise(function(e){sap.ui.require(["sap/ui/comp/p13n/P13nFilterPanel","sap/m/P13nItem","sap/m/P13nAnyFilterItem","sap/ui/comp/providers/ValueListProvider"],function(t,i,r,l){var n,u=true;if(u){var p,f,d;if(!this.oSmartTable){this.oSmartTable=this._getSmartTable()}if(!this.oSmartChart){this.oSmartChart=this._getSmartChart()}if(!this.oSmartFilterBar){this.oSmartFilterBar=this._getSmartFilterBar();this.aSFBControlConfig=this.oSmartFilterBar&&this.oSmartFilterBar.getControlConfiguration()}if(this.oSmartTable){d=this.oSmartTable}else if(this.oSmartChart){d=this.oSmartChart}if(d){p=d.getModel();f=d.getEntitySet();n=d.getId()}if(!f&&!d&&this.getTable()&&this.getTable().isA("sap.ui.table.AnalyticalTable")){p=this.getTable().getModel();f=this.getTable().getBinding("rows")&&this.getTable().getBinding("rows").getPath().slice(1).split("(")[0]}this.oMDCFilterPanel=new s({enableReorder:false,change:this._mdcFilterPanelChangeHandler.bind(this),itemFactory:this._itemFactoryHandler.bind(this)});this._detachFieldsFromMDCFilterPanel();if(!this.oFilterProviderPromise){this.oFilterProviderPromise=o._createFilterProvider({entitySet:f,model:p,defaultDropDownDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultTokenDisplayBehaviour"),defaultSingleFieldDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultSingleFieldDisplayBehaviour"),dateFormatSettings:this.oSmartTable&&this.oSmartTable.data("dateFormatSettings"),useContainsAsDefaultFilter:this.oSmartTable&&this.oSmartTable.data("useContainsAsDefaultFilter"),annotationSuppressed:true,useDateRangeType:false,context:"mdcFilterPanel",smartContainerId:n})}this.oFilterProviderPromise.then(function(e){this._aActiveFilterPanelFieldNames=[];if(!e._aCustomFieldMetadata){e._aCustomFieldMetadata=[]}this.oFilterProvider=e;this.oMDCFilterPanel.setModel(e.oModel,e.sFilterModelName);if(!this._aSplitIntervalFields){this._aSplitIntervalFields=this._getSplitIntervalFieldNames()}this.oMDCFilterPanel.setP13nData(this._prepareP13nData());this._updateFilterData()}.bind(this));return e(this.oMDCFilterPanel)}else{var m=this.getColumnMap(true),h=new t({containerQuery:true,enableEmptyOperations:true,items:{path:"$sapmP13nPanel>/transientData/filter/filterItems",template:new i({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}",maxLength:"{$sapmP13nPanel>maxLength}",precision:"{$sapmP13nPanel>precision}",scale:"{$sapmP13nPanel>scale}",type:"{$sapmP13nPanel>type}",typeInstance:"{$sapmP13nPanel>typeInstance}",isDefault:"{$sapmP13nPanel>isDefault}",values:"{$sapmP13nPanel>values}",nullable:"{$sapmP13nPanel>nullable}"})},filterItems:{path:"$sapmP13nPanel>/controlDataReduce/filter/filterItems",template:new r({key:"{$sapmP13nPanel>key}",columnKey:"{$sapmP13nPanel>columnKey}",exclude:"{$sapmP13nPanel>exclude}",operation:"{$sapmP13nPanel>operation}",value1:"{$sapmP13nPanel>value1}",value2:"{$sapmP13nPanel>value2}"})},messageStrip:this.getMessageStrip(),beforeNavigationTo:this.setModelFunction(),filterItemChanged:function(e){var t=e.getParameter("reason");var i=e.getParameter("index");var a=e.getParameter("itemData");var r=this.getControlDataReduce();if(a&&t==="added"){if(i>-1){r.filter.filterItems.splice(i,0,a)}else{r.filter.filterItems.push(a)}}if(t==="removed"&&i>-1){r[this.getType()][this.getItemType()].splice(i,1)}this.setControlDataReduce2Model(r);this.fireAfterPotentialModelChange({json:r})}.bind(this)});if(this._aDropdownFields&&this._aDropdownFields.length>0){this._aDropdownFields=this._aDropdownFields.filter(function(e){var t=m[e.name];return!!a._getCustomProperty(t,"fullName")})}h._oConditionPanel.data("dropdownFields",this._aDropdownFields);var g=function(e,t){var i=this.getColumnMap(true),r=i[t],n=a._getCustomProperty(r,"fullName"),o=this._getSmartFilterBar(),s,u=this._getSmartTable(),p,f=o&&o.getControlConfiguration(),d,m,g,c,y,F;if(e.isA("sap.m.ComboBox")||e.isA("sap.m.MultiComboBox")){d="items";m=false;if(o&&o._oFilterProvider){s=o._oFilterProvider;g=s._sTextArrangementDisplayBehaviour||"idOnly"}else if(u&&u._oTableProvider){s=u._oTableProvider;g=s._oDefaultDropDownDisplayBehaviour||"idOnly"}this._aDropdownFields.forEach(function(e){if(e.name===t){p=e["com.sap.vocabularies.Common.v1.Text"];if(p){g=s._oMetadataAnalyser.getTextArrangementValue(p)}else if(e["com.sap.vocabularies.UI.v1.TextArrangement"]){g=s._oMetadataAnalyser.getTextArrangementValue(e)}}});if(Array.isArray(f)&&f.length>0){for(F=0;F<f.length;F++){c=f[F];if(c.getKey()===t){g=c.getDisplayBehaviour();break}}}}else{d="suggestionRows";m=true}if(o&&o._oFilterProvider&&o._oFilterProvider._aFilterBarMultiValueFieldMetadata){y=o._oFilterProvider._aFilterBarMultiValueFieldMetadata.filter(function(e){return e.name===t})[0];if(y){h._oConditionPanel.setDisplayFormat(y.displayFormat)}}if(n){e.setShowSuggestion&&e.setShowSuggestion(true);e.setFilterSuggests&&e.setFilterSuggests(false);e.setModel(this.getTable().getModel());return new l({fieldName:t,control:e,model:this.getTable().getModel(),maxLength:a._getCustomProperty(r,"maxLength"),displayBehaviour:g,resolveInOutParams:false,loadAnnotation:true,fullyQualifiedFieldName:n,aggregation:d,typeAheadEnabled:m,enableShowTableSuggestionValueHelp:false})}}.bind(this);h._oConditionPanel._fSuggestCallback=g;h._enableEnhancedExcludeOperations();h.addStyleClass("sapUiSmallMarginTop");return e(h)}}.bind(this))}.bind(this))};h.prototype._getSplitIntervalFieldNames=function(){var e,t,i=[],a=this.oFilterProvider;if(a&&a.aAllFields){for(e=0;e<a.aAllFields.length;e++){t=a.aAllFields[e];if(t.filterRestriction===m.Interval&&t.type!=="Edm.DateTime"){i.push(t.name)}}}return i};h.prototype._getFieldMetadata=function(e,t){var i=null;if(Array.isArray(e)){e.some(function(e){if(e&&e.fields){e.fields.some(function(e){if(e&&e.name===t){i=e}return i!==null})}return i!==null})}return i};h.prototype._itemFactoryHandler=function(e){var t,i,a,r,l=e.name,n=this.oFilterProvider,o=this._getControlByName(l),s=this._getFilterPropertyFromColumn(l),u;if(s&&s.includes("/")){u=n._oMetadataAnalyser.extractNavigationPropertyField(s,n.sEntitySet);u=n._createFieldMetadata(u)}else{u=n._getFieldMetadata(s)}if(u&&s&&l!==s){u=Object.assign({},u)}this._aActiveFilterPanelFieldNames.push(l);if(!o){if(!u){if(!this._aViewMetadata){this._aViewMetadata=n._oMetadataAnalyser._getAllFilterableFieldsByEntityForAllEndpoints(n.sEntitySet,true,false,null)}u=this._getFieldMetadata(this._aViewMetadata,l);if(u){u=n._createFieldMetadata(u)}}u=this._updateFieldMetadata(u,e,s);if(this.aSFBControlConfig){for(t=0;t<this.aSFBControlConfig.length;t++){i=this.aSFBControlConfig[t];if(i.getKey()===u.fieldName){a=i.getDisplayBehaviour();if(a&&!i.isPropertyInitial("displayBehaviour")){r=Object.assign({},u);r.displayBehaviour=a}break}}}if(r){r.fCreateControl(r);o=r.control}else{u.fCreateControl(u);o=u.control}o._sControlName=e.name;this._aFilterPanelFields.push(o);if(o.isA("sap.m.Select")||o.isA("sap.m.TimePicker")){o.setWidth("100%")}if(o.isA("sap.m.MultiInput")){o.attachTokenUpdate(this._fieldChangeHandler.bind(this))}else{o.attachChange(this._fieldChangeHandler.bind(this))}}if(o.getValueState&&o.getValueState()===d.Error){o.setValueState(d.None)}return o};h.prototype._fieldChangeHandler=function(e){var t,i,a,r=[],l,n=this.oFilterProvider,o=n.getFilterData(),s=e.getSource(),u=s._sControlName,p={exclude:false,columnKey:u,operation:"EQ",value1:null,value2:null};setTimeout(function(){Promise.all(n._getCurrentValidationPromises()).then(function(){for(t in o){if(o.hasOwnProperty(t)){i=o[t];if(i){a=n._getFieldMetadata(t);if(a&&a.fieldNameOData&&t!==a.fieldNameOData){t=a.fieldNameOData}p.columnKey=t;if(p.columnKey&&p.columnKey.includes("___")){p.columnKey=p.columnKey.replaceAll("___","/")}l=Object.assign({},p);if(Array.isArray(i.ranges)&&i.ranges.length>0){r.push(this._createConditionForRanges(i.ranges))}if(Array.isArray(i.items)&&i.items.length>0){r.push(this._createConditionForItems(i.items,p))}if(i.hasOwnProperty("low")&&i.low){r.push(this._createConditionForIntervals(i,t,p))}if(i.value){if(s&&s.getValueState()!==d.Error){l=Object.assign({},p);l.value1=i.value;r.push(l)}}if(typeof i!=="object"||i instanceof Date){l=Object.assign({},p);l.value1=i;r.push(l)}}}}r=r.flat();this._updateControlDataReduce(r)}.bind(this))}.bind(this))};h.prototype._updateFieldMetadata=function(e,t,i){var a,r,l=t.name,n=this.oFilterProvider,o=this._getIsCustomColumn(l),s=this._getColumnByKey(l);if(e&&o){a=s&&(s.getHeader&&s.getHeader()||s.getLabel&&s.getLabel());if(a&&a.getText()){e.label=a.getText()}}if(i&&i.includes("/")){e=n._oMetadataAnalyser.extractNavigationPropertyField(i,n.sEntitySet);e=n._createFieldMetadata(e)}if(!e){l=this._getFilterPropertyFromColumn(l);r=n.aAllFields&&n.aAllFields.find(function(e){return e.name===l});r=n._createFieldMetadata(r);e=Object.assign({},r)}if(o){e=this._prepareFieldMetadataForCustomColumn(e,t)}return e};h.prototype._prepareFieldMetadataForCustomColumn=function(e,t){var i=t.name,r,l,n,o,s,u=t.name,p=this._getColumnByKey(u),f=this.oFilterProvider;if(u.includes("/")){this._aCustomColumnKeysWithSlash.push(u);u=u.replaceAll("/","___")}e.customColumnKey=i;e.fieldName=u;e.name=u;o=!!e.ui5Type&&e.ui5Type.oConstraints;e.label=p&&(p.getHeader?p.getHeader().getText():p.getLabel().getText());n=a._getCustomProperty(p,"maxLength");l=a._getCustomProperty(p,"scale");r=a._getCustomProperty(p,"precision");if(o&&(n||l||r)){s=e.ui5Type;e=Object.assign({},e,{ui5Type:Object.assign({},e.ui5Type,{oConstraints:Object.assign({},e.ui5Type.oConstraints)})});for(var d in s){if(!s.hasOwnProperty(d)){e.ui5Type[d]=s[d]}}}if(n){e.maxLength=n;if(o){e.ui5Type.oConstraints.maxLength=n}}if(l){e.scale=l;if(o){e.ui5Type.oConstraints.scale=l}}if(r){e.precision=r;if(o){e.ui5Type.oConstraints.precision=r}}f._aCustomFieldMetadata.push(e);this._updateFilterData();return e};h.prototype._prepareP13nData=function(){var e=[],t,i=this._getControlDataReduceFilterItems();this.getTransientData().filter.filterItems.forEach(function(a){t=i&&i.some(function(e){return e.columnKey===a.columnKey});if(a.isDefault){t=true}e.push({name:a.columnKey,label:a.text,active:t})});return e};h.prototype._mdcFilterPanelChangeHandler=function(e){if(e.getParameter("reason")===this.oMDCFilterPanel.CHANGE_REASON_REMOVE){this._handleFieldRemove(e)}};h.prototype._handleFieldRemove=function(e){var t=this.oFilterProvider,i=e.getParameter("item").name,a,r=t._getFieldMetadata(i),l=this._getControlByName(i),n=this._getControlDataReduceFilterItems();if(n&&n.length>0){n=n.filter(function(e){return e.columnKey!==i})}this._updateControlDataReduce(n);if(!r){a=this._getFilterPropertyFromColumn(i);r=t.aAllFields.find(function(e){return e.name===a});r=t._createFieldMetadata(r);r.name=i;r.fieldName=i;r.control=l}t._createInitialModelForField({},r);if(l&&l.getValue&&l.getValue()){l.setValue(null)}};h.prototype._detachFieldsFromMDCFilterPanel=function(){var e,t=this.oMDCFilterPanel.exit;this.oMDCFilterPanel.exit=function(){t.apply(this,arguments);this._aFilterPanelFields.forEach(function(t){if(t){e=t.getParent();if(e){e.removeContent(t)}}});if(this._aActiveFilterPanelFieldNames){this._aActiveFilterPanelFieldNames=null}}.bind(this)};h.prototype._createConditionForRanges=function(e){var t,i,a=[],r;for(t=0;t<e.length;t++){i=Object.assign({},e[t]);if(!i.columnKey){i.columnKey=i.keyField}r=this.oFilterProvider._getFieldMetadata(i.columnKey);if(r&&r.fieldNameOData){i.columnKey=r.fieldNameOData}if(i.columnKey&&i.columnKey.includes("___")){i.columnKey=i.columnKey.replaceAll("___","/")}delete i.keyField;delete i.tokenText;a.push(i)}return a};h.prototype._createConditionForItems=function(e,t){var i,a,r=[],l;for(i=0;i<e.length;i++){a=e[i];l=Object.assign({},t);l.value1=a.key;l.token=a.text;r.push(l)}return r};h.prototype._createConditionForIntervals=function(e,t,i){var a,r=this.oFilterProvider,l=[],n;a=Object.assign({},i);a.operation="BT";if(e.low&&e.high){a.value1=e.low;a.value2=e.high}else if(e.low){if(r._aFilterBarDateTimeFieldNames.indexOf(t)>-1){n=r._getFieldMetadata(t);l=p.parseDateTimeOffsetInterval(e.low);l[0]=n.ui5Type.parseValue(l[0],"string");if(l.length===2){l[1]=n.ui5Type.parseValue(l[1],"string")}}else{l=p.parseFilterNumericIntervalData(e.low)}if(l){a.value1=l[0];a.value2=l[1]}}return a};h.prototype._updateFilterData=function(e){var t,i,a,r,l,n,o=this.oFilterProvider,s,u=e?e:this._getControlDataReduceFilterItems();o.clear();n=Object.assign({},o.getFilterData());if(u&&u.length>0){for(t=0;t<u.length;t++){l=Object.assign({},u[t]);r=l.keyField?l.keyField:l.columnKey;if(this._aCustomColumnKeysWithSlash.includes(r)){r=r.replaceAll("/","___")}a=n[r];if(!l.keyField){l.keyField=l.columnKey;delete l.columnKey}if(l.token){i={key:l.value1,text:l.token};if(!a.items){a.items=[]}a.items.push(i)}else if(l.conditionTypeInfo){if(!l.conditionTypeInfo.data.operation){l.conditionTypeInfo.data.operation=l.conditionTypeInfo.data.operator}a.conditionTypeInfo=l.conditionTypeInfo;a.ranges.push(l)}else if(a&&a.hasOwnProperty("low")){if(o._aFilterBarDateTimeFieldNames&&o._aFilterBarDateTimeFieldNames.indexOf(r)>-1){s=o._getFieldMetadata(r);if(l.value1 instanceof Date){l.value1=s.ui5Type.formatValue(l.value1,"string")}if(l.value2 instanceof Date){l.value2=s.ui5Type.formatValue(l.value2,"string")}}if(this._aSplitIntervalFields&&this._aSplitIntervalFields.indexOf(l.keyField)>-1){i={low:l.value1+"-"+l.value2,high:null}}else{i={low:l.value1,high:l.value2}}n[r]=i}else if(a===null||typeof a!=="object"){n[r]=l.value1}else{if(!(a&&a.ranges)){a.ranges=[]}n[r].ranges.push(l)}}o.setFilterData(n)}};h.prototype._getControlByName=function(e){var t,i,a,r=this._aFilterPanelFields;for(t=0;t<r.length;t++){a=r[t];if(a._sControlName===e){i=a;break}}return i};h.prototype.getChangeType=function(e,t){if(!t||!t.filter||!t.filter.filterItems){return i.personalization.ChangeType.Unchanged}if(t&&t.filter&&t.filter.filterItems){t.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(e&&e.filter&&e.filter.filterItems){e.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}var a=JSON.stringify(e.filter.filterItems)!==JSON.stringify(t.filter.filterItems);return a?i.personalization.ChangeType.ModelChanged:i.personalization.ChangeType.Unchanged};h.prototype.getChangeData=function(e,t){if(!e||!e.filter||!e.filter.filterItems){return this.createControlDataStructure()}if(t&&t.filter&&t.filter.filterItems){t.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(e&&e.filter&&e.filter.filterItems){e.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(!t||!t.filter||!t.filter.filterItems){return{filter:a.copy(e.filter)}}if(JSON.stringify(e.filter.filterItems)!==JSON.stringify(t.filter.filterItems)){return{filter:a.copy(e.filter)}}return null};h.prototype.getUnionData=function(e,t){if(!t||!t.filter||!t.filter.filterItems){return{filter:a.copy(e.filter)}}return{filter:a.copy(t.filter)}};h.prototype._getSmartFilterBar=function(){var e,t=this.getTable();if(t){e=t.oParent&&t.oParent._oSmartFilter}if(!e&&t&&this.getTableType()===i.personalization.TableType.ChartWrapper){e=t.getChartObject()&&t.getChartObject().oParent&&t.getChartObject().oParent._oSmartFilter}return e?e:null};h.prototype._getSmartTable=function(){var e=this.getTable()&&this.getTable().getParent();return e&&e.isA("sap.ui.comp.smarttable.SmartTable")?e:null};h.prototype._getSmartChart=function(){var e=this.getTable();if(e&&this.getTableType()===i.personalization.TableType.ChartWrapper){return e&&e.getChartObject()&&e.getChartObject().getParent()}return null};h.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this._aDropdownFields=null;this.aFilterItems=null;this._aSFBMultiInputs=null;this.oSmartChart=null;this.oSmartTable=null;this.oSmartFilterBar=null;this.aSFBControlConfig=null;this._aSplitIntervalFields=null;if(this.oFilterProviderPromise){this.oFilterProviderPromise=null}if(this.oFilterProvider&&this.oFilterProvider.destroy){this.oFilterProvider.destroy();this.oFilterProvider=null}if(this._aFilterPanelFields&&this._aFilterPanelFields.length>0){this._aFilterPanelFields.forEach(function(e){e.destroy()})}this._aFilterPanelFields=null;this._aActiveFilterPanelFieldNames=null;this._aViewMetadata=null;this._aCustomColumnKeysWithSlash=null};return h});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/GroupController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/m/P13nConditionPanel"],function(e,t,o,r,n){"use strict";var a=t.P13nConditionOperation;var p=e.extend("sap.ui.comp.personalization.GroupController",{constructor:function(o,r){e.apply(this,arguments);this.setType(t.P13nPanelType.group);this.setItemType(t.P13nPanelType.group+"Items")},metadata:{events:{afterGroupModelDataChange:{}}}});p.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.TreeTable){t.detachGroup(this._onGroup,this);t.attachGroup(this._onGroup,this)}};p.prototype.getColumn2Json=function(e,t,r){if(this.getTableType()!==o.personalization.TableType.AnalyticalTable){return null}if(!e.getGrouped()){return null}return{columnKey:t,isGrouped:e.getGrouped(),operation:e.getSortOrder&&e.getSortOrder()==="Ascending"?a.GroupAscending:a.GroupDescending,showIfGrouped:e.getShowIfGrouped?e.getShowIfGrouped():false}};p.prototype.getAdditionalData2Json=function(e,t){if(this.getTableType()!==o.personalization.TableType.AnalyticalTable){return}if(!e.group.groupItems.length){return}t.getGroupedColumns().forEach(function(t,o){if(typeof t==="string"){t=sap.ui.getCore().byId(t)}var n=r.getIndexByKey("columnKey",r.getColumnKey(t),e.group.groupItems);if(n>-1&&o===n){return}var a=e.group.groupItems.splice(n,1);e.group.groupItems.splice(o,0,a)})};p.prototype.getColumn2JsonTransient=function(e,t,o,n){if(!r.isGroupable(e)){return null}return{columnKey:t,text:o,tooltip:n!==o?n:undefined}};p.prototype.handleIgnore=function(e,t){e.sort.sortItems.splice(t,1)};p.prototype.syncJson2Table=function(e){var t=this.getColumnMap();var r=this.getTable();var n;this.fireBeforePotentialTableChange();if(this.getTableType()===o.personalization.TableType.TreeTable){return}else if(this.getTableType()===o.personalization.TableType.AnalyticalTable){var a=true;for(var p in t){n=t[p];if(!n){return}if(n.getGrouped()){n.setGrouped(false,a);n.setShowIfGrouped(false)}}e.group.groupItems.forEach(function(e){n=t[e.columnKey];if(!n){return}n.setGrouped(true,a);n.setShowIfGrouped(e.showIfGrouped)})}else if(this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.TreeTable){if(e.group.groupItems.length>0){e.group.groupItems.some(function(e){n=t[e.columnKey];if(n){r.setGroupBy(n);return true}})}else{r.setGroupBy(null)}}this.fireAfterPotentialTableChange()};p.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();if(!e.GroupBy||!e.GroupBy.length){return t}t.group.groupItems=e.GroupBy.map(function(e){return{columnKey:e,operation:a.GroupAscending,showIfGrouped:false}});return t};p.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.group||!t.group.groupItems||!t.group.groupItems.length){return}e.GroupBy=t.group.groupItems.map(function(e){return e.columnKey})};p.prototype._onGroup=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(e.getParameter("groupedColumns"));this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange()};p.prototype._setGroup=function(e,t){this.fireBeforePotentialTableChange();if(e){this._updateInternalModel([t])}else{this._updateInternalModel([])}this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange()};p.prototype._updateInternalModel=function(e){this.getInternalModel().setProperty("/controlData/group/groupItems",[]);var t=this.getControlData();e.forEach(function(e){if(typeof e==="string"){e=sap.ui.getCore().byId(e)}var o=r.getColumnKey(e);var n=r.getIndexByKey("columnKey",o,t.group.groupItems);n=n>-1?n:t.group.groupItems.length;this.getInternalModel().setProperty("/controlData/group/groupItems/"+n+"/",{columnKey:o,showIfGrouped:e.getShowIfGrouped?e.getShowIfGrouped():false})},this);this.updateControlDataBaseFromJson(t)};p.prototype.getPanel=function(){if(!r.hasGroupableColumns(this.getColumnMap())){return null}return new Promise(function(e){sap.ui.require(["sap/m/P13nGroupPanel","sap/m/P13nItem","sap/m/P13nGroupItem"],function(t,r,n){return e(new t({maxGroups:this.getTableType()===o.personalization.TableType.AnalyticalTable?"-1":"1",containerQuery:true,items:{path:"$sapmP13nPanel>/transientData/group/groupItems",template:new r({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},groupItems:{path:"$sapmP13nPanel>/controlDataReduce/group/groupItems",template:new n({columnKey:"{$sapmP13nPanel>columnKey}",operation:"{$sapmP13nPanel>operation}",showIfGrouped:"{$sapmP13nPanel>showIfGrouped}"})},beforeNavigationTo:this.setModelFunction(),updateGroupItem:function(){this.fireAfterPotentialModelChange({json:this.getControlDataReduce()})}.bind(this),addGroupItem:function(e){if(!e.getParameter("groupItemData")){return}var t=e.getParameter("index");var o=e.getParameter("groupItemData");var r={columnKey:o.getColumnKey(),operation:o.getOperation(),showIfGrouped:o.getShowIfGrouped()};var n=this.getControlDataReduce();if(t>-1){n.group.groupItems.splice(t,0,r)}else{n.group.groupItems.push(r)}this.setControlDataReduce2Model(n);this.fireAfterPotentialModelChange({json:n})}.bind(this),removeGroupItem:function(e){var t=e.getParameter("index");if(t<0){return}var o=this.getControlDataReduce();o.group.groupItems.splice(t,1);this.setControlDataReduce2Model(o);this.fireAfterPotentialModelChange({json:o})}.bind(this)}))}.bind(this))}.bind(this))};p.prototype.retrieveAdaptationUI=function(e){if(!r.hasGroupableColumns(this.getColumnMap())){return null}return new Promise(function(e){sap.ui.require(["sap/m/p13n/GroupPanel"],function(t){var r=this.getAdaptationData();var n=this.getTableType()===o.personalization.TableType.AnalyticalTable;var a=new t({queryLimit:n?undefined:1,enableShowField:n});this.oPanel=a;a.setP13nData(r);a.attachChange(function(e){var t=t=e.getParameter("item");var o=a.getP13nData(true);var r=this.getControlDataReduce();r.group.groupItems=o.map(function(e){return{isGrouped:true,columnKey:e.name,operation:e.descending?"GroupDescending":"GroupAscending",showIfGrouped:t.name===e.name?t.showIfGrouped:true}});this.setControlDataReduce2Model(r);this.fireAfterPotentialModelChange({json:r})}.bind(this));e(a)}.bind(this))}.bind(this))};p.prototype._transformAdaptationData=function(t,o){var r=e.prototype._transformAdaptationData.apply(this,arguments);r.grouped=!!t;r.showIfGrouped=t?t.showIfGrouped:true;return r};p.prototype._sortAdaptationData=function(e){this._getP13nBuilder().sortP13nData({visible:"grouped",position:"position"},e)};p.prototype._getPresenceAttribute=function(){return"grouped"};p.prototype.getChangeType=function(e,t){if(!t||!t.group||!t.group.groupItems){return o.personalization.ChangeType.Unchanged}var r=JSON.stringify(e.group.groupItems)!==JSON.stringify(t.group.groupItems);return r?o.personalization.ChangeType.ModelChanged:o.personalization.ChangeType.Unchanged};p.prototype.getChangeData=function(e,t){if(!e||!e.group||!e.group.groupItems){return this.createControlDataStructure()}if(!t||!t.group||!t.group.groupItems){return{group:r.copy(e.group)}}if(JSON.stringify(e.group.groupItems)!==JSON.stringify(t.group.groupItems)){return{group:r.copy(e.group)}}return null};p.prototype.getUnionData=function(e,t){if(!t||!t.group||!t.group.groupItems){return{group:r.copy(e.group)}}return{group:r.copy(t.group)}};p.prototype.isGroupSelected=function(e,t){var o=-1;e.groupItems.some(function(e,r){if(e.columnKey===t){o=r;return true}});return o>-1};p.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this.getTable()&&(this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.TreeTable)){this.getTable().detachGroup(this._onGroup,this)}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SelectionController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util"],function(e,t,n,i){"use strict";var o=e.extend("sap.ui.comp.personalization.SelectionController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.selection);this.setItemType(t.P13nPanelType.selection+"Items")},metadata:{events:{afterSelectionModelDataChange:{}}}});o.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,text:e.getLabel(),visible:e.getSelected()}};o.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,href:e.getHref(),internalHref:e.getInternalHref(),target:e.getTarget(),press:e.getPress(),description:e.getDescription()}};o.prototype.syncJson2Table=function(e){this.fireBeforePotentialTableChange();this.fireAfterPotentialTableChange()};o.prototype.getPanel=function(e){return new Promise(function(e){sap.ui.require(["sap/m/P13nSelectionPanel","sap/m/P13nItem","sap/m/P13nSelectionItem"],function(t,n,i){return e(new t({titleLarge:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_SELECTION_TITLE"),items:{path:"$sapmP13nPanel>/transientData/selection/selectionItems",template:new n({columnKey:"{$sapmP13nPanel>columnKey}",href:"{$sapmP13nPanel>href}",target:"{$sapmP13nPanel>target}",text:"{$sapmP13nPanel>text}",press:"{$sapmP13nPanel>press}"})},selectionItems:{path:"$sapmP13nPanel>/controlDataReduce/selection/selectionItems",template:new i({columnKey:"{$sapmP13nPanel>columnKey}",selected:"{$sapmP13nPanel>visible}"})},beforeNavigationTo:this.setModelFunction(),changeSelectionItems:function(e){if(!e.getParameter("items")){return}var t=this.getControlDataReduce();t.selection.selectionItems=e.getParameter("items").map(function(e){return{columnKey:e.columnKey,visible:e.selected}});this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this)}))}.bind(this))}.bind(this))};o.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/p13n/panels/LinkSelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_COLUMNHEADER_WITHOUT_COUNT"),linkPressed:this.getTable().getPress(),enableReorder:false});i.setP13nData(n);i._oListControl.setMultiSelectMode("Default");this.oPanel=i;var o;i.attachChange(function(e){var t=this.getControlDataReduce();o=e.getSource().getP13nData().map(function(e,t){return{columnKey:e.name,visible:e.visible}});t.selection.selectionItems=o;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this));e(i)}.bind(this))}.bind(this))};o.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);i.text=n.text;i.href=n.href;i.internalHref=n.internalHref?n.internalHref:undefined;i.visible=t.visible;i.description=n.description;i.label=n.name;return i};o.prototype.getChangeType=function(e,t){return this.getChangeData(e,t)?n.personalization.ChangeType.ModelChanged:n.personalization.ChangeType.Unchanged};o.prototype.getChangeData=function(e,t){if(!t||!t.selection||!t.selection.selectionItems){return null}var n={selection:i.copy(e.selection)};if(this._isSemanticEqual(e,t)){return null}var o=[];n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(i.semanticEqual(e,n)){o.push(e);return}for(var s in e){if(s==="columnKey"||!n){continue}if(e[s]===n[s]){delete e[s]}}if(Object.keys(e).length<2){o.push(e)}});o.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.selection.selectionItems);n.selection.selectionItems.splice(t,1)});return n};o.prototype.getUnionData=function(e,t){var n=i.copy(e);if(!t||!t.selection||!t.selection.selectionItems){return n.selection?{selection:i.copy(n.selection)}:null}if(!n||!n.selection||!n.selection.selectionItems){return{selection:i.copy(t.selection)}}var o=this.createControlDataStructure();n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(n){if(n.visible!==undefined){e.visible=n.visible}}o.selection.selectionItems.push(e)});return o};o.prototype._isSemanticEqual=function(e,t){var n=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){return 0}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var o=i.copy(e.selection.selectionItems).sort(n);var s=i.copy(t.selection.selectionItems).sort(n);return!o.some(function(e,t){if(!i.semanticEqual(e,s[t])){return true}})};o.prototype.getResetWarningText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_RESET_WARNING")};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SelectionWrapper", ["sap/ui/core/Element","./ColumnWrapper"],function(e,a){"use strict";var p=e.extend("sap.ui.comp.personalization.SelectionWrapper",{constructor:function(a,p){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{press:{type:"function",defaultValue:null}},aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}}}});return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SortController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/base/util/merge"],function(t,e,o,r,n){"use strict";var a=t.extend("sap.ui.comp.personalization.SortController",{constructor:function(o,r){t.apply(this,arguments);this.setType(e.P13nPanelType.sort);this.setItemType(e.P13nPanelType.sort+"Items")},metadata:{events:{afterSortModelDataChange:{}}}});a.prototype.setTable=function(e){t.prototype.setTable.apply(this,arguments);if(this.getTable()&&e.detachSort&&e.attachSort){e.detachSort(this._onSort,this);e.attachSort(this._onSort,this)}};a.prototype.getColumn2Json=function(t,e,o){if(!r.isSortable(t)){return null}if(!t.getSorted||t.getSorted&&!t.getSorted()){return null}return{columnKey:e,operation:t.getSortOrder()}};a.prototype.getColumn2JsonTransient=function(t,e,o,n){if(!r.isSortable(t)){return null}return{columnKey:e,text:o,tooltip:n!==o?n:undefined}};a.prototype.handleIgnore=function(t,e){t.sort.sortItems.splice(e,1)};a.prototype.syncJson2Table=function(t){var e=this.getColumnMap();var r=n({},e);this.fireBeforePotentialTableChange();if(this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.TreeTable){t.sort.sortItems.forEach(function(t){var o=e[t.columnKey];if(!o){return}if(t.operation===undefined){return}if(!o.getSorted()){o.setSorted(true)}if(o.getSortOrder()!==t.operation){o.setSortOrder(t.operation)}delete r[t.columnKey]});for(var a in r){var s=r[a];if(s&&s.getSorted()){s.setSorted(false)}}}this.fireAfterPotentialTableChange()};a.prototype.getDataSuiteFormat2Json=function(t){var e=this.createControlDataStructure();if(!t.SortOrder||!t.SortOrder.length){return e}e.sort.sortItems=t.SortOrder.map(function(t){return{columnKey:t.Property,operation:t.Descending?"Descending":"Ascending"}});return e};a.prototype.getDataSuiteFormatSnapshot=function(t){var e=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!e.sort||!e.sort.sortItems||!e.sort.sortItems.length){return}t.SortOrder=e.sort.sortItems.map(function(t){return{Property:t.columnKey,Descending:t.operation==="Descending"}})};a.prototype._onSort=function(t){t.preventDefault();this._updateInternalModel(r.getColumnKey(t.getParameter("column")),t.getParameter("sortOrder"),t.getParameter("columnAdded"));this.syncJson2Table(this.getControlData());this.fireAfterSortModelDataChange()};a.prototype._updateInternalModel=function(t,e,o){if(!t||e!=="Descending"&&e!=="Ascending"&&e!=="None"){return}if(!o){this.getInternalModel().setProperty("/controlData/sort/sortItems",[])}var n=this.getControlData();if(e!="None"){var a=r.getIndexByKey("columnKey",t,n.sort.sortItems);a=a>-1?a:n.sort.sortItems.length;this.getInternalModel().setProperty("/controlData/sort/sortItems/"+a+"/",{columnKey:t,operation:e})}this.updateControlDataBaseFromJson(n)};a.prototype.getPanel=function(){if(!r.hasSortableColumns(this.getColumnMap())){return null}return new Promise(function(t){sap.ui.require(["sap/m/P13nSortPanel","sap/m/P13nItem","sap/m/P13nSortItem"],function(e,o,r){return t(new e({containerQuery:true,items:{path:"$sapmP13nPanel>/transientData/sort/sortItems",template:new o({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},sortItems:{path:"$sapmP13nPanel>/controlDataReduce/sort/sortItems",template:new r({columnKey:"{$sapmP13nPanel>columnKey}",operation:"{$sapmP13nPanel>operation}"})},beforeNavigationTo:this.setModelFunction(),updateSortItem:function(){this.fireAfterPotentialModelChange({json:this.getControlDataReduce()})}.bind(this),addSortItem:function(t){if(!t.getParameter("sortItemData")){return}var e=t.getParameter("index");var o=t.getParameter("sortItemData");var r={columnKey:o.getColumnKey(),operation:o.getOperation()};var n=this.getControlDataReduce();if(e>-1){n.sort.sortItems.splice(e,0,r)}else{n.sort.sortItems.push(r)}this.setControlDataReduce2Model(n);this.fireAfterPotentialModelChange({json:n})}.bind(this),removeSortItem:function(t){var e=t.getParameter("index");if(e<0){return}var o=this.getControlDataReduce();o.sort.sortItems.splice(e,1);this.setControlDataReduce2Model(o);this.fireAfterPotentialModelChange({json:o})}.bind(this)}))}.bind(this))}.bind(this))};a.prototype.retrieveAdaptationUI=function(t){if(!r.hasSortableColumns(this.getColumnMap())){return null}return new Promise(function(t){sap.ui.require(["sap/m/p13n/SortPanel"],function(e){var o=this.getAdaptationData();var r=new e;r.setP13nData(o);this.oPanel=r;r.attachChange(function(t){var e=r.getP13nData(true);var o=this.getControlDataReduce();o.sort.sortItems=e.map(function(t){return{columnKey:t.name,operation:t.descending?"Descending":"Ascending"}});this.setControlDataReduce2Model(o);this.fireAfterPotentialModelChange({json:o})}.bind(this));t(r)}.bind(this))}.bind(this))};a.prototype._transformAdaptationData=function(e,o){var r=t.prototype._transformAdaptationData.apply(this,arguments);r.sorted=!!e;r.descending=e?e.operation==="Descending":false;return r};a.prototype._sortAdaptationData=function(t){this._getP13nBuilder().sortP13nData({visible:"sorted",position:"position"},t)};a.prototype._getPresenceAttribute=function(){return"sorted"};a.prototype.getChangeType=function(t,e){if(!e||!e.sort||!e.sort.sortItems){return o.personalization.ChangeType.Unchanged}var r=JSON.stringify(t.sort.sortItems)!==JSON.stringify(e.sort.sortItems);return r?o.personalization.ChangeType.ModelChanged:o.personalization.ChangeType.Unchanged};a.prototype.getChangeData=function(t,e){if(!t||!t.sort||!t.sort.sortItems){return{sort:{sortItems:[]}}}if(!e||!e.sort||!e.sort.sortItems){return{sort:r.copy(t.sort)}}if(JSON.stringify(t.sort.sortItems)!==JSON.stringify(e.sort.sortItems)){return{sort:r.copy(t.sort)}}return null};a.prototype.getUnionData=function(t,e){if(!e||!e.sort||!e.sort.sortItems){return{sort:r.copy(t.sort)}}return{sort:r.copy(e.sort)}};a.prototype.exit=function(){t.prototype.exit.apply(this,arguments);var e=this.getTable();if(e&&e.detachSort){e.detachSort(this._onSort,this)}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/UIManager", ["sap/ui/mdc/p13n/UIManager","sap/ui/base/Object"],function(a,i){"use strict";var n=a.extend("sap.ui.comp.personalization.UIManager",{constructor:function(a){this.oAdaptationProvider=a;i.call(this)}});return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Util", ["sap/ui/comp/library","sap/m/library","sap/base/util/deepExtend"],function(e,t,r){"use strict";var n=e.personalization.ChangeType;var a=e.personalization.AggregationRole;var i=e.personalization.TableType;var o=e.personalization.ColumnType;var u={getColumnKeys:function(e){if(!e||!e.length){return[]}return e.map(function(e){return this.getColumnKey(e)},this)},sortItemsByText:function(e,t){var r;try{var r=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=="undefined"){var n=window.Intl.Collator(r,{numeric:true});e.sort(function(e,r){return n.compare(e[t],r[t])})}else{e.sort(function(e,n){return e[t].localeCompare(n[t],r,{numeric:true})})}}catch(e){}},getUnionOfAttribute:function(e,t){var r=[];var n=function(e){if(r.indexOf(e)<0){r.push(e)}};for(var a in e){var i=e[a];if(!i[t]){continue}i[t].forEach(n)}return r},getUnionOfColumnKeys:function(e){var t=[];var r=function(e){t=t.concat(e.map(function(e){return e.columnKey}));t=t.filter(function(e,r){return t.indexOf(e)===r})};for(var n in e){for(var a in e[n]){if(!Array.isArray(e[n][a])){continue}r(e[n][a])}}return t},copy:function(e){if(e instanceof Array){return r([],e)}else{return r({},e)}},sort:function(e,t){var r=this.copy(t);r.sort(function(t,r){var n=t[e].toLocaleLowerCase();var a=r[e].toLocaleLowerCase();if(n<a){return-1}if(n>a){return 1}return 0});return r},removeEmptyProperty:function(e){for(var t in e){if(e[t]===null||e[t]===undefined){delete e[t]}}return e},semanticEqual:function(e,t){if(!e||!t){return false}for(var r in e){if(e[r]!==t[r]){return false}}return true},hasChangedType:function(e){for(var t in e){if(e[t]===n.ModelChanged||e[t]===n.TableChanged){return true}}return false},isNamespaceChanged:function(e,t){if(e[t]){return e[t]===n.ModelChanged||e[t]===n.TableChanged}return false},createArrayFromString:function(e){if(!e){return[]}var t=[];var r=e.split(",");r.forEach(function(e){if(e!==""){t.push(e.trim())}});return t},getIndexByKey:function(e,t,r){if(!r||!r.length){return-1}var n=-1;r.some(function(r,a){if(r[e]!==undefined&&r[e]===t){n=a;return true}});return n},getColumnKey:function(e){return this._getCustomProperty(e,"columnKey")||e.getId()},getColumnType:function(e){return this._getCustomProperty(e,"type")},hasSortableColumns:function(e){for(var t in e){if(u.isSortable(e[t])){return true}}return false},hasGroupableColumns:function(e){for(var t in e){if(u.isGroupable(e[t])){return true}}return false},hasFilterableColumns:function(e){for(var t in e){if(u.isFilterable(e[t])){return true}}return false},hasAggregatableColumns:function(e){for(var t in e){if(u.isAggregatable(e[t])){return true}}return false},isGroupable:function(e){if(e&&e.isA("sap.ui.table.AnalyticalColumn")){return e.isGroupableByMenu()||this._getCustomProperty(e,"isGroupable")}if(e&&e.isA("sap.m.Column")){return this.isSortable(e)}return false},isSortable:function(e){if(e.getSortProperty){return!!e.getSortProperty()}return!!this._getCustomProperty(e,"sortProperty")},isFilterable:function(e){if(e.getFilterProperty){return!!e.getFilterProperty()}return!!this._getCustomProperty(e,"filterProperty")},isAggregatable:function(e){if(e.getAggregationRole){return e.getAggregationRole()===a.Dimension||e.getAggregationRole()===a.Measure}return false},getArrayElementByKey:function(e,t,r){if(!r||!r.length){return null}var n=null;r.some(function(r){if(r[e]!==undefined&&r[e]===t){n=r;return true}});return n},isColumnIgnored:function(e,t){if(!t){return false}return t.indexOf(this.getColumnKey(e))>-1},createSort2Json:function(e,t,r,n){if(this.getTableBaseType(e)!==i.Table&&this.getTableType(e)!==i.ChartWrapper){return}this.addSortPersistentData(this._mapTable2P13nSortJson(e),{sort:{sortItems:t}},r,n)},addSortPersistentData:function(e,t,r,n){var a=[];e.sort.sortItems.forEach(function(e){if(!e.isSorted||r.indexOf(e.columnKey)>-1){return}t.sort.sortItems.push({columnKey:e.columnKey,operation:e.operation});a.push(e.columnKey)});if(n){n.forEach(function(e){if(a.indexOf(e.name)>-1||!e.sorted){return}t.sort.sortItems.push({columnKey:e.name,operation:e.sortOrder,initiallyNotVisibleColumn:true})})}},_mapTable2P13nSortJson:function(e){return{sort:{sortItems:e.getColumns().map(function(e){return{columnKey:u.getColumnKey(e),isSorted:e.getSorted(),operation:e.getSortOrder()}})}}},getTableType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ChartWrapper":return i.ChartWrapper;case"sap.ui.comp.personalization.SelectionWrapper":return i.SelectionWrapper;case"sap.m.Table":return i.ResponsiveTable;case"sap.ui.table.AnalyticalTable":return i.AnalyticalTable;case"sap.ui.table.TreeTable":return i.TreeTable;case"sap.ui.table.Table":return i.Table}return null},getTableBaseType:function(e){switch(this.getTableType(e)){case i.ChartWrapper:return i.ChartWrapper;case i.SelectionWrapper:return i.SelectionWrapper;case i.ResponsiveTable:return i.ResponsiveTable;case i.AnalyticalTable:case i.Table:case i.TreeTable:return i.Table}return null},getColumnBaseType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ColumnWrapper":return o.ColumnWrapper;case"sap.m.Column":return o.ResponsiveColumn;case"sap.ui.table.AnalyticalColumn":case"sap.ui.table.Column":return o.TableColumn}return null},_getCustomProperty:function(e,t){var r=this._getCustomData(e);if(!r||!t){return null}return r[t]},_getCustomData:function(e){if(!e){return null}var t=e.data("p13nData");if(typeof t==="string"){try{t=JSON.parse(t);e.data("p13nData",t)}catch(e){}}return t},getColumnKeysOfType:function(e,t){var r=[];for(var n in t){if(this.getColumnType(t[n])===e){r.push(n)}}return r},convertFilters:function(e,t){if(e&&e.filter&&e.filter.filterItems){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var a=this.getColumnKeysOfType("datetime",t);e.filter.filterItems.forEach(function(e){var i=t&&t[e.columnKey];if(r.indexOf(e.columnKey)>-1||n.indexOf(e.columnKey)>-1||a.indexOf(e.columnKey)>-1){if(i&&i.data("p13nData")&&i.data("p13nData").edmType==="Edm.String"){return}if(e.value1&&typeof e.value1==="string"){e.value1=new Date(e.value1)}if(e.value2&&typeof e.value2==="string"){e.value2=new Date(e.value2)}}})}},convertSelectOptions:function(e,t){if(e&&e.SelectOptions){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var a=this.getColumnKeysOfType("datetime",t);e.SelectOptions.forEach(function(e){e.Ranges.forEach(function(t){if(r.indexOf(e.PropertyName)>-1||n.indexOf(e.PropertyName)>-1||a.indexOf(e.PropertyName)>-1){if(t.Low&&typeof t.Low==="string"){t.Low=new Date(t.Low)}if(t.High&&typeof t.High==="string"){t.High=new Date(t.High)}}})})}}};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Validator", ["sap/ui/comp/library","sap/m/library","sap/ui/core/library"],function(e,r,s){"use strict";var n=s.MessageType;var o=r.P13nPanelType;var a=e.personalization.TableType;var i={checkGroupAndColumns:function(e,r,s,i,t){if(e!==a.AnalyticalTable||!r.group||!r.columns){return Promise.resolve(t)}for(var u in s){var l=r.columns.controller.isColumnSelected(i.columns,u);var c=r.group.controller.isGroupSelected(i.group,u);if(c&&!l){t.push({columnKey:u,panelTypes:[o.group,o.columns],messageType:n.Warning,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_MSG_GROUPING_NOT_POSSIBLE_DESCRIPTION")})}}return Promise.resolve(t)},checkSaveChanges:function(e,r,s,i){if(e!==a.SelectionWrapper){return Promise.resolve(i)}return r.selection.payload.callbackSaveChanges(s).then(function(e){if(e){return i}i.push({panelTypes:[o.selection],messageType:n.Error,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_MSG_CHANGES_SAVE_FAILED")});return i})},checkChartConsistency:function(e,r,s,i){if(e!==a.ChartWrapper){return Promise.resolve(i)}return r.dimeasure.controller.isChartConsistent(s).then(function(e){if(!e){i.push({panelTypes:[o.dimeasure],messageType:n.Error,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_MSG_VALIDATION_CHARTTYPE")})}return i})},checkVisibleItemsThreshold:function(e,r,s,a){if(!r.columns){return Promise.resolve(a)}var i=-1;if(r.columns.payload&&r.columns.payload.visibleItemsThreshold){i=r.columns.payload.visibleItemsThreshold}var t=s.columns.columnsItems.filter(function(e){return e.visible}).length;if(i>-1&&t>i){a.push({panelTypes:[o.columns],messageType:n.Warning,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_P13N_VISIBLE_ITEMS_THRESHOLD_MESSAGE")})}return Promise.resolve(a)}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/BaseValueListProvider", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/base/EventProvider","sap/ui/comp/odata/ODataType","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/DateTimeUtil","sap/base/Log","sap/m/Token","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/table/Util"],function(jQuery,t,e,i,a,s,o,n,r,l,h,d){"use strict";var u=t.smartfilterbar.DisplayBehaviour;var p=t.ANALYTICAL_PARAMETER_PREFIX;var f=e.extend("sap.ui.comp.providers.BaseValueListProvider",{constructor:function(t){e.call(this);this.sFieldName=t.fieldName;this.oControl=t.control;this.oODataModel=t.model;this.oFilterModel=t.filterModel;this.oFilterProvider=t.filterProvider;this.sDisplayFormat=t.displayFormat;this._oDateFormatSettings=t.dateFormatSettings;this._aValidationPromises=[];this.sContext=t.context;this.fnAsyncWritePromise=t.fnAsyncWritePromise;this._selectedODataRowHandler=t.selectedODataRowHandler;if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._fieldViewMetadata=t.fieldViewMetadata;this.sValueListEntitySetName=null;this.bResolveInOutParams=t.resolveInOutParams===false?false:true;this.sDisplayBehaviour=t.displayBehaviour;this.sDDLBDisplayBehaviour=this.sDisplayBehaviour;if(!this.sDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour===u.auto){this.sDDLBDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultDropDownDisplayBehaviour:u.descriptionOnly}this._sType=t.type;this._sMaxLength=t.maxLength;this.sPropertyTypePath="";if(this.bResolveInOutParams&&!this.oFilterModel&&!this.oFilterProvider){this._resolvePropertyPath()}if(t.loadAnnotation&&t.fullyQualifiedFieldName){this._oMetadataAnalyser=t.metadataAnalyser;this._sFullyQualifiedFieldName=t.fullyQualifiedFieldName;this._attachAnnotationLoadOnRender()}else{if(t.loadAnnotation){n.error("BaseValueListProvider","loadAnnotation is true, but no fullyQualifiedFieldName set for field '"+(this._sFullyQualifiedFieldName||this.sFieldName)+"'! Please check your annotations")}this._onAnnotationLoad({primaryValueListAnnotation:t.annotation,additionalAnnotations:t.additionalAnnotations})}}});f.prototype._attachAnnotationLoadOnRender=function(){this.oBeforeRenderingEventDelegate={onBeforeRendering:function(){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate,this);delete this.oBeforeRenderingEventDelegate;if(!this._bValueListRequested){if(this.bInitialised){if(this._onMetadataInitialised&&this.sAggregationName&&!this.bTypeAheadEnabled&&this.oControl.$()){this._onMetadataInitialised()}}else{this._loadAnnotation()}}}};this.oControl.addEventDelegate(this.oBeforeRenderingEventDelegate,this)};f.prototype.loadAnnotation=function(){if(this.oBeforeRenderingEventDelegate){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate,this);delete this.oBeforeRenderingEventDelegate}if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate,this);delete this.oAfterRenderingEventDelegate}return this._loadAnnotation()};f.prototype._loadAnnotation=function(){if(!this._bValueListRequested){this._bValueListRequested=true;if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new a(this.oODataModel);this._bCleanupMetadataAnalyser=true}return this.getValueListAnnotation().then(this._onAnnotationLoad.bind(this),function(t){this._oError=t;this.bInitialised=true;n.debug(t)}.bind(this))}return Promise.resolve()};f.prototype.getValueListAnnotation=function(){var t;if(a.hasValueListRelevantQualifiers(this._fieldViewMetadata)){t=this.oControl.getBindingContext()&&this.oControl.getBindingContext().getPath()}return this._oMetadataAnalyser.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,t)};f.prototype.attachValueListChanged=function(t,e){this.attachEvent("valueListChanged",t,e)};f.prototype.detachValueListChanged=function(t,e){this.detachEvent("valueListChanged",t,e)};f.prototype._onAnnotationLoad=function(t){var e={};this.oPrimaryValueListAnnotation=t.primaryValueListAnnotation;this.additionalAnnotations=t.additionalAnnotations;this._resolveAnnotationData(this.oPrimaryValueListAnnotation);this.bInitialised=true;if(this._fBaseValueListProviderResolve){this._fBaseValueListProviderResolve()}if(this._onMetadataInitialised&&this.sAggregationName&&!this.bTypeAheadEnabled&&this.oControl.$()){this._onMetadataInitialised()}if(t.primaryValueListAnnotation&&t.primaryValueListAnnotation.annotation||t.primaryValueListAnnotationWithPVQualifier&&t.primaryValueListAnnotationWithPVQualifier.annotation){e.primaryValueListAnnotation=t.primaryValueListAnnotation||t.primaryValueListAnnotationWithPVQualifier}if(Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0){e.additionalAnnotations=t.additionalAnnotations}if(Array.isArray(t.additionalAnnotationsWithPVQualifier)&&t.additionalAnnotationsWithPVQualifier.length>0){if(Array.isArray(e.additionalAnnotations)){e.additionalAnnotations=e.additionalAnnotations.concat(t.additionalAnnotationsWithPVQualifier)}else{e.additionalAnnotations=t.additionalAnnotationsWithPVQualifier}}return e};f.prototype._resolvePropertyPath=function(){var t=this.oControl.getBindingInfo("value"),e,i,a;if(t&&t.parts){e=t.parts[0]?t.parts[0].path:""}if(e){a=e.split("/");if(a.length>1){i=a[a.length-1];this.sPropertyTypePath=e.replace("/"+i,"")}}};f.prototype._resolveAnnotationData=function(t){var e=0,i=0,a,s,o;if(this.oODataModel&&t){this.bSupportBasicSearch=t.isSearchSupported;this.sValueListTitle=t.valueListTitle||t.qualifier;this.sKey=t.keyField;this._aKeys=t.keys;this.sValueListEntitySetName=t.valueListEntitySetName;this.mInParams=t.inParams;this.mOutParams=t.outParams;this.mConstParams=t.constParams;this.sTokenDisplayBehaviour=this.sDisplayBehaviour;if(!this.sTokenDisplayBehaviour||this.sTokenDisplayBehaviour===u.auto){this.sTokenDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultTokenDisplayBehaviour:u.descriptionAndId}this.sSingleFieldDisplayBehaviour=this.sDisplayBehaviour;if(!this.sSingleFieldDisplayBehaviour||this.sSingleFieldDisplayBehaviour===u.auto){this.sSingleFieldDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultSingleFieldDisplayBehaviour:u.descriptionAndId}if(!t.descriptionField){this.sTokenDisplayBehaviour=u.idOnly;this.sSingleFieldDisplayBehaviour=u.idOnly}this.sDescription=t.descriptionField||this.sKey;if(this.sValueListEntitySetName&&this.sKey){this._aCols=[];this._aCombinedDescriptionColNames=[];this.aSelect=[];a=t.valueListFields;o=t.aHighImportanceFields;if(o&&o.length){this._aHighImportanceCols=[]}e=a.length;for(i=0;i<e;i++){s=a[i];if(s.visible){var r=this._getColumnConfigFromField(s);if(r&&o&&o.indexOf(s)!==-1){this._aHighImportanceCols.push(r)}if(r){this._aCols.push(r)}}this.aSelect.push(s.name)}if(t.descriptionField){this.aSelect.push(t.descriptionField)}if(t.deprecationCodeField){this.aSelect.push(t.deprecationCodeField)}}else{if(!this.sKey){n.error("BaseValueListProvider","key for ValueListEntitySetName '"+this.sValueListEntitySetName+"' missing! Please check your annotations")}}}};f.prototype._getColumnConfigFromField=function(t){if(this._aCombinedDescriptionColNames&&this._aCombinedDescriptionColNames.includes(t.name)){return}var e=null,s=null,o,n,r=t.displayBehaviour||this._oMetadataAnalyser&&this._oMetadataAnalyser.getTextArrangementValue(t.fullName),l=this._oMetadataAnalyser&&this._oMetadataAnalyser.getDescriptionFieldName(t.name,this.sValueListEntitySetName),h=t.maxLength||0,p=0,f=0,m=t.name;if(t.type==="Edm.Boolean"){e="boolean"}else if(t.type==="Edm.DateTime"&&t.displayFormat==="Date"){e="date";n=this._oDateFormatSettings;o={displayFormat:"Date"}}else if(t.type==="Edm.Decimal"){e="decimal";o={precision:t.precision,scale:t.scale}}else if(t.type==="Edm.String"){if(t.isCalendarDate){e="stringdate"}else{e="string"}}if(a.hasTextArrangementAnnotation(t)&&l&&r&&(r===u.idAndDescription||r===u.descriptionAndId)){var y=this.oPrimaryValueListAnnotation.valueListFields.find(function(t){return t.name===l});p=y?y.maxLength:0;f=1;m=[t.name,l];this._aCombinedDescriptionColNames.push(l)}o=Object.assign({maxLength:""+(parseInt(h)+parseInt(p)+f)},o);s=i.getType(t.type,n,o,t.isCalendarDate);return{description:t.description,displayBehaviour:r,label:t.fieldLabel,tooltip:t.quickInfo||t.fieldLabel,type:e,oType:s,suggestionsWidth:d.calcColumnWidth(s,t.fieldLabel),width:d.calcColumnWidth(s,t.fieldLabel,{headerGap:true}),template:m,sort:t.sortable?t.name:undefined,sorted:t.sortable&&t.name===this.sKey,sortOrder:"Ascending"}};f.prototype._getFilterData=function(){var t,e={};if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){t=this.oFilterProvider._oSmartFilter.getFilterData();if(this.sFieldName&&this.sFieldName.indexOf(p)===0){Object.keys(t).forEach(function(i){var a=i.split(p);e[a[a.length-1]]=t[i]});return e}}return t};f.prototype._setFilterData=function(t){var e=t,i={};if(this.oFilterProvider){if(this.sFieldName&&this.sFieldName.indexOf(p)===0){Object.keys(t).forEach(function(e){i[p+e]=t[e]});e=i}this.oFilterProvider.setFilterData(e)}};f.prototype._adaptPropertyValue=function(t,e){var i=e;if((e instanceof Date||typeof e==="string"&&!isNaN(e))&&this.oPrimaryValueListAnnotation&&this.oPrimaryValueListAnnotation.fields){var a=null;this.oPrimaryValueListAnnotation.fields.some(function(e){if(e.name===t){a=e}return a!==null});if(a&&a.type==="Edm.DateTime"&&a.displayFormat==="Date"){i=o.utcToLocal(e)}if(a&&a.isDigitSequence){var s=new RegExp("^[0]*$");if(s.test(e)){i=null}}}return i};f.prototype._calculateFilterInputData=function(){var t,e,i=null,a,s;delete this.mFilterInputData;this.mFilterInputData={};this.aFilterField=[];if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){i=this._getFilterData()}else if(this.oFilterModel){i=this.oFilterModel.getData()}if(this.mInParams&&i){for(t in this.mInParams){if(t){e=this.mInParams[t];e=e.replace("/",".");if(e!==this.sKey){if(this.sContext==="mdcFilterPanel"||this.sContext==="SmartFilterBar"&&this._isFieldHiddenInFilterBar(this.oFilterProvider._oSmartFilter,t)){continue}if(i[t]){this.mFilterInputData[e]=i[t];if(typeof this.mFilterInputData[e]==="object"){if(this.mFilterInputData[e].ranges&&this.mFilterInputData[e].ranges.length>0){for(var o=0;o<this.mFilterInputData[e].ranges.length;o++){this.mFilterInputData[e].ranges[o].keyField=e}}}this.aFilterField.push(e)}}}}}else if(this.oODataModel&&this.bResolveInOutParams){a=this.oControl.getBindingContext();if(this.mInParams&&a){for(t in this.mInParams){if(t){e=this.mInParams[t];e=e.replace("/",".");if(e!==this.sKey){var n=this.sPropertyTypePath?this.sPropertyTypePath+"/"+t:t;var r=a.getProperty(n);if(r||r===false){r=this._adaptPropertyValue(e,r);this.mFilterInputData[e]=r;this.aFilterField.push(e)}}}}}}if(this.mConstParams){for(s in this.mConstParams){this.mFilterInputData[s]=this.mConstParams[s];this.aFilterField.push(s)}}};f.prototype._isFieldHiddenInFilterBar=function(t,e){var i=t&&(t._getFilterItemByName(e)||t._getFilterItemByName(p+e));return!i||!i.getVisibleInAdvancedArea()};f.prototype._calculateAndSetFilterOutputData=function(t){var e,i,a,n=null,r,l,h,d,u,p,f;if(this.mOutParams&&t&&(this.oFilterProvider||this.oFilterModel)){n={};u=function(t){return t.key===h.key};p=function(t){if(h.value1 instanceof Date&&t.value1 instanceof Date){return t.operation==="EQ"&&h.value1.getTime()===t.value1.getTime()}return t.operation==="EQ"&&h.value1===t.value1};f=function(t){return t.operation==="EQ"&&h.key===t.value1};for(e in this.mOutParams){if(e){if(!this.oFilterProvider&&Object.keys(this.mOutParams).length>1){if(e!==this.sFieldName){continue}}var m=this.oFilterProvider&&this.oFilterProvider._getFieldMetadata(e);a=this.mOutParams[e];if(t.length>0){for(var d=0;d<this._aCols.length;d++){if(this._aCols[d].template===a){var y=this._aCols[d].description;i=t[0][y]}}}if(a!==this.sKey){l=null;d=t.length;while(d--){r=t[d];if(this.sContext==="mdcFilterPanel"||this.sContext==="SmartFilterBar"&&this._isFieldHiddenInFilterBar(this.oFilterProvider._oSmartFilter,e)){continue}if(r[a]){var g=r[a];var v=m&&(m.type==="Edm.DateTime"||!m.hasValueListAnnotation);if(v){if(m.type==="Edm.DateTime"&&this._oDateFormatSettings.UTC==true){g=o.utcToLocal(g)}h={exclude:false,operation:"EQ",keyField:e,value1:g,value2:null}}else{h={key:g,text:s.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,g,i)}}if(!n[e]){if(!l&&this.oFilterModel){l=this.oFilterModel.getData()}if(l&&l[e]&&l[e].items){n[e]=l[e];if(!n[e].ranges){n[e].ranges=[]}}else{n[e]={items:[],ranges:[]}}}var c=n[e];if(v){if(c.ranges.filter(p).length<=0){c.ranges.push(h)}}else if(c.items.filter(u).length<=0){if(!c.ranges||c.ranges.filter(f).length<=0){c.items.push(h)}}}}}}}if(n){if(this.oFilterProvider){this._setFilterData(n);if(!jQuery.isEmptyObject(n)){this.fireEvent("valueListChanged",{changes:Object.keys(n)})}}else if(this.oFilterModel){this.oFilterModel.setData(n,true)}}}else if(this.oODataModel&&this.bResolveInOutParams){this._calculateAndSetODataModelOutputData(t[0])}};f.prototype._calculateAndSetODataModelOutputData=function(t){var e,i,a,s,o,n={};if(t&&this.mOutParams){e=this.oControl.getBindingContext();for(i in this.mOutParams){if(i){a=this.mOutParams[i];if(a!==this.sKey){o=t[a];n[i]=o;s=this.sPropertyTypePath?this.sPropertyTypePath+"/"+i:i;this.oODataModel.setProperty(s,o,e,true)}}}if(n&&!jQuery.isEmptyObject(n)){this.fireEvent("valueListChanged",{changes:n})}}};f.prototype._handleRowsSelect=function(t){var e,i,a,o,n,l=[],h,d;if(!(this.oControl&&this.oControl.addToken)){return}h=this.oControl.getTokens();for(e=0;e<t.length;e++){a=t[e][this.sKey];o=t[e][this.sDescription];if(a||a===""){o=s.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,a,o);n=new r({key:a,text:o,tooltip:o});n.data("row",t[e]);l.push(n);for(i=0;i<h.length;i++){d=h[i];var u=d.getKey();if(u||u===""&&u===a){break}else if(d.data("range")&&!d.data("range").exclude&&d.data("range").operation==="EQ"&&d.data("range").value1==a){break}}if(i<h.length){h.splice(i,1)}}}if(l.length){this.oControl.setTokens(h.concat(l))}};f.prototype.readData=function(t){var e=[],i;this._oReadPromise=new Promise(function(t){this._fBaseValueListProviderResolve=t}.bind(this));if(this.bInitialised){this._fBaseValueListProviderResolve()}this._oReadPromise.then(function(){this._fBaseValueListProviderResolve=null;for(var a=0;a<t.length;a++){i=this.sDisplayFormat==="UpperCase"?t[a].toUpperCase():t[a];e.push(new l(this.sKey,h.EQ,i))}if(!this.sValueListEntitySetName){return}this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:e,success:function(e,i){if(e){if(e.results&&e.results.length!==t.length){n.error("Expecting "+t.length+" result rows, but received "+e.results.length+" rows...");return}var a=e.results;if(this.oControl&&this.oControl.isA("sap.m.MultiInput")&&this.oControl.getTokens().length!==t.length){a=this._getUpdatedDataModelRows(a)}this._handleRowsSelect(a)}}.bind(this),error:function(t){n.error("Error occured reading /"+this.sValueListEntitySetName)}.bind(this)})}.bind(this))};f.prototype._getUpdatedDataModelRows=function(t){var e=this.oControl.getTokens(),i=[];for(var a=0;a<e.length;a++){var s=e[a];var o=s.getKey();if(o){i.push(o)}else if(s.data("range")&&s.data("range").value1){i.push(s.data("range").value1)}}var n=[];for(var a=0;a<t.length;a++){var r=t[a][this.sKey];if(i.indexOf(r)!==-1){n.push(t[a])}}return n};f.prototype._addValidationPromise=function(t){var e,i,a,s=false;for(e=0;e<this._aValidationPromises.length;e++){a=this._aValidationPromises[e];if(a===null){this._aValidationPromises[e]=t;i=e;s=true;break}}if(!s){this._aValidationPromises.push(t);i=this._aValidationPromises.length-1}t.finally(function(){this._removeValidationPromise(i)}.bind(this))};f.prototype._removeValidationPromise=function(t){this._aValidationPromises[t]=null};f.prototype._getCurrentValidationPromises=function(){var t,e,i=[];for(t=0;t<this._aValidationPromises.length;t++){e=this._aValidationPromises[t];this._removeValidationPromise(t);i.push(e)}return i};f.prototype._isMultiFilterField=function(t){return t.isA("sap.m.MultiInput")};f.prototype._getDisplayBehaviour=function(){return this._isMultiFilterField(this.oControl)?this.sTokenDisplayBehaviour:this.sSingleFieldDisplayBehaviour};f.prototype.setValue=function(t){var e=this.oControl,i=e&&e.getBinding("value"),a=i&&i.getType();if(a&&a.isA("sap.ui.comp.smartfield.type.TextArrangement")){a.setSelectedValue(t)}e.setValue(t)};f.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._bCleanupMetadataAnalyser&&this._oMetadataAnalyser){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this.oBeforeRenderingEventDelegate){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate);delete this.oBeforeRenderingEventDelegate}if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate);delete this.oAfterRenderingEventDelegate}this.oControl=null;this.sFieldName=null;this.mFilterInputData=null;this.aFilterField=null;this.sValueListEntitySetName=null;this.oODataModel=null;this.oFilterModel=null;this.oFilterProvider=null;this.oPrimaryValueListAnnotation=null;this.additionalAnnotations=null;this.sDisplayFormat=null;this.bSupportBasicSearch=null;this.bInitialised=null;this._oError=null;this.sValueListTitle=null;this.sKey=null;this._aKeys=null;this.mInParams=null;this.mOutParams=null;this.sDescription=null;this.aSelect=null;this._aCols=null;this._aHighImportanceCols=null;this.sDDLBDisplayBehaviour=null;this.sTokenDisplayBehaviour=null;this._oDateFormatSettings=null;this._fieldViewMetadata=null;this._oReadPromise=null;this._fBaseValueListProviderResolve=null;this.bIsDestroyed=true;this._aValidationPromises=null};return f});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ChartProvider", ["sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/ChartMetadata","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/ODataType","./ControlProvider","sap/ui/core/format/DateFormat"],function(t,e,a,i,r,n,o){"use strict";var s=function(a){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");if(a){this._oParentODataModel=a.model;this.sEntitySet=a.entitySet;this._sIgnoredFields=a.ignoredFields;this._bSkipAnnotationParse=a.skipAnnotationParse==="true";this._sChartQualifier=a.chartQualifier;this._sPresentationVariantQualifier=a.presentationVariantQualifier;this._oDefaultDropDownDisplayBehaviour=a.defaultDropDownDisplayBehaviour;this._bUseTimeseries=a.useTimeSeries;this._sNotAssignedText=a.notAssignedText;try{this._oDateFormatSettings=a.dateFormatSettings?JSON.parse(a.dateFormatSettings):undefined;if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}}catch(t){}if(a.chartLibrary){e.feedWithChartLibrary(a.chartLibrary)}}this._aODataFieldMetadata=[];this._oChartViewMetadata=null;this._oChartDataPointMetadata=null;this._aIgnoredFields=[];this._oMetadataAnalyser=new t(this._oParentODataModel);this._intialiseMetadata()};s.prototype._intialiseMetadata=function(){var t,a=[],i,r,o=0;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);this._sFullyQualifiedEntityTypeName=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);if(!this._bSkipAnnotationParse){this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(this._sFullyQualifiedEntityTypeName,this._sPresentationVariantQualifier);if(this._oPresentationVariant&&this._oPresentationVariant.chartAnnotation){this._oChartAnnotation=this._oPresentationVariant.chartAnnotation}else{this._oChartAnnotation=this._oMetadataAnalyser.getChartAnnotation(this._sFullyQualifiedEntityTypeName,this._sChartQualifier)}}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this._sFullyQualifiedEntityTypeName)}this._generateIgnoredFieldsArray();this._oControlProvider=new n({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,dateFormatSettings:this._oDateFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,enableDescriptions:false,entitySet:this.sEntitySet});if(this._aODataFieldMetadata){this._prepareHierarchy();o=this._aODataFieldMetadata.length}for(r=0;r<o;r++){i=this._aODataFieldMetadata[r];if(this._aIgnoredFields.indexOf(i.name)>-1||!i.visible){continue}if(i.type.indexOf("Edm.")===0){t=this._getFieldViewMetadata(i);this._enrichWithChartViewMetadata(i,t);a.push(i)}}if(this._oChartAnnotation){this._oChartViewMetadata=Object.assign({},this._oChartAnnotation);this._oChartViewMetadata.chartType=e.getChartType(this._oChartViewMetadata.chartType);this._oChartViewMetadata.fields=a}};s.prototype._prepareHierarchy=function(){for(var t=0;t<this._aODataFieldMetadata.length;t++){if(this._aODataFieldMetadata[t].hierarchy){for(var e=0;e<this._aODataFieldMetadata.length;e++){this._aODataFieldMetadata[e].hierarchy=this._aODataFieldMetadata[e].hierarchy||{};this._aODataFieldMetadata[e].hierarchy.up=this._aODataFieldMetadata[e].hierarchy.up||{};if(this._aODataFieldMetadata[t].hierarchy.field===this._aODataFieldMetadata[e].name){this._aODataFieldMetadata[t].hierarchy.down=this._getFieldViewMetadata(this._aODataFieldMetadata[e]);this._aODataFieldMetadata[e].hierarchy.up[this._aODataFieldMetadata[t].hierarchy.type]=this._getFieldViewMetadata(this._aODataFieldMetadata[t])}}}}};s.prototype._setAnnotationMetadata=function(t){if(t&&t.fullName){var e=this._oMetadataAnalyser.getSemanticObjectsFromAnnotation(t.fullName);if(e){t.semanticObjects=e}}};s.prototype._getFieldViewMetadata=function(t){var e=this._oControlProvider.getFieldViewMetadata(t,false);this._setAnnotationMetadata(e);return e};s.prototype._generateIgnoredFieldsArray=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",")}};s.prototype._enrichWithChartViewMetadata=function(e,a){function i(t,e,a){if(e.aggregationRole){return e.aggregationRole===t}if(a){var i=t=="dimension"?a.dimensionFields:a.measureFields;return i&&i.indexOf(e.name)!=-1}return false}e.isMeasure=i("measure",e,this._oChartAnnotation);e.isDimension=i("dimension",e,this._oChartAnnotation);e.isHierarchyDimension=e.hierarchy&&e.hierarchy.type===t.hierarchyType.nodeFor&&i("dimension",e.hierarchy.down,this._oChartAnnotation);e.quickInfo=a.quickInfo;e.modelType=a.modelType;e.hasValueListAnnotation=a.hasValueListAnnotation;e.fullName=a.fullName;e.timeUnitType=this._getTimeUnitType(e);e.dateFormatter=this._getDateFormatter(e);e.isTimeDimension=e.timeUnitType!==undefined;e.role=this._getRole(e);e.hierarchyLevel=this._getHierarchyLevel(e);e.dataPoint=this._getDataPoint(e);e.filterType=a.filterType;if(a.template){e.template=a.template}if(e.isDimension){e.displayBehaviour=a.displayBehaviour}else if(e.isHierarchyDimension){var r=e.hierarchy.up[t.hierarchyType.nodeExternalKeyFor]||a;e.displayBehaviour=r.displayBehaviour;e.description=r.description||r.name}e.isSemanticObject=a.semanticObjects?true:false;this._setInResult(e);this._setSortOrder(e)};s.prototype._getTimeUnitType=function(t){var e;switch(t.type){case"Edm.Date":e="Date";break;case"Edm.DateTime":case"Edm.DateTimeOffset":if(t.displayFormat==="Date"){e="Date"}break;case"Edm.String":if(t.isCalendarDate){e="yearmonthday";break}if(i.isYearWeek(t)){e="yearweek";break}if(i.isYearMonth(t)){e="yearmonth";break}if(i.isYearQuarter(t)){e="yearquarter";break}if(a.isFiscalYear(t)){e="fiscalyear";break}if(a.isFiscalYearPeriod(t)){e="fiscalyearperiod";break}break}return e};s.prototype._getDateFormatter=function(t){var e,a;switch(t.type){case"Edm.Date":a=o.getDateInstance(this._oDateFormatSettings);break;case"Edm.Time":a=o.getTimeInstance(this._oDateFormatSettings);break;case"Edm.DateTimeOffset":case"Edm.DateTime":if(t.displayFormat==="Date"){a=o.getDateInstance(this._oDateFormatSettings)}else{a=o.getDateTimeInstance(this._oDateFormatSettings)}break;case"Edm.String":if(t.isCalendarDate&&this._oDateFormatSettings){var i;var n={isCalendarDate:true};if(!e){var s=r.getType("Edm.String",this._oDateFormatSettings,i,n);e=function(t){return s.formatValue(t,"string")}}}else if(!this._bUseTimeseries){var i;var n={isCalendarDate:true};e=this._getDateFormatterForAnnotation(t,i,n)}break}if(a){e=function(t){if(t===""){return this._sNotAssignedText}if(!t){return null}var e=new Date(t);return a.format(e)}.bind(this)}return e};s.prototype._getDateFormatterForAnnotation=function(t,e,a){var i={};var n=this._getParserSettingsForAnnotation(t);var s=this._getParserPrefixForAnnotation(t);if(this._oDateFormatSettings){Object.assign(i,this._oDateFormatSettings)}i.pattern=this._getFormatterPatternForAnnotation(t);if(i.pattern){var h=r.getType("Edm.String",i,e,a);var l=function(t){if(t==""){return this._sNotAssignedText}t=o.getInstance({pattern:n}).parse(t);return s+h.formatValue(t,"string")}.bind(this);return l}};s.prototype._getParserPrefixForAnnotation=function(t){if(i.isYearWeek(t)){return"CW "}else if(i.isYearQuarter(t)){return"Q"}return""};s.prototype._getParserSettingsForAnnotation=function(t){if(t.type==="Edm.String"){var e;if(i.isYearWeek(t)){e="yyyyww"}else if(i.isYearMonth(t)){e="yyyyMM"}else if(i.isYearQuarter(t)){e="yyyyQQQQQ"}return e}};s.prototype._getFormatterPatternForAnnotation=function(t){if(t.type==="Edm.String"){var e;if(t.isCalendarDate){e="d MMMM y"}else if(i.isYearWeek(t)){e="ww y"}else if(i.isYearMonth(t)){e="MMMM y"}else if(i.isYearQuarter(t)){e="Q y"}return e}};s.prototype._setInResult=function(t){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(t.name)>-1){t.inResult=true}}};s.prototype._setSortOrder=function(t){t.sorted=false;t.sortOrder="Ascending";var e;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){e=this._oPresentationVariant.sortOrderFields.length;for(var a=0;a<e;a++){if(this._oPresentationVariant.sortOrderFields[a].name===t.name){t.sorted=true;t.sortOrder=this._oPresentationVariant.sortOrderFields[a].descending?"Descending":"Ascending";t.sortIndex=a;break}}}};s.prototype._unmarkTextDimensions=function(t,e){var a,i;for(a=0;a<t.length;a++){i=t[a];if(i.isDimension){if(e.indexOf(i.name)>-1){i.isDimension=false}}}};s.prototype._getRole=function(t){if(this._oChartAnnotation){if((t.isDimension||t.isHierarchyDimension)&&this._oChartAnnotation.dimensionAttributes[t.name]){return e.getDimensionRole(this._oChartAnnotation.dimensionAttributes[t.name].role)}else if(t.isMeasure&&this._oChartAnnotation.measureAttributes[t.name]){return e.getMeasureRole(this._oChartAnnotation.measureAttributes[t.name].role)}}};s.prototype._getHierarchyLevel=function(t){if(this._oChartAnnotation){if(t.isHierarchyDimension&&this._oChartAnnotation.dimensionAttributes[t.name]){var e=null;try{e=parseInt(this._oChartAnnotation.dimensionAttributes[t.name].hierarchyLevel)}catch(t){e=0}return e}return 0}};s.prototype._getTextPropertyForHierachyDimension=function(e){var a=e.hierarchy.up[t.hierarchyType.nodeExternalKeyFor]||e;return a.description||a.name};s.prototype._getDataPoint=function(t){if(this._oChartAnnotation&&t.isMeasure&&this._oChartAnnotation.measureAttributes[t.name]&&this._oChartAnnotation.measureAttributes[t.name].dataPoint){var e=this._oChartAnnotation.measureAttributes[t.name].dataPoint;var a=e.split("#");var i=a.length===2?a[1]:"";return this._getMeasureDataPoint(i,t.name)}return null};s.prototype.getChartViewMetadata=function(){return this._oChartViewMetadata};s.prototype.getViewField=function(t){var e=this._oChartViewMetadata.fields.filter(function(e){return e.name===t})[0];return e};s.prototype.getChartDataPointMetadata=function(){if(!this._oChartDataPointMetadata&&this._sFullyQualifiedEntityTypeName){this._oChartDataPointMetadata=this._oMetadataAnalyser.getDataPointAnnotation(this._sFullyQualifiedEntityTypeName)}return this._oChartDataPointMetadata};s.prototype._getMeasureDataPoint=function(t,e){var a=this.getChartDataPointMetadata();if(a){var i=null;if(t){if(a.additionalAnnotations){i=a.additionalAnnotations[t]}}else if(a.primaryAnnotation){i=a.primaryAnnotation}if(i!=null&&i.Value&&i.Value.Path==e){return i}}return null};s.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false};s.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this._oControlProvider&&this._oControlProvider.destroy){this._oControlProvider.destroy()}this._oControlProvider=null;this._aODataFieldMetadata=null;this._oChartViewMetadata=null;this._oChartDataPointMetadata=null;this._sIgnoredFields=null;this.bIsDestroyed=true};s.prototype.provideSemanticColoring=function(t){var a={};if(t.Criticality){if(t.Criticality.Path){a={Calculated:t.Criticality.Path}}else{a={Static:e.getCriticalityType(t.Criticality.EnumMember)}}}else{var i={};var r=this._buildThresholds(i,t.CriticalityCalculation);if(r){a={ConstantThresholds:i}}else{a={DynamicThresholds:i}}}return a};s.prototype.calculateDimensionColoring=function(t){var a=e.getValueCriticality(t);if(!a){return null}var i,r,n={Positive:{Values:[]},Critical:{Values:[]},Negative:{Values:[]},Neutral:{Values:[]}};for(var o=0;o<a.length;o++){r=a[o];i=e.calculateValue(r.Value);if(r.Criticality.EnumMember.endsWith("Positive")){n.Positive.Values.push(i)}else if(r.Criticality.EnumMember.endsWith("Critical")){n.Critical.Values.push(i)}else if(r.Criticality.EnumMember.endsWith("Negative")){n.Negative.Values.push(i)}else{n.Neutral.Values.push(i)}}return n};s.prototype._buildThresholds=function(t,a){var i=true;t.ImprovementDirection=e.getImprovementDirectionType(a.ImprovementDirection.EnumMember);var r=e.getCriticalityThresholds();var n=r.length;var o={oneSupplied:false};var s={oneSupplied:false};for(var h=0;h<n;h++){o[r[h]]=a[r[h]]?a[r[h]].Path:undefined;o.oneSupplied=o.oneSupplied||o[r[h]];if(!o.oneSupplied){s[r[h]]=e.calculateConstantValue(a[r[h]]);s.oneSupplied=s.oneSupplied||s[r[h]]}}if(o.oneSupplied){i=false;for(var h=0;h<n;h++){if(o[r[h]]){t[r[h]]=o[r[h]]}}}else{var l;t.AggregationLevels=[];if(s.oneSupplied){l={VisibleDimensions:null};for(var h=0;h<n;h++){if(s[r[h]]){l[r[h]]=s[r[h]]}}t.AggregationLevels.push(l)}if(a.ConstantThresholds&&a.ConstantThresholds.length>0){for(var h=0;h<a.ConstantThresholds.length;h++){var d=a.ConstantThresholds[h];var u=d.AggregationLevel?[]:null;if(d.AggregationLevel&&d.AggregationLevel.length>0){for(var f=0;f<d.AggregationLevel.length;f++){u.push(d.AggregationLevel[f].PropertyPath)}}l={VisibleDimensions:u};for(var f=0;f<n;f++){var y=e.calculateConstantValue(d[r[f]]);if(y){l[r[f]]=y}}t.AggregationLevels.push(l)}}}return i};s.prototype.getMaxItems=function(){var t=-1;if(this._oPresentationVariant&&this._oPresentationVariant.maxItems){t=this._oPresentationVariant.maxItems}return t};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ControlProvider", ["sap/m/CheckBox","sap/m/DatePicker","sap/m/TimePicker","sap/m/HBox","sap/m/Input","sap/m/Text","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/Image","sap/m/Link","sap/m/VBox","sap/m/FlexItemData","sap/m/library","sap/ui/comp/navpopover/SmartLink","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/ODataHelper","sap/ui/comp/smartfield/SmartField","sap/ui/comp/odata/ODataType","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/CriticalityMetadata","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/MultiUnitUtil","sap/ui/core/Control","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/navpopover/NavigationPopoverHandler","./ValueHelpProvider","./ValueListProvider","sap/ui/comp/library"],function(e,t,i,a,n,r,s,o,l,p,c,u,d,m,y,h,f,g,_,b,T,S,v,D,C,F,O,A,M){"use strict";var I;var L=function(e){if(e){this._oParentODataModel=e.model;this._oMetadataAnalyser=e.metadataAnalyser;this._aODataFieldMetadata=e.fieldsMetadata;this._oLineItemAnnotation=e.lineItemAnnotation;this._oSemanticKeyAnnotation=e.semanticKeyAnnotation;this._smartTableId=e.smartTableId;this._bProcessDataFieldDefault=e.processDataFieldDefault;this._isAnalyticalTable=e.isAnalyticalTable;this._isMobileTable=e.isMobileTable;this._oDateFormatSettings=e.dateFormatSettings;this._useUTCDateTime=e.useUTCDateTime;this._bEnableDescriptions=e.enableDescriptions;this._oCurrencyFormatSettings=e.currencyFormatSettings;this._oDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour||"descriptionAndId";this.useSmartField=e.useSmartField==="true";this.useSmartToggle=e.useSmartToggle==="true";this._sEntitySet=e.entitySet;this._oSemanticKeyAdditionalControl=e._semanticKeyAdditionalControl;this._oSemanticObjectController=e.semanticObjectController;this._bPreserveDecimals=e.preserveDecimals;this._oCustomizeConfigTextInEditModeSource=e.textInEditModeSource;this._oCustomizeConfigIgnoreInsertRestrictions=e.ignoreInsertRestrictions}if(!this._oMetadataAnalyser&&this._oParentODataModel){this._oMetadataAnalyser=new y(this._oParentODataModel);this._intialiseMetadata()}this._mSmartField={};this._oHelper=new h(this._oMetadataAnalyser.oModel);this._aValueListProvider=[];this._aValueHelpProvider=[];this._aLinkHandlers=[]};L.prototype._intialiseMetadata=function(){if(!this._aODataFieldMetadata){this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntity)}};L.prototype.getFieldViewMetadata=function(e,t){var i=this._createFieldMetadata(e);this._createFieldTemplate(i,t);return i};L.prototype._getTextInEditModeSource=function(e){if(!this._oCustomizeConfigTextInEditModeSource){return M.smartfield.TextInEditModeSource.None}return this._oCustomizeConfigTextInEditModeSource[e.name]||this._oCustomizeConfigTextInEditModeSource["*"]||M.smartfield.TextInEditModeSource.None};L.prototype._getIgnoreInsertRestrictions=function(e){if(!this._oCustomizeConfigIgnoreInsertRestrictions){return false}if(this._oCustomizeConfigIgnoreInsertRestrictions.hasOwnProperty(e.name)){return this._oCustomizeConfigIgnoreInsertRestrictions[e.name]}return this._oCustomizeConfigIgnoreInsertRestrictions["*"]||false};L.prototype._createFieldTemplate=function(e,t){if(this.useSmartField){e.template=new f({textInEditModeSource:this._getTextInEditModeSource(e),value:{path:e.name},entitySet:this._sEntitySet,contextEditable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},controlContext:this._isMobileTable?"responsiveTable":"table",wrapping:this._isMobileTable});if(g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){e.template.setTextAlign("Right");e.template.setWidth("100%")}this._completeSmartField(e);e.template._setPendingEditState(t)}if(this.useSmartToggle){e.template=new I({editable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},edit:this.useSmartField?e.template:this._createEditableTemplate(e),display:this._createDisplayOnlyTemplate(e)})}else if(!this.useSmartField){e.template=t?this._createEditableTemplate(e):this._createDisplayOnlyTemplate(e)}};L.prototype._completeSmartField=function(e){var t={annotations:{},path:e.name,ignoreInsertRestrictions:this._getIgnoreInsertRestrictions(e)},i,a;if(!this._mSmartField.entitySetObject){this._mSmartField.entitySetObject=this._oHelper.oMeta.getODataEntitySet(this._sEntitySet);this._mSmartField.entityType=this._oHelper.oMeta.getODataEntityType(this._mSmartField.entitySetObject.entityType)}t.modelObject=this._oParentODataModel;t.entitySetObject=this._mSmartField.entitySetObject;t.entitySet=this._mSmartField.entitySetObject;t.entityType=this._mSmartField.entityType;this._oHelper.getProperty(t);e.fieldControlProperty=this._oHelper.oAnnotation.getFieldControlPath(t.property.property);if(e.fieldControlProperty&&e.parentPropertyName){e.fieldControlProperty=e.parentPropertyName+"/"+e.fieldControlProperty}t.annotations.uom=this._oHelper.getUnitOfMeasure2(t);t.annotations.text=this._oHelper.getTextProperty2(t);t.annotations.lineitem=this._oLineItemAnnotation;t.annotations.semantic=y.getSemanticObjectsFromProperty(t.property.property);this._oHelper.getUOMTextAnnotation(t);if(t.property.property["sap:value-list"]||t.property.property["com.sap.vocabularies.Common.v1.ValueList"]){t.annotations.valuelist=this._oHelper.getValueListAnnotationPath(t);if(t.property.property["sap:value-list"]){t.annotations.valuelistType=t.property.property["sap:value-list"]}else{t.annotations.valuelistType=this._oMetadataAnalyser.getValueListSemantics(t.property.property["com.sap.vocabularies.Common.v1.ValueList"])}}this._oHelper.getUOMValueListAnnotationPath(t);delete t.entitySet;if(typeof t.annotations.valuelist==="string"){a=this._oHelper.getAnalyzer().getValueListAnnotation(t.annotations.valuelist);i=a.primaryValueListAnnotation;if(i){t.property.valueListAnnotation=i;t.property.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(i);t.property.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(i.valueListEntitySetName);t.property.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(i.valueListEntitySetName).entityType);t.annotations.valueListData=i}}e.template.data("configdata",{configdata:t});e.template.data("dateFormatSettings",this._oDateFormatSettings);e.template.data("currencyFormatSettings",this._oCurrencyFormatSettings);e.template.data("defaultDropDownDisplayBehaviour",this._oDefaultDropDownDisplayBehaviour);e.template.data("defaultInputFieldDisplayBehaviour",e.displayBehaviour);if(t.annotations.uom||g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){var n=e.template.getTextAlign();if(n==="Initial"){n="Right"}if(g.isNumeric(e.type)&&!e.unit&&e.description&&e.displayBehaviour!=="idOnly"){n=undefined}e.align=n}L._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals)};L.prototype._createEditableTemplate=function(a,r){var s=null,o=L._createModelTypeInstance(a,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals);var l=a.type==="Edm.DateTime"&&a.displayFormat==="Date";if(l||a.isCalendarDate){s=new t({value:{path:a.name,type:o}})}else if(a.type==="Edm.Boolean"){s=new e({selected:{path:a.name}})}if(a.semanticObjects&&!r){s=this._createSmartLinkFieldTemplate(a,o,function(){return this._createEditableTemplate(a,true)}.bind(this))}if(!s){if(a.type==="Edm.Time"){s=new i({value:{path:a.name,type:o}})}else{s=new n({value:{path:a.name,type:o}});if(a.unit){s.bindProperty("description",{path:a.unit});s.setTextAlign("Right");s.setTextDirection("LTR");s.setFieldWidth("80%")}else if(this._bEnableDescriptions&&a.description){s.bindProperty("description",{path:a.description})}else if(g.isNumeric(a.type)||g.isDateOrTime(a.type)||b.isCalendarValue(a)||_.isFiscalValue(a)){a.align="Right";s.setTextAlign("Right");s.setTextDirection("LTR")}if(a.hasValueListAnnotation){this._associateValueHelpAndSuggest(s,a)}}}return s};L.prototype._associateValueHelpAndSuggest=function(e,t){e.setShowValueHelp(true);this._aValueHelpProvider.push(new O({fieldName:t.fieldName,control:e,model:this._oParentODataModel,dateFormatSettings:this._oDateFormatSettings,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,title:t.label,preventInitialDataFetchInValueHelpDialog:true,takeOverInputValue:false,type:t.type,maxLength:t.maxLength}));e.setShowSuggestion(true);e.setFilterSuggests(false);this._aValueListProvider.push(new A({fieldName:t.fieldName,control:e,model:this._oParentODataModel,displayFormat:t.displayFormat,dateFormatSettings:this._oDateFormatSettings,displayBehaviour:t.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,aggregation:"suggestionRows",typeAheadEnabled:true}))};L.prototype._createDisplayOnlyTemplate=function(e,t){var i=null,a=null,n,s,o;a=L._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals);if(g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){n="Right";if(g.isNumeric(e.type)&&!e.unit&&e.description&&e.displayBehaviour!=="idOnly"){n=undefined}}if(e.urlInfo){i=this._createLink(e,a,e.urlInfo)}else if(e.criticalityInfo){i=this._createObjectStatusTemplate(e,a,e.criticalityInfo)}if(this._isMobileTable&&!i){if(e.isImageURL){i=new l({src:{path:e.name},width:"3em",height:"3em"})}else{o=L._getSemanticKeyIndex(e,this._oSemanticKeyAnnotation);if(o>-1){i=this._createObjectIdentifierTemplate(e,a,o===0)}}}if(!i){if(e.semanticObjects&&!t){i=this._createSmartLinkFieldTemplate(e,a,function(){return this._createDisplayOnlyTemplate(e,true)}.bind(this))}else if(e.unit){i=this._createMeasureFieldTemplate(e,a)}else if(e.isEmailAddress||e.isPhoneNumber){i=this._createEmailOrPhoneLink(e,a)}else{s=this._getDefaultBindingInfo(e,a,true);i=new r({wrapping:this._isMobileTable,textAlign:n,text:s})}}e.align=n;return i};L._getSemanticKeyIndex=function(e,t){var i=-1,a;if(t&&t.semanticKeyFields){i=t.semanticKeyFields.indexOf(e.name);if(i<0){a=y.resolveEditableFieldFor(e);i=a?t.semanticKeyFields.indexOf(a):-1}}return i};L._createModelTypeInstance=function(e,t,i,a){var n,r,s={};var o=e.type==="Edm.DateTime"&&e.displayFormat==="Date";if(o||e.isCalendarDate){n=t;r={displayFormat:"Date"}}else if(e.type==="Edm.DateTime"&&i){n={UTC:true}}else if(e.type==="Edm.Decimal"){r={precision:e.precision,scale:e.scale};n={preserveDecimals:a}}else if(e.type==="Edm.String"){r={isDigitSequence:e.isDigitSequence}}if(e.isCalendarDate){s.isCalendarDate=true}if(e.isFiscalDate){s.isFiscalDate=true;s.fiscalType=_.getFiscalAnotationType(e)}r=Object.assign({},r,{maxLength:e.maxLength});if(e.type=="Edm.DateTime"){e.modelType=g.getType(e.type,n,r,s);e.modelType.formatValue(new Date,"string");e.modelType.oFormat.oFormatOptions.UTC=false;return g.getType(e.type,n,r,s)}e.modelType=g.getType(e.type,n,r,s);return e.modelType};L.prototype.createModelTypeInstance=function(e){return L._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals)};L.prototype._createEmailOrPhoneLink=function(e,t){var i=new p({text:this._getDefaultBindingInfo(e,t,true),wrapping:this._isMobileTable,press:function(t){var i=t.getSource().getText();if(e.isEmailAddress){d.URLHelper.triggerEmail(i)}else if(e.isPhoneNumber){d.URLHelper.triggerTel(i)}}});return i};L.prototype._getDefaultBindingInfo=function(e,t,i){var a={path:e.name,type:t,formatter:S.getWhitespaceReplacer(i)};if(e.type==="Edm.DateTimeOffset"&&e.timezone){a={parts:[{path:e.name,type:t},{path:e.timezone}],formatter:S.getDateTimeWithTimezoneFormatter(),useRawValues:true}}else if(this._bEnableDescriptions&&e.description){a={parts:[{path:e.name,type:t},{path:e.description}],formatter:S.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,i)};if(t&&t.getName()==="sap.ui.comp.odata.type.NumericText"&&this._bEnableDescriptions&&e.description){var n=a.formatter;a.formatter=function(e,t,i){if(e===null&&t){e=""}return n(e,t,i)}}}return a};L.prototype._createLink=function(e,t,i){var a=null;e.linkProperties=i.parameters||i.urlPath;if(i.urlPath){a={path:i.urlPath}}else if(i.urlTarget){a=i.urlTarget}return new p({text:this._getDefaultBindingInfo(e,t,true),wrapping:this._isMobileTable,href:a})};L.prototype._createObjectIdentifierTemplate=function(e,t,i){var a,n,r,o,l,p;var u=this;var d=function(t){if(u._oSemanticObjectController&&u._oSemanticObjectController.getForceLinkRendering()&&u._oSemanticObjectController.getForceLinkRendering()[e.name]){return true}var i=e.semanticObjects.additionalSemanticObjects.concat(e.semanticObjects.defaultSemanticObject);return C.hasDistinctSemanticObject(i,t)};if(e.semanticObjects){C.getDistinctSemanticObjects().then(function(t){if(d(t)){p=new F({semanticObject:e.semanticObjects.defaultSemanticObject,additionalSemanticObjects:e.semanticObjects.additionalSemanticObjects,semanticObjectLabel:e.label,fieldName:e.name,semanticObjectController:u._oSemanticObjectController,navigationTargetsObtained:function(e){var t=sap.ui.getCore().byId(e.getSource().getControl());var i=e.getParameters().mainNavigation;if(i){i.setDescription(t.getText())}e.getParameters().show(t.getTitle(),i,undefined,undefined)}});u._aLinkHandlers.push(p)}})}if(e.description){switch(e.displayBehaviour){case"descriptionAndId":e.vertical=true;n=e.description;r=e.name;o=t;break;case"idAndDescription":e.vertical=true;n=e.name;r=e.description;l=t;break;case"idOnly":n=e.name;o=t;break;default:n=e.description;break}}else{n=e.name;l=t}a=new s({title:n?{path:n,type:l,formatter:S.getWhitespaceReplacer(true)}:undefined,text:r?{path:r,type:o,formatter:S.getWhitespaceReplacer(true)}:undefined,titleActive:e.semanticObjects?{path:"$sapuicompcontrolprovider_distinctSO>/distinctSemanticObjects",formatter:function(e){return d(e)}}:false,titlePress:function(e){if(p){p.setControl(e.getSource());p.setBindingContext(e.getSource().getBindingContext());p.openPopover(e.getParameter("domRef"))}}});a.attachEvent("ObjectIdentifier.designtime",function(e){if(p){p.setControl(e.getSource());e.getParameters().registerNavigationPopoverHandler(p)}});a.setModel(C.getJSONModel(),"$sapuicompcontrolprovider_distinctSO");if(this._oSemanticKeyAdditionalControl&&i){this._bSemanticKeyAdditionalControlUsed=true;return new c({renderType:"Bare",items:[a,this._oSemanticKeyAdditionalControl]}).addStyleClass("sapUiTinyMarginTopBottom")}return a};L.prototype._createObjectStatusTemplate=function(e,t,i){var a,n,r,s;r=T.getShowCriticalityIcon(i.criticalityRepresentationType);if(i.path){e.criticality=i.path;a={path:i.path,formatter:T.getCriticalityState};if(i.criticalityRepresentationPath){e.criticalityRepresentation=i.criticalityRepresentationPath;n={parts:[{path:i.path},{path:i.criticalityRepresentationPath}],formatter:function(e,t){return T.getShowCriticalityIcon(t)?T.getCriticalityIcon(e):undefined}}}else if(r){n={path:i.path,formatter:T.getCriticalityIcon}}}else{a=T.getCriticalityState(i.criticalityType);if(i.criticalityRepresentationPath){e.criticalityRepresentation=i.criticalityRepresentationPath;n={path:i.criticalityRepresentationPath,formatter:function(e){return T.getShowCriticalityIcon(e)?T.getCriticalityIcon(i.criticalityType):undefined}}}else if(r){n=T.getCriticalityIcon(i.criticalityType)}}if(e.unit){s={parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?S.getInlineAmountFormatter(this._bPreserveDecimals):S.getInlineMeasureUnitFormatter(this._bPreserveDecimals),useRawValues:true}}else{s=this._getDefaultBindingInfo(e,t,true)}return new o({text:s,state:a,icon:n})};L.prototype._createSmartLinkFieldTemplate=function(e,t,i){var a=e.unit?{parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?S.getAmountCurrencyFormatter(this._bPreserveDecimals):S.getMeasureUnitFormatter(this._bPreserveDecimals),useRawValues:true}:this._getDefaultBindingInfo(e,t,true);var n=new m({semanticObject:e.semanticObjects.defaultSemanticObject,additionalSemanticObjects:e.semanticObjects.additionalSemanticObjects,semanticObjectLabel:e.label,fieldName:e.name,text:a,uom:e.unit?{path:e.unit}:undefined,wrapping:this._isMobileTable,beforeNavigationCallback:this._oSemanticObjectController?this._oSemanticObjectController.getBeforeNavigationCallback():undefined,navigationTargetsObtained:function(t){var i=this.getBinding("text");if(!i||!Array.isArray(i.getValue())||e.unit){t.getParameters().show();return}var a=i.getValue();var n=S.getTextsFromDisplayBehaviour(e.displayBehaviour,a[0],a[1]);var r=t.getParameters().mainNavigation;if(r){r.setDescription(n.secondText)}t.getParameters().show(n.firstText,r,undefined,undefined)}});n.setSemanticObjectController(this._oSemanticObjectController);n.setCreateControlCallback(i);return n};L.prototype._createMeasureFieldTemplate=function(e,t){var i,n,s,o,l,d=false;d=!!(e.isCurrencyField&&this._oCurrencyFormatSettings&&this._oCurrencyFormatSettings.showCurrencySymbol);o=new r({layoutData:this._isMobileTable?undefined:new u({growFactor:1,baseSize:"0%"}),textDirection:"LTR",wrapping:false,textAlign:"End",text:{parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?S.getAmountCurrencyFormatter(this._bPreserveDecimals):S.getMeasureUnitFormatter(this._bPreserveDecimals),useRawValues:true}}).addStyleClass("sapUiCompCurrency").addStyleClass("sapUiCompCurrencyTabNums");l=new r({layoutData:new u({shrinkFactor:0}),textDirection:"LTR",wrapping:false,textAlign:"End",width:"3em",text:{path:e.unit,formatter:d?S.getCurrencySymbolFormatter():undefined}}).addStyleClass("sapUiCompUoMPart").addStyleClass("sapUiCompCurrencyMonoFont");i=new a({renderType:"Bare",justifyContent:"End",wrap:this._isMobileTable?"Wrap":undefined,items:[o,l]});i.addStyleClass("sapUiCompDirectionLTR");if(this._isAnalyticalTable){s=i;s.bindProperty("visible",{path:e.unit,formatter:v.isNotMultiUnit});n=new p({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_LINK_TEXT")||"Show Details",visible:{path:e.unit,formatter:v.isMultiUnit},press:[{value:e.name,unit:e.unit,additionalParent:this.useSmartToggle,smartTableId:this._smartTableId,template:s},v.openMultiUnitPopover]});i=new c({renderType:"Bare",items:[n,s]})}return i};L.prototype._createFieldMetadata=function(e){var t=Object.assign({},e);t.label=e.fieldLabel||e.name;t.quickInfo=e.quickInfo;t.displayBehaviour=t.displayBehaviour||this._oDefaultDropDownDisplayBehaviour;t.filterType=this._getFilterType(e);this._updateValueListMetadata(t);this._setAnnotationMetadata(t);if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(e.name)>-1){t.urlInfo=this._oLineItemAnnotation.urlInfo&&this._oLineItemAnnotation.urlInfo[e.name];t.criticalityInfo=this._oLineItemAnnotation.criticality&&this._oLineItemAnnotation.criticality[e.name]}else if(this._bProcessDataFieldDefault){this._oMetadataAnalyser.updateDataFieldDefault(t)}return t};L.prototype._updateValueListMetadata=function(e){e.hasValueListAnnotation=e["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=e["sap:value-list"]==="fixed-values"}else if(e["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(e["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=y.isValueListWithFixedValues(e)}}};L.prototype._setAnnotationMetadata=function(e){if(e&&e.fullName){e.semanticObjects=this._oMetadataAnalyser.getSemanticObjectsFromAnnotation(e.fullName)}};L.prototype._getFilterType=function(e){return S._getFilterType(e)};L.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(!this._bSemanticKeyAdditionalControlUsed&&this._oSemanticKeyAdditionalControl&&this._oSemanticKeyAdditionalControl.destroy){this._oSemanticKeyAdditionalControl.destroy()}e(this._aValueHelpProvider);this._aValueHelpProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;e(this._aLinkHandlers);this._aLinkHandlers=null;if(this._oHelper){this._oHelper.destroy()}this._oHelper=null;this._mSmartField=null;this._aODataFieldMetadata=null;this._oDateFormatSettings=null;this._oCurrencyFormatSettings=null;this._oDefaultDropDownDisplayBehaviour=null;this._oLineItemAnnotation=null;this._oSemanticKeyAnnotation=null;this._oParentODataModel=null;this.bIsDestroyed=true};I=D.extend("sap.ui.comp.SmartToggle",{metadata:{library:"sap.ui.comp",properties:{editable:{type:"boolean",defaultValue:false}},aggregations:{edit:{type:"sap.ui.core.Control",multiple:false},display:{type:"sap.ui.core.Control",multiple:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("span",t).class("sapUiCompSmartToggle").openEnd();e.renderControl(t.getEditable()?t.getEdit():t.getDisplay());e.close("span")}}});I.prototype.getFocusDomRef=function(){var e=this.getEditable()?this.getEdit():this.getDisplay();if(e){return e.getFocusDomRef()}return D.prototype.getFocusDomRef.call(this)};I.prototype.getAccessibilityInfo=function(){var e=this.getEditable()?this.getEdit():this.getDisplay();if(e&&e.getAccessibilityInfo){return e.getAccessibilityInfo()}return null};I.prototype.addAssociation=function(e,t,i){if(e==="ariaLabelledBy"){var a=this.getEdit(),n=this.getDisplay();a&&a.addAssociation(e,t,i);n&&n.addAssociation(e,t,i)}return D.prototype.addAssociation.apply(this,arguments)};I.prototype.removeAssociation=function(e,t,i){if(e==="ariaLabelledBy"){var a=this.getEdit(),n=this.getDisplay();a&&a.removeAssociation(e,t,i);n&&n.removeAssociation(e,t,i)}return D.prototype.removeAssociation.apply(this,arguments)};I.prototype.removeAllAssociation=function(e,t){if(e==="ariaLabelledBy"){var i=this.getEdit(),a=this.getDisplay();i&&i.removeAllAssociation(e,t);a&&a.removeAllAssociation(e,t)}return D.prototype.removeAllAssociation.apply(this,arguments)};return L},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/TableProvider", ["sap/ui/comp/odata/MetadataAnalyser","./ControlProvider","sap/ui/comp/util/FormatUtil","sap/ui/Device","sap/ui/comp/odata/FiscalMetadata"],function(t,e,i,a,n){"use strict";var o=function(e){if(e){this._oParentODataModel=e.model;this.sEntitySet=e.entitySet;this._sIgnoredFields=e.ignoredFields;this._sInitiallyVisibleFields=e.initiallyVisibleFields;this.isEditableTable=e.isEditableTable;this._smartTableId=e.smartTableId;this._isAnalyticalTable=e.isAnalyticalTable;this._isMobileTable=e.isMobileTable;this.useSmartField=e.useSmartField;this.useSmartToggle=e.useSmartToggle;this.useUTCDateTime=e.useUTCDateTime==="true";this._bSkipAnnotationParse=e.skipAnnotationParse==="true";this._sLineItemQualifier=e.lineItemQualifier;this._sPresentationVariantQualifier=e.presentationVariantQualifier;this.enableInResultForLineItem=e.enableInResultForLineItem==="true";this._oSemanticKeyAdditionalControl=e._semanticKeyAdditionalControl;this._bShowDetailsButton=e.showDetailsButton;this._bEnableAutoColumnWidth=e.enableAutoColumnWidth;this._bPreserveDecimals=e.preserveDecimals;this._oCustomizeConfigTextInEditModeSource=e.textInEditModeSource;this._oCustomizeConfigIgnoreInsertRestrictions=e.ignoreInsertRestrictions;try{var i=function(t){switch(typeof t){case"string":return JSON.parse(t);case"object":if(t==null){return undefined}return t;default:return undefined}};this._oDateFormatSettings=i(e.dateFormatSettings);this._oCurrencyFormatSettings=i(e.currencyFormatSettings);this._oDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour}catch(t){}}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._aODataFieldMetadata=[];this._aTableViewMetadata=[];this._aIgnoredFields=[];this._aInitiallyVisibleFields=[];this._oMetadataAnalyser=new t(this._oParentODataModel);this._oSemanticObjectController=e.semanticObjectController;this._intialiseMetadata()};o.prototype._intialiseMetadata=function(){var t=[],i=-1,a,n,o,s,r,l,d;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);d=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);if(!this._bSkipAnnotationParse){this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(d,this._sPresentationVariantQualifier);if(this._oPresentationVariant){this._oLineItemAnnotation=this._oPresentationVariant.lineItemAnnotation}if(!this._oLineItemAnnotation){this._oLineItemAnnotation=this._oMetadataAnalyser.getLineItemAnnotation(d,this._sLineItemQualifier)}}if(this._isMobileTable){this._oSemanticKeyAnnotation=this._oMetadataAnalyser.getSemanticKeyAnnotation(d)}if(!this._isAnalyticalTable){this._addLineItemNavigationFields(d)}l=this._oMetadataAnalyser.getEntityContainerAttribute("supported-formats");if(l){this._bSupportsExcelExport=l.indexOf("xlsx")>-1;this._oPdfAnnotation=l.indexOf("pdf")>-1&&this._oMetadataAnalyser.getPDFSupportedAnnotation();this._bSupportsPDFExport=this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oPdfAnnotation}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(d)}this._generateArrays();this._oControlProvider=new e({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,lineItemAnnotation:this._oLineItemAnnotation,semanticKeyAnnotation:this._oSemanticKeyAnnotation,_semanticKeyAdditionalControl:this._oSemanticKeyAdditionalControl,processDataFieldDefault:true,isMobileTable:this._isMobileTable,isAnalyticalTable:this._isAnalyticalTable,smartTableId:this._smartTableId,dateFormatSettings:this._oDateFormatSettings,currencyFormatSettings:this._oCurrencyFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,useSmartField:this.useSmartField,useSmartToggle:this.useSmartToggle,useUTCDateTime:this.useUTCDateTime,enableDescriptions:true,entitySet:this.sEntitySet,semanticObjectController:this._oSemanticObjectController,preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions});this._oFieldSemanticObjectMap={};if(this._aODataFieldMetadata){n=this._aODataFieldMetadata.length}for(a=0;a<n;a++){o=this._aODataFieldMetadata[a];if(this._aIgnoredFields.indexOf(o.name)>-1||!o.visible){continue}if(o.type.indexOf("Edm.")===0){s=this._oControlProvider.getFieldViewMetadata(o,this.isEditableTable);this._enrichWithTableViewMetadata(s,i++);t.push(s);if(s.semanticObject){this._oFieldSemanticObjectMap[s.name]=s.semanticObject}}}r=function(t,e){return t.index-e.index};this._aTableViewMetadata=t.sort(r);if(this._isAnalyticalTable&&this._mDimensionFromText){this._aTableViewMetadata.forEach(function(t){var e=this._mDimensionFromText[t.name];if(e&&t.aggregationRole!=="dimension"){if(!t.additionalProperty){t.additionalProperty=e}else{t.additionalProperty+=","+e}}}.bind(this))}};o.prototype._addLineItemNavigationFields=function(t){var e,i,a,n;if(this._aODataFieldMetadata&&this._oLineItemAnnotation){e=this._oLineItemAnnotation.fields;if(e){i=e.length}while(i--){a=e[i];if(a&&a.indexOf("/")>=0){n=this._oMetadataAnalyser.extractNavigationPropertyField(a,this.sEntitySet);if(n){n.name=n.parentPropertyName+"/"+n.name;if(n.description){n.description=n.parentPropertyName+"/"+n.description}if(n.unit){n.unit=n.parentPropertyName+"/"+n.unit}this._aODataFieldMetadata.push(n)}}}}};o.prototype.getFieldSemanticObjectMap=function(){return this._oFieldSemanticObjectMap};o.prototype.getTableViewMetadata=function(){return this._aTableViewMetadata};o.prototype.getSupportsExcelExport=function(){return this._bSupportsExcelExport};o.prototype.getExportCapabilities=function(t){var e={};if(t.indexOf("UI5Client")>-1){e["XLSX"]={}}if(this._bSupportsPDFExport&&t=="UI5ClientPDF"){e["PDF"]={};Object.assign(e["PDF"],this._oPdfAnnotation)}return e};o.prototype.getMultiUnitBehaviorEnabled=function(){return this._oMetadataAnalyser.getMultiUnitBehaviorEnabled()};o.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false};o.prototype.getRequestAtLeastFields=function(){return this._oPresentationVariant&&this._oPresentationVariant.requestAtLeastFields?this._oPresentationVariant.requestAtLeastFields:[]};o.prototype.isLineItemDefaultImportance=function(e){if(e.importance!="High"){return false}var i=this._oLineItemAnnotation&&this._oLineItemAnnotation.annotation||[];return i.some(function(i){return i.Value&&i.Value.Path==e.name&&!t.hasImportance(i)})};o.prototype.getFieldMetadata=function(t,e){var i=this._aTableViewMetadata.concat(this._aODataFieldMetadata).find(function(e){return e.name==t});if(!i&&t&&t.includes("/")){try{i=this._oMetadataAnalyser.extractNavigationPropertyField(t,this.sEntitySet)}catch(t){}}if(i){if(!i.modelType){this._oControlProvider.createModelTypeInstance(i)}if(e&&!i.hasOwnProperty("additionalProperty")){i.additionalProperty=this._getAdditionalProperty(i).join(",")}}return i};o.prototype._generateArrays=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",")}if(this._sInitiallyVisibleFields){this._aInitiallyVisibleFields=this._sInitiallyVisibleFields.split(",")}};o.prototype._getAdditionalProperty=function(t){var e=[];if(t.isMeasureField&&t.unit){e.push(t.unit)}else if(t.description){e.push(t.description)}if(t.criticality){e.push(t.criticality)}if(t.criticalityRepresentation){e.push(t.criticalityRepresentation)}if(t.linkProperties&&t.linkProperties.length){e=e.concat(t.linkProperties)}if(t.fieldControlProperty){e.push(t.fieldControlProperty)}if(t.timezone){e.push(t.timezone)}return e};o.prototype._enrichWithTableViewMetadata=function(t,e){var a=[],o,s,r,l;var d=function(t){var e,i;if(t&&t.indexOf("/")>-1){i=t.split("/");i.pop();e=i.join("/")}return e};this._updateLabel(t);t.importance=this._getFieldImportance(t)||t.importance;t.isInitiallyVisible=this._isInitiallyVisible(t);t.index=this._getIndex(t,e);if(!t.width){l=this._getLineItemFieldWidth(t);if(l){t.width=l}else if(!this._isMobileTable&&!this._bEnableAutoColumnWidth){t.width=i.getWidth(t)}}o=this._getAdditionalProperty(t);r=o.length;if(r){t.additionalProperty=o.join(",")}while(r--){s=d(o[r]);if(s){a.push(s)}}if(t.parentPropertyName){a.push(t.parentPropertyName)}t.navigationProperty=a.join(",");this._setSortOrder(t);if(t.isFiscalDate){n.updateViewMetadata(t)}if(this._isAnalyticalTable){t.summed=t.aggregationRole==="measure";this._setInResult(t);this._setGroupBy(t);this._mapDimensionFromTextProperty(t)}};o.prototype._isInitiallyVisible=function(t){var e=false;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){e=this._oLineItemAnnotation.fields.indexOf(t.name)>-1;if(e&&!a.system.desktop&&!this._bShowDetailsButton){var i=t.importance;if(i){if(a.system.tablet){e=i==="High"||i==="Medium"}else if(a.system.phone){e=i==="High"}}}}if(!e&&this._aInitiallyVisibleFields){e=this._aInitiallyVisibleFields.indexOf(t.name)>-1}return e};o.prototype._setInResult=function(t){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(t.name)>-1){t.inResult=true}}else if(this.enableInResultForLineItem){if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(t.name)>-1){t.inResult=true}}};o.prototype._setSortOrder=function(t){var e;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){e=this._oPresentationVariant.sortOrderFields.length;for(var i=0;i<e;i++){if(this._oPresentationVariant.sortOrderFields[i].name===t.name){t.sorted=true;t.sortOrder=this._oPresentationVariant.sortOrderFields[i].descending?"Descending":"Ascending";break}}}};o.prototype._setGroupBy=function(t){if(this._oPresentationVariant&&this._oPresentationVariant.groupByFields&&this._oPresentationVariant.groupByFields.indexOf(t.name)>=0){t.grouped=true}};o.prototype._getFieldImportance=function(t){var e=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.importance){e=this._oLineItemAnnotation.importance[t.name]}return e};o.prototype._getLineItemFieldWidth=function(t){var e=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.width){e=this._oLineItemAnnotation.width[t.name]}return e};o.prototype._mapDimensionFromTextProperty=function(t){if(!t.description||t.aggregationRole!=="dimension"){return}if(!this._mDimensionFromText){this._mDimensionFromText={}}this._mDimensionFromText[t.description]=t.name};o.prototype._getIndex=function(t,e){var i=-1,a=0,n=0;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){a=this._oLineItemAnnotation.fields.length;i=this._oLineItemAnnotation.fields.indexOf(t.name)}if(i<0&&this._aInitiallyVisibleFields){n=this._aInitiallyVisibleFields.length;i=this._aInitiallyVisibleFields.indexOf(t.name);if(i>-1){i+=a}}if(i>-1){return i}return e+a+n};o.prototype._updateLabel=function(t){var e;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.labels){e=this._oLineItemAnnotation.labels[t.name]}if(e){t.label=e;if(t.template&&t.template.setSemanticObjectLabel){t.template.setSemanticObjectLabel(t.label)}}};o.prototype.getFieldLabel=function(t,e){if(!e){return null}var i;if(e.indexOf("/")>-1){i=this._oMetadataAnalyser.extractNavigationPropertyField(e,t)}else{i=this._oMetadataAnalyser.getFieldsByEntitySetName(t).find(function(t){return t.name==e})}if(!i){return null}return i["com.sap.vocabularies.Common.v1.Label"]&&i["com.sap.vocabularies.Common.v1.Label"]["String"]||i["fieldLabel"]||null};o.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this._oControlProvider&&this._oControlProvider.destroy){this._oControlProvider.destroy()}this._mDimensionFromText=null;this._oControlProvider=null;this._aODataFieldMetadata=null;this._aTableViewMetadata=null;this._aIgnoredFields=null;this._aInitiallyVisibleFields=null;this._sIgnoredFields=null;this._sInitiallyVisibleFields=null;this.bIsDestroyed=true};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/TokenParser", ["sap/ui/comp/library","sap/ui/base/ManagedObject","sap/m/Token","sap/m/library","sap/ui/comp/util/FormatUtil"],function(e,t,a,r,o){"use strict";var n=e.valuehelpdialog.ValueHelpRangeOperation;var i=r.P13nConditionOperation;var p={default:[i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],string:[i.Empty,i.NotEmpty,i.Contains,i.EQ,i.BT,i.StartsWith,i.EndsWith,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotContains,i.NotStartsWith,i.NotEndsWith,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],date:[i.Empty,i.NotEmpty,i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],time:[i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],numeric:[i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],numc:[i.Contains,i.EQ,i.BT,i.EndsWith,i.LT,i.LE,i.GT,i.GE,i.NotContains,i.NotEQ,i.NotBT,i.NotEndsWith,i.NotLT,i.NotLE,i.NotGT,i.NotGE],boolean:[i.EQ]};var s=[i.Empty,i.BT,i.EQ,i.Contains,i.StartsWith,i.EndsWith,i.LT,i.LE,i.GT,i.GE,i.NotEmpty,i.NotBT,i.NotEQ,i.NotContains,i.NotStartsWith,i.NotEndsWith,i.NotLT,i.NotLE,i.NotGT,i.NotGE];var l=function(e){var t=e&&e.rangeOperationsKeys||s;this._aKeyFields=[];this._sDefaultOperation=typeof e==="string"&&e||e&&e.defaultOperation&&e.defaultOperation||undefined;this._mTypeOperations=e&&e.typeOperations||p;this._initRangeOperations(t)};function u(e){var t=this.re.exec(e),a=t[1],r=t[2];if(t){if(a&&a.trim){a=a.trim()}if(r&&r.trim){r=r.trim()}return[a,r]}return[]}l.rangeOperations={};l.rangeOperations[i.Empty]={regex:new RegExp("^"+o.getFormattedRangeText(n.Empty,null,null,false)+"$","i"),operator:i.Empty,example:o.getFormattedRangeText(n.Empty,null,null,false),template:o.getFormattedRangeText(n.Empty,null,null,false),exclude:false,parse:function(e){return[]}};l.rangeOperations[i.BT]={regex:/^([^!].*)\.\.\.(.+)$/,operator:i.BT,example:"foo...bar",template:"$0...$1",exclude:false,parse:u};l.rangeOperations[i.EQ]={regex:/^\=(.+)$/,operator:i.EQ,example:"=foo",template:"=$0",exclude:false};l.rangeOperations[i.Contains]={regex:/^\*(.+)\*$/,operator:i.Contains,example:"*foo*",template:"*$0*",exclude:false};l.rangeOperations[i.StartsWith]={regex:/^([^\*!].*)\*$/,operator:i.StartsWith,example:"foo*",template:"$0*",exclude:false};l.rangeOperations[i.EndsWith]={regex:/^\*(.*[^\*])$/,operator:i.EndsWith,example:"*foo",template:"*$0",exclude:false};l.rangeOperations[i.LT]={regex:/^\<([^\=].*)$/,operator:i.LT,example:"< foo",template:"<$0",exclude:false};l.rangeOperations[i.LE]={regex:/^\<\=(.+)$/,operator:i.LE,example:"<=foo",template:"<=$0",exclude:false};l.rangeOperations[i.GT]={regex:/^\>([^\=].*)$/,operator:i.GT,example:"> foo",template:">$0",exclude:false};l.rangeOperations[i.GE]={regex:/^>=(.+)$/,operator:i.GE,example:">=foo",template:">=$0",exclude:false};l.rangeOperations[i.NotEmpty]={regex:new RegExp("^"+o.getFormattedRangeText(n.Empty,null,null,true).replace("(","\\(").replace(")","\\)")+"$","i"),operator:i.NotEmpty,example:o.getFormattedRangeText(n.Empty,null,null,true),template:o.getFormattedRangeText(n.Empty,null,null,true),exclude:true,parse:function(e){return[]}};l.rangeOperations[i.NotBT]={regex:/^![(]?(.+)\.\.\.([^)]+)[)]?$/,operator:i.NotBT,example:"!foo...bar",template:"!($0...$1)",exclude:true,parse:u};l.rangeOperations[i.NotEQ]={regex:/^![(]?=(.+?)[)]?$/,operator:i.NotEQ,example:"!=foo",template:"!(=$0)",exclude:true};l.rangeOperations[i.NotContains]={regex:/^![(]?\*(.+)\*[)]?$/,operator:i.NotContains,example:"!*foo*",template:"!(*$0*)",exclude:true};l.rangeOperations[i.NotStartsWith]={regex:/^![(]?([^\\*].*)\*[)]?$/,operator:i.NotStartsWith,example:"!foo*",template:"!($0*)",exclude:true};l.rangeOperations[i.NotEndsWith]={regex:/^![(]?\*([^\*)]*)[)]?$/,operator:i.NotEndsWith,example:"!*foo",template:"!(*$0)",exclude:true};l.rangeOperations[i.NotLT]={regex:/^![(]?<([^=].*?)[)]?$/,operator:i.NotLT,example:"!<foo",template:"!(<$0)",exclude:true};l.rangeOperations[i.NotLE]={regex:/^![(]?<=(.+?)[)]?$/,operator:i.NotLE,example:"!<=foo",template:"!(<=$0)",exclude:true};l.rangeOperations[i.NotGT]={regex:/^![(]?>([^=].*?)[)]?$/,operator:i.NotGT,example:"!>foo",template:"!(>$0)",exclude:true};l.rangeOperations[i.NotGE]={regex:/^![(]?>=(.+?)[)]?$/,operator:i.NotGE,example:"!>=foo",template:"!(>=$0)",exclude:true};l.excludeOperationsMapping={};l.excludeOperationsMapping[i.NotEmpty]=i.Empty;l.excludeOperationsMapping[i.NotLT]=i.LT;l.excludeOperationsMapping[i.NotLE]=i.LE;l.excludeOperationsMapping[i.NotGT]=i.GT;l.excludeOperationsMapping[i.NotGE]=i.GE;l.excludeOperationsMapping[i.NotContains]=i.Contains;l.excludeOperationsMapping[i.NotStartsWith]=i.StartsWith;l.excludeOperationsMapping[i.NotEndsWith]=i.EndsWith;l.excludeOperationsMapping[i.NotBT]=i.BT;l.excludeOperationsMapping[i.NotEQ]=i.EQ;l.prototype._initRangeOperations=function(e){e.forEach(function(e){this.createOperation(l.rangeOperations[e])},this)};l.prototype.destroy=function(){if(this._oInput&&!this._oInput.bIsDestroyed){this._oInput.removeValidator(this._validator);if(this._aOrgValidators&&this._aOrgValidators.length>0){this._oInput.addValidator(this._aOrgValidators)}this._oInput=null}this._aOrgValidators=null;this._aKeyFields=null;this._mTypeOperations=null};l.prototype.setDefaultOperation=function(e){this._sDefaultOperation=e};l.prototype.getDefaultOperation=function(){return this._sDefaultOperation};l.prototype.getOperations=function(){return this._mOperations};l.prototype.getOperation=function(e){return this._mOperations&&this._mOperations[e]};l.prototype._getKeyFieldByLabel=function(e){var t;this._aKeyFields.some(function(a){if(a.label.toUpperCase()===e.toUpperCase()){t=a}},this);return t};l.prototype.addKeyField=function(e){this._aKeyFields.push(e)};l.prototype.getKeyFields=function(){return this._aKeyFields};l.prototype.addTypeOperations=function(e,t){this._mTypeOperations[e]=t};l.prototype.removeTypeOperations=function(e){delete this._mTypeOperations[e]};l.prototype.getTypeOperations=function(e){return this._mTypeOperations[e]||this._mTypeOperations["default"]};l.prototype.createOperation=function(e){var t=e.operator,a=e.example,r=e.regex,o=e.template,n=e.parse,i=e.exclude;if(!this._mOperations){this._mOperations={}}this._mOperations[t]={key:t,example:a,re:r,template:o,exclude:i,parser:this,match:function(e,t){var a=this.re.exec(e);if(a){var r=this.parse(e);if(t){r.forEach(function(e){if(t.hasOwnProperty("maxLength")&&t.maxLength>=0&&e.length>t.maxLength){a=null}if(t.oType){try{e=t.oType.parseValue(e,"string");t.oType.validateValue(e)}catch(e){a=null}}},this)}}return a},parse:n||function(e){var t=this.re.exec(e);if(t){var a=t[1]||t[2];if(a&&a.trim){a=a.trim()}return[a]}return[]},getFilledTemplate:function(e,t){var a=this.parse(e);var r=[];var o="";for(var n=0;n<a.length;n++){r[n]=this.formatValue(a[n],false,t)}o=l._templateReplace(this.template,r);return o},getConditionData:function(e,t){var a={};a.exclude=this.exclude;if(this.exclude){a.operation=l.excludeOperationsMapping[this.key];if(!a.operation){a.operation=this.key}}else{a.operation=this.key}var r=this.parse(e);for(var o=0;o<r.length;o++){a["value"+(o+1)]=this.formatValue(r[o],true,t)}return a},formatValue:function(e,t,a){if(!a){return e}if(a.hasOwnProperty("maxLength")){if(a.maxLength>=0){e=e.substring(0,a.maxLength)}}if(a.displayFormat){if(a.displayFormat==="UpperCase"){e=e.toUpperCase()}}if(a.oType){try{e=a.oType.parseValue(e,"string");a.oType.validateValue(e)}catch(e){return"ERROR"}if(!t){e=a.oType.formatValue(e,"string")}}return e}};return this._mOperations[t]};l.prototype.removeOperation=function(e){delete this._mOperations[e]};l.prototype.removeAllOperations=function(){var e=Object.keys(this._mOperations);e.forEach(function(e){delete this._mOperations[e]},this)};l.prototype.getTranslatedText=function(e,t,a){var r=t.key;e=e!=="default"?"_"+e.toUpperCase()+"_":"";if(e==="_STRING_"||e==="_BOOLEAN_"||e==="_NUMC_"){e=""}if(e==="_TIME_"){e="_DATE_"}if(!a){a="sap.m"}r="CONDITIONPANEL_OPTION"+e+r;var o=sap.ui.getCore().getLibraryResourceBundle(a).getText(r)||r;if(o.startsWith("CONDITIONPANEL_OPTION")){r="CONDITIONPANEL_OPTION"+t.key;o=sap.ui.getCore().getLibraryResourceBundle(a).getText(r)}return o};l.prototype.associateInput=function(e){this._oInput=e;this._aOrgValidators=this._oInput&&this._oInput.isA("sap.m.MultiInput")?this._oInput.getValidators().slice():[];this._oInput.removeAllValidators();this._oInput.addValidator(this._validator.bind(this))};l.prototype._validator=function(e){if(this._aOrgValidators){var t;this._aOrgValidators.some(function(a){t=a(e);return t},this);if(t){return t}}if(e.text){return this._onValidate(e.text)}return null};l._templateReplace=function(e,t){return e.replace(/\$\d/g,function(e){return t[parseInt(e.substr(1))]})};l.prototype._onValidate=function(e){var r=this._aKeyFields.length>0?this._aKeyFields[0]:null;if(this._oInput._getIsSuggestionPopupOpen&&this._oInput._getIsSuggestionPopupOpen()&&this._oInput._oSuggestionsTable&&this._oInput._oSuggestionsTable.getSelectedItem()){return null}if(r){var o=/^\w+\:\s/.exec(e);if(o){var n=o[0];r=this._getKeyFieldByLabel(n.slice(0,n.indexOf(":")));if(r){e=e.slice(o[0].length).trim()}}}var p=r&&r.type||"default";var s=this.getTypeOperations(p);var u=function(e,o){if(e.match(o,r)){var n=e.getConditionData(o,r);n.keyField=r?r.key:null;if(r.hasOwnProperty("maxLength")&&r.maxLength===1){if([i.Contains,i.EndsWith,i.StartsWith].indexOf(e.key)!==-1){return}}if(p==="numc"){if([i.Contains,i.EndsWith].indexOf(e.key)!==-1){n.value1=r.oType.formatValue(n.value1,"string")}}var s=(r&&r.label&&this._aKeyFields.length>1?r.label+": ":"")+e.getFilledTemplate(o,r);s=t.escapeSettingsValue(s);return new a({text:s,tooltip:s}).data("range",n)}return null}.bind(this);var f;if(s.some(function(t){f=u(this._mOperations[t],e);return f},this)){return f}if(this._sDefaultOperation&&this._mOperations[this._sDefaultOperation]){e=l._templateReplace(this._mOperations[this._sDefaultOperation].template,[e]);return u(this._mOperations[this._sDefaultOperation],e)}return null};l._createRangeByText=function(e){var t=l._matchOperationFromText(e);if(!t){return{exclude:false,operation:i.EQ,tokenText:null,value1:e,value2:null}}var a=t;var r=false;if(l.excludeOperationsMapping[t]){a=l.excludeOperationsMapping[t];r=true}var o=a===i.BT?true:false;return l._getRangeByTextAndOperation(e,a,r,o)};l._matchOperationFromText=function(e){var t=[];for(var a in l.rangeOperations){if(l.rangeOperations[a].regex.test(e)){t.push(a)}}if(t.length===0){return null}if(t.length>1){if(e===o.getFormattedRangeText(n.Empty,null,null,false)&&t.indexOf(l.rangeOperations[i.Empty].operator)>-1){t=[l.rangeOperations[i.Empty].operator]}if(e===o.getFormattedRangeText(n.Empty,null,null,true)&&t.indexOf(l.rangeOperations[i.NotEmpty].operator)>-1){t=[l.rangeOperations[i.NotEmpty].operator]}if(t.indexOf(l.rangeOperations[i.NotContains].operator)>-1&&t.indexOf(l.rangeOperations[i.NotStartsWith].operator)>-1){return l.rangeOperations[i.NotContains].operator}}return t[0]};l._getRangeByTextAndOperation=function(e,t,a,r){var o=[];if(a&&e.startsWith("!(")&&e.endsWith(")")){e=e.slice(2,-1)}var n=l.rangeOperations[t].template;if(r){o=e.split("...");return{exclude:a,operation:t,value1:o[0],value2:o[1]}}else{var i=n.indexOf("$0");var p=i+2;if(p===n.length){e=e.slice(i)}else{p=n.length-p;e=e.slice(i,-p)}return{exclude:a,operation:t,value1:e,value2:null}}};return l},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ValueHelpProvider", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/m/library","sap/m/List","sap/m/ResponsivePopover","sap/m/StandardListItem","sap/m/Token","sap/m/Table","sap/m/ColumnListItem","sap/m/Label","./BaseValueListProvider","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/DateTimeUtil","sap/ui/model/json/JSONModel","sap/ui/core/format/DateFormat","sap/ui/Device","sap/ui/model/Sorter","sap/base/util/merge","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/VariantItem","sap/base/strings/capitalize"],function(jQuery,e,t,i,a,s,l,o,r,n,h,u,p,d,g,c,f,m,y,_,S,D){"use strict";var V=e.valuehelpdialog.ValueHelpRangeOperation;var v={DeprecatedCode:"W",RevokedCode:"E",ValidCode:""};var C;var F=h.extend("sap.ui.comp.providers.ValueHelpProvider",{constructor:function(e){if(e){this.preventInitialDataFetchInValueHelpDialog=!!e.preventInitialDataFetchInValueHelpDialog;this.sTitle=e.title;this.bSupportMultiselect=!!e.supportMultiSelect;this.bSupportRanges=!!e.supportRanges;this.bIsSingleIntervalRange=!!e.isSingleIntervalRange;this.bIsSearchExpressionFilterRestriction=!!e.isSearchExpressionFilterRestriction;this.bIsUnrestrictedFilter=!!e.isUnrestrictedFilter;this.bTakeOverInputValue=e.takeOverInputValue===false?false:true;this._sScale=e.scale;this._sPrecision=e.precision;this._defaultOperation=e.defaultOperation?e.defaultOperation:null;this.filterBarClass=e.filterBarClass;this._onBeforeOpenValueHelpDialog=e._onBeforeOpenValueHelpDialog||function(){};if(this.bIsSingleIntervalRange){this.bSupportRanges=true}}h.apply(this,arguments);this._onInitialise()}});F.prototype._onInitialise=function(){if(this.oControl.attachValueHelpRequest){this._fVHRequested=function(e){if(!this.bInitialised){return}var t=e.getParameter("_userInputValue");this.oControl=e.getSource();this.bForceTriggerDataRetreival=e.getParameter("fromSuggestions");if(this.bSupportBasicSearch&&(this.bTakeOverInputValue||this.bForceTriggerDataRetreival)&&(t||t==="")){this.sBasicSearchText=t}this._createValueHelpDialog()}.bind(this);this.oControl.attachValueHelpRequest(this._fVHRequested)}};F.prototype._getEntitiesLazy=function(){return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/filterbar/vh/CollectiveSearchSelect","sap/ui/comp/valuehelpdialog/ValueHelpDialog"],function(t,i){e([i,t])})})})};F.prototype._createValueHelpDialog=function(){if(!this.bCreated){this.bCreated=true;if(!this._oValueHelpDialogClass||!this._oCollectiveSearchSelectClass){this._getEntitiesLazy().then(this._onValueHelpDialogRequired.bind(this))}else{this._onValueHelpDialogRequired([this._oValueHelpDialogClass,this._oCollectiveSearchSelectClass])}}};F.prototype._getTitle=function(){if(this.sTitle){return this.sTitle}else if(this.oFilterProvider){return this.oFilterProvider._determineFieldLabel(this._fieldViewMetadata)}return""};F.prototype.getValueListAnnotation=function(){var e;if(this._isContextDependent()){e=this.oControl.getBindingContext()&&this.oControl.getBindingContext().getPath()}return this._oMetadataAnalyser.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,e)};F.prototype._onValueHelpDialogRequired=function(e){if(this.bInitialised&&this.bIsContextDependent){this._bValueListRequested=false;return this._loadAnnotation().then(function(){return this._onInitValueHelpDialog(e)}.bind(this))}else{return this._onInitValueHelpDialog(e)}};F.prototype._onInitValueHelpDialog=function(e){this._oValueHelpDialogClass=e[0];this._oCollectiveSearchSelectClass=e[1];var t=this.oControl.getId()+"-valueHelpDialog";this.oValueHelpDialog=new this._oValueHelpDialogClass(t,{stretch:f.system.phone,basicSearchText:this.sBasicSearchText,supportRangesOnly:this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation,supportMultiselect:this.bSupportMultiselect,title:this._getTitle(),supportRanges:this.bSupportRanges,displayFormat:this.sDisplayFormat,ok:this._onOK.bind(this),cancel:this._onCancel.bind(this),beforeOpen:function(){this._onBeforeOpenValueHelpDialog({fieldName:this.sFieldName,_switchView:this._switchView.bind(this)})}.bind(this),afterClose:function(){if(this.oPrimaryValueListAnnotation){this._resolveAnnotationData(this.oPrimaryValueListAnnotation)}this.oValueHelpDialog.destroy();this.bCreated=false;if(this.oControl&&this.oControl.focus&&!f.system.phone){this.oControl.focus()}}.bind(this)});if(this.oValueHelpDialog&&this._defaultOperation&&V[this._defaultOperation]){this.oValueHelpDialog.setConditionPanelDefaultOperation(this._defaultOperation)}if(this.oValueHelpDialog._oColSearchBox){this.oValueHelpDialog._oColSearchBox.destroy();this.oValueHelpDialog._oColSearchBox=null}this.oValueHelpDialog._oColSearchBox=new this._oCollectiveSearchSelectClass({visible:false,title:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("COLLECTIVE_SEARCH_SELECTION_TITLE")}).addStyleClass("sapUiTinyMarginEnd");this.oValueHelpDialog.setProperty("_enhancedExcludeOperations",true);this.oControl.addDependent(this.oValueHelpDialog);this.oValueHelpDialog.suggest(function(e,t){if(this.oPrimaryValueListAnnotation){var i=function(i){e.setShowSuggestion(true);e.setFilterSuggests(false);e._oSuggestProvider=new i({fieldName:t,control:e,model:this.oODataModel,displayFormat:this.sDisplayFormat,resolveInOutParams:false,displayBehaviour:this.sTokenDisplayBehaviour,annotation:this.oPrimaryValueListAnnotation,fieldViewMetadata:this._fieldViewMetadata,maxLength:this._sMaxLength,filterModel:this.oFilterModel,aggregation:"suggestionRows",typeAheadEnabled:true,enableShowTableSuggestionValueHelp:false})}.bind(this);C=sap.ui.require("sap/ui/comp/providers/ValueListProvider");if(!C){sap.ui.require(["sap/ui/comp/providers/ValueListProvider"],i)}else{i(C);return e._oSuggestProvider}return null}}.bind(this));if(this.bIsSingleIntervalRange){this.oValueHelpDialog.setIncludeRangeOperations([V.BT,V.EQ],this._sType);this.oValueHelpDialog.setMaxIncludeRanges(1);this.oValueHelpDialog.setMaxExcludeRanges(0);this.oValueHelpDialog.setMaxConditions(1);this.oValueHelpDialog.bIsSingleIntervalRange=this.bIsSingleIntervalRange;this._updateInitialInterval()}else if((this._sType==="date"||this._sType==="time"||this._sType==="datetime")&&!this.bIsUnrestrictedFilter){this.oValueHelpDialog.setIncludeRangeOperations([V.EQ],this._sType);this.oValueHelpDialog.setMaxExcludeRanges(0)}else if(this.bIsSearchExpressionFilterRestriction){this.oValueHelpDialog.setIncludeRangeOperations(u._getSearchExpressionRangeOperationsKeys(),u._getSearchExpressionType());this.oValueHelpDialog.setExcludeRangeOperations(u._getSearchExpressionRangeOperationsKeys(),u._getSearchExpressionType())}if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCompact").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact")}else if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCozy").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCozy")}else if(jQuery("body").hasClass("sapUiSizeCompact")){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact")}else{this.oValueHelpDialog.addStyleClass("sapUiSizeCozy")}if(this.bSupportRanges){this.oValueHelpDialog.setRangeKeyFields([{label:this._getTitle(),key:this.sFieldName,typeInstance:this._fieldViewMetadata?this._fieldViewMetadata.ui5Type:null,type:this._sType,formatSettings:this._sType==="numc"?{isDigitSequence:true,maxLength:this._sMaxLength}:Object.assign({},this._oDateFormatSettings,{UTC:false}),scale:this._sScale,precision:this._sPrecision,maxLength:this._sMaxLength,nullable:this._fieldViewMetadata?this._fieldViewMetadata.nullable:false}])}if(!(this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation)){this.oValueHelpDialog.setModel(this.oODataModel);this._createAdditionalValueHelpControls();this._createCollectiveSearchControls()}if(this.oControl.getTokens){var i=this.oControl.getTokens();if(i){i=this._adaptTokensFromFilterBar(i);this.oValueHelpDialog.setTokens(i)}}return Promise.resolve().then(this.oValueHelpDialog.open.bind(this.oValueHelpDialog))};F.prototype._isContextDependent=function(){var e,t;if(this.bIsContextDependent===undefined){t=this._oMetadataAnalyser.getPropertyContextByPath(this._sFullyQualifiedFieldName);if(t){e=t.getObject();if(u.hasValueListRelevantQualifiers(e)){this.bIsContextDependent=true}}}return this.bIsContextDependent};F.prototype._adaptTokensFromFilterBar=function(e){var t,i,a,s=e;if(this.oFilterProvider&&e&&this._sType==="time"){s=[];for(var l=0;l<e.length;l++){t=y({},e[l]);i=t.data("range");if(i){i=y({},i);if(i.value1 instanceof Date){a=d.localToUtc(i.value1);i.value1={__edmType:"Edm.Time",ms:a.getTime()}}if(i.value2 instanceof Date){a=d.localToUtc(i.value2);i.value2={__edmType:"Edm.Time",ms:a.getTime()}}t.data("range",i);s.push(t)}}}return s};F.prototype._updateInitialInterval=function(){var e=this.oControl.getValue(),t,i,a,s,o;if(e){t=new l;i={exclude:false,keyField:this.sFieldName};if(this._sType==="numeric"){a=p.parseFilterNumericIntervalData(e);if(a.length==0){a.push(e)}}else if(this._sType==="datetime"){a=p.parseDateTimeOffsetInterval(e);s=c.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));o=s.parse(a[0]);a[0]=o?o:new Date(a[0]);if(a.length===2){o=s.parse(a[1]);a[1]=o?o:new Date(a[1])}}else{a=e.split("-")}if(a&&a.length===2){i.operation="BT";i.value1=a[0];i.value2=a[1]}else{i.operation="EQ";i.value1=a[0]}t.data("range",i)}if(t){this.oValueHelpDialog.setTokens([t])}};F.prototype._createCollectiveSearchControls=function(){var e,t=0,i=0,a,s;if(this.additionalAnnotations&&this.additionalAnnotations.length){a=function(e){var t,i,a,s=e.getParameter("key"),l=e.getSource(),o=l&&l.getItems();for(var r=0;r<o.length;r++){a=o[r];if(a.getKey()===s){t=a;break}}if(t){i=t.data("_annotation");if(i){this._triggerAnnotationChange(i)}}}.bind(this);e=new D({key:this.oPrimaryValueListAnnotation.keyField,text:this.oPrimaryValueListAnnotation.valueListTitle});e.data("_annotation",this.oPrimaryValueListAnnotation);this.oValueHelpDialog._oColSearchBox.addItem(e);this.oValueHelpDialog._oColSearchBox.setSelectedItemKey(this.oPrimaryValueListAnnotation.keyField);i=this.additionalAnnotations.length;for(t=0;t<i;t++){s=this.additionalAnnotations[t];e=new D({key:s.qualifier,text:s.valueListTitle});e.data("_annotation",s);this.oValueHelpDialog._oColSearchBox.addItem(e)}this.oValueHelpDialog._oColSearchBox.attachSelect(a);this.oValueHelpDialog._oColSearchBox.setVisible(true)}};F.prototype._triggerAnnotationChange=function(e){this.oValueHelpDialog.resetTableState();this._resolveAnnotationData(e);this._createAdditionalValueHelpControls()};F.prototype._createAdditionalValueHelpControls=function(){var e=null,t=this.filterBarClass;this.oValueHelpDialog.setKey(this.sKey);this.oValueHelpDialog.setKeys(this._aKeys);this.oValueHelpDialog.setDescriptionKey(this.sDescription);this.oValueHelpDialog.setTokenDisplayBehaviour(this.sTokenDisplayBehaviour);var i=new g;i.setData({cols:this._aCols});this.oValueHelpDialog.setModel(i,"columns");if(this.bSupportBasicSearch){e=this.sKey}if(this.oSmartFilterBar){this.oSmartFilterBar._setCollectiveSearch(null);this.oSmartFilterBar.destroy()}if(!t){t=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar")}this.oSmartFilterBar=new t(this.oValueHelpDialog.getId()+"-smartFilterBar",{entitySet:this.sValueListEntitySetName,basicSearchFieldName:e,enableBasicSearch:this.bSupportBasicSearch,isRunningInValueHelpDialog:true,advancedMode:true,showGoOnFB:!f.system.phone,filterBarExpanded:false,search:this._onFilterBarSearchPressed.bind(this),reset:this._onFilterBarResetPressed.bind(this),filterChange:this._onFilterBarFilterChange.bind(this),initialise:this._onFilterBarInitialise.bind(this)});if(this._oDateFormatSettings){this.oSmartFilterBar.data("dateFormatSettings",this._oDateFormatSettings)}if(this.oPrimaryValueListAnnotation&&this.oPrimaryValueListAnnotation.constParams){this.oSmartFilterBar.data("hiddenFields",Object.keys(this.oPrimaryValueListAnnotation.constParams))}this.oValueHelpDialog.setFilterBar(this.oSmartFilterBar)};F.prototype._onFilterBarFilterChange=function(){if(!this._bIgnoreFilterChange){this.oValueHelpDialog.getTableAsync().then(function(e){e.setShowOverlay(true);this.oValueHelpDialog.TableStateSearchData()}.bind(this))}};F.prototype._expandFilterBar=function(){var e=this.oFilterProvider&&this.oFilterProvider._oAdditionalConfiguration,t=e?e.getControlConfigurationByKey(this._fieldViewMetadata.fieldName):null;if(this.oSmartFilterBar._hasMandatoryFields()){this.oSmartFilterBar.setFilterBarExpanded(true);this.oSmartFilterBar._bShowAllFilters=true;this.oSmartFilterBar.rerenderFilters()}else if(!this.bSupportBasicSearch||this.oFilterProvider&&this.oFilterProvider._getPreventInitialDataFetchInValueHelpDialog(this._fieldViewMetadata,t)){this.oSmartFilterBar.setFilterBarExpanded(true)}};F.prototype._onFilterBarSearchPressed=function(){this._rebindTable()};F.prototype._rebindTable=function(){var e,t,i,a;e=this.oSmartFilterBar.getFilters();a=this.oPrimaryValueListAnnotation.deprecationCodeField;if(a){if(e.length===0||e.length>0&&!this._checkForExistingRevokedFilters(e[0],a)){e.push(new _(a,S.NE,v.RevokedCode))}}t=this.oSmartFilterBar.getParameters()||{};if(this.aSelect&&this.aSelect.length){t["select"]=this.aSelect.toString()}i={path:"/"+this.sValueListEntitySetName,filters:e,parameters:t,events:{dataReceived:function(e){this.oValueHelpDialog.TableStateDataFilled();var t=e.getSource();this.oValueHelpDialog.getTableAsync().then(function(e){if(t&&this.oValueHelpDialog&&this.oValueHelpDialog.isOpen()){var i=t.getLength();if(i){this.oValueHelpDialog.update()}else{this.oValueHelpDialog._updateTitles()}}}.bind(this))}.bind(this)}};this.oValueHelpDialog.getTableAsync().then(function(e){e.setShowOverlay(false);this.oValueHelpDialog.TableStateDataSearching();e.setEnableBusyIndicator(true);if(e instanceof o){var t;if(this.sKey&&this._oMetadataAnalyser){t=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sValueListEntitySetName);for(var a=0;a<t.length;a++){if(t[a].name===this.sKey&&t[a].sortable!==false){i.sorter=new m(this.sKey);break}}}i.factory=function(t,i){var a=e.getModel("columns").getData().cols;return new r({cells:a.map(function(e){var t=e.template;return new n({text:"{"+t+"}"})})})};e.bindItems(i)}else{var s=e.getColumns();for(var a=0;a<s.length;a++){var l=s[a];l._appDefaults=null;if(i&&i.parameters&&i.parameters.custom){var h=i.parameters.custom.search?false:l.getBindingContext("columns").getProperty("sorted");l.setSorted(h)}}s=e.getSortedColumns();if(!s||s.length==0){s=e.getColumns()}for(var a=0;a<s.length;a++){var l=s[a];if(l.getSorted()){if(!i.sorter){i.sorter=[]}i.sorter.push(new m(l.getSortProperty(),l.getSortOrder()==="Descending"))}}e.bindRows(i)}}.bind(this))};F.prototype._checkForExistingRevokedFilters=function(e,t){var i=false;if(e.sPath===t&&e.sOperator===V.EQ&&e.oValue1===v.RevokedCode){i=true}else if(Array.isArray(e.aFilters)){for(var a=0;a<e.aFilters.length;a++){i=this._checkForExistingRevokedFilters(e.aFilters[a],t);if(i){break}}}return i};F.prototype._onFilterBarResetPressed=function(){this._calculateFilterInputData();if(this.oSmartFilterBar){this.oSmartFilterBar.setFilterData(this.mFilterInputData)}};F.prototype._onFilterBarInitialise=function(){var e=null;this._bIgnoreFilterChange=true;this._onFilterBarResetPressed();delete this._bIgnoreFilterChange;if(this.oSmartFilterBar&&this.oSmartFilterBar.getBasicSearchControl){e=this.oSmartFilterBar.getBasicSearchControl();if(e){e.setValue(this.sBasicSearchText);if(f.system.phone&&e.isA("sap.m.SearchField")){e.setShowSearchButton(true)}}}if(!this.preventInitialDataFetchInValueHelpDialog||this.bForceTriggerDataRetreival){this._rebindTable();this.bForceTriggerDataRetreival=false}if(f.system.desktop){this._expandFilterBar()}};F.prototype._onOK=function(e){var t=e.getParameter("_tokensHaveChanged"),i=e.getParameter("tokens"),a,s,l=0,o=[],r=null,n,h={},u;this._onCancel();if(!t){return}if(this.oControl.isA("sap.m.MultiInput")){this.oControl.setValue("");this.oControl.destroyTokens();this.oControl.setTokens(i);l=i.length;if(l>0){h.type="added";h.addedTokens=i}this.oControl.fireTokenUpdate(h);while(l--){r=i[l].data("row");if(r){o.push(r)}}}else{if(i[0]){if(this.bIsSingleIntervalRange){a=i[0].data("range");if(a){if(this._sType==="datetime"){n=c.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));if(typeof a.value1==="string"){a.value1=new Date(a.value1)}if(a.operation==="BT"){if(typeof a.value2==="string"){a.value2=new Date(a.value2)}s=n.format(a.value1)+"-"+n.format(a.value2)}else{s=n.format(a.value1)}}else{if(a.operation==="BT"){s=a.value1+"-"+a.value2}else{s=a.value1}}}}else{s=i[0].getKey()}r=i[0].data("row");if(r){u="/"+i[0].data("longKey");o.push(r)}i[0].destroy()}if(this.sContext==="SmartField"&&this._selectedODataRowHandler){this._selectedODataRowHandler(s,o[0],u)}this.setValue(s);if(this.sContext==="SmartFilterBar"&&!this.bIsSingleIntervalRange){var d=o[0]&&o[0][this.sDescription];this.oControl.setValue(p.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,s,d));this.oControl.setValueState("None");this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,s);this.oFilterProvider._setSingleInputsTextArrangementFieldData(this.sFieldName,s,d)}this.oControl.fireChange({value:s,validated:true})}if(this.fnAsyncWritePromise){this.fnAsyncWritePromise().then(this._calculateAndSetFilterOutputData.bind(this,o))}else{this._calculateAndSetFilterOutputData(o)}};F.prototype._onCancel=function(){this.oValueHelpDialog.close();this.oValueHelpDialog.setModel(null)};F.prototype._switchView=function(e){if(!(this.oValueHelpDialog&&this.oValueHelpDialog._oColSearchBox)){return}var t=this.oValueHelpDialog._oColSearchBox,i=t.getItems(),a=i.find(function(t){return t.getKey()===e});if(a){this._triggerAnnotationChange(a.data("_annotation"));this.oValueHelpDialog._oColSearchBox.setSelectedItemKey(a.getKey())}};F.prototype.destroy=function(){if(this.oControl&&this.oControl.detachValueHelpRequest){this.oControl.detachValueHelpRequest(this._fVHRequested);this._fVHRequested=null}h.prototype.destroy.apply(this,arguments);if(this.oValueHelpDialog){this.oValueHelpDialog.destroy();this.oValueHelpDialog=null}if(this.oSmartFilterBar){this.oSmartFilterBar.destroy();this.oSmartFilterBar=null}this.sTitle=null};return F});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ValueListProvider", ["sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/DateTimeUtil","sap/ui/core/SeparatorItem","sap/m/GroupHeaderListItem","sap/m/Column","sap/m/ColumnListItem","sap/m/Text","sap/m/Token","./BaseValueListProvider","sap/ui/core/ListItem","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/model/FilterOperator","sap/ui/comp/util/FormatUtil","sap/ui/comp/historyvalues/HistoryValuesProvider","sap/ui/comp/historyvalues/HistoryOptOutProvider","sap/ui/comp/historyvalues/Constants","sap/m/ComboBox","sap/m/MultiComboBox","sap/m/Select","sap/base/util/deepEqual","sap/ui/Device","sap/base/Log","sap/base/util/values","sap/m/Label","sap/base/strings/whitespaceReplacer","sap/ui/comp/smartfilterbar/FilterProviderUtils"],function(t,e,i,o,s,n,r,a,l,h,u,d,g,p,c,m,f,_,y,S,C,v,F,P,b,V,I,D,A,w,H){"use strict";var T=e.smartfilterbar.DisplayBehaviour;var R=i.PopinDisplay;var L=i.WrappingType;var M=t.ValueState;var B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SEARCH_FIELD_VALIDATION_WARNING_MESSAGE");var N={Recommendations:10,RecentlyUsed:20,Others:30};var x="list";var E=d.extend("sap.ui.comp.providers.ValueListProvider",{constructor:function(t){if(t){this.sAggregationName=t.aggregation;this.bTypeAheadEnabled=!!t.typeAheadEnabled;this.bEnableShowTableSuggestionValueHelp=t.enableShowTableSuggestionValueHelp===undefined?true:t.enableShowTableSuggestionValueHelp;this.dropdownItemKeyType=t.dropdownItemKeyType;this.sDeferredGroupId=t.deferredGroupId;this._fieldHistoryEnabled=t.fieldHistoryEnabled;this._fieldHistoryEnabledInitial=t.fieldHistoryEnabledInitial}this._aRecommendations=[];this._oRecommendationListPromise=Promise.resolve();this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._groupHeaderFactory=this._groupHeaderFactory.bind(this);this._pendingValidationCount=0;d.apply(this,arguments);this._onInitialise()}});E.prototype._onInitialise=function(){if(!this.bTypeAheadEnabled){this.oAfterRenderingEventDelegate={onAfterRendering:this._onMetadataInitialised};this.oControl.addEventDelegate(this.oAfterRenderingEventDelegate,this)}else if(this.oControl.attachSuggest){this._fSuggest=function(t){this.oControl=t.getSource();if(!this.bInitialised){return}if(!this.isDisableSearchMatchesPatternWarning()&&this.oControl.getValueState&&this.oControl.getValueState()===M.Warning&&this.oControl.getValueStateText&&this.oControl.getValueStateText()===B){return}if(!this._oTemplate||!this.oControl.data("_hassuggestionTemplate")){this._createSuggestionTemplate()}var e=t.getParameter("suggestValue");this._fetchData(e)}.bind(this);this.oControl.attachSuggest(this._fSuggest);if(!this.oFilterModel){var t=this;var e=this.oControl.setParent;this.oControl.setParent=function(i,o,s){var n=this.getParent();var r=e.apply(this,arguments);i=this.getParent();var a=!(i&&n===null);if(i!==n&&a){t.unbindAggregation()}return r}}this._handleSelect()}this.oControl.setModel(new m,x);this._setupHistoryValues();this._setupRecommendations()};E.prototype._onMetadataInitialised=function(){if(this.bInitialised){if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate)}if(this.oPrimaryValueListAnnotation){this._oPresentationVariant=this._handlePresentationVariantSortOrderAnnotation();if(this.sAggregationName&&this.sAggregationName=="suggestionRows"){this._createSuggestionTemplate()}else{this._createDropDownTemplate()}this._fetchData();if(this._isControlDropdown()){if(this.mOutParams&&Object.keys(this.mOutParams).length>1){this._handleOutParameters()}if(this.mInParams&&Object.keys(this.mInParams).length>1){this._handleInParameters()}}}else{I.error("ValueListProvider","Missing primary ValueListAnnotation for "+(this._sFullyQualifiedFieldName||this.sFieldName))}if(this.oAfterRenderingEventDelegate){delete this.oAfterRenderingEventDelegate}}};E.prototype._onAnnotationLoad=function(t){var e=d.prototype._onAnnotationLoad.call(this,t);if(!this._isControlSupportedForHistory(this.oControl)){return e}if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){this._setupSuggestionInteractions()}if(this.sContext==="SmartFilterBar"&&this._hasNotValidatedSingleField(this.sFieldName)){this._validateInput(this.oFilterProvider._oNotValidatedSingleFields[this.sFieldName]);this.oFilterProvider._oNotValidatedSingleFields[this.sFieldName]=""}return e};E.prototype._isSortable=function(t){if(this.oPrimaryValueListAnnotation){for(var e=0;e<this.oPrimaryValueListAnnotation.valueListFields.length;e++){if(this.oPrimaryValueListAnnotation.valueListFields[e].name===t){return this.oPrimaryValueListAnnotation.valueListFields[e].sortable!==false}}return false}return false};E.prototype._createDropDownTemplate=function(){this._oTemplate=new g({key:{path:this._resolveSuggestionBindingPath(this.sKey),type:this.dropdownItemKeyType},text:{parts:[{path:this._resolveSuggestionBindingPath(this.sKey),type:this.dropdownItemKeyType},{path:this._resolveSuggestionBindingPath(this.sDescription)}],formatter:function(t,e){var i=_.getFormatterFunctionFromDisplayBehaviour(this.sDDLBDisplayBehaviour),o=i(t,e);return w(o)}.bind(this)}});if(this._oRecommendationListAnnotation){this._oTemplate.bindProperty("additionalText",{path:this._resolveSuggestionBindingPath(this._oRecommendationListAnnotation.rankProperty)})}this._oSorter=null;var t=this._isSortable(this.sKey),e=this._isSortable(this.sDescription);if(this._oPresentationVariant){if(this._oPresentationVariant._bIsPresentationVariantSortPathInVHDEntityType&&this._oPresentationVariant._bIsPresentationVariantSortOrderPropertySortable){this._oSorter=new c(this._oPresentationVariant.sPresentationVariantSortPath,this._oPresentationVariant.sortOrderFields[0].descending)}else{I.error("ValueListProvider","Is Presentation Variant SortOrder property path part of EntityType = "+this._oPresentationVariant._bIsPresentationVariantSortPathInVHDEntityType+". Is property sortable ="+this._oPresentationVariant._bIsPresentationVariantSortOrderPropertySortable)}}else{if(this.sDDLBDisplayBehaviour===T.idOnly||this.sDDLBDisplayBehaviour===T.idAndDescription||this.sDDLBDisplayBehaviour===T.descriptionAndId){if(t){this._oSorter=new c(this.sKey)}}else{if(e){this._oSorter=new c(this.sDescription)}else if(this.sDescription!==this.sKey&&t){this._oSorter=new c(this.sKey)}}}};E.prototype._createSuggestionTemplate=function(){var t=0,e=0,i=0,o=this._aHighImportanceCols||this._aRecommendationCols||this._aCols;this._oTemplate=new l;if(o){this.oControl.removeAllSuggestionColumns();e=o.length;for(t=0;t<e;t++){var s=false,n="1px",r=o[t].suggestionsWidth;if(V.system.phone){r=undefined;if(t>=2){s=true;n=(t+1)*10+"rem"}}this.oControl.addSuggestionColumn(new a({header:new A({wrapping:true,wrappingType:L.Hyphenated,text:o[t].label}),demandPopin:s,popinDisplay:R.Inline,minScreenWidth:n,width:r}));var h={path:this._resolveSuggestionBindingPath(o[t].template),type:o[t].oType,formatter:function(t){return w(t)}};if(Array.isArray(o[t].template)){h={parts:[{path:this._resolveSuggestionBindingPath(o[t].template[0])},{path:this._resolveSuggestionBindingPath(o[t].template[1])}],formatter:function(t,e,i){var o=_.getFormatterFunctionFromDisplayBehaviour(t),s=o(e,i);return w(s)}.bind(this,o[t].displayBehaviour)}}this._oTemplate.addCell(new A({wrapping:true,text:h}));if(r){i+=parseFloat(r.substring(0,r.length-2))}}if(i>0){this.oControl.setProperty("maxSuggestionWidth",i+e+"em",true)}if(e===1){this.oControl._setSeparateSuggestions(false)}}this.oControl.data("_hassuggestionTemplate",true);if(this.oControl&&this.oControl._oSuggestionTable){this.oControl._oSuggestionTable.addStyleClass("sapUiCompValueListProviderTable")}};E.prototype._handleRowSelect=function(t,e,i){var o,s,n,r=i&&typeof i.getPath==="function"&&i.getPath()||"";if(t){o=t[this.sKey];s=t[this.sDescription]}if(o||o===""){if(this.oControl.addToken){s=w(_.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,o,s));n=new u;n.setKey(o);n.setText(s);n.setTooltip(s);n.data("row",t);if(e){e(n)}if(this.oControl.getValue()===""){this.oControl.setValue("")}delete this.oControl.__sValidationText}else{if(this.sContext==="SmartField"&&this._selectedODataRowHandler){this._selectedODataRowHandler(o,t,r)}this.setValue(o);if(this.sContext==="SmartFilterBar"||this.sContext==="mdcFilterPanel"){this.oControl.setValue(_.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,o,s));this.oControl.setValueState("None");this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,o);this.oFilterProvider._setSingleInputsTextArrangementFieldData(this.sFieldName,o,s);if(!this.oFilterProvider._oSingleFieldSetFromFilterData[this.sFieldName]){this.oControl.fireChange({value:o,validated:true})}delete this.oFilterProvider._oSingleFieldSetFromFilterData[this.sFieldName]}if(this.sContext!=="SmartFilterBar"){this.oControl.fireChange({value:o,validated:true})}}}if(this.fnAsyncWritePromise){this.fnAsyncWritePromise().then(this._calculateAndSetFilterOutputData.bind(this,[t]))}else{this._calculateAndSetFilterOutputData([t])}};E.prototype._multiInputValidator=function(t){if(!this.bInitialised){return}if(this._aValidators){var e;this._aValidators.some(function(i){e=i(t);return e},this);if(e){return e}}var i=t.suggestionObject,o,s=t.text;if(i){var n=this._getSuggestionsModelName(),r=i.getBindingContext(n);o=r.getObject();this._handleRowSelect(o,t.asyncCallback,r)}else if(s){this._validateInput(s,t.asyncCallback)}};E.prototype._validateInput=function(t,e){var i,o=[],s=this.oControl,n;if(this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(s.__sValidationText!==t){s.__sValidationText=t;if(t===this._truncateSearchText(t)||this.sContext==="SmartFilterBar"&&this._fieldViewMetadata.filterRestriction==="single"){s.__bValidatingToken=true;this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){o=H.generateFilters(this.aFilterField,this.mFilterInputData)}o.push(new p(this.sKey,f.EQ,t));if(this.bSupportBasicSearch){n={"search-focus":this.sKey}}this._pendingValidationCount++;i=new Promise(function(t,i){this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:o,urlParameters:n,success:function(i){if(!this.oControl||!this._pendingValidationCount&&!this.oControl.hasOwnProperty("__bValidatingToken")){return}var o=i;delete this.oControl.__bValidatingToken;this._pendingValidationCount--;if(i){if(i.results&&i.results.length>=1){if(i.results.length===1){o=i.results[0]}if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata.filterRestriction==="single"&&i.results.length>1){o=i.results[0]}if(this.oControl.data("__validationError")){this.oControl.data("__validationError",null);this.oControl.setValueState("None")}}else{this.oControl.setValueState("Error");this.oControl.data("__validationError",true)}if(o&&o[this.sKey]){s._pendingAutoTokenGeneration=true;this._handleRowSelect(o,e);s._pendingAutoTokenGeneration=false}}this._afterTokenValidate();t()}.bind(this),error:function(){if(this.oControl.data("__validationError")){this.oControl.setValueState("None")}delete this.oControl.__bValidatingToken;this._afterTokenValidate();t()}.bind(this)})}.bind(this));this._addValidationPromise(i)}}else{if(s.data("__validationError")){s.setValueState(M.Error)}}};E.prototype._validateStringSingleWithValueList=function(t){var e;if(t.getParameter("validated")){return}e=t.getParameter("value");if(e===""||e===undefined){return}this._validateInput(e)};E.prototype._afterTokenValidate=function(){if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter&&this.oFilterProvider._oSmartFilter.bIsSearchPending&&this.oFilterProvider._oSmartFilter.search){if(this.oFilterProvider._oSmartFilter.getLiveMode&&this.oFilterProvider._oSmartFilter.getLiveMode()){return}this.oFilterProvider._oSmartFilter.search()}};E.prototype._onSuggestionItemSelected=function(t){var e,i=t.getParameter("selectedRow");if(i){var o=this._getSuggestionsModelName();e=i.getBindingContext(o);this._handleRowSelect(e.getObject(),null,e)}};E.prototype._setFilterOutputDataFromSelectedRow=function(t){var e,i,o;if(t){e=this._getSuggestionsModelName();i=t.getBindingContext(e);o=i.getObject();this._calculateAndSetFilterOutputData([o])}};E.prototype._onMultiComboBoxItemSelected=function(t){if(!t.getParameter("selected")){return}var e=t.getParameter("changedItem");this._setFilterOutputDataFromSelectedRow(e)};E.prototype._onComboBoxItemSelected=function(t){var e=t.getParameter("value"),i=t.getParameter("newValue"),o=t.getParameter("filterChangeReason");if(o&&!e&&!i){return}var s=this.oControl.getSelectedItem();this._setFilterOutputDataFromSelectedRow(s)};E.prototype._handleSelect=function(){if(this.oControl.addValidator){this._aValidators=this.oControl&&this.oControl.isA("sap.m.MultiInput")?this.oControl.getValidators().slice():[];this.oControl.removeAllValidators();this._fValidator=this._multiInputValidator.bind(this);this.oControl.addValidator(this._fValidator)}else if(this.oControl.attachSuggestionItemSelected){this.oControl.attachSuggestionItemSelected(this._onSuggestionItemSelected,this);if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata&&this._fieldViewMetadata.hasValueListAnnotation){this.oControl.attachChange(this._validateStringSingleWithValueList,this)}}if(this.oControl.setRowResultFunction){this.oControl.setRowResultFunction(function(t){var e,i="",o=this._getSuggestionsModelName();if(t){e=t.getBindingContext(o)}if(e&&this.sKey){i=e.getProperty(this.sKey)}return i}.bind(this))}};E.prototype._filterDropdownRowsByInParameters=function(){this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){this.oControl.setBusy(true);this._fetchData();this._mLastFilterInputData=this.mFilterInputData;if(!this.oControl.isA("sap.m.Select")){this._cleanupControlSelection()}}};E.prototype.isInSmartFilterBar=function(){return!!this.oFilterModel};E.prototype.isDisableSearchMatchesPatternWarning=function(){if(this._disableSearchMatchesPatternWarning===undefined&&this.isInSmartFilterBar()&&this.oFilterProvider&&this.oFilterProvider._oSmartFilter){this._disableSearchMatchesPatternWarning=this.oFilterProvider._oSmartFilter.getDisableSearchMatchesPatternWarning()}return this._disableSearchMatchesPatternWarning};E.prototype._isControlDropdown=function(t){if(!t){t=this.oControl}return!!(t.isA("sap.m.MultiComboBox")||t.isA("sap.m.ComboBox"))||t.isA("sap.m.Select")};E.prototype._cleanupControlSelection=function(){if(this.oControl.isA("sap.m.MultiComboBox")){this.oControl.setSelectedKeys(null);if(this.isInSmartFilterBar()){this.oFilterModel.setProperty("/"+this.sFieldName+"/items",[])}}else{this.oControl.setSelectedKey(null);this.oControl.clearSelection()}};E.prototype._openDropdown=function(){if(this.oControl.isA("sap.m.MultiComboBox")){F.prototype.open.apply(this.oControl,arguments)}else if(this.oControl.isA("sap.m.ComboBox")){v.prototype.open.apply(this.oControl,arguments)}else if(this.oControl.isA("sap.m.Select")){P.prototype.open.apply(this.oControl,arguments)}};E.prototype._handleOutParameters=function(){if(this.oControl.isA("sap.m.MultiComboBox")){this.oControl.attachSelectionChange(this._onMultiComboBoxItemSelected,this)}else if(this.oControl.isA("sap.m.ComboBox")||this.oControl.isA("sap.m.Select")){this.oControl.attachChange(this._onComboBoxItemSelected,this)}};E.prototype._handleInParameters=function(){this.oControl.setBusyIndicatorDelay(0);this._calculateFilterInputData();this._mLastFilterInputData=this.mFilterInputData;this.oControl.open=function(){this._calculateFilterInputData();if(b(this._mLastFilterInputData,this.mFilterInputData)){this._openDropdown();return}this._filterDropdownRowsByInParameters();this._openDropdown()}.bind(this);this.oControl.addEventDelegate({onmousedown:function(t){if(this.oControl.getArrowIcon&&t.target===this.oControl.getArrowIcon().getFocusDomRef()){this._bSkipFocusIn=true}}.bind(this),onmouseup:function(t){if(this._bSkipFocusIn&&(this.oControl.getArrowIcon&&t.target===this.oControl.getArrowIcon().getFocusDomRef())){this.oControl.open()}this._bSkipFocusIn=false}.bind(this),onfocusin:function(t){if(this._bSkipFocusIn){return t}setTimeout(function(){this._calculateFilterInputData();if(b(this._mLastFilterInputData,this.mFilterInputData)){return}this._filterDropdownRowsByInParameters()}.bind(this));return t}.bind(this)})};E.prototype._primaryValueListAnnotationChanged=function(t){var e=this.oControl,i=this._oMetadataAnalyser,o,s,n=[],r=e.getBindingContext()&&e.getBindingContext().getPath();if(r){o=e.getModel()&&e.getModel().getContext(r);s=i.getPropertyContextByPath(this._sFullyQualifiedFieldName);n=i._getODataValueListRelevantQualifiers(s,o)}if(n.length>0&&(!n.includes(this.oPrimaryValueListAnnotation.qualifier)||n.includes("")&&this.oPrimaryValueListAnnotation.qualifier!=="")){i.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,r).then(function(i){if(e.oParent&&e.oParent._oFactory){e.oParent._oFactory._initValueList(i)}this._onAnnotationLoad(i);this._rebindInnerControlSuggestions();this._fetchData(t)}.bind(this));return true}return false};E.prototype._fetchData=function(t){var e={},i=[],s=this._getBindingLength(),n="",r,a;if(o.hasValueListRelevantQualifiers(this._fieldViewMetadata)&&this._primaryValueListAnnotationChanged(t)){return}t=t||"";if(this.bTypeAheadEnabled){if(t&&this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(this.bSupportBasicSearch){if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){e={"search-focus":this.sKey,search:t}}else{e.custom={"search-focus":this.sKey,search:t}}}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){i=H.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings})}if(!this.bSupportBasicSearch){if(this._fieldViewMetadata&&this._fieldViewMetadata.filterType==="numc"){i.push(new p(this.sKey,f.Contains,t))}else{n=this._truncateSearchText(t);if(n===t){i.push(new p(this.sKey,f.StartsWith,n))}else{this.oControl.closeSuggestions();return}}}s=10}e["$top"]=s;e["$skip"]=0;if(!this.sValueListEntitySetName){I.error("ValueListProvider","Empty sValueListEntitySetName for "+this.sAggregationName+" binding! (missing primaryValueListAnnotation)")}if(this.sDeferredGroupId){e["batchGroupId"]=this.sDeferredGroupId}if(this.aSelect&&this.aSelect.length){e["$select"]=this.aSelect.toString()}if(!(this._shouldHaveRecommendations()||this._shouldHaveHistory())||!this._isControlSupportedForHistory(this.oControl)){if(this.bTypeAheadEnabled&&this.bEnableShowTableSuggestionValueHelp){a={dataReceived:function(t){var e=t.getSource(),i;if(e){i=e.getLength();if(i&&i<=s){this.oControl.setShowTableSuggestionValueHelp(false)}else{this.oControl.setShowTableSuggestionValueHelp(true)}}}.bind(this)}}else if(this.bTypeAheadEnabled){this.oControl.setShowTableSuggestionValueHelp(false)}if(this.aSelect&&this.aSelect.length){e["select"]=this.aSelect.toString();delete e["$select"]}if(this._isControlDropdown(this.oControl)&&(this.mInParams&&Object.keys(this.mInParams).length>1||this.mConstParams&&Object.keys(this.mConstParams).length>=1)){if(!a){a={dataReceived:function(){this.oControl.setBusy(false)}.bind(this)}}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){i=H.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings})}}this.oControl.bindAggregation(this.sAggregationName,{path:"/"+this.sValueListEntitySetName,length:s,parameters:e,filters:i,sorter:this._oSorter,events:a,template:this._oTemplate,templateShareable:true});return}this._bindInnerControlSuggestions();var l=this;r=new Promise(function(t,o){if(!l.sValueListEntitySetName){t({results:[]})}l.oODataModel.read("/"+l.sValueListEntitySetName,{urlParameters:e,filters:i,sorters:l._oSorter&&[l._oSorter],success:function(e){t(e)},error:function(t){o(t)}})});var h=Promise.resolve([]);if(this._shouldHaveHistory()){h=l._oHistoryValuesProvider.getFieldData()}Promise.all([r,this._oRecommendationListPromise,h]).then(function(t){var e=[],i=[],o=[],n=[],r=l._getSuggestionsModelName(),a=l.oControl;if(!a){return}var h=a.getModel(r);if(Array.isArray(t[0]&&t[0].results)){i=l._addSuggestionsToGroup(t[0].results,N.Others)}if(Array.isArray(t[1]&&t[1].results)){o=l._addSuggestionsToGroup(t[1].results,N.Recommendations)}if(l._shouldHaveHistory()&&Array.isArray(t[2])){n=l._addSuggestionsToGroup(t[2],N.RecentlyUsed);n=l._parseHistoryJsonDates(n)}e=e.concat(o).concat(n).concat(i);e=l._getDistinctSuggestions(e);e=e.filter(l._filterSuggestionsWithInParams.bind(l,l.mFilterInputData));l._showSuggestionsMoreButton(i.length>=s);if(l.oControl.isA("sap.m.MultiInput")){l.oControl._oSuggPopover._oProposedItem=null}h.setData(e)})};E.prototype._sortRecommendations=function(t,e){var i=this._oRecommendationListAnnotation.rankProperty,o=parseFloat(t[i]),s=parseFloat(e[i]);return s-o};E.prototype._showSuggestionsMoreButton=function(t){if(!this.bTypeAheadEnabled){return}if(this.bEnableShowTableSuggestionValueHelp){this.oControl.setShowTableSuggestionValueHelp(t)}else{this.oControl.setShowTableSuggestionValueHelp(false)}};E.prototype._addSuggestionsToGroup=function(t,e){if(!t){return[]}return t.map(function(t){var i={};i[C.getSuggestionsGroupPropertyName()]=e;return Object.assign({},t,i)})};E.prototype._groupHeaderFactory=function(t){var e=this._getGroupHeaderTitle(t.key);if(this._isControlDropdown()){return new n({key:C.getHistoryPrefix()+t.key+".key",text:e})}return new r({title:e})};E.prototype._getGroupHeaderTitle=function(t){switch(t){case N.Recommendations:return this._oResourceBundle.getText("VALUELIST_RECOMMENDATIONS_TITLE");case N.RecentlyUsed:return this._oResourceBundle.getText("VALUELIST_RECENTLY_USED_TITLE");default:return this._oResourceBundle.getText("VALUELIST_OTHERS_TITLE")}};E.prototype._getGroupHeaderSorter=function(){if(this._groupHeaderSorter){return this._groupHeaderSorter}this._groupHeaderSorter=new c({path:C.getSuggestionsGroupPropertyName(),descending:false,group:function(t){return t.getProperty(C.getSuggestionsGroupPropertyName())}});return this._groupHeaderSorter};E.prototype._getDistinctSuggestions=function(t){var e={},i=[],o=this._aHighImportanceCols||this._aCols,s=o&&o.map(function(t){return t.template});if(!s&&t.length>0){s=Object.keys(t[0])}t.forEach(function(t){var o=s.reduce(function(e,i){e.push([i,t[i]]);return e},[]);var n=o.toString();if(!e[n]){i.push(t);e[n]=true}},this);return i};E.prototype._resolveRecommendationListAnnotationData=function(t){var e=t.fieldsToDisplay,i,o,s;this._aRecommendationCols=[];this.aRecommendationSelect=[];for(var n=0;n<e.length;n++){i=e[n];o=this._getColumnConfigFromField(i);if(i.visible){this._aRecommendationCols.push(o);this.aRecommendationSelect.push(i.name)}}if(this._aHighImportanceCols&&this._oRecommendationListAnnotation){s=this._oRecommendationListAnnotation.rankField[0];s=this._getColumnConfigFromField(s);this._aHighImportanceCols.push(s)}};E.prototype._setupRecommendations=function(){if(!this._shouldHaveRecommendations()||!this._isControlSupportedForHistory(this.oControl)){return}this._resolveRecommendationListAnnotationData(this._getRecommendationListAnnotation());this._fetchRecommendations()};E.prototype._shouldHaveRecommendations=function(){return o.isRecommendationList(this._fieldViewMetadata)};E.prototype._getRecommendationListAnnotation=function(){if(!this._oRecommendationListAnnotation){var t=this._oMetadataAnalyser._getRecommendationListAnnotation(this._sFullyQualifiedFieldName);this._oRecommendationListAnnotation=this._oMetadataAnalyser._enrichRecommendationListAnnotation(t)}return this._oRecommendationListAnnotation};E.prototype._fetchRecommendations=function(){var t=this;this._oRecommendationListPromise=new Promise(function(e,i){t.oODataModel.read("/"+t._oRecommendationListAnnotation.path,{urlParameters:{$skip:0,$top:5,$select:t.aRecommendationSelect.toString()},sorter:t._oSorter,success:function(i){var o=t._addSuggestionsToGroup(i.results,N.Recommendations),s=t._getSuggestionsModelName(),n=t.oControl.getModel(s),r=n.getData(),a=o.sort(t._sortRecommendations.bind(t));t._aRecommendations=a;if(Array.isArray(r)){a=[].concat(r).concat(a)}n.setData(a);t._showSuggestionsMoreButton(false);e(i)},error:function(t){i(t)}})})};E.prototype._createHistoryValuesProvider=function(){return new y(this.oControl,this._sFullyQualifiedFieldName)};E.prototype._createHistoryOptOutProvider=function(){return S.createOptOutSettingPage()};E.prototype._setupHistoryValues=function(){if(!this._shouldHaveHistory()||!this._isControlSupportedForHistory(this.oControl)){return}this._oHistoryValuesProvider=this._createHistoryValuesProvider();this._createHistoryOptOutProvider();this._oHistoryValuesProvider.getHistoryEnabled().then(function(t){if(!t||!this._oHistoryValuesProvider){return}this._oHistoryValuesProvider.attachChangeListener();this._oHistoryValuesProvider.attachEvent("fieldUpdated",this._onHistoryFieldUpdated,this);this._oHistoryValuesProvider.getFieldData().then(this._onHistoryDataInitialized.bind(this))}.bind(this))};E.prototype._onHistoryDataInitialized=function(t){this._updateModelHistoryData(t);return t};E.prototype._onHistoryFieldUpdated=function(t){var e=t.getParameter("fieldData")||[];if(this.oControl.isA("sap.m.Input")){setTimeout(function(){this._updateModelHistoryData(e);this.oControl&&this.oControl._oSuggPopover._oPopover.close()}.bind(this));return}this._updateModelHistoryData(e);if(this.oControl.isA("sap.m.ComboBox")){setTimeout(function(){this.oControl&&this.oControl._oSuggestionPopover._oPopover.close()}.bind(this))}};E.prototype._updateModelHistoryData=function(t){if(!this.oControl){return}t=this._parseHistoryJsonDates(t);var e=[],i=this._addSuggestionsToGroup(t,N.RecentlyUsed),o=this._getSuggestionsModelName(),s=this.oControl.getModel(o),n=s.getData();if(!Array.isArray(n)){n=[]}e=this._getDistinctSuggestions(e.concat(i).concat(n));s.setData(e);this._showSuggestionsMoreButton(false)};E.prototype._shouldHaveHistory=function(){if(!this._fieldHistoryEnabled||!this._fieldViewMetadata||!this._sFullyQualifiedFieldName||!this.oControl||this._isControlDropdown()&&(this._fieldHistoryEnabledInitial||this._fieldHistoryEnabledInitial===undefined)&&this._fieldHistoryEnabled){return false}var t=window["sap-ushell-config"],e,i,s;if(t){e=t.apps}if(e){i=e.inputFieldHistory}if(i){s=i.enabled}return sap.ushell&&sap.ushell.Container&&s&&!o.isPotentiallySensitive(this._fieldViewMetadata)};E.prototype._bindInnerControlSuggestions=function(){if(this.sAggregationName&&this.oControl.isBound(this.sAggregationName)){return}this._rebindInnerControlSuggestions()};E.prototype._rebindInnerControlSuggestions=function(){if(this.sAggregationName&&this.sAggregationName==="suggestionRows"){this._createSuggestionTemplate()}else{this._createDropDownTemplate()}var t={path:this._getSuggestionsModelName()+">/",template:this._oTemplate,templateShareable:true,length:this._getBindingLength()};t.groupHeaderFactory=this._groupHeaderFactory;t.sorter=this._getGroupHeaderSorter();if(this.sAggregationName){this.oControl.bindAggregation(this.sAggregationName,t)}};E.prototype._setupSuggestionInteractions=function(){if(this.sAggregationName==="suggestionRows"){this._setupInputSuggestionInteractions();return}this._setupComboBoxSuggestionInteractions()};E.prototype._setupInputSuggestionInteractions=function(){var t=this.oControl;t.setFilterSuggests(true);t.setFilterFunction(function(t,e){var i=this._getSuggestionsModelName(),o=e.getBindingContext(i).getObject(),s=o[this.sKey],n=o[this.sDescription],r=_.getFormatterFunctionFromDisplayBehaviour(this.sDDLBDisplayBehaviour),a=r(s,n);t=t.replace(/\*$/,"");t=t.replace(/^\*/,"");var l=Object.keys(o).some(function(e){var i=o[e]+"";return i.toLowerCase().indexOf(t.toLowerCase())!==-1});var h=a.toLowerCase().indexOf(t.toLowerCase())!==-1;return l||h}.bind(this));t.attachLiveChange(function(t){var e=t.getParameter("value"),i=[N.RecentlyUsed,N.Recommendations];if(e===""){this.oControl._oSuggPopover._oPopover.close();this._showInitialSuggestions(i)}},this);t.addEventDelegate({onmousedown:function(e){if(this.oControl.getAggregation("_suggestionPopup")&&this.oControl.getAggregation("_suggestionPopup").isOpen()||e.target.tagName!=="INPUT"){return}this._bindInnerControlSuggestions();if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.getFieldData().then(function(e){this._updateModelHistoryData(e);this._showInitialSuggestions("suggestionRows",t.getValue())}.bind(this))}},onkeyup:function(e){this._bindInnerControlSuggestions();if(e.keyCode!==9){return}if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.getFieldData().then(function(e){this._updateModelHistoryData(e);this._showInitialSuggestions("suggestionRows",t.getValue())}.bind(this))}}},this);if(t.isA("sap.m.MultiInput")||!this._shouldHaveRecommendations()){return}t.attachSuggestionItemSelected(function(t){var e=this._getSuggestionsModelName(),i=t.getParameter("selectedRow"),o;if(i){var s=i.getBindingContext(e).getObject();o=s&&s[this.sKey]}if(this._isNotRecommendationItemSelected("suggestionRows",o)){this._setControlValueState(M.Warning)}else{this._setControlValueState(M.None)}},this)};E.prototype._setupComboBoxSuggestionInteractions=function(){var t=this.oControl;t.setShowSecondaryValues(true);t.addEventDelegate({onmousedown:function(e){if(this.oControl.getPicker()&&this.oControl.getPicker().isOpen()||e.target.tagName!=="INPUT"){return}this._bindInnerControlSuggestions();setTimeout(function(){this._showInitialSuggestions("items",t.getValue())}.bind(this))},onkeyup:function(e){this._bindInnerControlSuggestions();if(e.keyCode!==9){return}setTimeout(function(){this._showInitialSuggestions("items",t.getValue())}.bind(this))}},this);if(t.isA("sap.m.MultiComboBox")||!this._shouldHaveRecommendations()){return}t.attachChange(function(t){if(this._isNotRecommendationItemSelected("items",t.getParameter("value"))){this._setControlValueState(M.Warning)}else{this._setControlValueState(M.None)}},this)};E.prototype._isNotRecommendationItemSelected=function(t,e){return this._findSuggestionItemGroup(t,e)!==N.Recommendations};E.prototype._findSuggestionItemGroup=function(t,e){var i=this.oControl.getBinding(t),o=i?i.getCurrentContexts():[],s;for(var n=0;n<o.length;n++){var r=o[n].getObject(),a=r[this.sKey],l=r[this.sDescription];if(a===e||l===e){s=r;break}}return s?s[C.getSuggestionsGroupPropertyName()]:null};E.prototype._setControlValueState=function(t){this.oControl.setValueState(t?t:M.None);this.oControl.setValueStateText(" ")};E.prototype._showInitialSuggestions=function(t,e){var i=this,o=[N.RecentlyUsed,N.Recommendations],s=[N.RecentlyUsed],n=[];if(this._isNotRecommendationItemSelected(t,e)){n=o}else if(this._shouldHaveHistory()){n=s}this._calculateFilterInputData();this.oControl.showItems(function(t,e){var o=i._getSuggestionsModelName(),s=e.getBindingContext(o),r=s?s.getObject():{},a=r[C.getSuggestionsGroupPropertyName()];return i._filterSuggestionsWithInParams(i.mFilterInputData,r)&&n.indexOf(a)!==-1})};E.prototype._filterSuggestionsWithInParams=function(t,e){if(!t||t.length===0){return true}return Object.keys(t).every(function(i){var o=e[i];var s=t[i];if(!o){return true}if(typeof s==="string"){return s===o}if(typeof s==="object"&&s.items&&s.items.length>0){return s.items.some(function(t){return t.key===o})}return true})};E.prototype._getSuggestionsModelName=function(){var t;if(!this._isControlSupportedForHistory(this.oControl)){return t}if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){t=x}return t};E.prototype._resolveSuggestionBindingPath=function(t){var e=this._getSuggestionsModelName();if(e){t=e+">"+t}return t};E.prototype._isControlSupportedForHistory=function(t){if(!t){return false}if(t.isA("sap.ui.comp.smartfield.DisplayComboBox")){return false}if(t.isA("sap.m.ComboBox")||t.isA("sap.m.MultiComboBox")||t.isA("sap.m.Input")||t.isA("sap.m.MultiInput")){return true}return false};E.prototype._getBindingLength=function(){var t=300;if(this.oODataModel&&this.oODataModel.iSizeLimit&&this.oODataModel.iSizeLimit>t){t=this.oODataModel.iSizeLimit}return t};E.prototype._parseHistoryJsonDates=function(t){return t.map(function(t){return Object.keys(t).reduce(function(e,i){if(s._hasJsonDateString(t[i])){e[i]=s._parseJsonDateString(t[i])}else{e[i]=t[i]}return e},{})})};E.prototype._truncateSearchText=function(t){var e=-1;if(this._sMaxLength){e=parseInt(this._sMaxLength)}else if(this._fieldViewMetadata&&this._fieldViewMetadata.maxLength){e=parseInt(this._fieldViewMetadata.maxLength)}if(e>-1&&t.length>e){t=t.substr(0,e)}return t};E.prototype._handlePresentationVariantSortOrderAnnotation=function(){var t,e,i=this.oPrimaryValueListAnnotation.valueListEntityName;if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new o(this.oODataModel);this._bCleanupMetadataAnalyser=true}t=this._oMetadataAnalyser._getPresentationVariantQualifierForVHD(i);e=this._oMetadataAnalyser.getPresentationVariantAnnotation(i,t);if(e&&e.sortOrderFields.length!==0){e.sPresentationVariantSortPath=e.sortOrderFields[0].name;this._oMetadataAnalyser._getEntityDefinition(i).property.forEach(function(t){if(t.name===e.sPresentationVariantSortPath){e._bIsPresentationVariantSortPathInVHDEntityType=true}});this.oPrimaryValueListAnnotation.fields.forEach(function(t){if(t.name===e.sPresentationVariantSortPath&&t.sortable===true){e._bIsPresentationVariantSortOrderPropertySortable=true}})}return e};E.prototype._hasNotValidatedSingleField=function(t){return this.oFilterProvider&&this.oFilterProvider._oNotValidatedSingleFields&&this.oFilterProvider._oNotValidatedSingleFields[t]};E.prototype.unbindAggregation=function(){if(this.oControl){this.oControl.unbindAggregation(this.sAggregationName)}return this};E.prototype.destroy=function(){if(this.oControl){if(this.oControl.detachSuggest&&this._fSuggest){this.oControl.detachSuggest(this._fSuggest);this._fSuggest=null}if(this.oControl.removeValidator&&this._fValidator){this.oControl.removeValidator(this._fValidator);this._fValidator=null}else if(this.oControl.detachSuggestionItemSelected){this.oControl.detachSuggestionItemSelected(this._onSuggestionItemSelected,this)}if(this.oControl.detachChange){this.oControl.detachChange(this._validateStringSingleWithValueList,this)}this.oControl.unbindAggregation(this.sAggregationName);this.oControl.data("_hassuggestionTemplate",false);delete this.oControl.__sValidationText;delete this.oControl.__bValidatingToken}if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.destroy();this._oHistoryValuesProvider=null}d.prototype.destroy.apply(this,arguments);if(this.oJsonModel){this.oJsonModel.destroy();this.oJsonModel=null}if(this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;this.sAggregationName=null;this.bTypeAheadEnabled=null;this._oSorter=null};return E});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/AnnotationHelper", [],function(){"use strict";var t=function(){};t.prototype.getText=function(t){return this._getObject("com.sap.vocabularies.Common.v1.Text/Path",t)};t.prototype.getTextArrangement=function(t,e,r){var o=null,a=null;a=this._getObject("com.sap.vocabularies.Common.v1.Text",t);if(a){o=a["com.sap.vocabularies.UI.v1.TextArrangement"]}if(!o){o=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",t)}if(!o){o=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",e)}if(r&&!o&&a&&a.Path){for(var n=0;n<e.property.length;n++){if(e.property[n].name===a.Path){a=e.property[n];var i=this._getObject("com.sap.vocabularies.Common.v1.Text",a);if(i&&!i.navigationPath){o=i["com.sap.vocabularies.UI.v1.TextArrangement"]}break}}}if(o&&o.EnumMember){if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"){return"descriptionAndId"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"idAndDescription"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"){return"idOnly"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"descriptionOnly"}}return null};t.prototype.getUnit=function(t){return this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",t)||this._getObject("Org.OData.Measures.V1.Unit/Path",t)};t.prototype.getLabel=function(t){var e=this._getObject("com.sap.vocabularies.UI.v1.DataFieldWithUrl/Label/String",t);return e||this._getObject("com.sap.vocabularies.Common.v1.Label/String",t)};t.prototype.isCurrency=function(t,e){return!!(e&&e["sap:semantics"]==="currency-code")||!!(t&&this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",t))};t.prototype.getQuickInfo=function(t){return this._getObject("com.sap.vocabularies.Common.v1.QuickInfo/String",t)};t.prototype.isMasked=function(t){return!!this._getObject("com.sap.vocabularies.Common.v1.Masked",t)};t.prototype.isMultiLineText=function(t){return!!this._getObject("com.sap.vocabularies.UI.v1.MultiLineText",t)};t.prototype.isStaticMandatory=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl",t);if(e&&e.EnumMember){return e.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Mandatory"}return false};t.prototype.isNullable=function(t){var e=this._getObject("nullable",t);if(e){return e==="true"}return true};t.prototype.isUpperCase=function(t){return this._getObject("com.sap.vocabularies.Common.v1.IsUpperCase/Bool",t)==="true"};t.prototype.canCreateEntitySet=function(t){return!(this._getObject("Org.OData.Capabilities.V1.InsertRestrictions/Insertable/Bool",t)==="false")};t.prototype.canCreateProperty=function(t){var e=this._getObject("Org.OData.Core.V1.Immutable/Bool",t);var r=this._getObject("Org.OData.Core.V1.Computed/Bool",t);if(r){return r=="false"}if(e){return e=="true"}return true};t.prototype.canUpdateEntitySet=function(t){return!(this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Bool",t)==="false")};t.prototype.getUpdateEntitySetPath=function(t){return this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Path",t)};t.prototype.canUpdateProperty=function(t){var e=this._getObject("Org.OData.Core.V1.Computed/Bool",t)==="true"||this._getObject("Org.OData.Core.V1.Immutable/Bool",t)==="true"||this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",t)==="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly";return!e};t.prototype.getFieldControlPath=function(t){return this._getObject("com.sap.vocabularies.Common.v1.FieldControl/Path",t)};t.prototype.getUIHiddenPath=function(t){return this._getObject("com.sap.vocabularies.UI.v1.Hidden/Path",t)};t.prototype.getVisible=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",t);if(e==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"){return"false"}var r=this._getObject("com.sap.vocabularies.UI.v1.Hidden",t);if(r&&r.Bool&&!(r.Bool=="false")){return"false"}return"true"};t.prototype.getImportanceAnnotation=function(t){var e,r=this._getObject("com.sap.vocabularies.UI.v1.Importance",t);if(r){e=r.EnumMember}switch(e){case"com.sap.vocabularies.UI.v1.ImportanceType/High":return"High";case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";default:return"Low"}};t.prototype._getObject=function(t,e){var r=e,o=t.split("/"),a=0;while(r&&o[a]){r=r[o[a]];a++}return r};t.prototype.destroy=function(){};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/BindingUtil", ["sap/ui/model/odata/AnnotationHelper","sap/ui/base/BindingParser"],function(t,r){"use strict";var e=function(){};e.prototype.correctPath=function(t){var r,e=/\((.+)\)*/,a=e.exec(t);if(a){r=t.replace(a[0],"")}else{r=t||""}return r.replace("/","")};e.prototype.getNavigationProperties=function(t){var r,e,a={};e=t.getBindingContext();if(e&&e.sPath){a.paths=e.sPath.split("/")}r=t.getObjectBinding();if(r&&r.sPath){a.objectBinding=r.sPath;if(a.paths){a.paths.push(r.sPath)}else{a.paths=[r.sPath]}}if(!a.paths){a.paths=[]}return a};e.prototype.getBindingParts=function(t,r,e){var a=0,o,p,n;if(t&&t.parts){a=t.parts.length}for(o=0;o<a;o++){n="";p=t.parts[o];if(p.model){n=n+p.model+">"}n=n+p.path;r.push(n);e.length++}};e.prototype.toBinding=function(t){var r={},e,a,o,p,n={model:true,formatter:true,mode:true,path:true};if(t){if(t.parts&&t.parts.length){p=t.parts.length;r.parts=[]}for(o=0;o<p;o++){a=t.parts[o];r.parts.push(a)}for(e in n){if(t[e]){r[e]=t[e]}}return r}return null};e.prototype.toBindingPath=function(t){var r,e="",a,o,p;r=this.toBinding(t);if(r){if(r.model){e=r.model+">"}if(r.path){e=e+r.path}else if(r.parts&&r.parts.length>0){p=r.parts.length;for(o=0;o<p;o++){a=r.parts[o];if(a.model){e=e+a.model+">"}e=e+a.path}}}return e};e.prototype.fromFormatter=function(t,r,e){var a,o,p,n={model:t,formatter:r.formatter};p=r.path();o=p.length;if(o>0){n.parts=p;if(e){for(a=0;a<o;a++){e.push(p[a])}}}else{n.path=""}return n};e.prototype.executeODataBindingExpression=function(e,a){var o,p,n,i,s,f="";if(e&&a){s=t.format(a,e);f=s;i=r.complexParser(s,a);n=[];if(i){if(i.formatter){for(o=0;o<i.parts.length;o++){p=a.getProperty(i.parts[o].path,"value");n.push(p)}f=i.formatter.apply(null,n)}else{f=a.getProperty(i.path,"value")}}}return f};e.prototype.destroy=function(){};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ComboBox", ["sap/ui/comp/library","sap/m/ComboBox","sap/m/ComboBoxRenderer"],function(e,t,r){"use strict";var i="00000000-0000-0000-0000-000000000000";function a(e){return e===i}var s=t.extend("sap.ui.comp.smartfield.ComboBox",{metadata:{library:"sap.ui.comp",properties:{enteredValue:{type:"string",group:"Data",defaultValue:""},realValue:{type:"string",group:"Data",defaultValue:""}}},renderer:r});s.prototype.init=function(){t.prototype.init.apply(this,arguments);this.attachChange(function(){var e=this.getSelectedKey(),t=e?e:this.getValue();if(!e&&this.getItemByKey(t)){this.setSelectedKey(t)}this.setProperty("realValue",t)}.bind(this))};s.prototype.setRealValue=function(e){this.setValue(e);this.setSelectedKey(e);return this.setProperty("realValue",e)};s.prototype.setEnteredValue=function(e){if(typeof e!=="undefined"){this.setSelectedKey(e)}var t=this.getSelectedItem();if(e&&!t&&!a(e)){this.setValue(e)}var r=t?this.getSelectedKey():this.getValue();this.setProperty("enteredValue",r);return this};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/Configuration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var i=a.extend("sap.ui.comp.smartfield.Configuration",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlType",group:"Misc",defaultValue:null},displayBehaviour:{type:"sap.ui.comp.smartfield.DisplayBehaviour",group:"Misc",defaultValue:null},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false}}}});return i});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ControlFactoryBase", ["sap/ui/base/Object","sap/ui/core/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/ui/comp/util/FormatUtil","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/comp/smartfield/BindingUtil","sap/ui/comp/odata/MetadataAnalyser","sap/m/HBox","sap/base/Log","sap/base/strings/capitalize","sap/ui/comp/smartfilterbar/SmartFilterBar"],function(t,e,a,i,o,n,r,s,l,d,u,p,g){"use strict";var f=a.smartfield.ControlContextType;var h=e.ValueState;var c=t.extend("sap.ui.comp.smartfield.ControlFactoryBase",{constructor:function(e,a){t.apply(this,arguments);this.sName="ControlFactoryBase";this._oModel=e;this._oParent=a;this._oBinding=new s;this._aProviders=[];this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}});c.prototype.bind=function(){return Promise.resolve()};c.prototype.createControl=function(t){var e,a;e=this._getCreator(t);if(e){a=this[e](t);this._addAriaLabelledBy(a);this._addAriaDescribedBy(a);if(a&&a.onCreate){this[a.onCreate](a.control,a.params)}}return a};c.prototype.updateControl=function(t){var e,a=t.mode,i=this._oParent,o=i.data("configdata");if(o&&o.configdata){e=i.getFirstInnerControl();if(o.configdata.onText&&a==="display"){o.configdata.onText(e)}else if(o.configdata.onInput&&a==="edit"){o.configdata.onInput(e)}}};c.prototype._addAriaLabelledBy=function(t){var e=this._getTargetControlForAccAttributes(t),a=this._oParent.getAriaLabelledBy();if(e&&e.addAriaLabelledBy&&a.length>0){e.removeAllAriaLabelledBy();a.forEach(function(t){e.addAriaLabelledBy(t)})}};c.prototype._addAriaDescribedBy=function(t){var e=this._getTargetControlForAccAttributes(t),a=this._oParent.getAriaDescribedBy();if(e&&e.addAriaDescribedBy&&a.length>0){e.removeAllAriaDescribedBy();a.forEach(function(t){e.addAriaDescribedBy(t)})}};c.prototype._getTargetControlForAccAttributes=function(t){var e,a=this._oParent.getControlContext();if(a===f.None||a===f.Form||a===f.SmartFormGrid){if(t){e=t.control;if(e instanceof d){if(e.getItems().length>0){e=e.getItems()[0]}}}}return e};c.prototype.addValidations=function(t,e){var a,i,o=this;a=function(t,a){var i,n,r=a.getParameter("targetControl")||a.getSource();if(r){if(r.setValueState){r.setValueState(t)}n=a.getParameter("exception");if(n){i=n.message}if(!i){i=a.getParameter("message")}if(r.setValueStateText){r.setValueStateText(i)}}if(e){o._oParent[e](t===h.Error)}};i=function(t){a(h.Error,t)};t.attachFormatError(i);t.attachParseError(i);t.attachValidationError(i);t.attachValidationSuccess(function(t){o._oParent.onValidation(t);a(h.None,t)})};c.prototype._getDisplayBehaviourConfiguration=function(t){var e=null,a=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";var i=this._oParent.getConfiguration();if(i){e=i.getDisplayBehaviour()}if(!e&&this._oMetaData&&this._oMetaData.entityType){e=this._oHelper.oAnnotation.getTextArrangement(this._oMetaData.property.property,this._oMetaData.entityType,a)}if(!e){e=this._oParent.data(t?t:"defaultInputFieldDisplayBehaviour")}return e};c.prototype._getPreventInitialDataFetchInVHDialog=function(t){var e=this._oParent.getConfiguration();if(e&&!e.isPropertyInitial("preventInitialDataFetchInValueHelpDialog")){return e.getPreventInitialDataFetchInValueHelpDialog()}if(l.isValueList(t)&&t["com.sap.vocabularies.Common.v1.ValueList"]&&t["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return t["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};c.prototype._formatDisplayBehaviour=function(t,e,a){var i=this._getDisplayBehaviourConfiguration(t);if(t==="defaultCheckBoxDisplayBehaviour"){return this._getFormattedExpressionFromDisplayBehaviour(i,e)}if(t==="defaultComboBoxReadOnlyDisplayBehaviour"&&!i){i="descriptionAndId"}return o.getFormattedExpressionFromDisplayBehaviour(i||"idOnly",e,a)};c.prototype._getFormattedExpressionFromDisplayBehaviour=function(t,e){var a="";switch(t){case"OnOff":a=e?"SMARTFIELD_CB_ON":"SMARTFIELD_CB_OFF";break;case"TrueFalse":a=e?"SMARTFIELD_CB_TRUE":"SMARTFIELD_CB_FALSE";break;default:a=e?"SMARTFIELD_CB_YES":"SMARTFIELD_CB_NO";break}return this._oRb.getText(a)};c.prototype.getDropdownItemKeyType=function(){};c.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(){};c.prototype.createValueHelp=function(t){var e,a=t.edmProperty,i=t.valueHelp;if(i.annotation&&(a["sap:value-list"]||a["com.sap.vocabularies.Common.v1.ValueList"])){var o=i.displayBehaviour||this._getDisplayBehaviourConfiguration("defaultDropDownDisplayBehaviour"),s=this._oParent.data("dateFormatSettings"),l=this._getPreventInitialDataFetchInVHDialog(a);if(typeof s==="string"){try{s=JSON.parse(s)}catch(t){}}var d,u,p=this._oParent.data("configdata"),f,h;if(typeof i.annotation==="string"){u=i.annotation}else if(i&&typeof i.annotation==="object"){if(p&&p.configdata){f=p.configdata.annotations;if(f&&f.valuelist&&typeof f.valuelist==="string"){u=f.valuelist}}h=f&&(f.valueListData&&f.valueListData.annotation||f.valuelist);d=i.analyser.getValueListAnnotationForFunctionImport({"":h||i.annotation},a.name).primaryValueListAnnotation}var c=t.control,y=t.model,m=t.onValueListChange;if(!i.noDialog){if(c.setFilterSuggests){c.setFilterSuggests(false)}var _=new n({context:"SmartField",fnAsyncWritePromise:this._oParent._isAsync&&this._oParent._isAsync()?this._oParent.checkValuesValidity.bind(this._oParent):null,selectedODataRowHandler:this._selectedODataRowHandler.bind(this),fieldName:a.name,control:c,model:y,dateFormatSettings:s,displayBehaviour:o,loadAnnotation:true,fullyQualifiedFieldName:u,metadataAnalyser:i.analyser,annotation:d,title:i.dialogtitle,preventInitialDataFetchInValueHelpDialog:l,supportMultiSelect:!!i.supportMultiSelect,supportRanges:!!i.supportRanges,takeOverInputValue:true,type:i.type,maxLength:a.maxLength,filterBarClass:g});if(m){_.attachValueListChanged(m)}this._aProviders.push(_);if(c.setShowValueHelp){c.setShowValueHelp(true)}}var v=true,P=true;if(this._oParent._getHistoryEnabled){v=this._oParent._getHistoryEnabled();P=this._oParent.isPropertyInitial("historyEnabled")}if(!i.noTypeAhead||!c.isA("sap.m.Input")){e={control:c,model:y,dateFormatSettings:s,displayBehaviour:o,fieldViewMetadata:a,loadAnnotation:true,fullyQualifiedFieldName:u,metadataAnalyser:i.analyser,annotation:d,aggregation:i.aggregation,typeAheadEnabled:!i.noTypeAhead,dropdownItemKeyType:this.getDropdownItemKeyType(c),maxLength:a.maxLength,fieldHistoryEnabled:v,fieldHistoryEnabledInitial:P};var A=new r(this.getValueListProviderConfiguration(e));if(!i.noTypeAhead){if(c.setShowSuggestion){c.setShowSuggestion(true)}}if(m){A.attachValueListChanged(m)}this._aProviders.push(A)}}};c.prototype.getValueListProviderConfiguration=function(t){return{context:"SmartField",fnAsyncWritePromise:this._oParent._isAsync&&this._oParent._isAsync()?this._oParent.checkValuesValidity.bind(this._oParent):null,selectedODataRowHandler:this._selectedODataRowHandler.bind(this),control:t.control,model:t.model,dateFormatSettings:t.dateFormatSettings,displayBehaviour:t.displayBehaviour,fieldViewMetadata:t.fieldViewMetadata,loadAnnotation:true,fullyQualifiedFieldName:t.fullyQualifiedFieldName,metadataAnalyser:t.metadataAnalyser,annotation:t.annotation,aggregation:t.aggregation,typeAheadEnabled:t.typeAheadEnabled,dropdownItemKeyType:t.dropdownItemKeyType,maxLength:t.maxLength,fieldHistoryEnabled:t.fieldHistoryEnabled,fieldHistoryEnabledInitial:t.fieldHistoryEnabledInitial}};c.prototype._selectedODataRowHandler=function(t,e,a){if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.setDataForNextDescriptionRequest(t,e);this.oTextArrangementDelegate.setAbsolutePathToVLProperty(a)}};c.prototype.getAttribute=function(t){var e=this._oParent.getBindingInfo(t);if(e){return this._oBinding.toBindingPath(e)}return this._oParent["get"+t.substring(0,1).toUpperCase()+t.substring(1)]()};c.prototype.getCustomDataConfiguration=function(){var t=this._oParent.data("configdata");return t&&t.configdata?t.configdata:null};c.prototype.createAttributes=function(t,e,a,i){var o=this,n,r={};for(var s in a){if(a.hasOwnProperty(s)){var l=this._oParent.getBindingInfo(s);if(l){r[s]=this._oBinding.toBinding(l)}else if(s==="valueState"&&this._oParent.isPropertyInitial("valueState")){l=this.getValueStateBindingInfoForRecommendationStateAnnotation();if(l){r[s]=l}else{r[s]=this._oParent["get"+p(s)]()}}else{r[s]=this._oParent["get"+p(s)]()}}}if(t){if(e&&e.property&&e.property.type==="Edm.String"&&!this._oParent.getClientSideMandatoryCheck()){n={parseKeepsEmptyString:true}}r[t]={model:this._oMetaData.model,path:this._oMetaData.path,type:e?this._oTypes.getType(e,n):null,mode:this._oParent.getBindingMode("value")}}if(i){r[i.event]=function(t){try{var e=t.getParameters();var a={value:e[i.parameter],newValue:e[i.parameter]};o._oParent.fireChange(a)}catch(t){u.warning(t)}}}return r};c.prototype.mapBindings=function(t,e,a){var i,o;for(i in e){o=this._oParent.getBindingInfo(i);if(o){t[e[i]]=this._oBinding.toBinding(o)}else{t[e[i]]=a&&a[e[i]]||this._oParent["get"+i.substring(0,1).toUpperCase()+i.substring(1)]()}}};c.prototype.getFormatSettings=function(t){var e=null,a,i,o;if(t){e=this._oParent.data(t);if(!e){a=this._oParent.getCustomData();if(a){o=a.length;while(o--){i=a[o];if(i.getKey()===t){e=i.getValue();break}}}}if(e&&typeof e==="string"){try{e=JSON.parse(e)}catch(t){return null}}}return e};c.prototype.getValueListProvider=function(){return this._aProviders.find(function(t){return t.isA("sap.ui.comp.providers.ValueListProvider")})};c.prototype.destroyValueHelp=function(){this._aProviders.forEach(function(t){t.destroy()});this._aProviders=[]};c.prototype.destroy=function(){this.destroyValueHelp();if(this._oBinding){this._oBinding.destroy()}this._oBinding=null;this._oParent=null;this._oModel=null;this._oRb=null};return c},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ControlProposal", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var t=e.smartfield.ControlProposalType;var o=a.extend("sap.ui.comp.smartfield.ControlProposal",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:t.None}},aggregations:{objectStatus:{type:"sap.ui.comp.smartfield.ObjectStatus",multiple:false}}}});return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/FieldControl", ["sap/ui/comp/smartfield/BindingUtil","sap/ui/model/ParseException","sap/base/strings/capitalize","sap/base/util/isPlainObject"],function(t,e,i,r){"use strict";var n=function(e,i){this._bIsDestroyed=false;this._oBinding=new t;this._oStoredProperties={};this._bVisibleSet=false;this._bEditableSet=false;this._bMandatorySet=false;this._bUomEditableSet=false;this._oStoredBindings={};this._oParent=e;this._oHelper=i;this._oAnnotation=i.oAnnotation};n.prototype.getPropertyNames=function(t){if(t){return["editable","visible"]}return["editable","visible","mandatory"]};n.prototype.getControlFormatters=function(t,e){var r,n,o,a={};if(t&&e){n=e.length;while(n--){o=e[n];r="_get"+i(o);if(this[r]){a[o]=this[r](t,this._oParent.getBindingInfo(o))}}}return a};n.prototype._getEditable=function(t,e,n){if(n===undefined){n="editable"}var o,a=this._oParent["get"+i(n)](),s=-1,p=-1,d=-1,l=-1,f=this;var h={length:0};if(n==="uomEditable"){this._bUomEditableSet=true}else{this._bEditableSet=true}if(!e){o=this._oParent["get"+i(n)]();this._oStoredProperties[n]=o;this._oStoredBindings.editable=null}else if(this._oStoredBindings.editable===undefined){this._oStoredBindings.editable=e}return{path:function(){var i=[],r,n=0;if(!t.property||!t.property.property){return[""]}r=f._oAnnotation.getFieldControlPath(t.property.property);if(r){i.push(f._toPath(t,r));s=n;n++}if(t.entitySet["sap:updatable-path"]){if(t.toRoleAssociationEndMultiplicity==="1"){i.push(f._toPath(t,t.entitySet["sap:updatable-path"]))}else{i.push(t.entitySet["sap:updatable-path"])}p=n;n++}if(e){d=n;f._oBinding.getBindingParts(e,i,h);n=n+h.length}if(t&&t.navigationPath&&!f._oParent._getEditableForNotExpandedNavigation()){i.push(t.navigationPath);l=n;n++}if(n>0){return i}return[""]},formatter:function u(_,g,y,b){if(f._bIsDestroyed){return false}if(!f._oAnnotation){return false}var c=this||f._oParent;var m;if(c&&typeof c.getBindingContext==="function"){m=c.getBindingContext()}var P=m&&m.getObject(),S=P&&P.__metadata,v=!!(S&&S.created),E=t.property&&t.property.property;if(P&&E){if(v){if(!f._getCreatableStatic(t)){return false}}else if(!f._getUpdatableStatic(t)){return false}}var B=[];if(s>-1){B.push(arguments[s]!==1)}if(p>-1&&(!P||!S||!v)&&arguments[p]!==undefined&&arguments[p]!==null){B.push(!!arguments[p])}if(d>-1){if(e.formatter){B.push(f._execFormatter(e.formatter,arguments,d,h.length))}else{B.push(!!arguments[d])}}if(l>-1){B.push(!!arguments[l])}if(B.length===0){var A=c&&c.getBinding(n),C=c&&c.getBindingPath(n),I=C==="",M=!!A&&A.isInitial(),U=_==null;if(U&&I&&(m&&!m.isTransient()||m===undefined)){o=f._oParent["get"+i(n)]()}else if(I&&r(_)&&P&&E&&f._getCreatableStatic(t)&&f._getUpdatableStatic(t)){o=f._oParent["get"+i(n)]()}else if(!M&&U){o=true}else if(!M&&a&&m&&m.isTransient()&&P&&E&&f._getCreatableStatic(t)){o=true}else if(!M&&!U&&I&&!r(_)){o=_}B.push(o)}return f._compare(B,false,true)}}};n.prototype._execFormatter=function(t,e,i,r){var n=[],o;if(i>-1&&r>-1){for(o=0;o<r;o++){n.push(e[i+o])}}return t.apply(this._oParent,n)};n.prototype._getCreatableStatic=function(t){var e=this._oAnnotation.canCreateEntitySet(t.entitySet),i=this._oAnnotation.canCreateProperty(t.property.property),r=t.ignoreInsertRestrictions;return(e||r)&&i};n.prototype._getUpdatableStatic=function(t){return this._oAnnotation.canUpdateEntitySet(t.entitySet)&&this._oAnnotation.canUpdateProperty(t.property.property)};n.prototype._compare=function(t,e,i){var r,n=t.length;for(r=0;r<n;r++){if(t[r]===e){return e}}return i};n.prototype._getVisible=function(t,e,n){if(n===undefined){n="visible"}var o,a=-1,s=-1,p=this;var d={length:0};this._bVisibleSet=true;if(!e){o=this._oParent["get"+i(n)]();this._oStoredProperties[n]=o;this._oStoredBindings.visible=null}else if(this._oStoredBindings.visible===undefined){this._oStoredBindings.visible=e}return{path:function(){var i=[],r,n=0;if(!t.property||!t.property.property){return[""]}r=p._oAnnotation.getUIHiddenPath(t.property.property);if(!r){r=p._oAnnotation.getFieldControlPath(t.property.property)}if(r){i.push(p._toPath(t,r));s=n;n++}if(e){a=n;p._oBinding.getBindingParts(e,i,d);n=n+d.length}if(n>0){return i}return[""]},formatter:function l(f,h){if(p._bIsDestroyed){return false}if(!p._oAnnotation){return false}var u=this||p._oParent;var _=t.property&&t.property.property;if(_&&p._oAnnotation.getVisible(_)==="false"||p._oAnnotation.getUIHiddenPath(_)&&f===true){return false}var g=[];if(s>-1){g.push(arguments[s]!==0);u._fieldControlValue=f}if(a>-1){if(e.formatter){g.push(p._execFormatter(e.formatter,arguments,a,d.length))}else{g.push(!!arguments[a])}}if(g.length==0){var y=u&&u.getBinding(n),b=u&&u.getBindingPath(n),c=b==="",m=!!y&&y.isInitial(),P=f==null,S;if(m&&P&&c){S=o}else if(!m&&P){S=true}else if(!m&&!P&&c&&!r(f)){S=f}else{S=p._oParent["get"+i(n)]()}g.push(S)}return p._compare(g,false,true)}}};n.prototype._getMandatory=function(t,e){var i=-1,r=-1,n=this;var o={length:0};this._bMandatorySet=true;if(!e){this._oStoredProperties.mandatory=this._oParent.getMandatory();this._oStoredBindings.mandatory=null}else if(this._oStoredBindings.mandatory===undefined){this._oStoredBindings.mandatory=e}return{path:function(){var a=[],s,p=0;if(!t.property||!t.property.property){return[""]}s=n._oAnnotation.getFieldControlPath(t.property.property);if(s){a.push(n._toPath(t,s));r=p;p++}if(e){i=p;n._oBinding.getBindingParts(e,a,o);p=p+o.length}if(p>0){return a}return[""]},formatter:function a(s,p){if(n._bIsDestroyed){return true}var d=t.property&&t.property.property,l=[];if(d){if(d.nullable==="false"||n._oAnnotation&&n._oAnnotation.isStaticMandatory(d)){l.push(true)}else if(d.nullable){l.push(false)}}var f=r>-1;if(f){l.push(arguments[r]===7)}var h=i>-1;if(h){if(e.formatter){l.push(n._execFormatter(e.formatter,arguments,i,o.length))}else{l.push(!!arguments[i])}}if(l.length===0||d.nullable==="true"&&!f&&!h){l.push(n._oParent.getMandatory())}return n._compare(l,true,false)}}};n.prototype._toPath=function(t,e){if(t.property.complex){return t.path.replace(t.property.property.name,e)}if(t.navigationPath){return t.navigationPath+"/"+e}return e};n.prototype.getMandatoryCheck=function(t){if(t){switch(t.property.type){case"Edm.DateTimeOffset":case"Edm.DateTime":case"Edm.Time":case"Edm.String":case"Edm.Decimal":case"Edm.Double":case"Edm.Float":case"Edm.Single":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":case"Edm.SByte":case"Edm.Guid":return function(i,r){var n=i===""||i==null;if(n){var o=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("VALUEHELPVALDLG_FIELDMESSAGE");if(this._oAnnotation&&!this._oAnnotation.isNullable(t.property)&&(this._oParent.getClientSideMandatoryCheck()||t.property.type!=="Edm.String")){throw new e(o)}if(this._oParent.getClientSideMandatoryCheck()&&this._oParent.getMandatory()){throw new e(o)}}}.bind(this)}}};n.prototype.getUOMEditState=function(t){var e,i,r,n=0,o;o=this._oParent.getBindingInfo("editable");e=this._getEditable(t,o);r={model:t.model,path:this._oHelper.getUOMPath(t),entitySet:t.entitySet,entityType:t.entityType,property:{property:t.annotations.uom.property,complex:t.property.complex,typePath:this._oHelper.getUOMTypePath(t)}};i=this._getEditable(r,this._oParent.getBindingInfo("uomEditable"),"uomEditable");return{path:function(){var t=e.path(),r=i.path();if(t[0]===""&&r===""){return[""]}n=t.length;return t.concat(r)},formatter:function t(r,o,a,s){var p=[],d,l,f,h=arguments.length;for(d=0;d<n;d++){p.push(arguments[d])}l=e.formatter.apply(null,p);p=[];for(d=0;d<h;d++){p.push(arguments[d])}for(d=0;d<n;d++){p.shift()}f=i.formatter.apply(null,p);if(!f&&!l){return 0}return 1}}};n.prototype.hasUomEditState=function(t){var e;if(t&&t.annotations&&t.annotations.uom){e=this._oParent.getControlProposal();if(e){if(e.getControlType()==="ObjectNumber"){return true}if(e.getObjectStatus()){return true}}return this._oParent.getProposedControl()==="ObjectNumber"}return false};n.prototype.bindProperties=function(t){var e={propertiesNames:this.getPropertyNames()};t=Object.assign(e,t);var i=t.propertiesNames,r=t.metadata;if(i.length){var n=this.getControlFormatters(r,i);for(var o in n){var a=this._oBinding.fromFormatter(r.model,n[o]);this._oParent.bindProperty(o,a)}}};n.prototype.destroy=function(){if(this._oBinding){this._oBinding.destroy();this._oBinding=null}this._oAnnotation=null;var t=this._oParent;if(t&&!t._bInDestroy){var e=true;for(var r in this._oStoredProperties){t.unbindProperty(r,e);var n="set"+i(r),o=t[n];if(typeof o==="function"){o.call(t,this._oStoredProperties[r])}}if(this._oStoredProperties){if(!this._oStoredProperties.editable&&this._bEditableSet){t.unbindProperty("editable")}if(!this._oStoredProperties.visible&&this._bVisibleSet){t.unbindProperty("visible")}if(!this._oStoredProperties.mandatory&&this._bMandatorySet){t.unbindProperty("mandatory")}if(!this._oStoredProperties.uomEditable&&this._bUomEditableSet){t.unbindProperty("uomEditable")}}if(this._oStoredBindings){if(this._oStoredBindings.editable){t.bindProperty("editable",this._oStoredBindings.editable)}if(this._oStoredBindings.visible){t.bindProperty("visible",this._oStoredBindings.visible)}if(this._oStoredBindings.mandatory){t.bindProperty("mandatory",this._oStoredBindings.mandatory)}if(this._oStoredBindings.uomEditable){t.bindProperty("uomEditable",this._oStoredBindings.uomEditable)}}}this._oStoredProperties=null;this._oStoredBindings=null;this._oParent=null;this._oHelper=null;this._bIsDestroyed=true;this._bEditableSet=false;this._bMandatorySet=false;this._bVisibleSet=false;this._bUomEditableSet=false};return n},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/JSONControlFactory", ["sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/Input","sap/m/Text","sap/ui/comp/smartfield/ControlFactoryBase","sap/ui/comp/smartfield/JSONTypes"],function(e,t,r,a,o,n,i){"use strict";var s=n.extend("sap.ui.comp.smartfield.JSONControlFactory",{constructor:function(e,t,r){n.apply(this,[e,t]);this.sName="JSONControlFactory";this._oMetaData=r;this._oTypes=new i}});s.prototype._getCreator=function(){var e={Boolean:"_createBoolean",Date:"_createDate",DateTime:"_createString",Float:"_createString",Integer:"_createString",String:"_createString"};if(!this._oParent.getEditable()||!this._oParent.getEnabled()){if(this._oParent.getJsontype()==="Boolean"){return"_createBoolean"}return"_createDisplay"}return e[this._oParent.getJsontype()]||"_createString"};s.prototype._createString=function(){var e,t,r={width:true,textAlign:true,placeholder:true,name:true,maxLength:true};e=!this._oParent.getShowValueHelp();t=!this._oParent.getShowSuggestion();if(e){if(this._oParent.data("controlType")==="dropDownList"){return this._createComboBox({annotation:null,noDialog:e,noTypeAhead:true})}}return{control:new a(this.createAttributes("value",this._oParent.getJsontype(),r,{event:"change",parameter:"value"})),onCreate:"_onCreate",noDialog:e,noTypeAhead:t,params:{getValue:"getValue"}}};s.prototype._createComboBox=function(e){var r={width:true,textAlign:true,placeholder:true,name:true};return{control:new t(this.createAttributes("value",this._oParent.getJsontype(),r,{event:"selectionChange",parameter:"selectedItem"})),onCreate:"_onCreate",params:{valuehelp:e,getValue:"getValue"}}};s.prototype._createBoolean=function(){var t=this.createAttributes("selected",this._oParent.getJsontype(),{},{event:"select",parameter:"selected"});t.enabled=this._oParent.getEditable()&&this._oParent.getEnabled();return{control:new e(t),onCreate:"_onCreate",params:{getValue:"getSelected"}}};s.prototype._createDate=function(){var e={width:true,textAlign:true,placeholder:true,name:true};return{control:new r(this.createAttributes("value",this._oParent.getJsontype(),e,{event:"change",parameter:"value"})),onCreate:"_onCreate",params:{getValue:"getValue"}}};s.prototype._createDisplay=function(){var e={width:true,textAlign:true};return{control:new o(this.createAttributes("text",this._oParent.getJsontype(),e))}};s.prototype._onCreate=function(e,t){var r;this.addValidations(e,"setSimpleClientError");if(t.getValue){r=t.getValue;t.getValue=function(){return e[r]()}}};s.prototype.destroy=function(){this._oTypes.destroy();this._oTypes=null;this._oMetaData=null;n.prototype.destroy.apply(this,[])};return s},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/JSONTypes", ["sap/ui/model/type/Boolean","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/type/String"],function(e,t,n,r,u){"use strict";var o=function(){};o.prototype.getType=function(o){if(o){switch(o){case"Boolean":return new e;case"Date":return new t;case"Float":return new n;case"Integer":return new r;default:return new u}}return null};o.prototype.destroy=function(){};return o},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataControlFactory", ["sap/ui/core/library","sap/m/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/ui/comp/smartfield/ComboBox","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/HBox","sap/m/Input","sap/m/Select","sap/m/Text","sap/m/ExpandableText","sap/ui/core/Configuration","sap/ui/core/Renderer","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","sap/ui/comp/odata/ODataModelUtilSync","./ODataTypes","./TextArrangementDelegate","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/TimePicker","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfield/Configuration","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/core/InvisibleText","sap/base/Log","sap/base/assert","sap/base/security/URLListValidator","sap/base/util/merge","sap/base/strings/capitalize","sap/base/util/deepClone","sap/base/strings/whitespaceReplacer","sap/m/FlexItemData"],function(t,e,a,o,i,r,n,s,l,p,u,h,d,c,g,m,y,_,f,M,v,D,C,P,T,b,x,S,I,V,F,A,E,O,B,L,U,w,N,H,k,R,j,W,z){"use strict";var q=t.ValueState;var G=t.TextAlign;var K=e.InputType;var $=e.EmptyIndicatorMode;var J=e.FlexJustifyContent;var Q=a.smartfield.CriticalityRepresentationType;var X=a.smartfield.ControlContextType;var Y=t.TextDirection;var Z=e.FlexAlignContent;var tt=a.smartfield.TextInEditModeSource;var et;var at=M.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(t,e,a){M.call(this,t,e);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=a;this._oHelper=new C(t,this._oBinding);this._oFieldControl=new v(e,this._oHelper);this._oTypes=new T(e);this._oSelector=new D(this._oMetaData,e,this._oTypes);this.oTextArrangementDelegate=new b(this);this._bInitialized=false;this.bPending=false;this.oMeasureField=null;et=sap.ui.require("sap/ui/comp/smartfield/SmartField");if(!et){throw new Error("SmartField module not loaded for "+this)}}});at.prototype._init=function(t){var e=t.entitySetObject||this._oHelper.oMeta.getODataEntitySet(t.entitySet),a=this._oMetaData.path===t.path&&this._oMetaData.entitySet&&this._oMetaData.entitySet.name===e.name&&this._oMetaData.model===t.model;if(a){return}this._oMetaData.model=t.model;this._oMetaData.path=t.path;this._oMetaData.entitySet=e;if(this._oHelper.oMeta){N(this._oMetaData.entitySet,'The entity set named "'+t.entitySet+'" was not found in the "'+this._oHelper.oMeta.getODataEntityContainer().name+'" entity container of the service metadata document. - '+this.getMetadata().getName())}this._oMetaData.entityType=t.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType);this._oMetaData.navigationPath=t.navigationPath||null;if(typeof t.ignoreInsertRestrictions==="boolean"){this._oMetaData.ignoreInsertRestrictions=t.ignoreInsertRestrictions}if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);var o=this.getEdmProperty();N(!!o,'The EDM property "'+t.path+'" was not found in the "'+this._oMetaData.entityType.namespace+"."+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(o){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData);this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=this._oHelper.getAnalyzer().getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=O.getSemanticObjectsFromProperty(o);this._oMetaData.annotations.semanticKeys=this._oHelper.getAnalyzer().getSemanticKeyAnnotation(this._oMetaData.entitySet.entityType);if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom)}this._oHelper.getUOMTextAnnotation(this._oMetaData);if(this._oParent&&this._oParent.getExpandNavigationProperties()){var i=this._oParent.getBindingContext(),r=i&&i.getObject(),n=r&&r.__metadata.created;if(!n){var s=this._oHelper.getAutoExpandProperties(o);if(s.length>0){this._oParent.bindElement({path:"",parameters:{expand:s,select:s}})}}}}}else{this._oMetaData.modelObject=t.modelObject;this._oMetaData.property=t.property;this._oMetaData.annotations.text=t.annotations.text;this._oMetaData.annotations.uom=t.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={}}if(t.annotations.valueListData){this._oMetaData.annotations.valuelist=t.annotations.valueListData}else{this._oMetaData.annotations.valuelist=t.annotations.valuelist}this._oMetaData.annotations.valuelistType=t.annotations.valuelistType;this._oMetaData.annotations.lineitem=t.annotations.lineitem;this._oMetaData.annotations.semantic=t.annotations.semantic;this._oMetaData.annotations.valuelistuom=t.annotations.valuelistuom}};at.prototype._initValueList=function(t){var e=this._oMetaData.property,a=t.primaryValueListAnnotation;this._oMetaData.annotations.valueListData=a;e.valueListAnnotation=a;e.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(a);e.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName);e.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName).entityType)};at.prototype._getTextArrangementType=function(){var t=null,e=b.getPaths("ValueList",this._oMetaData);if(e.keyField&&e.descriptionField){t=this._oTypes.getType(this._oMetaData.property,null,null,{composite:true,keyField:e.keyField,descriptionField:e.descriptionField,valueListNoValidation:this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation"});if(!(t.isA("sap.ui.comp.smartfield.type.TextArrangementString")||t.isA("sap.ui.comp.smartfield.type.TextArrangementGuid"))){t=null}}return t};at.prototype._createEdmDisplay=function(t){var e,a=t.mode,o,i,r,n,s,l,p=false,u="getText",h=this,d={width:true,textAlign:true},c=this.getEdmProperty(),_=this._oParent.data("configdata"),f=_&&_.isInnerControl!==true||this._oParent.isContextTable(),M=this._oSelector.checkComboBox({mode:a,configOnly:f}),v=this._oSelector.checkDatePicker()||(c?c.type.startsWith("Edm.Date"):false),D=c?c.type==="Edm.Time":false;if(c){r=this._oHelper.oAnnotation.getText(c)}if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink(v)}n=this.createAttributes(null,this._oMetaData.property,d);n.emptyIndicatorMode=$.Auto;this.oType=null;var C=c&&O.getTimezonePropertyPath(c)||false;if(c&&c.type==="Edm.DateTimeOffset"&&C){this.oType=this._getDateFormatType();var P=function(){if(!arguments[0]&&!(this.oType.oFormatOptions&&this.oType.oFormatOptions.showDate===false&&this.oType.oFormatOptions.showTime===false)){return""}return this.oType.formatValue(arguments,"string")};n.text={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,type:this.oType},{path:C,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,formatter:P.bind(this)}}else if(v||D){this.oType=this._getDateFormatType();n.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this.oType}}else{n.text={model:this._oMetaData.model,type:this.oType};if(this._bTextInDisplayModeValueList&&this._oMetaData.property&&this._oMetaData.property.valueListAnnotation){l={};if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){l.sDisplayFormat="UpperCase"}l.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";s=this.oTextArrangementDelegate.getBindingInfo(l);this.oType=s.type;n.text.parts=s.parts}if(!this.oType){this.oType=this._oTypes.getType(this._oMetaData.property);n.text.path=this._oHelper.getEdmDisplayPath(this._oMetaData)}n.text.type=this.oType}if(c){o=this._oHelper.oAnnotation.isMasked(c);if(o){n.text.formatter=T.maskValue}if(r){i=this._oSelector.useObjectIdentifier(v,o);if(i){delete n.width;delete n.textAlign;n.text={path:this._oMetaData.path};n.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){n.titleActive=true;n.titlePress=function(t){h._oParent.firePress(t)}}else if(this._oMetaData.annotations.semantic&&this._oMetaData.annotations.semantic.defaultSemanticObject){var b;var x;var I=this._oMetaData.annotations.semantic.additionalSemanticObjects.concat(this._oMetaData.annotations.semantic.defaultSemanticObject);F.getDistinctSemanticObjects().then(function(t){b=F.hasDistinctSemanticObject(I,t);if(b){var e=h._oParent.getBindingInfo("value");var a=e.parts[0].path;var o=h._oHelper.oAnnotation.getLabel(h._oMetaData.property.property);if(h._oMetaData.annotations.lineitem&&h._oMetaData.annotations.lineitem.labels&&h._oMetaData.annotations.lineitem.labels[a]){o=h._oMetaData.annotations.lineitem.labels[a]}x=new L({semanticObject:h._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:h._oMetaData.annotations.semantic.additionalSemanticObjects,semanticObjectLabel:o,fieldName:a,navigationTargetsObtained:function(t){var e=sap.ui.getCore().byId(t.getSource().getControl());var a=t.getParameters().mainNavigation;if(a){a.setDescription(e.getText())}t.getParameters().show(e.getTitle(),a,undefined,undefined)}})}});n.titleActive={path:"$sapuicompsmartfield_distinctSO>/distinctSemanticObjects",formatter:function(t){return F.hasDistinctSemanticObject(I,t)}};n.titlePress=function(t){if(b&&x){x.setControl(t.getSource(t.getParameter("domRef")));x.openPopover()}}}}else if(!(_&&_.isInnerControl===true)){n.text={};n.text.parts=[];n.text.parts.push(this._oMetaData.path);n.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));n.text.formatter=function(t,e){if(M.combobox){var a=h._formatDisplayBehaviour("defaultComboBoxReadOnlyDisplayBehaviour",t,e),o=a(t,e);return W(o)}if(h.oType&&!h._bTextInDisplayModeValueList){t=h.oType.formatValue(t,"string")}if(h.oType&&h.oType.isA("sap.ui.comp.odata.type.NumericText")&&t===null&&e){t=""}return h._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",t,e)}}}else if(this._oSelector.checkCheckBox()){n.text.formatter=function(t){return h._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}}}if(i){e=new S(this._oParent.getId()+"-objIdentifier",n);if(this._oMetaData.annotations.semantic){e.setModel(F.getJSONModel(),"$sapuicompsmartfield_distinctSO")}}else{if(n.text.type&&n.text.type.isA("sap.ui.comp.smartfield.type.DateTime")&&n.text.type.oConstraints&&n.text.type.oConstraints.isDateOnly){n.wrapping=false}if(this._oParent.isContextTable()&&y.getRTL()){n.textDirection="LTR"}if(typeof n.text.formatter==="undefined"&&!C){n.text.formatter=function(t){return W(t)}}if(this._oHelper.oAnnotation.isMultiLineText(c)){delete n.width;e=new m(this._oParent.getId()+"-expandableText",n)}else{e=new g(this._oParent.getId()+"-text",n)}p=this._oSelector._checkComboBox({mode:a,configOnly:f}).combobox&&(this._oParent.getFetchValueListReadOnly()||r===undefined);if(p){u=null}}if(i&&_&&_.configdata&&_.configdata.onText){delete _.configdata.onText}var V={control:e,onCreate:"_onCreate",params:{getValue:u,noValidations:true,type:null}};if(this.oType){V.type={type:this.oType,property:this._oMetaData.property}}return V};at.prototype._getDateFormatType=function(){var t=this.getFormatSettings("dateFormatSettings"),e=this.getEdmProperty(),a;try{a=j(t)}catch(e){a=t}if(a&&e&&e.type==="Edm.DateTimeOffset"){a.UTC=false}return this._oTypes.getType(this._oMetaData.property,a)};at.prototype._createEdmTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e={width:true,placeholder:true,valueState:true,valueStateText:true};var a=at.getBoundPropertiesMapInfoForControl(V.getMetadata().getName(),{propertyName:"value"})[0];var o={valueFormat:"HH:mm:ss"};o=Object.assign(o,this.createAttributes(a,this._oMetaData.property,e,{event:"change",parameter:"value"}));if(o.width===""){o.width="100%"}if(t){o[a].type=this._oTypes.getType(this._oMetaData.property,t)}var i=new V(this._oParent.getId()+"-timePicker",o);this._enhanceInputControls(i);return{control:i,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:o.value.type,property:this._oMetaData.property}}}};at.prototype._createObjectStatus=function(){var t=this.createAttributes(null,this._oMetaData.property,null),e=this._oHelper.oAnnotation.getText(this.getEdmProperty());var a=at.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];if(e){t[a]={parts:[this._oHelper.getEdmDisplayPath(this._oMetaData)]}}else{t[a]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)}}this._addObjectStatusAttributes(t);var o=new I(this._oParent.getId()+"-objStatus",t);return{control:o,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}}};at.prototype._addObjectStatusAttributes=function(t){var e,a=this._oParent.getControlProposal(),o=a.getObjectStatus();if(o){e=o.getBindingInfo("criticality")}var i=function(t){var e={0:q.None,1:q.Error,2:q.Warning,3:q.Success};var a={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":q.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":q.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":q.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":q.Success};return a[t]||e[t]||q.None};var r=function(){var t={};t[q.Error]="sap-icon://error";t[q.Warning]="sap-icon://alert";t[q.Success]="sap-icon://sys-enter-2";t[q.None]=null;var a;if(e){if(e.formatter){a=e.formatter.apply(null,arguments)}else{a=arguments[0]}}else{a=o.getCriticality()}if(a===undefined||a===null){return null}return t[i(a)]};var n=function(){if(!o){return false}return o.getCriticalityRepresentationType()!==Q.WithoutIcon};if(e){t.state={formatter:function(){var t;if(e.formatter){t=e.formatter.apply(null,arguments)}else{t=arguments[0]}return i(t)},parts:e.parts};if(n()){t.icon={formatter:r,parts:e.parts}}}else{if(o){t.state=i(o.getCriticality())}if(n()){t.icon=r()}}};at.prototype._createInput=function(t){var e=new d(this._oParent.getId()+"-input",t);this._enhanceInputControls(e);return e};at.prototype._enhanceInputControls=function(t){if(t.isA("sap.m.InputBase")&&typeof t._setPreferUserInteraction==="function"){t._setPreferUserInteraction(true)}};at.prototype._createEdmString=function(t){var e={},a=t.mode;if(this._oSelector.checkCheckBox()){return this._createCheckBox()}var o=this._oSelector.checkSelection();if(o.selection){return this._createSelect({valueHelp:at.getValueHelpDropdownSettings(o)})}o=this._oSelector.checkComboBox(t);if(o.combobox){return this._createComboBox({valueHelp:at.getValueHelpDropdownSettings(o),edit:true})}var i={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var r=this.getEdmProperty();if(this._oHelper.oAnnotation.isMultiLineText(r)){delete i["width"];return this._createMultiLineText({attributesNamesMap:i})}var n=this._oParent.isTextInEditModeSourceNotNone(),s=/Edm.String|Edm.Guid/.test(r.type);if(n||this._bTextInDisplayModeValueList){N(s,"The ValueList and NavigationProperty"+"members of the sap.ui.comp.smartfield.TextInEditModeSource enumeration are only supported for OData "+"EDM Properties typed as Edm.String or Edm.Guid. - "+this.getMetadata().getName())}var l=at.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var p=this._oParent._getComputedTextInEditModeSource(),u,h,c;if(this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource")&&a==="edit"){u=true}if(s){this.oTextArrangementDelegate.bValidMetadata=this.oTextArrangementDelegate.checkRequiredMetadata(p,u);h=this._oHelper.checkValueListRequiredMetadataForValidation(this._oMetaData.property)}if(this.oTextArrangementDelegate.bValidMetadata){c=this.createAttributes("",this._oMetaData.property,i);e.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";c[l]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(p===tt.ValueList&&h&&a==="edit"){c=this.createAttributes(l,this._oMetaData.property,i);c[l]=this.oTextArrangementDelegate.getBindingInfo(e)}else{c=this.createAttributes(l,this._oMetaData.property,i)}if(B.isFiscalValue(r)){c.placeholder=c.value.type.formatter.getPattern();return{control:this._createInput(c),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:c.value.type,property:this._oMetaData.property}}}}var g=this._createInput(c);if(this._oHelper.oAnnotation.isMasked(r)){g.setType(K.Password)}var m=this.getCustomDataConfiguration();if(this.oTextArrangementDelegate.bValidMetadata){this._handleEventingForTextArrangement({control:g})}else{this._handleEventingForEdmString({control:g,edmProperty:this._oMetaData.property.property,currency:m&&m.currency})}return{control:g,onCreate:"_onCreate",params:{valuehelp:{annotation:o.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:c.value.type,property:this._oMetaData.property}}}};at.getValueHelpDropdownSettings=function(t){return{annotation:t.annotation,noDialog:true,noTypeAhead:true}};at.prototype._getMaxLength=function(){return this._oTypes.getMaxLength(this._oMetaData.property,this._oParent.getBindingInfo("value"))};at.prototype._addAriaLabelledBy=function(t){var e,a,o,i=this._oParent.getControlContext();if(i===X.None||i===X.Form||i===X.SmartFormGrid){M.prototype._addAriaLabelledBy.apply(this,arguments);o=this._oParent.data("configdata");if(o&&o.configdata.isInnerControl&&o.configdata.isUOM){if(t){a=t.control;if(a instanceof h){if(a.getItems().length>0){a=a.getItems()[0]}}}if(a&&a.getAriaLabelledBy&&a.getAriaLabelledBy().length===0){var r=this.getEdmProperty();if(this._oHelper.oAnnotation.getLabel(r)){e=new U({text:this._oHelper.oAnnotation.getLabel(r)});a.addAriaLabelledBy(e);this._oParent.addAggregation("_ariaLabelInvisibleText",e)}}}}};at.prototype._addAriaDescribedBy=function(){var t=this._oParent.getControlContext();if(t===X.None||t===X.Form||t===X.SmartFormGrid){M.prototype._addAriaDescribedBy.apply(this,arguments)}};at.prototype._handleEventingForEdmString=function(t){var e=t.control;if(!e){return}e.attachChange(function a(o){var i=this._getChangeEventParams(o),r=o&&o.getParameters(),n=o&&o.getSource();if(r){var s=r.value;i.value=s;i.newValue=s;if(e._oSuggestionPopup&&e._oSuggestionPopup.isOpen()){if(!r.validated){return}}if(t.currency){var l=this.getCurrencyValidationSettings();l.oSource=n;if(this._oHelper.oAnnotation.isUpperCase(t.edmProperty)&&s){s=s.toUpperCase();e.setValue(s)}}try{this._oParent.fireChange(i)}catch(t){w.error(t)}}}.bind(this))};at.prototype._handleEventingForTextArrangement=function(t){var e=t.control;if(!e){return}e.attachChange(function(t){var a=this._getChangeEventParams(t),o=e.getShowSuggestion(),i=o&&e._oSuggPopover.isOpen();if(!a.validated&&o&&i){return}try{var r=this._oParent.data("configdata");if(r&&r.configdata&&this._oParent.isTextInEditModeSourceNotNone()){this._oParent.checkValuesValidity().then(function(){this._oParent.fireChange(a)}.bind(this))}else{this._oParent.fireChange(a)}}catch(t){w.error(t)}}.bind(this))};at.prototype.getUOMChangeHandler=function(t){return function(e){try{var a=t.smartFieldRootControl,o=e.getParameters(),i=o.value,r=e.getSource(),n=t.currency,s=n?this.getCurrencyValidationSettings(t):this.getUnitValidationSettings(t);s.oSource=r;n?this.updateModelPropertiesForCurrency("value",s):this.updateModelPropertiesForUnit("value",s);a.fireChange({value:i,newValue:i,unitChanged:!!t.unit,validated:!!o.validated})}catch(e){if(e.validationUnitError){a.fireChange({value:i,newValue:i,unitChanged:!!t.unit,validated:!!o.validated})}w.error(e)}}.bind(this)};at.prototype.getCurrencyValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var o=e.getInnerControls();return{amountField:o[0],currencyField:o[1],errorState:e._oError,checkValidity:e.checkValuesValidity.bind(e),rootControl:e}};at.prototype.getUnitValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var o=e.getInnerControls();return{measureField:o[0],unitField:o[1],errorState:e._oError,checkValidity:e.checkUnitValidity.bind(e),rootControl:e}};at.prototype.updateModelPropertiesForCurrency=function(t,e){var a=e.amountField,i=e.currencyField,r=e.oSource,n=a.getValue(),s,l="";if(i){var p=i.getMetadata().getName();s=at.getBoundPropertiesMapInfoForControl(p,{propertyName:t})[0];var u="get"+R(s);l=i[u]()}var h=[n,l];var d={rawValues:h,handleSuccess:false};var c=e.checkValidity(d);function g(e){var l=a.getModel(),p=a.getBinding(t),u,d;if(i){u=i.getBinding(s);d=u.getType()}var c=p.getType(),g=p.getExternalValue(),m=u&&u.getExternalValue(),y=c.parseValue(n,"string",h),_=y[1],f=c.formatValue(y,"string"),M=d&&d.formatValue(_,"string");if(l.getDefaultBindingMode()===o.TwoWay){if(!e){p.setValue(y)}}if(!e){a.setValue(f)}var v=false,D=true;if(p.hasValidation()&&!e){var C={element:a,property:t,type:c,newValue:f,oldValue:g,mParameters:{originSource:r}};a.fireValidationSuccess(C,v,D)}if(u&&u.hasValidation()){var P={element:i,property:s,type:d,newValue:M,oldValue:m,mParameters:{originSource:r}};i.fireValidationSuccess(P,v,D)}}function m(t){}function y(){var o=e.errorState;if(o.bComplex&&o.bFirst&&o.bSecond){var r=a.getBinding(t).getExternalValue();h=[r,l];var n={rawValues:h,innerControls:[i],handleSuccess:false};var s=e.checkValidity(n);s.then(function(){return g.call(this,true)}.bind(this)).catch(m)}}c.then(function(){return g()}).catch(m).finally(y)};at.prototype.updateModelPropertiesForUnit=function(t,e){var a=e.measureField,i=e.unitField,r=a.getValue(),n,s="";if(i){var l=i.getMetadata().getName();n=at.getBoundPropertiesMapInfoForControl(l,{propertyName:t})[0];var p="get"+R(n),u=i.getParent();if(i.isA("sap.m.ComboBox")){s=i.getSelectedKey()}else if(this._getDisplayBehaviourConfiguration()&&u&&(!u.getEditable()||u._oFactory._getTextArrangementType())){s=u.getBinding("value").getValue()}else{s=i[p]()}}else if(this._checkSuppressUnit()){var h=this.getMetaData().annotations.uom.path,d=a.getBindingContext();s=this._oModel.getData(h,d)}var c=[r,s];var g={rawValues:c,handleSuccess:false};var m=e.checkValidity(g);if(m){var y=a.getModel(),_=a.getBinding(t),f,M;if(i){f=i.getBinding(n);M=f.getType()}var v=_.getType(),D=v.parseValue(r,"string",c),C=D[1],P,T;if(C===undefined&&i&&!i.getEditable){P=v.formatValue([D[0],null],"string");T=C}else{P=v.formatValue(D,"string");if(!_.isA("sap.ui.comp.smartfield.type.Unit")){C=s}T=M&&M.formatValue(C,"string")}if(y.getDefaultBindingMode()===o.TwoWay){_.setValue(D)}a.setValue(P);if(i&&i.getEditable&&i.getEditable()&&i.getParent().getVisible()&&!i.isA("sap.m.ComboBox")){i.setValue(T)}}};at.prototype._createComboBox=function(t){var e=null,a=this._oSelector&&this._oSelector._oParent&&this._oSelector._oParent.oParent&&this._oSelector._oParent.oParent.isA("sap.ui.comp.smartmultiedit.Field")||this._oParent&&this._oParent.getFixedValueListValidationEnabled&&this._oParent.getFixedValueListValidationEnabled(),o=a?s:l,i=this._oParent._getComputedTextInEditModeSource(),r=i==="ValueList"?"realValue":"value",n=a?"value":r,p={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true},u,h={};u=at.getBoundPropertiesMapInfoForControl(o.getMetadata().getName(),{propertyName:n})[0];h["change"]=this._oHelper.getDropdownChangeHandler(this._oParent,!a);h=Object.assign(h,this.createAttributes(u,this._oMetaData.property,p));if(h.width===""){h.width="100%"}if(t.edit){if(a){e=new s(this._oParent.getId()+"-comboBoxEdit",h)}else{e=new l(this._oParent.getId()+"-comboBoxEdit",h)}this._enhanceInputControls(e);e.attachChange(function(){this._oParent.oValidation.handleComboValidation(e)}.bind(this))}else{e=this._createDisplayedComboBox(h)}this._oParent.oValidation.addValidationToType(h[u].type);return{control:e,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"get"+u[0].toUpperCase()+u.slice(1),type:{type:h[u].type,property:this._oMetaData.property}}}};at.prototype._createDisplayedComboBox=function(t){var e=s.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp",properties:{wrapping:{type:"boolean",group:"Appearance",defaultValue:true}}},renderer:{apiVersion:2,render:function(t,e){var a=e.getWidth(),o=e.getValue(),i=e.getTextDirection(),r=e.getTextAlign(),n=e.getTooltip_AsString(),s=e.getWrapping();t.openStart("span",e);t.class("sapMText");t.class("sapUiSelectable");if(s){if(o&&o.length>0&&!/\s/.test(o)){t.class("sapMTextBreakWord")}}else{t.class("sapMTextNoWrap")}if(a&&o!==""){t.style("width",a)}else{t.class("sapMTextMaxWidth")}if(i!==Y.Inherit){t.attr("dir",i.toLowerCase())}if(n){t.attr("title",n)}if(r){r=_.getTextAlign(r,i);if(r){t.style("text-align",r)}}var l=s?"sapMTextRenderWhitespaceWrap":"sapMTextRenderWhitespace";t.class(l);t.openEnd();o.replace(/\r\n|\n\r|\r/g,"\n");t.text(o);t.close("span")}},updateDomValue:function(t){if(!this.isActive()){return this}t=this._getInputValue(t);if(this.$().text()!==t){this.$().text(t);this._bCheckDomValue=true}return this},getValue:function(){return this.getProperty("value")},getFocusDomRef:function(){return this.getDomRef()},getEditable:function(){return false}});return new e(this._oParent.getId()+"-comboBoxDisp",t)};at.prototype._createSelect=function(t){var e={width:true,name:true,valueState:true},a;var o=at.getBoundPropertiesMapInfoForControl(c.getMetadata().getName(),{propertyName:"value"})[0];var i={change:this._oHelper.getDropdownChangeHandler(this._oParent),forceSelection:false};i=Object.assign(i,this.createAttributes(o,this._oMetaData.property,e));if(i.width===""){i.width="100%"}a=new c(this._oParent.getId()+"-select",i);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:i.selectedKey.type,property:this._oMetaData.property}}}};at.prototype._createCheckBox=function(){var t=at.getBoundPropertiesMapInfoForControl(n.getMetadata().getName(),{propertyName:"value"})[0];var e=this.createAttributes(t,null,{},{event:"select",parameter:"selected"});e.editable=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable();e.selected.type=this._oTypes.getAbapBoolean();return{control:new n(this._oParent.getId()+"-cBox",e),onCreate:"_onCreate",params:{getValue:"getSelected"}}};at.prototype._createEdmDateTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e,a,o;var i={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var r=this.createAttributes(null,this._oMetaData.property,i,{event:"change",parameter:"value"});if(this._oSelector.checkDatePicker()){e=at.getBoundPropertiesMapInfoForControl(p.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t,{displayFormat:"Date"}),model:this._oMetaData.model,mode:this._oParent.getBindingMode("value")};if(t&&t.style){r.displayFormat=t.style}o=new p(this._oParent.getId()+"-datePicker",r);this._enhanceInputControls(o);return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}}e=at.getBoundPropertiesMapInfoForControl(u.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")};a=new u(this._oParent.getId()+"-input",r);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}};at.prototype._createEdmDateTimeOffset=function(){var t,e=this.getFormatSettings("dateFormatSettings"),a=this.getEdmProperty(),o;try{t=j(e)}catch(a){t=e}if(t){t.UTC=false}var i=at.getBoundPropertiesMapInfoForControl(u.getMetadata().getName(),{propertyName:"value"})[0];var r={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var n=this.createAttributes(null,this._oMetaData.property,r,{event:"change",parameter:"value"});var s=a&&O.getTimezonePropertyPath(a)||false;if(s){if(e&&e.showTimezone===false){n.showTimezone=false}else{n.showTimezone=true}if(t&&t.style){n.displayFormat=t.style}if(t&&t.pattern){n.displayFormat=t.pattern}this.oType=this._oTypes.getType(this._oMetaData.property,t);n[i]={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,parameters:{useUndefinedForUnresolved:true},type:this.oType},{path:s,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,mode:this._oParent.getBindingMode("value")}}else{n[i]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")}}o=new u(this._oParent.getId()+"-input",n);this._enhanceInputControls(o);return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:n.value.type,property:this._oMetaData.property}}}};at.prototype._createEdmNumeric=function(t){var e=this._oSelector.checkComboBox(t),a=t?t.mode:undefined,o;if(e.combobox){return this._createComboBox({valueHelp:{annotation:e.annotation,noDialog:true,noTypeAhead:true},edit:true})}var i={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var r=at.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var n=this.createAttributes(r,this._oMetaData.property,i,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&y.getRTL()){n.textDirection="LTR"}o=this._createInput(n);if(a==="edit"&&this._oParent.isFormContextType()){o.setTextAlign(G.End)}return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:n.value.type,property:this._oMetaData.property}}}};at.prototype._createEdmUOM=function(t){var e=t.mode,a=this._oParent.getEntitySet(),o=at.getBoundPropertiesMapInfoForControl(et.getMetadata().getName(),{propertyName:"value"})[0],i=this._getPropertyBindingMode(o),r=this.getEdmProperty(),n=this._oMetaData.annotations.uom.property.property,s=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(r,n);var l={currency:s,edmProperty:n,bindingMode:i};var p=this._createEdmUOMAttributes(l),u=y.getRTL(),d=u&&this._oParent.isContextTable(),c=this._oParent.getId(),g;if(d){p.textDirection="LTR"}var m=this._createInput(p);this.oMeasureField=m;if(e==="edit"&&this._oParent.isFormContextType()){m.setTextAlign(G.End)}if(this._oParent.data("suppressUnit")==="true"){var _={getValue:"getValue"};if(!s){_.type={type:p.value.type,property:this._oMetaData.property}}return{control:m,onCreate:"_onCreate",params:_}}if(!s){g={type:p.value.type,property:this._oMetaData.property}}var f={textAlign:this._getEdmUOMTextAlignment()};if(i==="TwoWay"){f.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:s,unit:true})}var M=this._oHelper.getUOMPath(this._oMetaData);f[o]={model:this._oMetaData.model,path:M,mode:i};this.mapBindings(f,at._getEmbeddedSmartFieldMapSettings(),t);if(this._oParent.getConfiguration()){f.configuration=new E({preventInitialDataFetchInValueHelpDialog:this._getPreventInitialDataFetchInVHDialog()})}if(a){f.entitySet=a}var v=new et(c+"-sfEdit",f),D=this;v.data("configdata",{configdata:{currency:s,smartFieldRootControl:this._oParent,measureField:this.oMeasureField,isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:M,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){D._updateStaticAmountInputFlexItemData(m);D._updateStaticUOMTextFlexItemData(v);D._updateInnerControl(t,{RTLInTable:d})},onInput:function(t){var e=v&&!v.getVisible();D._updateDynamicAmountInputFlexItemData(m,{isfullWidth:e});D._updateStaticUOMInputFlexItemData(v);D._updateInnerControl(t,{RTLInTable:d})}}});v.data("errorCheck","setComplexClientErrorSecondOperandNested");if(v.getVisible()){m.addStyleClass("smartFieldPaddingRight")}m.addStyleClass("sapUiCompSmartFieldValue");var C=new h({justifyContent:J.End,items:[m,v],fitContainer:true,width:this._oParent.getWidth()});C.addStyleClass("sapUiCompUOM");C.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){if(d){C.addStyleClass("sapUiCompDirectionLTR")}C.addStyleClass("sapUiCompUOMInTable");if(e!=="edit"){C.addStyleClass("sapUiCompUOMInTableDisplay")}}return{control:C,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:g}}};at.prototype._createEdmUOMAttributes=function(t){t=t||{};var e=this.createUOMDefaultAttributes(t);var a=at.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var i=t.bindingMode||"TwoWay";var r=t.currency||this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property);e[a]={mode:o.OneWay,model:this._oMetaData.model,parts:[{mode:i,path:this._oMetaData.path},{mode:i,path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:r?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],type:r?this._oTypes.getCurrencyType(this._oMetaData.property):this._oTypes.getUoMType(this._oMetaData.property)};return e};at.prototype.createUOMDefaultAttributes=function(t){return{textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),valueState:this.getValueStateBindingInfoForRecommendationStateAnnotation(),change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:t.currency})}};at.prototype._getEdmUOMTextAlignment=function(){var t=this.getAttribute("textAlign");if(!t){t=G.Initial}if(t===G.Initial){if(this._oParent.isContextTable()){return G.End}return G.Begin}return t};at.prototype._createEdmUOMDisplay=function(t){var e=this,a=this._oParent.getEntitySet(),o=this._oHelper.getUOMPath(this._oMetaData),i=this._getEdmUOMTextAlignment(),r=null,n=this.getEdmProperty(),s=y.getRTL(),l=s&&this._oParent.isContextTable(),p=this._oHelper.oAnnotation.isCurrency(n),u=at.getBoundPropertiesMapInfoForControl(et.getMetadata().getName(),{propertyName:"value"})[0],d=this._getPropertyBindingMode(u)||"TwoWay";var c=at.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var m={textAlign:i};m[c]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:o},{mode:"OneTime",path:p?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(n,{currency:p,mask:this._oHelper.oAnnotation.isMasked(n),type:this._oTypes.getType(this._oMetaData.property)}),useRawValues:true};if(l){m.textDirection="LTR"}var _=new g(this._oParent.getId()+"-text",m);o=this._oHelper.getUOMPath(this._oMetaData);m={textAlign:this._getEdmUOMTextAlignment()};if(d==="TwoWay"){m.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:p,unit:true})}c=at.getBoundPropertiesMapInfoForControl(et.getMetadata().getName(),{propertyName:"value"})[0];m[c]={model:this._oMetaData.model,path:o,mode:this._getPropertyBindingMode(c)};this.mapBindings(m,at._getEmbeddedSmartFieldMapSettings(),t);_.addStyleClass("smartFieldPaddingRight");_.addStyleClass("sapUiCompSmartFieldValue");if(this._checkSuppressUnit()){return{control:_}}if(a){m.entitySet=a}r=new et(this._oParent.getId()+"-sfDisp",m);r.data("configdata",{configdata:{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:o,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){if(t&&t.setWrapping){t.setWrapping(false)}e._updateInnerControl(t,{RTLInTable:l})},onInput:function(t){e._updateInnerControl(t,{RTLInTable:l})},getContextEditable:function(){return e._oParent.getContextEditable()}}});r.data("errorCheck","setComplexClientErrorSecondOperandNested");var f=new h({alignItems:Z.Center,items:[_,r],fitContainer:true,width:this._oParent.getWidth()});f.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){f.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(l){f.addStyleClass("sapUiCompDirectionLTR")}f.addStyleClass("sapUiCompUOMInTable")}return{control:f}};at.prototype._createEdmUOMObjectStatus=function(){var t,e=this.getEdmProperty(),a=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(e),o=this._oTypes.getDisplayFormatter(e,{currency:a}),i=this._oHelper.getUOMPath(this._oMetaData),r={};var n=at.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];r[n]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:i},{mode:"OneTime",path:a?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:function(){var t=o.apply(this,arguments);return t+arguments[1]},useRawValues:true};this._addObjectStatusAttributes(r);t=new I(this._oParent.getId()+"-objStatus",r);t.addStyleClass("sapUiCompUOM");return{control:t}};at.prototype._createEdmUOMObjectNumber=function(){var t,e,a=this._getEdmUOMTextAlignment();var o=at.getBoundPropertiesMapInfoForControl(x.getMetadata().getName(),{propertyName:"value"});if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property)){t={model:this._oMetaData.model,textAlign:a};t[o[0]]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:"/##@@requestCurrencyCodes",targetType:"any"}],type:this._oTypes.getCurrencyType(this._oMetaData.property)};t[o[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}else{t={model:this._oMetaData.model,textAlign:a};t[o[0]]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};t[o[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}e=new x(this._oParent.getId()+"-objNumber",t);e.addStyleClass("sapUiCompUOM");return{control:e}};at.prototype._createEdmSemantic=function(){var t=this,e=this._oParent.getBindingPath("value"),a=this.getEdmProperty(),o=this._oHelper.oAnnotation.getLabel(a);if(this._oMetaData.annotations.lineitem&&this._oMetaData.annotations.lineitem.labels&&this._oMetaData.annotations.lineitem.labels[e]){o=this._oMetaData.annotations.lineitem.labels[e]}var i={semanticObject:this._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:this._oMetaData.annotations.semantic.additionalSemanticObjects,semanticObjectLabel:o,fieldName:e,width:this.getAttribute("width"),createControlCallback:function(){var t=this.createControl(true);if(t){return t.control}return null}.bind(this)};var r=this._oHelper.oAnnotation.getText(a);this.oType=this._oTypes.getType(this._oMetaData.property);if(r){i.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(e,a){if(t.oType){e=t.oType.formatValue(e,"string")}if(t.oType&&t.oType.isA("sap.ui.comp.odata.type.NumericText")&&e===null&&a){e=""}if(e&&a){return t._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",e,a)}return e?e:""}};i.navigationTargetsObtained=function(e){var a=this.getBinding("text");if(!Array.isArray(a.getValue())){e.getParameters().show();return}var o=a.getValue();var i=t._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")||"idOnly";var r=A.getTextsFromDisplayBehaviour(i,o[0],o[1]);var n=e.getParameters().mainNavigation;if(n){n.setDescription(r.secondText)}e.getParameters().show(r.firstText,n,undefined,undefined)}}else{var n=this._oHelper.getUOMPath(this._oMetaData);if(n){i.text={parts:[{path:e},{path:n}],model:this._oMetaData.model,formatter:this._oHelper.oAnnotation.isCurrency(a,this._oMetaData.annotations.uom.property.property)?A.getAmountCurrencyFormatter():A.getMeasureUnitFormatter(),useRawValues:true};i.uom={path:n}}else{i.text={path:e,model:this._oMetaData.model,type:this.oType}}}return{control:new f(this._oParent.getId()+"-sl",i),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}}};at.prototype._createMultiLineText=function(t){var e=at.getBoundPropertiesMapInfoForControl(i.getMetadata().getName(),{propertyName:"value"})[0];var a=this.createAttributes(e,this._oMetaData.property,t.attributesNamesMap);var o=this.getFormatSettings("multiLineSettings");a=k(a,o);if(this._oParent.isContextTable()){a.width="100%"}var r=new i(this._oParent.getId()+"-textArea",a);this._enhanceInputControls(r);this._handleEventingForEdmString({control:r,edmProperty:this._oMetaData.property.property});return{control:r,onCreate:"_onCreate",params:{type:{type:a.value.type,property:this._oMetaData.property},getValue:"getValue"}}};at.prototype._createLink=function(t){var e=this,a=this._oParent,o=a.getBindingInfo("url");var i={text:"",href:""};var n=at.getBoundPropertiesMapInfoForControl(r.getMetadata().getName(),{propertyName:"url"})[0];if(o){i[n]=this._oBinding.toBinding(o)}else{i[n]=a.getUrl()}if(a.hasListeners("press")){i.press=function(t){t.preventDefault();a.firePress(t)}}var s=a.getBindingInfo("value");var l=at.getBoundPropertiesMapInfoForControl(r.getMetadata().getName(),{propertyName:"value"});if(s){var p=this._oMetaData,u=p.path,h=p.property.property;if(p.annotations.text&&h.type==="Edm.String"){i[l[0]]={parts:[p.path,this._oHelper.getEdmDisplayPath(p)],formatter:this._formatText.bind(e)}}else if(at.isSpecialLink(h)){var d=at[at._getLinkFormatterFunctionName(h)];i[l[0]]={path:u};i[l[1]]={path:u,formatter:null};if(typeof d==="function"){i[l[1]].formatter=d}}else if(t){i[l[0]]={path:u,type:this._getDateFormatType()}}else{i[l[0]]=this._oBinding.toBinding(s)}}else{i[l[0]]=a.getValue()}return{control:new r(a.getId()+"-link",i),onCreate:"_onCreate",params:{noValidation:true}}};at.prototype._createEdmBoolean=function(t){var e=this._oSelector.checkComboBox(t),a=t.mode==="edit",o=this,i=null,r;if(e.combobox){if(a||this._oParent.getFetchValueListReadOnly()){return this._createComboBox({valueHelp:{annotation:e.annotation,noDialog:true,noTypeAhead:true},edit:a})}}var s,l;if(a){l=at.getBoundPropertiesMapInfoForControl(n.getMetadata().getName(),{propertyName:"value"})[0];s=this.createAttributes(l,this._oMetaData.property,{},{event:"select",parameter:"selected"});r=new n(this._oParent.getId()+"-cBoxBool",s);i={getValue:"getSelected"}}else{l=at.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];s=this.createAttributes(l,this._oMetaData.property,{width:true,textAlign:true});s[l]={model:this._oMetaData.model,path:this._oMetaData.path,formatter:function(t){return o._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}};r=new g(this._oParent.getId()+"-text",s)}return{control:r,onCreate:"_onCreate",params:i}};at.prototype._createValueHelp=function(){var t=this._oParent.getContent();if(!t){return}var e={annotation:this._oMetaData.annotations.valuelist,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"};this._getValueHelpDialogTitle(e);e.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){this._oParent.fireValueListChanged({changes:t.mParameters.changes})}.bind(this)})};at.prototype.getValueListProviderConfiguration=function(t){var e=M.prototype.getValueListProviderConfiguration.apply(this,arguments);if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){e.displayFormat="UpperCase"}return e};at.prototype._checkSuppressUnit=function(){if(this._oParent.data("suppressUnit")==="true"){return true}var t=this._oParent.getBindingInfo("uomVisible");return!t&&!this._oParent.getUomVisible()};at.prototype.getEdmProperty=function(){var t=this._oHelper;if(t){return t.getEdmProperty(this._oMetaData)}return null};at.prototype.getEntityType=function(){if(this._oMetaData){return this._oMetaData.entityType}return null};at.prototype._checkLink=function(){var t=this._oParent.getBindingInfo("url"),e=this.getEdmProperty();if(t||this._oParent.getUrl()||at.isSpecialLink(e)){return true}return this._oParent.hasListeners("press")};at._getEmbeddedSmartFieldMapSettings=function(){return{uomEditable:"editable",uomEnabled:"enabled",uomVisible:"visible",mandatory:"mandatory",contextEditable:"contextEditable"}};at.getBoundPropertiesMapInfoForControl=function(t,e){e=e||{};var a=null;switch(t){case"sap.m.Input":case"sap.m.TimePicker":case"sap.m.DatePicker":case"sap.m.DateTimePicker":case"sap.m.TextArea":a={value:["value"]};break;case"sap.m.Text":case"sap.m.ObjectIdentifier":case"sap.ui.comp.navpopover.SmartLink":a={value:["text"]};break;case"sap.m.Link":a={url:["href"],value:["text","href"]};break;case"sap.m.ObjectStatus":a={value:["text","state","icon"]};break;case"sap.m.ObjectNumber":a={value:["number","unit"]};break;case"sap.m.Select":case"sap.m.ComboBox":case"sap.ui.comp.smartfield.DisplayComboBox":a={value:["selectedKey"]};break;case"sap.ui.comp.smartfield.ComboBox":a={value:["enteredValue"],realValue:["realValue"]};break;case"sap.m.CheckBox":a={value:["selected"]};break;case"sap.ui.comp.smartfield.SmartField":var o=Object.keys(et.getMetadata().getProperties());a={};o.forEach(function(t,e,o){a[t]=[o[e]]});break}if(a&&e.propertyName){return a[e.propertyName]||null}return a};at.isSpecialLink=function(t){return O.isEmailAddress(t)||O.isPhoneNumber(t)||O.isURL(t)};at._getLinkFormatterFunctionName=function(t){return"_format"+O.getLinkDisplayFormat(t)};at._formatEmailAddress=function(t){return"mailto:"+t};at._formatPhoneNumber=function(t){return"tel:"+t};at._formatURL=function(t){return H.validate(t)?t:""};at.prototype._formatText=function(t,e){if(t&&e){var a=this._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",t,e);return W(a)}return t||""};at.prototype._getCreator=function(t){return this._oSelector.getCreator(t)};at.prototype._onCreate=function(t,e){var a,o,i=true,r=this;if(e){if(e.noValidation){i=false}if(e.valuehelp){this._getValueHelpDialogTitle(e.valuehelp);e.valuehelp.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e.valuehelp,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){r._oParent.fireValueListChanged({changes:t.mParameters.changes})}})}if(e.getValue){a=e.getValue;e.getValue=function(){return t[a]()}}if(e.type){o=this._oFieldControl.getMandatoryCheck(e.type.property);if(o){e.type.type.oFieldControl=o}}}if(i){this.addValidations(t,this._oParent.data("errorCheck")||"setSimpleClientError")}if(!this._checkUOM()){t.addStyleClass("sapUiCompSmartFieldValue")}};at.prototype._checkUOM=function(){var t=this._oParent.data("configdata");if(t&&t.configdata){if(t.configdata.onInput||t.configdata.onText){return true}}return false};at.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(t,e,a){t=t||this.getEdmProperty();var o=t&&t["com.sap.vocabularies.UI.v1.RecommendationState"];if(!o){return null}N(!(o.Path===undefined),'Missing "Path" attribute of the "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());N(!(o.Path===""),'Missing path name of "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());e=e||this._oHelper.findProperty(this._oMetaData.entityType.property,o.Path);N(!!e,'The EDM property was not found in the "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(e&&e.type==="Edm.Byte"){return{model:a||this._oMetaData.model,path:o.Path,formatter:at.formatRecommendationState}}N(e&&e.type==="Edm.Byte",'The EDM property "'+e.name+'" of "'+this._oMetaData.entityType.name+'" entity type must be typed as Edm.Byte. - '+this.getMetadata().getName());return null};at.formatRecommendationState=function(t){t=String(t);switch(t){case"0":return q.None;case"1":return q.Information;case"2":return q.Warning;default:return q.None}};at.prototype._updateDynamicAmountInputFlexItemData=function(t,e){var a=t.getLayoutData()||new z,o="sapUiCompSmartFieldFlexItemAmountEdit",i="";if(a){if(e.isfullWidth){o="sapUiCompSmartFieldFlexItemAmountNoUnitEdit";i="100%"}a.setGrowFactor(1);a.setMaxWidth(i);a.setStyleClass(o);a.setMinWidth("0")}t.setLayoutData(a)};at.prototype._updateStaticAmountInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setGrowFactor(1);e.setMaxWidth("");e.setStyleClass("")}t.setLayoutData(e)};at.prototype._updateStaticUOMInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(1);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldFlexItemUnitEdit");e.setMinWidth("")}t.setLayoutData(e)};at.prototype._updateStaticUOMTextFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(0);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldUOMDisplayText");e.setMinWidth("auto")}t.setLayoutData(e)};at.prototype._updateInnerControl=function(t,e){var a=e.RTLInTable;if(t){if(a&&typeof t.setTextDirection==="function"){t.setTextDirection("LTR")}t.addStyleClass("sapUiCompSmartFieldUnit")}};at.prototype._getValueHelpDialogTitle=function(t){t.dialogtitle=this._oParent.getComputedTextLabel();if(!t.dialogtitle){var e=this.getEdmProperty();t.dialogtitle=this._oHelper.oAnnotation.getLabel(e)||e.name}};at.prototype._onCreateUOM=function(t,e){var a=t.getItems(),o;this.addValidations(a[0],"setComplexClientErrorFirstOperand");if(e&&e.getValue){e.getValue=function(){return a[0].getValue()}}e.uom=function(){return a[1].getValue()};e.uomset=function(t){a[1].setValue(t)};if(e.type){o=this._oFieldControl.getMandatoryCheck(e.type.property);if(o){e.type.type.oFieldControl=o}}};at.prototype.triggerCreationOfControls=function(){try{this._setUOMEditState();this._oFieldControl.bindProperties({metadata:this._oMetaData});this._addLabelAndQuickInfo()}catch(t){w.error(t,null,this.getMetadata().getName())}};at.prototype._checkTextInDisplayModeValueList=function(t){var e=this._oHelper.getValueListAnnotationPath(this._oMetaData),a=this.getEdmProperty();return!!(this._oMetaData.annotations&&this._oMetaData.annotations.valuelist!==undefined&&this._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")&&(this._oMetaData.property&&(this._oMetaData.property.property.type==="Edm.String"||this._oMetaData.property.property.type==="Edm.Guid"))&&(this._oHelper.oAnnotation.getTextArrangement(a)||this._oParent.data("defaultInputFieldDisplayBehaviour"))&&t.mode==="display"&&this._oParent.getFetchValueListReadOnly()&&e&&!this._oParent.getExpandNavigationProperties()&&!this._oHelper.startWithNavigationProperty(e,this._oMetaData)&&!this.isValueInitialWithTextArrangement(a))};at.prototype.isValueInitialWithTextArrangement=function(t){return this._oParent._isValueInitial()&&this._oHelper.oAnnotation.getText(t)};at.prototype._hasBoundFieldControl=function(){var t=this._oFieldControl.getPropertyNames();for(var e=0;e<t.length;e++){if(this._oParent.getBinding(t[e])){return true}}return false};at.prototype.bind=function(t){var e=t.mode,t=t||{},a=this._oMetaData;this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList(t);if(!(!this._bInitialized&&!this.bPending)&&(!t.rebind&&!this._bTextInDisplayModeValueList)){return Promise.resolve()}this._bInitialized=true;var o=this._oParent.data("configdata");if(o&&o.configdata){try{this._init(this._oMeta);if(a&&a.annotations&&o.configdata.property){a.annotations.valueListData=o.configdata.property.valueListAnnotation;return Promise.resolve({fetchIDAndDescription:true})}}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}if(!this._oModel){return Promise.reject()}var i=!!(this._oParent&&this._oParent.isTextInEditModeSourceNotNone());if(!i&&this._oModel.bMetaModelLoaded&&(e!=="display"||!this._oParent.getFetchValueListReadOnly())){try{this._init(this._oMeta)}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}this.bPending=true;return this._metadataInitialise().then(function t(){if(!this._oParent){this.bPending=false;return Promise.reject()}this._init(this._oMeta);if(e!=="display"&&i||this._bTextInDisplayModeValueList){var a=this._oMetaData.annotations.valuelist;if(typeof a==="string"){var o=this._oParent&&this._oParent.getBindingContext()&&this._oParent.getBindingContext().getPath();return this._oHelper.loadValueListAnnotation(a,o)}else{this.bPending=false;return Promise.reject()}}this.bPending=false}.bind(this)).then(function t(e){var a={fetchIDAndDescription:false};if(!i&&!this._bTextInDisplayModeValueList||!this._oParent){return}this.bPending=false;if(e){this._initValueList(e)}if(e&&this.oTextArrangementDelegate){a.fetchIDAndDescription=true}return a}.bind(this)).catch(function(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}.bind(this))};at.prototype._metadataInitialise=function(){return Promise.resolve().then(function(){if(this._oParent._bMetaModelLoadAttached){return this._oModel.getMetaModel().loaded()}else{return P.handleModelInit(this._oParent,function(){},true)}}.bind(this)).catch(function(t){w.error("The meta model could not be loaded.",t,this.getMetadata().getName())}.bind(this))};at.prototype._addLabelAndQuickInfo=function(){var t=this.getDataProperty();t=t.property;var e=this._oHelper.oAnnotation.getLabel(t);var a=this._oHelper.oAnnotation.getQuickInfo(t);if(e){this._oParent._sAnnotationLabel=e}if(a&&this._oParent.isPropertyInitial("tooltipLabel")){this._oParent.setTooltipLabel(a)}};at.prototype.rebindOnCreated=function(){var t,e=this._oFieldControl.getControlFormatters(this._oMetaData,["editable"]);for(var a in e){t=this._oBinding.fromFormatter(this._oMetaData.model,e[a]);this._oParent.bindProperty(a,t)}};at.prototype._setUOMEditState=function(){if(this._oFieldControl.hasUomEditState(this._oMetaData)){var t=this._oFieldControl.getUOMEditState(this._oMetaData);if(t){var e=this._oBinding.fromFormatter(this._oMetaData.model,t);this._oParent.bindProperty("uomEditState",e)}}};at.prototype.getDataProperty=function(){return this._oMetaData.property};at.prototype.getDropdownItemKeyType=function(t){var e=t.getMetadata().getName();if(e==="sap.ui.comp.smartfield.DisplayComboBox"||e==="sap.m.ComboBox"||e==="sap.ui.comp.smartfield.ComboBox"||e==="sap.m.Select"){var a=at.getBoundPropertiesMapInfoForControl(e,{propertyName:"value"})[0];var o=t.getBindingInfo(a);return o&&o.type||null}return null};at.prototype.getMetaData=function(){return this._oMetaData};at.prototype.getODataHelper=function(){return this._oHelper};at.prototype._getChangeEventParams=function(t){var e,a={},o=t&&t.getParameters();if(o){e=o.value;a.value=e;a.newValue=e;if(o.validated){a.validated=o.validated}}else{a=t}return a};at.prototype._getPropertyBindingMode=function(t){var e=typeof this._oParent.getBinding==="function"&&this._oParent.getBinding(t);return e&&typeof e.getBindingMode==="function"&&e.getBindingMode()||"TwoWay"};at.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){this.oTextArrangementDelegate&&this.oTextArrangementDelegate.fetchIDAndDescriptionCollectionIfRequired(t)};at.prototype.destroy=function(){if(this._oFieldControl){this._oFieldControl.destroy()}if(this._oSelector){this._oSelector.destroy()}if(this._oTypes){this._oTypes.destroy()}if(this._oHelper){this._oHelper.destroy()}if(this.oType){this.oType.destroy();this.oType=null}if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.destroy()}this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;this.oMeasureField=null;this.oTextArrangementDelegate=null;M.prototype.destroy.apply(this,arguments)};return at},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataControlSelector", [],function(){"use strict";var t=function(t,e,a){this._oMetaData=t;this._oParent=e;this._oTypes=a};t.prototype.checkComboBox=function(t){var e={},a,o;if(typeof t!=="undefined"){if(typeof t==="boolean"){a=t}else{a=t.configOnly;o=t.mode}}if(o==="display"){e.combobox=false;return e}return this._checkComboBox(a)};t.prototype._checkComboBox=function(t){var e={};if(this._oMetaData.annotations.valuelist){e.valuelistType=this._oMetaData.annotations.valuelistType;e.annotation=this._oMetaData.annotations.valuelist}if(!e.annotation){return e}if(e.valuelistType==="fixed-values"&&!t){e.combobox=true}if(!e.combobox){e.annotation=this._oMetaData.annotations.valuelist;e.combobox=this._checkConfig("dropDownList")}return e};t.prototype.checkSelection=function(){var t={};if(this._oMetaData.annotations.valuelist){t.annotation=this._oMetaData.annotations.valuelist;t.selection=this._checkConfig("selection")}return t};t.prototype.checkCheckBox=function(){var t,e;if(this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){t=this._oParent.getBindingInfo("value");e=this._oTypes.getMaxLength(this._oMetaData.property,t);if(e===1){if(this._checkConfig("checkBox")){return true}}}return false};t.prototype.checkDatePicker=function(){if(this._oMetaData.property&&this._oMetaData.property.property&&(this._oMetaData.property.property["sap:display-format"]==="Date"||this._oTypes.isCalendarDate(this._oMetaData.property))){return true}return this._checkConfig("datePicker")};t.prototype._checkConfig=function(t){var e=this._oParent.getConfiguration();if(e){return e.getControlType()===t}return false};t.prototype.getCreator=function(t){var e,a;if(typeof t!=="undefined"){if(typeof t==="boolean"){e=t}else{e=t.blockSmartLinkCreation;a=t.mode}}var o={"Edm.Decimal":"_createEdmNumeric","Edm.Double":"_createEdmNumeric","Edm.Float":"_createEdmNumeric","Edm.Single":"_createEdmNumeric","Edm.Int16":"_createEdmNumeric","Edm.Int32":"_createEdmNumeric","Edm.Int64":"_createEdmNumeric","Edm.Byte":"_createEdmNumeric","Edm.DateTimeOffset":"_createEdmDateTimeOffset","Edm.DateTime":"_createEdmDateTime","Edm.Boolean":"_createEdmBoolean","Edm.String":"_createEdmString","Edm.Time":"_createEdmTime"};if(this._isUOMDisplayObjectStatus()){return"_createEdmUOMObjectStatus"}if(this._isUOMDisplay()){return"_createEdmUOMObjectNumber"}if(a==="display"){if(this._oMetaData.annotations){if(this.useObjectIdentifier(this.checkDatePicker())&&this._oMetaData.annotations.text&&this._oMetaData.annotations.semanticKeys&&this._oMetaData.annotations.semanticKeys.semanticKeyFields&&this._oMetaData.annotations.semanticKeys.semanticKeyFields.indexOf(this._oMetaData.path)>-1){return"_createEdmDisplay"}if(this._oMetaData.annotations.semantic&&!e){return"_createEdmSemantic"}if(this._oMetaData.annotations.uom){return"_createEdmUOMDisplay"}if(this._isObjectStatusProposed()){return"_createObjectStatus"}return this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.Boolean"?"_createEdmBoolean":"_createEdmDisplay"}}if(this._oMetaData.annotations&&this._oMetaData.annotations.uom){return"_createEdmUOM"}if(this._oMetaData.property&&this._oMetaData.property.property){if(this._oTypes.isCalendarDate(this._oMetaData.property)){return"_createEdmDateTime"}return o[this._oMetaData.property.property.type]||"_createEdmString"}return null};t.prototype._isUOMDisplay=function(){if(this._oMetaData.annotations.uom){if(this._isObjectNumberProposed()){if(!this._oParent.getContextEditable()||!this._oParent.getEditable()&&!this._oParent.getUomEditable()||!this._oParent.getEnabled()&&!this._oParent.getUomEnabled()){return true}if(this._oParent.getProperty("uomEditState")===0){return true}}}return false};t.prototype._isUOMDisplayObjectStatus=function(){if(this._oMetaData.annotations.uom){if(this._isObjectStatusProposed()){if(!this._oParent.getContextEditable()||!this._oParent.getEditable()&&!this._oParent.getUomEditable()||!this._oParent.getEnabled()&&!this._oParent.getUomEnabled()){return true}if(this._oParent.getProperty("uomEditState")===0){return true}}}return false};t.prototype._isObjectStatusProposed=function(){var t=this._oParent.getControlProposal(),e;if(t){e=t.getObjectStatus();if(e){return true}}return false};t.prototype._isObjectNumberProposed=function(){var t;if(this._oParent.data("suppressUnit")!=="true"){t=this._oParent.getControlProposal();if(t&&t.getControlType()==="ObjectNumber"){return true}if(this._oParent.getProposedControl()==="ObjectNumber"){return true}}return false};t.prototype.useObjectIdentifier=function(t,e){var a;if(this._oMetaData&&this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){if(!t&&!e){a=this._oParent.getControlProposal();if(a&&a.getControlType()==="ObjectIdentifier"){return true}if(this._oParent.getProposedControl()==="ObjectIdentifier"){return true}}}return false};t.prototype.destroy=function(){this._oParent=null;this._oMetaData=null;this._oTypes=null};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataHelper", ["sap/ui/comp/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/AnnotationHelper","sap/base/Log","sap/ui/model/odata/_ODataMetaModelUtils","sap/ui/model/odata/ODataUtils","sap/base/assert"],function(t,e,n,i,a,r,o){"use strict";var p=t.TextArrangementType;var s=function(t,e,i){if(t){this.oMeta=t.getMetaModel()}if(i){this.oMeta=i}this._oModel=t;this._oUtil=e;this.oAnnotation=new n};s.prototype.getAnalyzer=function(t){if(!this._oAnalyzer){this._oAnalyzer=new e(this._oModel||t)}return this._oAnalyzer};s.prototype.checkNavigationProperty=function(t,e){var n,i,a,r;if(e&&t){n=this._oUtil.getNavigationProperties(e);a=n.paths.length;while(a--){i=n.paths.shift();i=this._oUtil.correctPath(i);if(i===""||i===t.entitySet.name){continue}r=this.getNavigationProperty(t.entityType,i);if(r.entitySet){t.entitySet=r.entitySet;t.entityType=r.entityType}}}};s.prototype.getNavigationProperty=function(t,e){var n=this._getNamedProperty(e,"navigationProperty",t),i,a,r={};if(n){i=this.oMeta.getODataAssociationSetEnd(t,n.name);if(i===null){return}a=this.getAssociation(t,n.name);if(a){r.toRoleAssociationEndMultiplicity=this.getToRoleAssociationEndMultiplicity(a.end,n.toRole)}r.entitySet=this.oMeta.getODataEntitySet(i.entitySet);if(r.entitySet){r.entityType=this.oMeta.getODataEntityType(r.entitySet.entityType)}}return r};s.prototype.startWithNavigationProperty=function(t,e){var n=t.split("/"),i;if(n&&n.length>1){i=this._getNamedProperty(n.shift(),"navigationProperty",e.entityType)}if(i){return i.name}return null};s.prototype.getProperty=function(t){var e=[],n,i,a,r,o,p={entityType:t.entityType,entitySet:t.entitySet};if(t){i=t.path.split("/");n=i.length;if(p&&n>1){while(p&&p.entityType){r=i[0];p=this.getNavigationProperty(p.entityType,r);if(p&&p.entityType){t.entityType=p.entityType;t.entitySet=p.entitySet;t.toRoleAssociationEndMultiplicity=p.toRoleAssociationEndMultiplicity;e.push(i.shift());n--}}}t.navigationPath=e.join("/");if(n>1){a=this.oMeta.getODataProperty(t.entityType,i[0]);if(a){t.property=this._getComplex(a,i,n)}return}if(t.navigationPath){o=t.path.replace(t.navigationPath+"/","")}else{o=t.path}a=this.oMeta.getODataProperty(t.entityType,o);t.property={property:a,typePath:t.path,valueListAnnotation:null,valueListKeyProperty:null,valueListEntitySet:null,valueListEntityType:null}}};s.prototype._getComplex=function(t,e,n){var i=t,a,r=[];while(n--){if(i){if(n===0){a=i.name;i=this._getNamedProperty(e[0],"property",i);return{typePath:a+"/"+e[0],property:i,complex:true,parents:r}}i=this.oMeta.getODataComplexType(i.type);if(i){r.push(i)}}e.shift()}};s.prototype._getNamedProperty=function(t,e,n){var i;if(n[e]){for(var a=0;a<n[e].length;a++){if(n[e][a].name===t){i=n[e][a];break}}}return i};s.prototype.getTextProperty2=function(t){var e,n;e=this.oAnnotation.getText(t.property.property);if(e){n=this._preprocAnnotation(e,t);this.getProperty(n);this._postprocAnnotation(n,t)}return n};s.prototype.getUnitOfMeasure2=function(t){var e,n;e=this.oAnnotation.getUnit(t.property.property);if(e){n=this._preprocAnnotation(e,t);this.getProperty(n);this._postprocAnnotation(n,t)}return n};s.prototype._preprocAnnotation=function(t,e){var n,i;i=this.traverseNavigationProperties(t,e.entityType);if(!i.navigationPath){i.entitySet=e.entitySet}if(e.navigationPath){i.path=e.path.replace(e.navigationPath+"/","")}else{i.path=e.path}if(i.navigationPath){n=t.replace(i.navigationPath+"/","")}else{n=t}i.path=i.path.replace(e.property.property.name,n);if(i.navigationPath){i.navigationPathHelp=i.navigationPath}return i};s.prototype._postprocAnnotation=function(t,e){var n;if(t.navigationPathHelp){t.navigationPath=t.navigationPathHelp}if(t.navigationPath){n=t.navigationPath}else{n=""}if(e.navigationPath){if(n){n=e.navigationPath+"/"+n}else{n=e.navigationPath}}t.navigationPath=n;if(t.navigationPath){t.path=t.navigationPath+"/"+t.path}};s.prototype.traverseNavigationProperties=function(t,e){var n={},i={},a,r,o;a=t.split("/");o=a.length;n.entityType=e;i.entityType=e;while(o--){r=a.shift();if(r===""){continue}i=this.getNavigationProperty(n.entityType,r);if(!i.entitySet){break}n.entityType=i.entityType;n.entitySet=i.entitySet;if(n.navigationPath){n.navigationPath=n.navigationPath+"/"+r}else{n.navigationPath=r}}return n};s.prototype.getValueListAnnotationPath=function(t){var e,n,i=this.getEdmProperty(t),a=i?i.name:"";if(t&&t.property&&t.property.complex){n=t.property.parents.length-1;e=t.property.parents[n].namespace;e=e+"."+t.property.typePath}else if(t&&t.entitySet&&i){e=t.entitySet.entityType+"/"+a}return e};s.prototype.getUOMValueListAnnotationPath=function(t){var e;if(t.annotations.uom){e=this.getValueListAnnotationPath(t.annotations.uom)}if(e){t.annotations.valuelistuom=e}};s.prototype.getUOMTextAnnotation=function(t){if(t&&t.annotations&&t.annotations.uom){t.annotations.textuom=this.getTextProperty2(t.annotations.uom)}};s.prototype.geValueListEntitySet=function(t){if(t&&t.annotations&&t.annotations.valuelist){if(t.annotations.valuelist.primaryValueListAnnotation&&t.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName){t.annotations.valuelistentityset=this.oMeta.getODataEntitySet(t.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName)}}};s.prototype.getEdmProperty=function(t){var e=t.property;return e&&e.property||null};s.prototype.getValueListData=function(t){var n=this.getEdmProperty(t),i=t.annotations;if(e.isValueList(n)){i.valuelist=this.getValueListAnnotationPath(t);var a=e.getValueListMode(n);if(a){i.valuelistType=a}else{i.valuelistType=this.getAnalyzer().getValueListSemantics(n["com.sap.vocabularies.Common.v1.ValueList"])}}};s.prototype.findProperty=function(t,e){return a.findObject(t,e)};s.prototype.getAssociation=function(t,e){var n;if(t){n=this.findProperty(t.navigationProperty,e)}if(n&&this.oMeta.oModel){return a.getObject(this.oMeta.oModel,"association",n.relationship)}return null};s.prototype.getToRoleAssociationEnd=function(t,e){if(Array.isArray(t)){for(var n=0;n<t.length;n++){var i=t[n];if(i.role===e){return i}}}return null};s.prototype.getToRoleAssociationEndMultiplicity=function(t,e){var n=this.getToRoleAssociationEnd(t,e);return n?n.multiplicity:""};s.prototype.checkNavigationPropertyRequiredMetadata=function(t){var e=t.propertyName,n=t.textAnnotation,a=n?n.Path:"",r=t.entityType,s=r.namespace+"."+r.name,l="sap.ui.comp.smartfield.ODataHelper",y="com.sap.vocabularies.Common.v1.Text";if(!n){i.info('Missing "'+y+'" annotation for "'+e+'" EDM property of "'+s+'" entity type.',l);return false}if(a===undefined){o(false,'Missing "Path" attribute of "'+y+'" annotation for "'+e+'" EDM property of "'+s+'" entity type. - '+l);return false}if(a===""){o(false,'Missing URL path name of "'+y+'" annotation for "'+e+'" EDM property of "'+s+'" entity type. - '+l);return false}var f="com.sap.vocabularies.UI.v1.TextArrangement",u=n[f];if(!u){i.info('Missing "'+f+'" annotation for "'+e+'" EDM property of "'+s+'" entity type.',l);return false}var h=u.EnumMember;if(h===undefined){o(false,'Missing "EnumMember" attribute of "'+f+'" annotation for "'+e+'" EDM property of "'+s+'" entity type. - '+l);return false}if(!(h.split("/")[1]in p)){o(false,'Invalid "'+h+'" Text annotation enumeration member for "'+e+'" EDM property of "'+s+'" entity type. - '+l);return false}if(u.EnumMember===p.TextSeparate){return false}if(a.indexOf("/")===-1){o(false,'Invalid navigation property URL path name specified in the "'+y+'" annotation of the "'+e+'" EDM property of the "'+s+'" entity type. - '+l);return false}var c=a.split("/")[0],g=this.findProperty(r.navigationProperty,c);if(!g){o(false,'The navigation property URL path name "'+c+'" (specified in the Text annotation of the "'+e+'" EDM property) was not found in the "'+s+'" entity type of the service metadata document. - '+l);return false}var v=this.getAssociation(r,c);if(!v){o(false,'Missing "'+g.relationship+'" association for "'+g.name+'" EDM navigation property of the "'+s+'" entity type. - '+l);return false}var d=v.referentialConstraint;if(!d){o(false,'Missing referential constraint for "'+g.relationship+'" association in the service metadata document. - '+l);return false}if(!Array.isArray(v.end)||!(v.end.length>0)){o(false,'Missing association end for "'+g.relationship+'" association in the service metadata document. - '+l);return false}var m=this.getToRoleAssociationEndMultiplicity(v.end,g.toRole);if(m!=="1"){o(false,'Expected multiplicity of 1 for "'+g.toRole+'" association end of the "'+g.relationship+'" association in the service metadata document. - '+l);return false}if(d.principal.propertyRef.length!==1||d.dependent.propertyRef.length!==1){o(false,'Expected the single "'+e+'" foreign key EDM property as '+'referential constraint in the "'+g.relationship+'" association. - '+l);return false}var P=t.entityTypeOfNavigationProperty||this.getNavigationProperty(r,c).entityType;if(P.key.propertyRef.length!==1){o(false,'Expected a single key property in the lookup "'+P.namespace+"."+P.name+'" entity type. - '+l);return false}var A=d.principal.propertyRef[0].name;if(A!==P.key.propertyRef[0].name){o(false,'Expected a property named "'+A+'" to be the single key property in the lookup "'+P.namespace+"."+P.name+'" entity type. - '+l);return false}return true};s.prototype.checkNavigationPropertyRequiredMetadataNoAsserts=function(t){var e=t.textAnnotation,n=e?e.Path:"",i=t.entityType;if(!e){return false}if(n===undefined){return false}if(n===""){return false}var a="com.sap.vocabularies.UI.v1.TextArrangement",r=e[a];if(!r){return false}var o=r.EnumMember;if(o===undefined){return false}if(!(o.split("/")[1]in p)){return false}if(r.EnumMember===p.TextSeparate){return false}if(n.indexOf("/")===-1){return false}var s=n.split("/")[0],l=this.findProperty(i.navigationProperty,s);if(!l){return false}var y=this.getAssociation(i,s);if(!y){return false}var f=y.referentialConstraint;if(!f){return false}if(!Array.isArray(y.end)||!(y.end.length>0)){return false}var u=this.getToRoleAssociationEndMultiplicity(y.end,l.toRole);if(u!=="1"){return false}if(f.principal.propertyRef.length!==1||f.dependent.propertyRef.length!==1){return false}var h=t.entityTypeOfNavigationProperty||this.getNavigationProperty(i,s).entityType;if(h.key.propertyRef.length!==1){return false}var c=f.principal.propertyRef[0].name;if(c!==h.key.propertyRef[0].name){return false}return true};s.prototype.checkValueListRequiredMetadataForTextArrangmentNoAsserts=function(t){var e=t.valueListAnnotation;if(!e){return false}if(!Array.isArray(e.fields)){return false}var n=e.descriptionField,i=this.findProperty(e.fields,n);if(!i){return false}if(i["sap:filterable"]==="false"){return false}return true};s.prototype.checkValueListRequiredMetadataForTextArrangment=function(t){var e=t.valueListAnnotation,n="sap.ui.comp.smartfield.ODataHelper";if(!e){var i=t.entityType,a=i.namespace+"."+i.name;o(false,'Missing "ValueList" annotation for "'+t.propertyName+'" EDM property of "'+a+'" entity type. - '+n);return false}if(!Array.isArray(e.fields)){o(false,'Missing fields for "'+e.valueListEntityName+'" entity. - '+n);return false}var r=e.descriptionField,p=this.findProperty(e.fields,r);if(r!==undefined){if(!p){o(false,'The "'+r+'" description field was not found '+"in the service metadata document. - "+n);return false}if(p["sap:filterable"]==="false"){o(false,'Expected the "'+p.fullName+'" field to be filterable. - '+n);return false}}return true};s.prototype.checkValueListRequiredMetadataForValidation=function(t){var e=t.valueListAnnotation;if(!e){return false}if(!Array.isArray(e.fields)){return false}return true};s.prototype.getEdmDisplayPath=function(t){var e=t.annotations.text;if(e){return e.path}return t.path};s.prototype.getTextAnnotationPropertyPath=function(t){return t?t.path:""};s.prototype.getAbsolutePropertyPathToValueListEntity=function(t){var e=t.property,n=e&&e["com.sap.vocabularies.Common.v1.Text"],i=t.bindingContextPath;if(typeof i==="string"&&i!==""&&n){return i+"/"+n.Path}var a=t.entitySet,o=t.entityID,p;if(o==null||o===""){return""}if(n&&a){if(t.property.type=="Edm.Guid"){p=t.entityID.toLowerCase()}else{p=t.entityID}p=r.formatValue(p,t.property.type,true);return"/"+a.name+"("+encodeURIComponent(p)+")"+"/"+n.Path}return""};s.prototype.getODataValueListKeyProperty=function(t){for(var e=0;e<t.fields.length;e++){var n=t.fields[e];if(n.name===t.keyField){return n}}};s.prototype.getUOMPath=function(t){if(t&&t.annotations&&t.annotations.uom){return t.annotations.uom.path}return null};s.prototype.getUOMTypePath=function(t){if(t.property.complex){return t.property.typePath.replace(t.property.property.name,t.annotations.uom.property.name)}return t.annotations.uom.property.name};s.prototype.getDropdownChangeHandler=function(t,e){return function(n){var a="",r=false;try{if(e){if(t.getFirstInnerControl&&t.getFirstInnerControl().setEnteredValue){t.getFirstInnerControl().setEnteredValue()}a=n.getSource().getSelectedKey();r=!!a;if(!a){a=n.getSource().getValue()}}else{var o=n.getParameter("selectedItem");if(!o&&n.getSource().getSelectedItem){o=n.getSource().getSelectedItem()}if(o){a=o.getKey();r=!!a}}t.fireChange({value:a,newValue:a,selectionChange:r})}catch(t){i.warning(t)}}};s.prototype.destroy=function(){if(this._oAnalyzer){this._oAnalyzer.destroy()}if(this.oAnnotation){this.oAnnotation.destroy()}this._oUtil=null;this.oMeta=null;this.oAnalyzer=null;this.oAnnotation=null};s.prototype.getAutoExpandProperties=function(t){var e=[],n=[];for(var i in t){switch(i){case"com.sap.vocabularies.Common.v1.Text":case"Org.OData.Measures.V1.Unit":case"Org.OData.Measures.V1.ISOCurrency":case"com.sap.vocabularies.Common.v1.FieldControl":if(t[i].Path){n=t[i].Path.split("/")}break}if(n.length>1&&e.indexOf(n[0])<0){e.push(n[0])}}return e.join(",")};s.prototype.loadValueListAnnotation=function(t,e){var n=this.getAnalyzer().getValueListAnnotationLazy(t,e);n.catch(function(){i.error("The value list annotation could not be loaded.",undefined,"sap.ui.comp.smartfield.ODataHelper.loadValueListAnnotation")});return n};return s},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataTypes", ["sap/ui/model/SimpleType","sap/ui/core/format/NumberFormat","sap/ui/model/odata/type/Boolean","sap/ui/comp/smartfield/type/Double","sap/ui/comp/smartfield/type/DateTime","sap/ui/comp/odata/type/StringDate","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/NumericText","sap/ui/comp/smartfield/type/DateTimeOffset","sap/ui/model/odata/type/DateTimeWithTimezone","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/Byte","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/String","sap/ui/comp/smartfield/type/TextArrangementString","sap/ui/comp/smartfield/type/TextArrangementGuid","sap/ui/comp/smartfield/type/AbapBool","sap/ui/comp/smartfield/type/Currency","sap/ui/comp/smartfield/type/Time","sap/ui/comp/smartfield/type/Guid","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/smartfield/type/Unit"],function(t,e,r,n,i,a,o,s,p,u,l,m,c,f,y,g,d,h,C,v,D,F,T,_,x,w){"use strict";var S=function(t){this._oParent=t};S.prototype.getType=function(e,v,D,w){w=w||{};var S=this._oParent.getBindingInfo("value"),b=S&&S.binding&&S.binding.getType(),A=w.composite&&b instanceof t;if(b&&!A){return O(b)}if(e&&e.property&&e.property.type){if(!b){D=this.getConstraints(e.property,D);v=this.getFormatOptions(e.property,v)}switch(e.property.type){case"Edm.Boolean":return new r(v,D);case"Edm.Double":return new n(v,D);case"Edm.Decimal":case"Edm.Single":return new l(v,this._getDecimalConstraints(e,D));case"Edm.Int16":return new m(v,D);case"Edm.Int32":return new c(v,D);case"Edm.Int64":return new f(v,D);case"Edm.Byte":return new y(v,D);case"Edm.SByte":return new g(v,D);case"Edm.DateTimeOffset":if(this.isWithTimeZone(e)){return new u(v)}return new p(v,D);case"Edm.DateTime":return new i(v,this._getDateTimeConstraints(e,D));case"Edm.String":if(this.isCalendarDate(e)){return new a(v)}var E=x.getFiscalAnotationType(e.property);if(E){return new o(v,D,{anotationType:E})}if(!b){D=this._getStringConstraints(e)}if(b&&!D){D=b.oConstraints}if(D&&D.isDigitSequence&&!w.composite){return new s(v,D)}if(w.composite){v=Object.assign({},v,this._getTextArrangementFormatOptions());return new h(v,D,this._getTextArrangementOptions(w))}return new d(v,D);case"Edm.Time":return new F(v,D);case"Edm.Guid":var L={},B=this._getTextArrangementFormatOptions();if(_.hasTextArrangementAnnotation(e.property)&&B&&B.textArrangement==="descriptionOnly"){L={validateException:{resourceBundle:"sap.ui.comp",text:"ENTER_AN_EXISTING_DESCRIPTION"}}}if(w.composite){v=Object.assign({},v,this._getTextArrangementFormatOptions());return new C(v,D,this._getTextArrangementOptions(w))}return new T(v,D,L);default:return null}}return null};function O(t){var e=t.parseValue,r=t.destroy;t.parseValue=function(t,r){var n=e.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(t,r)}return n};t.destroy=function(){r.apply(this,arguments);this.oFieldControl=null};return t}S.prototype.getConstraints=function(t,e){return Object.assign({},e,{nullable:_.isNullable(t),skipDecimalsValidation:_.isSkippingMeasuredQuantityCheck(t)})};S.prototype.getFormatOptions=function(t,e){var r={};if(_.isUpperCase(t)){r.displayFormat="UpperCase"}return Object.assign({},e,r)};S.prototype._getDateTimeConstraints=function(t,e){var r={},n;if(t.property["sap:display-format"]==="Date"||this.isCalendarDate(t)){r={displayFormat:"Date"}}for(n in e){r[n]=e[n]}return r};S.prototype.getMaxLength=function(t,e){var r=[],n,i=0;if(e&&e.constraints){if(e.constraints.maxLength&&e.constraints.maxLength>-1){r.push(e.constraints.maxLength)}}if(e&&e.type&&e.type.oConstraints){if(e.type.oConstraints.maxLength&&e.type.oConstraints.maxLength>-1){r.push(e.type.oConstraints.maxLength)}}if(t&&t.property&&t.property.maxLength){var a=parseInt(t.property.maxLength);if(a>-1){r.push(a)}}var o=this._oParent.getMaxLength();if(o>0){r.push(o)}var s=r.length;while(s--){n=r[s];if(n>0){if(i>0){if(n<i){i=n}}else{i=n}}}return i};S.prototype._getDecimalConstraints=function(t,e){var r=t.property;e=e||{};if(r.precision){e.precision=parseInt(r.precision)}if(r.scale){e.scale=parseInt(r.scale)}if(r["sap:variable-scale"]){e.variableScale=r["sap:variable-scale"]==="true"}return e};S.prototype._getTextArrangementFormatOptions=function(){return{textArrangement:this._oParent.getControlFactory()._getDisplayBehaviourConfiguration()}};S.prototype._getStringConstraints=function(t,e){e=e||{};var r=this._oParent.getBindingInfo("value"),n=this.getMaxLength(t,r),i;if(r&&r.type&&r.type.oConstraints){if(r.type.oConstraints.equals){i=r.type.oConstraints.equals}}if(n>0||i){if(n>0){e.maxLength=n}if(i){e.equals=i}}if(_.isDigitSequence(t.property)){e.isDigitSequence=true}return e};S.prototype._getTextArrangementOptions=function(t){var e=this._oParent.getControlFactory().oTextArrangementDelegate;return{keyField:t.keyField,descriptionField:t.descriptionField,valueListNoValidation:t.valueListNoValidation,valueList:t.valueList,onBeforeValidateValue:e.onBeforeValidateValue.bind(e),delegate:t.delegate}};S.prototype.isCalendarDate=function(t){var e=t.property["com.sap.vocabularies.Common.v1.IsCalendarDate"];if(e&&e.Bool){return e.Bool?e.Bool!=="false":true}return false};S.prototype.isWithTimeZone=function(t){return t.property["com.sap.vocabularies.Common.v1.Timezone"]?true:false};S.prototype.getDisplayFormatter=function(t,e){e=e||{};if(e.currency){return this.getCurrencyDisplayFormatter(e)}else if(e.type&&e.type.oConstraints&&e.type.oConstraints.scale&&t.scale){t.scale=e.type.oConstraints.scale}return this.getUOMDisplayFormatter(t,e)};S.prototype.getCurrencyDisplayFormatter=function(t){var e={showMeasure:false,emptyString:NaN},r;this._enhanceFormatOptions(e);r=new D(e);return function(e,n,i){var a,o,s,p,u,l=this&&this.oParent&&this.oParent.oParent,m=l&&l.isA("sap.ui.comp.smartfield.SmartField")&&l.isFormContextType();if(!e||!n||n==="*"){return""}if(!t.currency){a=e+="";return a}if(isNaN(parseFloat(e))){return e.toString()+""}a=r.formatValue([e,n,i],"string");p=i&&i[n]&&i[n].digits;s=r&&r.oOutputFormat&&r.oOutputFormat.oLocaleData.getCurrencyDigits(n);o=p||s;if(o===0&&!m){a+=""}u=3-o;if(u&&!m&&a){a=a.padEnd(a.length+u,"")}else{a+=""}if(t.mask){return S.maskValue(a)}return a}};S.prototype.getUOMDisplayFormatter=function(t,e){var r={showMeasure:false,emptyString:NaN},n;this._enhanceFormatOptions(r);n=new w(r,{scale:t&&t.scale?t.scale:0});return function(t,r,i){var a,o,s=this&&this.oParent&&this.oParent.oParent,p=s&&s.isA("sap.ui.comp.smartfield.SmartField")&&s.isFormContextType();if(!t&&t!==0||!r&&r!==""||r==="*"){return""}if(isNaN(parseFloat(t))){return t.toString()+""}a=n.formatValue([t,r,i],"string");o=i&&i[r]&&i[r].UnitSpecificScale;if((o===0||o===null)&&!p){a+=""}if(!p&&s&&s.getControlContext&&s.getControlContext()===""&&a&&o){a=a.padEnd(a.length+1,"")}if(p){a+=""}if(e&&e.mask){return S.maskValue(a)}return a}};S.maskValue=function(t){if(t){return t.replace(new RegExp(".","igm"),"*")}return t};S.prototype.getCurrencyType=function(t){if(t){var e=this._getDecimalConstraints(t),r=this.getConstraints(t.property,e),n=b(r),i=A(e);this._enhanceFormatOptions(n);return new D(n,this.getConstraints(t.property,i))}return null};S.prototype.getUoMType=function(t){var e=["edm.int16","edm.int32","edm.byte","edm.double"];if(t){var r=this._getDecimalConstraints(t),n=this.getConstraints(t.property,r),i=b(n);if(e.includes(t.property.type.toLowerCase())){i.parseAsString=false;n.type=t.property.type}this._enhanceFormatOptions(i);return new w(i,n)}return null};function b(t){var e=t.nullable?null:0;return{showMeasure:false,parseAsString:true,emptyString:e,precision:t.precision}}function A(t){return{precision:t.precision,scale:t.scale,variableScale:t.variableScale}}S.prototype.getAbapBoolean=function(){return new v};S.prototype.destroy=function(){this._oParent=null};S.prototype._enhanceFormatOptions=function(t){var e=this._getCustomDataConfiguration();if(typeof e.preserveDecimals==="boolean"){t.preserveDecimals=e.preserveDecimals}};S.prototype._getCustomDataConfiguration=function(){var t={},e;if(this._oParent){e=this._oParent.data("preserveDecimals");if(e){t.preserveDecimals=e==="true"}}return t};return S},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ObjectStatus", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var i=t.extend("sap.ui.comp.smartfield.ObjectStatus",{metadata:{library:"sap.ui.comp",properties:{criticality:{type:"any",group:"Misc",defaultValue:null},criticalityRepresentationType:{type:"sap.ui.comp.smartfield.CriticalityRepresentationType",group:"Misc",defaultValue:e.smartfield.CriticalityRepresentationType.WithIcon}}}});return i});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SideEffectUtil", ["sap/ui/comp/odata/SideEffects"],function(t){"use strict";var e=function(e){this._oParent=e;this._oSideEffects=new t};e.prototype.getFieldGroupIDs=function(t,e){var i,n,r,o;if(t.property&&t.property.complex){n=t.property.parents[0];r=this._toTypePath(t.path,n)}i={entitySet:t.entitySet,entityType:t.entityType,complexType:n};o=this._oSideEffects.getSideEffects(t.path,r,i);return this._calcFieldGroups(o,t,e)};e.prototype._calcFieldGroups=function(t,e,i){var n,r,o,f,s=[],p;r=this._getSideEffects(t,e,i);f=r.length;p=this._oParent.getBindingContext();n=p.getPath();for(o=0;o<f;o++){this._calcFieldGroups2(r[o],s,i,n,p)}return s.length>0?s:null};e.prototype._calcFieldGroups2=function(t,e,i,n,r){var o,f,s,p=this;t.sideEffects.forEach(function(c){s={name:c.name,originType:c.originType,originName:t.origin.name,originNamespace:t.origin.namespace,context:n};f=JSON.stringify(s);f=f.substring(1,f.length-2);o=i.data(f);if(!o){o=p.createUUID();s.contextObject=r;i.data(o,s);i.data(f,o)}e.push(o)})};e.prototype._getSideEffects=function(t,e){var i=[];var n={};n.sideEffects=this._getSideEffectsFromEntity("entitySet",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.entitySet;i.push(n)}n={};n.sideEffects=this._getSideEffectsFromEntity("entityType",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.entityType;i.push(n)}n={};n.sideEffects=this._getSideEffectsFromEntity("complexType",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.property.parents[0];i.push(n)}return i};e.prototype._getSideEffectsFromEntity=function(t,e){var i,n=[];if(e[t]){for(i in e[t]){n.push({name:i,originType:t,sideEffect:e[t][i]})}}return n};e.prototype._toTypePath=function(t,e){var i=t.split("/");return t.replace(i[0],e.name)};e.prototype.createUUID=function(){var t=(new Date).getTime();var e="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(e){var i=(t+Math.random()*16)%16|0;t=Math.floor(t/16);return(e==="x"?i:i&7|8).toString(16)});return e};e.prototype.destroy=function(){if(this._oSideEffects){this._oSideEffects.destroy()}this._oSideEffects=null};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SmartField", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/library","sap/m/library","./JSONControlFactory","./ODataControlFactory","./BindingUtil","./SideEffectUtil","./ODataHelper","./ValidationUtil","sap/ui/core/Control","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/base/strings/capitalize","sap/base/Log","sap/base/util/Deferred","sap/m/DisplayListItem","sap/m/InputListItem","sap/ui/core/message/MessageMixin","./TextArrangementRead"],function(t,e,i,r,o,n,a,s,l,u,d,p,h,g,c,f,y,_,m,C,b,v,V){"use strict";var I=e.ValueState;var S=i.smartfield.TextInEditModeSource;var E=i.smartfield.Importance;var F=e.TextAlign;var P=r.FlexJustifyContent;var M=e.TextDirection;var x=i.smartfield.ControlContextType;var T=i.smartfield.ControlProposalType;var A=r.EmptyIndicatorMode;var D=d.extend("sap.ui.comp.smartfield.SmartField",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.ui.core.ISemanticFormContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartfield/SmartField.designtime",properties:{value:{type:"any",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},entitySet:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},contextEditable:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:""},textAlign:{type:"sap.ui.core.TextAlign",group:"Misc",defaultValue:F.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:M.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},name:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:I.None},valueStateText:{type:"string",group:"Appearance",defaultValue:""},showValueStateMessage:{type:"boolean",group:"Appearance",defaultValue:true},jsontype:{type:"sap.ui.comp.smartfield.JSONType",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},maxLength:{type:"int",group:"Misc",defaultValue:0},showSuggestion:{type:"boolean",group:"Misc",defaultValue:true},showValueHelp:{type:"boolean",group:"Misc",defaultValue:true},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},textLabel:{type:"string",group:"Misc",defaultValue:""},tooltipLabel:{type:"string",group:"Misc",defaultValue:""},uomVisible:{type:"boolean",group:"Misc",defaultValue:true},uomEditable:{type:"boolean",group:"Misc",defaultValue:true},uomEnabled:{type:"boolean",group:"Misc",defaultValue:true},url:{type:"string",group:"Misc",defaultValue:""},uomEditState:{type:"int",group:"Misc",defaultValue:-1},controlContext:{type:"sap.ui.comp.smartfield.ControlContextType",group:"Misc",defaultValue:x.None},proposedControl:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:T.None},wrapping:{type:"boolean",group:"Misc",defaultValue:true},clientSideMandatoryCheck:{type:"boolean",group:"Misc",defaultValue:true},fetchValueListReadOnly:{type:"boolean",group:"Misc",defaultValue:true},expandNavigationProperties:{type:"boolean",group:"Behavior",defaultValue:false},textInEditModeSource:{type:"sap.ui.comp.smartfield.TextInEditModeSource",group:"Behavior",defaultValue:S.None},historyEnabled:{type:"boolean",group:"Misc",defaultValue:true},importance:{type:"sap.ui.comp.smartfield.Importance",group:"Misc",defaultValue:E.Low},fixedValueListValidationEnabled:{type:"boolean",group:"Misc",defaultValue:false},_internalFieldGroupIds:{type:"string[]",defaultValue:[],visibility:"hidden"}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false},controlProposal:{type:"sap.ui.comp.smartfield.ControlProposal",multiple:false},_ariaLabelInvisibleText:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden"},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"}},events:{entitySetFound:{parameters:{entitySet:{type:"string"}}},change:{parameters:{value:{type:"string"},newValue:{type:"string"}}},changeModelValue:{parameters:{valueChanged:{type:"boolean"},valueLastValueState:{type:"boolean"},unitChanged:{type:"boolean"},unitLastValueState:{type:"sap.ui.core.ValueState"}}},initialise:{},visibleChanged:{parameters:{visible:{type:"boolean"}}},editableChanged:{parameters:{editable:{type:"boolean"}}},contextEditableChanged:{parameters:{editable:{type:"boolean"}}},innerControlsCreated:{},valueListChanged:{parameters:{changes:{type:"sap.ui.core.Control[]"}}},press:{}}},renderer:{apiVersion:2,render:function(e,i){var r=i.getContent(),o=i._oControl.edit,n=i.getFirstInnerControl();e.openStart("div",i);e.class("sapUiCompSmartField");e.openEnd();if(r&&i.getMode()==="display"&&i.isFormContextType()&&i._innerControlHasNoValue()&&n!==null&&!n.getMetadata().hasProperty("emptyIndicatorMode")){e.openStart("span");e.class("sapUiPseudoInvisibleText");e.openEnd();e.text(t.getLibraryResourceBundle("sap.ui.comp").getText("NO_VALUE"));e.close("span");e.openStart("span");e.attr("aria-hidden","true");e.class("sapMText");e.class("sapUiSelectable");e.class("sapMTextMaxWidth");e.class("sapUiCompSmartFieldValue");e.class("sapUiCompEmptyValue");e.openEnd();e.close("span")}if(i.getMode()==="edit"&&!i._getFocusCatcher()&&(o===null||o!==null&&r!==null&&o.getId()!==r.getId())){i._createFocusCatcher();e.renderControl(i._getFocusCatcher())}else if(r){e.renderControl(r);if(i._isFocusCatcherFocused()&&o&&o.getId()===r.getId()){r.focus()}if(i._getFocusCatcher()){i._destroyFocusCatcher()}}if(i.getAggregation("_ariaLabelInvisibleText")){i.getAggregation("_ariaLabelInvisibleText").forEach(function(t){e.renderControl(t)})}e.close("div")}}});v.call(D.prototype);var B=D.prototype.refreshDataState;D.prototype.init=function(){this._isInnerControlCreationDelayed=true;this._sAnnotationLabel="";this._bInDestroy=false;this._oSideEffects=new s(this);this._oFactory=null;this._oControl={display:null,edit:null,current:null};this._oValue={display:null,edit:null,uom:null,uomset:null};this._oError={bComplex:false,bFirst:false,bSecond:false};this._oState=this._initState();this._oUtil=new a;this._bSuppressToggleControl=false;this.oValidation=new u(this);this._oLastValidated=null;this.attachModelContextChange(function(){if(this._hasDefaultModel()){if(this.getBindingContext()){this._createICRenderedDeferred()}this.invalidate()}}.bind(this));this._initialStateApplied=new m;this._innerControlsRendered=Promise.resolve();this._initialStateApplied.promise.then(function(){var t=this.getBinding("value");if(t){var e=function(){var i=this.getBinding("value").getDataState();if(i.getOriginalValue()!==i.getValue()){this._bValueNotInitial=true;t.detachChange(e)}}.bind(this);t.attachChange(e)}}.bind(this))};D.prototype._getICRenderedPromise=function(){var t=this._oRenderedWithContext;return t?t.promise:undefined};D.prototype._createICRenderedDeferred=function(){var t;t=new m;this._oRenderedWithContext=t;Promise.all([new Promise(function(t){this.attachInnerControlsCreated(t)}.bind(this)),new Promise(function(t){var e={onAfterRendering:function(i){var r=this._getFocusCatcher(),o=this._oControl.edit,n=this.getAggregation("_content");if(o&&o.getDomRef()&&o.getFocusDomRef()&&o===n&&(!r||!r.getDomRef())){this.removeEventDelegate(e);t()}}.bind(this)};this.addEventDelegate(e)}.bind(this))]).then(function(){t.resolve()})};D.prototype.setVisible=function(t,e){var i=this.getVisible();d.prototype.setVisible.apply(this,arguments);t=this.getVisible();if(t!==i){this.fireVisibleChanged({visible:t})}return this};D.prototype._setVisibilityBasedOnImportance=function(t){var e,i,r,o,n,a=this._oFactory,s=this.oParent&&this.oParent.isA("sap.ui.comp.smartform.GroupElement")&&this.oParent.getDomRef();if(!a||!s){return}e=a.getMetaData&&a.getMetaData();i=e&&e.property&&e.property.property;o=a._oHelper&&a._oHelper.oAnnotation;if(o){if(!o.isNullable(i)||o.isStaticMandatory(i)||o.getVisible(i)==="false"){return}}if(this.getMandatory()||!this.getVisible()||this._fieldControlValue===0||this._fieldControlValue===7){return}r=!this.isPropertyInitial("importance")&&this.getImportance()||o&&o.getImportanceAnnotation(i);switch(t){case E.High:n=r===E.High?"":"none";break;case E.Medium:n=r===E.Low?"none":"";break;default:n=""}s.style.display=n};D.prototype.getComputedTextLabel=function(){return this.getProperty("textLabel")||this._sAnnotationLabel};D.prototype.isPropertyBeingUpdatedByModel=function(t){var e=this.getBindingInfo(t);return!!(e&&e.skipModelUpdate)};D.prototype._boundEntityExists=function(t){t=t||this.getBindingContext();return!!(t&&t.getObject())};D.prototype.setUomEditable=function(t){this.setProperty("uomEditable",t,true);var e=this._getEmbeddedSmartField();if(e){e.setEditable(this.getUomProperty("editable"))}return this};D.prototype.setUomEnabled=function(t){this.setProperty("uomEnabled",t,true);var e=this._getEmbeddedSmartField();if(e){e.setEnabled(this.getUomEnabled())}return this};D.prototype.setUomVisible=function(t){this.setProperty("uomVisible",t,true);var e=this._getEmbeddedSmartField();if(e){t=this.getUomProperty("visible");e.setVisible(t);var i=this._oFactory&&this._oFactory.oMeasureField;if(i){i.toggleStyleClass("smartFieldPaddingRight",t)}}return this};D.prototype.setShowValueHelp=function(t){var e=this.getShowValueHelp();this.setProperty("showValueHelp",t,true);var i=this.getContent();if(i&&typeof i.setShowValueHelp==="function"){t=this.getShowValueHelp();var r=t!==e,o=this._oFactory;if(r&&o){if(t){o._createValueHelp()}else{o.destroyValueHelp()}}i.setShowValueHelp(t)}return this};D.prototype.setShowSuggestion=function(t){var e=this.getShowSuggestion();this.setProperty("showSuggestion",t,true);var i=this.getContent();if(i&&typeof i.setShowSuggestion==="function"){t=this.getShowSuggestion();var r=t!==e,o=this._oFactory;if(r&&o){if(t){o._createValueHelp()}else{o.destroyValueHelp()}}i.setShowSuggestion(t)}return this};D.prototype.setConfiguration=function(t){var e=this.getConfiguration(),i=this.setAggregation("configuration",t,true);t=this.getConfiguration();var r=!!(t&&e===null||e&&t===null),o=!!this.getContent();if(o&&(r||t&&e&&(t.getControlType()!==e.getControlType()||t.getDisplayBehaviour()!==e.getDisplayBehaviour()))){this._destroyControls();this._toggleInnerControlIfRequired({mode:this.getMode()});if(t&&t.getDisplayBehaviour()){this._onInnerControlToggled({mode:this.getMode(),fetchIDAndDescription:true,forceTextArrangementFetch:true})}}return i};D.prototype.setTextInEditModeSource=function(t){var e=this.getTextInEditModeSource();this.setProperty("textInEditModeSource",t);t=this.getTextInEditModeSource();if(t!==e){if(this._oFactory){this._destroyFactory()}}return this};D.prototype.setTooltip=function(t){this._refreshTooltipBaseDelegate(t);this.setAggregation("tooltip",t,true);var e=this.getFirstInnerControl();if(e){e.setTooltip(t)}return this};D.prototype._setOnInnerControl=function(){var t,e=this.getContent(),i=this.getFirstInnerControl();if(e){if(typeof e.setWidth==="function"){var r=this.getWidth();if(r){e.setWidth(r)}}this._setPropertyOnControls("wrapping",this.getWrapping());if(typeof e.setName==="function"){e.setName(this.getName())}if(typeof e.setPlaceholder==="function"&&this.getPlaceholder()!==""){e.setPlaceholder(this.getPlaceholder())}if(typeof e.setTextAlign==="function"&&(!e.getTextAlign()||this.getTextAlign()!==F.Initial)){e.setTextAlign(this.getTextAlign())}if(typeof e.setJustifyContent==="function"){if(this.getTextAlign()===F.Initial||this.getTextAlign()===F.Begin){t=P.Start}else if(this.getTextAlign()==="Right"){t=P.End}else{t=this.getTextAlign()}e.setJustifyContent(t)}this._setPropertyOnControls("required",this.getMandatory());this._setPropertyOnControls("textDirection",this.getTextDirection());if(i&&i.getMetadata().getProperty("textAlign")&&(!i.getTextAlign()||this.getTextAlign()!==F.Initial)){this._setPropertyOnControls("textAlign",this.getTextAlign())}var o=this._getEmbeddedSmartField();if(o){if(!this.isPropertyInitial("uomEditable")){o.setEditable(this.getUomProperty("editable"))}if(!this.isPropertyInitial("uomEnabled")){o.setEnabled(this.getUomEnabled())}if(!this.isPropertyInitial("uomVisible")){o.setVisible(this.getUomProperty("visible"))}}}return this};D.prototype.getUomProperty=function(t){var e=this._getEmbeddedSmartField(),i=e&&e.getControlFactory(),r=i&&i._oFieldControl,o=y(t),n="getUom"+o,a=this[n]();if(e.isBound(t)&&r){var s=i.getMetaData();if(s){var l=r._oStoredBindings[t],u=r["_get"+o](s,l,t);u.path();var d=u.formatter.call(e,a);return d}}return a};D.prototype._setPropertyOnControls=function(t,e,i){i=i||this.getInnerControls();i.forEach(function(i){var r="set"+y(t);if(typeof i[r]==="function"){i[r](this._convertValueForControl(t,e,i))}},this)};D.prototype._convertValueForControl=function(t,i,r){var o;if(r){o=r.getMetadata().getProperty(t)}if(o){switch(t){case"wrapping":switch(o.type){case"boolean":return i;case"sap.ui.core.Wrapping":var n=e.Wrapping;if(i){return n.Soft}return n.None}}}return i};D.prototype.setEntitySet=function(t){this.setProperty("entitySet",t,true);this.fireEntitySetFound({entitySet:t});return this};D.prototype._setPendingEditState=function(t){this.data("pendingEditableState",!t)};D.prototype.setContent=function(t){return this.setAggregation("_content",t)};D.prototype.getContent=function(){return this.getAggregation("_content")};D.prototype.getControlFactory=function(){return this._oFactory};D.prototype.getValue=function(){var t=this.getInnerValueFunction();if(t){return t()}return this.getProperty("value")};D.prototype.getInnerValueFunction=function(){if(this._oValue&&typeof this._oValue[this.getMode()]==="function"){return this._oValue[this.getMode()]}return null};D.prototype.getValueState=function(){var t=this.getInnerControls(),e=this._getMaxSeverity(t);if(e>-1){return t[e].getValueState()}return I.None};D.prototype.setValueState=function(t){this.setProperty("valueState",t,true);var e=this.getInnerControls(),i,r="setSimpleClientError";if(e&&e.length){i=e[0];if(e.length>1){r="setComplexClientErrorFirstOperand"}}if(i&&typeof i.setValueState==="function"){i.setValueState(t);this[r](t===I.Error)}return this};D.prototype.getValueStateText=function(){var t=this.getInnerControls(),e=this._getMaxSeverity(t);if(e>-1){return t[e].getValueStateText()}return this.getProperty("valueStateText")};D.prototype.setValueStateText=function(t){this.setProperty("valueStateText",t,true);var e=this.getInnerControls(),i;if(e&&e.length){i=e[0]}if(i&&typeof i.setValueStateText==="function"){i.setValueStateText(t)}return this};D.prototype._getMaxSeverity=function(t){var e,i,r,o,n=0,a=-1,s={Error:3,Warning:2,Success:1,None:0};o=t.length;for(r=0;r<o;r++){i=t[r];if(i.getValueState){e=i.getValueState();if(e&&s[e]>n){n=s[e];a=r}}}return a};D.prototype.getFocusDomRef=function(){var t=this.getInnerControls(),e,i=t.length;if(i>0){e=t[0]}if(e&&e.getFocusDomRef){return e.getFocusDomRef()}return d.prototype.getFocusDomRef.apply(this,arguments)};D.prototype.getIdForLabel=function(){var t=this.getInnerControls(),e,i=t.length;if(i>0){e=t[0]}if(e&&typeof e.getIdForLabel==="function"){return e.getIdForLabel()}return this.getId()};D.prototype.unbindProperty=function(t,e){d.prototype.unbindProperty.apply(this,arguments);var i=this.getAllInnerControls();i.forEach(function(i){var r=i.getMetadata().getName();var o=n.getBoundPropertiesMapInfoForControl(r,{propertyName:t});if(Array.isArray(o)){o.forEach(function(t){i.unbindProperty(t,e)})}});return this};D.prototype.getMode=function(){var t=this.getEditable(),e=this.getEnabled(),i=this.getContextEditable();if(this.data("configdata")&&this.data("configdata").configdata&&this.data("configdata").configdata.isUOM&&this.data("configdata").configdata.isInnerControl&&this.data("configdata").configdata.getContextEditable){i=this.data("configdata").configdata.getContextEditable()}return t&&e&&i?"edit":"display"};D.prototype.isInEditMode=function(){return this.getMode()==="edit"};D.prototype._toggleInnerControlIfRequired=function(t){var e=t.mode;if(this._bSuppressToggleControl||(!this._oFactory||this._oFactory.bPending)){return}if(e==="edit"){this._createControlIfRequired(t)}else{var i=this.getProperty("value"),r=true;var o=this.data("configdata");if(o&&o.configdata&&!o.configdata.isUOM){if(i===null||i===""){r=false}}if(r){this._createControlIfRequired(t)}else{this.setContent(null);this._oControl.current="display"}}};D.prototype._propagateToInnerControls=function(t){if(t==="edit"){this._propagateFieldGroupIDs(this.getProperty("_internalFieldGroupIds"))}this._setOnInnerControl()};D.prototype._propagateFieldGroupIDs=function(t){var e;if(Array.isArray(t)&&t.length){e=this.getFirstInnerControl();if(e){e.setFieldGroupIds(t)}}};D.prototype._onInnerControlToggled=function(t){var e,i,r,o=false,n=false;if(t&&t.fetchIDAndDescription&&this.getModel()&&this.getBindingContext()&&this.getBinding("value")){this._oFactory.fetchIDAndDescriptionCollectionIfRequired(t.forceTextArrangementFetch)}this._initialStateApplied.resolve();this._propagateToInnerControls(t.mode);this._processEvents({editableChanged:t.editableChanged,editable:t.editable,contextEditableChanged:t.contextEditableChanged,contextEditable:t.contextEditable});if(t.mode==="display"&&this.isFormContextType()){this._setEmptyIndicator(this.getFirstInnerControl())}if(t.mode==="edit"){i=this.getContent();r=this._oControl.edit;o=r&&i&&r.getId()===i.getId();if(o){this._checkFieldGroups({mode:t.mode})}}e=this._getEmbeddedSmartField();if(e&&e.data("configdata")&&e.data("configdata").configdata.isUOM){e.setClientSideMandatoryCheck(t.clientSideMandatoryCheck);var a=this._oFactory.getMetaData&&this._oFactory.getMetaData();if(e.getBindingInfo("editable")||a&&a.annotations&&a.annotations.uom.property&&a.annotations.uom.property.property&&a.annotations.uom.property.property["sap:updatable"]){n=true}if(t.isFormContextType&&t.contextEditable&&t.contextEditable!==t.editable&&!n&&e.getEditable()!==t.editable){e.setEditable(t.editable)}}};D.prototype._processEvents=function(t){if(t.editableChanged){this.fireEditableChanged({editable:t.editable})}if(t.contextEditableChanged){this.fireContextEditableChanged({editable:t.contextEditable})}};D.prototype._forceInitialise=function(){if(this._isBoundToDefaultModel()){return this._processStateHandler()}else if(!this.bIsListeningForDefaultModel){this.bIsListeningForDefaultModel=true;return new Promise(function(t,e){this.attachEvent("modelContextChange",{resolve:t,reject:e},this._forceInitialiseHandler,this)}.bind(this))}};D.prototype._forceInitialiseHandler=function(t,e){if(this._isBoundToDefaultModel()){this.detachEvent("modelContextChange",this._forceInitialiseHandler,this);this._processStateHandler().then(function(){e.resolve()}).catch(function(t){e.reject(t)})}};D.prototype._processStateHandler=function(){var t=this.getMode();return this._processState().then(function(){var e=this._getEmbeddedSmartFieldByMode(t);return e&&e._processState()}.bind(this))};D.prototype._updateInnerControlsIfRequired=function(){var t,e,i={mode:this.getMode(),contextEditable:this.getContextEditable(),editable:this.getEditable(),enabled:this.getEnabled(),visible:this.getVisible()};this._updateInnerControlsIfRequiredHandler(i);t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){e={mode:t.getMode(),contextEditable:t.getContextEditable(),editable:t.getEditable(),enabled:t.getEnabled(),visible:t.getVisible()};t._updateInnerControlsIfRequiredHandler(e)}};D.prototype._updateInnerControlsIfRequiredHandler=function(t){this._init();if(this._oFactory!==null){this._oFactory._init(this._oFactory._oMeta)}this._toggleInnerControlIfRequired(t)};D.prototype.setImportance=function(t){var e=this.getProperty("importance");if(e===t){return this}this.setProperty("importance",t);return this};D.prototype.setValue=function(t){this.setProperty("value",t);if(!this.isPropertyBeingUpdatedByModel("value")&&!this.getBindingContext()){var e=this.getFirstInnerControl();if(e){var i=e.getMetadata().getName();var r=n.getBoundPropertiesMapInfoForControl(i,{propertyName:"value"})[0];var o=e.getBinding(r);if(this.getMode()==="display"&&o&&typeof o.getFormatter()==="function"&&o.getBindingMode()===f.OneWay){t=o.getExternalValue()}this._setPropertyOnControls(r,t,[e])}}return this};D.prototype._getInnerControlPropertyBinding=function(t){var e,i,r,o,a,s=this._oControl[t],l=s&&this._getInnerControls(s);if(Array.isArray(l)&&l.length>0){e=l[0];i=e.getMetadata().getName();r=n.getBoundPropertiesMapInfoForControl(i,{propertyName:"value"})}if(Array.isArray(r)&&r.length>0){o=r[0];a=e.getBinding(o)}return a};D.prototype.isTextInEditModeSourceNotNone=function(t){return this._getComputedTextInEditModeSource(false,t)!==S.None};D.prototype._getComputedTextInEditModeSource=function(t,e){var i=e||this.getMode(),r=this.getTextInEditModeSource(),o=this.data("defaultTextInEditModeSource");if(o&&this.isPropertyInitial("textInEditModeSource")&&i==="edit"){r=o}if(!t&&r===S.ValueListWarning){r=S.ValueListNoValidation}return r};D.prototype._isValueListWarning=function(){return this._getComputedTextInEditModeSource(true)===S.ValueListWarning};D.prototype._isValueListValidationMode=function(){var t=this._getComputedTextInEditModeSource(true);if(t===S.ValueList||t===S.ValueListWarning){return true}return false};D.prototype._createControlIfRequired=function(t){if(!this._oFactory){return}var e=t.mode,i=this._oControl[e];if(e!==this._oControl.current||!i){if(!i){var r=this._oFactory.createControl(t);if(r){if(e!=="edit"&&this._getFocusCatcher()){this._destroyFocusCatcher()}this._oControl[e]=r.control;this._placeCallBacks(r,e)}}this._oControl.current=e;this.setContent(this._oControl[e]);this._oFactory.updateControl(t);this._setOnInnerControl();this._fireInnerControlsCreated()}else if(!this.getContent()){this._oControl.current=e;this.setContent(this._oControl[e])}};D.prototype._fireInnerControlsCreated=function(){var t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){t.attachInnerControlsCreated(function(){this.fireInnerControlsCreated(this.getInnerControls())}.bind(this))}else{this.fireInnerControlsCreated(this.getInnerControls())}};D.prototype._placeCallBacks=function(t,e){if(t.params&&t.params.getValue){this._oValue[e]=t.params.getValue}if(t.params&&t.params.uom){this._oValue.uom=t.params.uom}if(t.params&&t.params.uomset){this._oValue.uomset=t.params.uomset}};D.prototype._init=function(t){var e,i,r;if(!this._oFactory){i=this.data("configdata");if(!i){e=this.getModel(t)}r=this.getBindingPath("value");if(t===undefined&&r&&(i||e)){this._oFactory=this._createFactory(t,e,r,i)}}};D.prototype.clone=function(){var t=d.prototype.clone.apply(this,arguments);t.attachModelContextChange(function(){t.invalidate()});return t};D.prototype._destroyFactory=function(){this._bSuppressToggleControl=true;this._bSideEffects=false;if(this._oFactory){this._oFactory.destroy()}this._oFactory=null;this._bSuppressToggleControl=false;this._destroyControls()};D.prototype._destroyControls=function(){if(this._oControl){if(this._oControl.display){this._oControl.display.destroy()}if(this._oControl.edit){this._oControl.edit.destroy()}this._oControl.display=null;this._oControl.edit=null;this._oControl.current=null}this._oValue={display:null,edit:null,uom:null,uomset:null};this.destroyAggregation("_content")};D.prototype._createFactory=function(t,e,i,r){if(e&&e instanceof c){return new o(e,this,{model:t,path:i})}var a;if(!r){a=this._getEntitySet(t)}if(a||r){var s;if(r){s=r.configdata;this._enhanceConfigData(s)}else{s={entitySet:a,model:t,path:i}}return new n(e,this,s)}return null};D.prototype._enhanceConfigData=function(t){var e=this.data("ignoreInsertRestrictions");if(typeof e==="boolean"){t.ignoreInsertRestrictions=e}};D.prototype._getEntitySet=function(t,e){var i=this.getEntitySet(),r=i!=="";if(r&&!t){return i}var o=this.getBindingContext(t);if(o){var n=o.getPath();if(n===""||n===undefined||n==="/undefined"){return""}i=this._oUtil.correctPath(n);if(!e){this.fireEntitySetFound({entitySet:i})}return i}return""};D.prototype._getODataEntityType=function(t){var e,i,r,o,n=this.getModel(),a=n&&n.getMetaModel();e=this._getEntitySet(t);if(e===""){return}o=a.getODataEntitySet(e);if(o!==null&&o.entityType){i=o.entityType}if(i===undefined){r=a.getODataFunctionImport(e);if(r!==null&&r.returnType){i=r.returnType}}return i};D.prototype.getDataType=function(){var t;if(this._oFactory){if(this._oFactory.getDataProperty){t=this._oFactory.getDataProperty();if(t){return t.property.type}}return this.getJsonType()}return null};D.prototype.getDataProperty=function(){var t,e,i,r,o,n=this.getModel(),a=n&&n.getMetaModel();if(this._oFactory){if(this._oFactory.getDataProperty){return this._oFactory.getDataProperty()}}else{o=this.data("configdata")&&this.data("configdata").configdata;if(o&&o.property){return o.property}if(!a||!a.oModel){return null}e=this._getODataEntityType();if(e===undefined){return null}t=this.getBindingPath("value");if(t===undefined){return null}i=a.getODataEntityType(e);r=a.getODataProperty(i,t);if(r===null){return null}return{property:r}}};D.prototype.getUnitOfMeasure=function(){if(this._oValue.uom){return this._oValue.uom()}return null};D.prototype.setUnitOfMeasure=function(t){if(t&&this._oValue.uomset){this._oValue.uomset(t)}};D.prototype.setSimpleClientError=function(t){this._oError.bFirst=t};D.prototype.setComplexClientErrorFirstOperand=function(t){this._oError.bComplex=true;this._oError.bFirst=t};D.prototype.setComplexClientErrorSecondOperand=function(t){this._oError.bComplex=true;this._oError.bSecond=t};D.prototype.setComplexClientErrorSecondOperandNested=function(t){var e=this.getParent().getParent();e.setComplexClientErrorSecondOperand(t)};D.prototype._hasClientError=function(){if(this._oError.bComplex){return this._oError.bFirst||this._oError.bSecond}return this._oError.bFirst};D.prototype.checkClientError=function(t){t=Object.assign({handleSuccess:false},t);var e="The sap.ui.comp.smartfield.SmartField#checkClientError method is deprecated. "+"Please use the sap.ui.comp.smartfield.SmartField#checkValuesValidity method instead.";_.warning(e,this.getMetadata().getName());if(this.getMode()==="display"){return false}if(this._hasClientError()&&!t.handleSuccess){return true}this.getInnerControls().forEach(function(e){this._checkErrors(e,{checkClientErrorsOnly:true,handleSuccess:t.handleSuccess})}.bind(this));return this._hasClientError()};D.prototype.checkValuesValidity=function(t){var e,i=this.getControlFactory(),r;if(i&&i.getEdmProperty){r=i.getEdmProperty();if(!r){return Promise.resolve()}e=r.name}if(this.getMode()==="display"){return Promise.resolve({property:e,instance:this})}t=t||{};var o={handleSuccess:true,innerControls:this.getInnerControls(),rawValues:[]};var n=this._getEmbeddedSmartField();t=Object.assign(o,t);if(t.rawValues.length===0&&n&&n.data("configdata")&&n.data("configdata").configdata.isUOM){this._updateCurrencyRawValues(t)}return new Promise(function(i,r){var o={rawValues:t.rawValues,handleSuccess:t.handleSuccess,bCheckValuesValidity:true};var n=t.innerControls.map(function(t){return this._checkErrors(t,o)},this);Promise.all(n).then(function(){i({property:e,instance:this})}.bind(this)).catch(function(t){r({property:e,instance:this})}.bind(this))}.bind(this))};D.prototype.checkUnitValidity=function(t){var e=false;if(this.getMode()==="display"){return true}t=t||{};var i={handleSuccess:true,innerControls:this.getInnerControls(),rawValues:[]};var r=this._getEmbeddedSmartField();t=Object.assign(i,t);if(t.rawValues.length===0&&r&&r.data("configdata")&&r.data("configdata").configdata.isUOM){this._updateCurrencyRawValues(t)}if(i.innerControls.length!==2&&(i.innerControls.length!==1&&!this._oFactory._checkSuppressUnit())){throw new h}r=r?r:i.innerControls[1];var o=i.innerControls[0],a=r?r:this._getUomControl(),s,l,u,d;t=Object.assign({checkClientErrorsOnly:false,handleSuccess:true},t);if(o){var c=n.getBoundPropertiesMapInfoForControl(o.getMetadata().getName(),{propertyName:"value"});u=c&&c[0]}if(a){var f=n.getBoundPropertiesMapInfoForControl(a.getMetadata().getName(),{propertyName:"value"});d=f&&f[0]}if(u){s=o.getBinding(u)}if(d){l=a.getBinding(d)}if(!s||!l&&!this._oFactory._checkSuppressUnit()){return true}try{var _="get"+y(u),m=s.getType(),C=s.sInternalType,b=o[_]();if(C&&m){var v=t.rawValues||s.getValue(),V=m.parseValue(b,s.sInternalType,v);if(V){m.validateValue(V)}if(s.hasValidation()){var I=false,S=true,E={element:o,property:u,type:s.getType(),newValue:b,oldValue:s.getValue(),mParameters:{suppressChangeModelValue:true}};o.fireValidationSuccess(E,I,S);e=true}}}catch(t){var F={element:o,property:u,type:s.getType(),newValue:b,oldValue:s.getValue(),exception:t,message:t.message};if(t instanceof g){F.targetControl=r&&r.getFirstInnerControl()}if(t instanceof p){o.fireParseError(F)}else if(t instanceof h){o.fireValidationError(F)}else{if(t.toString()==="TypeError: Cannot read property 'decimals' of undefined"){t.validationUnitError=true}throw t}}try{if(!d||!a.getVisible()){return e}var P="get"+y(d),M=l.getType(),x=l.sInternalType,b=o[_](),T=a[P]();if(x&&M){var v=t.rawValues||s.getValue(),A=M.parseValue(T,l.sInternalType,v);if(A){M.validateValue(A)}if(l.hasValidation()){var I=false,S=true,D={element:a,property:d,type:l.getType(),newValue:T,oldValue:l.getValue(),mParameters:{suppressChangeModelValue:true}};a.fireValidationSuccess(D,I,S);e&=true}}}catch(t){var B={element:a,property:d,type:l.getType(),newValue:T,oldValue:l.getValue(),exception:t,message:t.message};if(t instanceof p){a.fireParseError(B)}else if(t instanceof h){a.fireValidationError(B)}else{t.validationUnitError=true;throw t}e=false}return e};D.prototype._updateCurrencyRawValues=function(t){t.rawValues=t.innerControls.map(function(t){var e=t.getMetadata(),i=n.getBoundPropertiesMapInfoForControl(e.getName(),{propertyName:"value"});return e.getProperty(i).get(t)})};D.prototype._checkErrors=function(t,e){e=Object.assign({checkClientErrorsOnly:false,handleSuccess:true},e);var i,r,o=this;if(t){var a=n.getBoundPropertiesMapInfoForControl(t.getMetadata().getName(),{propertyName:"value"});r=a&&a[0]}if(r){i=t.getBinding(r)}if(!i){return Promise.resolve()}var s;function l(e){var n,a={element:t,property:r,type:i.getType(),newValue:s,oldValue:i.getValue(),exception:e,message:e.message};if(e instanceof g){n=o._getEmbeddedSmartField();a.targetControl=n&&n.getFirstInnerControl()}if(e instanceof p){t.fireParseError(a)}else if(e instanceof h){t.fireValidationError(a)}else{throw e}}function u(){if(e.handleSuccess&&i.hasValidation()){var o={element:t,property:r,type:i.getType(),newValue:s,oldValue:i.getValue(),mParameters:{suppressChangeModelValue:true}};var n=false,a=true;t.fireValidationSuccess(o,n,a)}}try{var d="get"+y(r),c=i.getType(),f=i.sInternalType;s=t[d]();if(f&&c){if(e.checkClientErrorsOnly&&c.async){var m="The deprecated sap.ui.comp.smartfield.SmartField#checkClientError method can not be "+"used with async types. Please use sap.ui.comp.smartfield.SmartField#checkValuesValidity "+"method instead.";_.error(m,this.getMetadata().getName());this.setSimpleClientError(true);return Promise.reject()}if(c.async){var C=i.getDataState();var b=c.formatValue(C.getValue(),f);if(!C.isControlDirty()&&b===s){u();return Promise.resolve()}}var v=e.rawValues||i.getValue(),V=c.parseValue(s,i.sInternalType,v),I;if(V&&V instanceof Promise){I=V.then(function(t){return c.validateValue(t)}).then(u);I.catch(l);return I}I=c.validateValue(V,e.bCheckValuesValidity);if(I instanceof Promise){I.catch(l);return I.then(u)}}}catch(t){l(t);return Promise.reject()}u();return Promise.resolve()};D.prototype.isContextTable=function(){return this.getControlContext()==="responsiveTable"||this.getControlContext()==="table"};D.prototype.isFormContextType=function(){var t=this.getControlContext(),e=i.smartfield.ControlContextType;return t===e.Form||t===e.SmartFormGrid};D.prototype.isTableContextType=function(){var t=this.getControlContext(),e=i.smartfield.ControlContextType;return t===e.Table||t===e.ResponsiveTable};D.prototype.getInnerControls=function(){var t=this.getContent();return this._getInnerControls(t)};D.prototype._getInnerControls=function(t){var e,i={"sap.m.HBox":function(t){var e,i,r=0;i=t.getItems();if(i){r=i.length}if(r===0){return[]}if(r===1){return[i[0]]}e=i[1].getContent();if(e){return[i[0],e]}return[i[0]]},"sap.ui.comp.navpopover.SmartLink":function(t){var e=t.getAggregation("innerControl");if(e){return[e]}return[t]}};if(t){e=i[t.getMetadata()._sClassName]}if(e){return e(t)}if(t){return[t]}return[]};D.prototype.getAllInnerControls=function(){var t=[],e=this._oControl;if(e){for(var i in e){if(e.hasOwnProperty(i)){var r=e[i];if(r&&r instanceof Object){t.push(r)}}}}return t};D.prototype._getEmbeddedSmartField=function(){var t=this.getContent();return this._getEmbeddedSmartFieldInstace(t)};D.prototype._getEmbeddedSmartFieldByMode=function(t){var e=t==="edit"?this._oControl.edit:this._oControl.display;return this._getEmbeddedSmartFieldInstace(e)};D.prototype._getEmbeddedSmartFieldInstace=function(t){if(t){if(t.isA("sap.m.HBox")){var e=t.getItems();if(e){for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartfield.SmartField")){return e[i]}}}}}return null};D.prototype._createFocusCatcher=function(){this.__oFakeInput=new sap.m.Input(this.getId()+"-fakeInput")};D.prototype._destroyFocusCatcher=function(){if(this.__oFakeInput){this.__oFakeInput.destroy();this.__oFakeInput=null}};D.prototype._getFocusCatcher=function(){return this.__oFakeInput};D.prototype._isFocusCatcherFocused=function(){return this._getFocusCatcher()&&this._getFocusCatcher().getId()+"-inner"===document.activeElement.getAttribute("id")};D.prototype.onAfterRendering=function t(){d.prototype.onAfterRendering.bind(this,arguments);this._applyPlaceHolder();if(this.__oFakeInput){setTimeout(function(){if(this.__oFakeInput){this.__oFakeInput.setBlocked(true)}}.bind(this),1e3)}};D.prototype.onBeforeRendering=function t(){var e;if(this.__oFakeInput){this.__oFakeInput.setBlocked(false)}if(!this._hasDefaultModel()||this._bInDestroy){return Promise.resolve()}e=this._processState().then(this.accessibilityAttributesHandler.bind(this)).then(d.prototype.onBeforeRendering.bind(this,arguments));return e};D.prototype._calculateCurrentState=function(){var t,e,i,r=this.getClientSideMandatoryCheck(),o=this._getControlDescriptionPath(this._oControl.edit),n=this._getControlDescriptionPath(this._oControl.display),a=this.getEditable(),s=this.getContextEditable(),l=this.isFormContextType(),u=this.getMode(),d=this.getEnabled(),p=this.getVisible(),h=this.getBinding("value"),g=h&&this._oState.isValuePropertyChanged(h.getValue()),c=this._oState.isValueBindingPathChanged(this.getBindingPath("value")),f=this._oState.isModelChanged(this.getModel()),y=this._oState.isBindingContextChanged(this.getBindingContext()),_=this._oState.isEntitySetChanged(this._getEntitySet(undefined,true)),m=this._oState.isModeChanged(u),C=this._oState.isEditableChanged(a),b=this._oState.isContextEditableChanged(s),v=this._isDescriptionBindingPathDefault(),V=this._getComputedTextInEditModeSource()===S.ValueListNoValidation&&g,I=m&&o!==n,E=c||f||_,F=E;if(E){this._oState._resetProperty("EDIT");this._oState._resetProperty("DISPLAY")}t=this._oState.isModeInitialized(u);e=y||!t;i=V||!t||v||g||I;return{mode:u,rebind:i,enabled:d,visible:p,editable:a,editableChanged:C,contextEditable:s,contextEditableChanged:b,forceTextArrangementFetch:e,clientSideMandatoryCheck:r,isFormContextType:l,isFactoryJustCreated:F,destroyFactory:E,bindingContextChanged:y}};D.prototype._processState=function(){var t,e,i,r,o=this._calculateCurrentState();e={mode:o.mode,rebind:o.rebind};i={mode:o.mode,contextEditable:o.contextEditable,editable:o.editable,enabled:o.enabled,visible:o.visible};r={editable:o.editable,editableChanged:o.editableChanged,isFormContextType:o.isFormContextType,contextEditable:o.contextEditable,contextEditableChanged:o.contextEditableChanged,forceTextArrangementFetch:o.forceTextArrangementFetch,clientSideMandatoryCheck:o.clientSideMandatoryCheck,mode:o.mode};if(this.isContextTable()&&(o.editableChanged||o.contextEditableChanged)&&(o.editable&&o.contextEditable)){var n=this._oControl&&this._oControl.edit;if(n){(n.isA("sap.m.HBox")?n.getItems():[n]).forEach(function(t){if(t.getValueState&&(t.getValueState()===I.Error||t.getValueState()===I.Warning)){t.setValueState(I.None)}})}}if(this._oFactory!==null&&o.destroyFactory){this._calculatePlaceHolder();this._destroyFactory()}if(o.bindingContextChanged){this._bSideEffects=false}this._init();if(this._oFactory===null){return Promise.resolve()}else{this._deletePlaceHolder()}t=this._oFactory.bind(e).then(function t(e){r.fetchIDAndDescription=e&&e.fetchIDAndDescription||false;if(this._oFactory===null){return Promise.reject()}if(o.isFactoryJustCreated&&this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")){this._oFactory.triggerCreationOfControls()}this._toggleInnerControlIfRequired(i);this._onInnerControlToggled(r);if(o.isFactoryJustCreated&&this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")){this._fireInitialise()}}.bind(this));return t};D.prototype._fireInitialise=function(){var t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){t.attachInitialise(this.fireInitialise.bind(this))}else{this.fireInitialise()}};D.prototype._calculatePlaceHolder=function(){var t=this.getFirstInnerControl(),e=t&&t.getDomRef()||null;this._iInnerControlHeight=e&&e.offsetHeight||null};D.prototype._deletePlaceHolder=function(){this._iInnerControlHeight=null};D.prototype._applyPlaceHolder=function(){var t=this.getDomRef();if(t){if(this._iInnerControlHeight){t.style.minHeight=this._iInnerControlHeight+"px"}else{t.style.minHeight=""}}};D.prototype.accessibilityAttributesHandler=function(){var t=this._getEmbeddedSmartField();if(this.isContextTable()){this._handleAriaLabelledByInSmartTable(t)}else if(t){this._handleUoMAriaLabelledBy(t)}};D.prototype.getFirstInnerControl=function(){var t=this.getInnerControls();if(t.length){return t[0]||null}return null};D.prototype._checkFieldGroups=function(t){var e,i,r=t.mode;if(this.getBindingContext()&&this._oFactory&&this._oFactory.getMetaData&&r==="edit"&&!this._bSideEffects){i=this._calculateFieldGroupMetaData();e=this._getView();if(e&&i){this._setFieldGroup(i,e)}}};D.prototype._calculateFieldGroupMetaData=function(){var t=this._oFactory.getMetaData();if(t&&(!t.property||t.property&&!t.property.property)){return}return t};D.prototype._setFieldGroup=function(t,e){var i,r=this._oSideEffects.getFieldGroupIDs(t,e);if(r){i=this.getFirstInnerControl();if(i){this._bSideEffects=true;i.setFieldGroupIds(r)}}};D.prototype._getView=function(){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){return t}t=t.getParent()}return null};D.prototype._getUomControl=function(){var t=this.getAllInnerControls();if(this.getUomEnabled()&&t&&t.length===1){var e=t[0].getItems?t[0].getItems():[];for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartfield.SmartField")){return e[i]}}}return null};D.prototype.refreshDataState=function(t,e){var i,r,o,n;if(t==="value"){o=e&&e.getChanges();n=o&&o.value;if(n&&n.value!==n.oldValue){this._oLastValidated=null}B.apply(this,arguments);if(e.isLaundering()){if(this.getEditable()){i=this.getBindingContext();if(i&&i.getObject){r=i.getObject();if(r&&r.__metadata&&r.__metadata.created){this._checkCreated=true;return}}}}if(this._checkCreated&&!e.isLaundering()&&!e.isDirty()){if(this._oFactory){this._oFactory.rebindOnCreated()}this._checkCreated=false}}};D.prototype.onValidation=function(t){var e,i=t.getParameters(),r=i.newValue!==i.oldValue,o=this.data("configdata")&&this.data("configdata").configdata,n=o&&o.smartFieldRootControl?o.smartFieldRootControl:this,a=n._getEmbeddedSmartField(),s=a&&a.getFirstInnerControl(),l=s&&s.getId(),u=n.getModel(),d=t.getSource().getId(),p=i.mParameters,h=p&&p.originSource&&p.originSource.getId(),g=this._oLastValidated!==null&&this._oLastValidated.sourceId===d&&this._oLastValidated.sNewValue===i.newValue,c=p&&p.suppressChangeModelValue||g||false,y=l&&l!==d,_=l&&l===d,m=l&&h&&l!==h,C=l&&h&&l===h;if(h&&h!==d||c||u.getDefaultBindingMode()!==f.TwoWay){return}this._oLastValidated={sourceId:d,sNewValue:i.newValue};if(m||y){e={valueChanged:r,valueLastValueState:n.getValueState(),unitChanged:false,unitLastValueState:a.getValueState()}}else if(C||_){e={valueChanged:false,valueLastValueState:n.getValueState(),unitChanged:r,unitLastValueState:a.getValueState()}}else{e={valueChanged:r,valueLastValueState:n.getValueState()}}n.fireChangeModelValue(e)};D.prototype.exit=function(){this._bInDestroy=true;var t=null;if(this.__oFakeInput){this.__oFakeInput.destroy()}if(this._oSideEffects){this._oSideEffects.destroy()}if(this._oUtil){this._oUtil.destroy()}if(this._oFactory){this._oFactory.destroy()}var e=this._oControl;if(e){if(e.current==="edit"){t=e["display"]}else{t=e["edit"]}if(e[e.current]&&!e[e.current].getParent()){e[e.current].destroy()}}if(t&&typeof t.destroy==="function"){t.destroy()}this._oUtil=null;this._oError=null;this._oValue=null;this._oFactory=null;this._oControl=null;this._oSideEffects=null;this._oState=null;this._sAnnotationLabel="";this._oLastValidated=null};D.getSupportedAnnotationPaths=function(t,e,i,r){var o,n,a=[],s;if(t&&e&&i){s={entitySet:e,entityType:t.getODataEntityType(e.entityType),path:i};o={helper:new l(null,null,t)};if(r){o.navigationPathOnly=r}o.helper.getProperty(s);D._getFromEntitySet(a,s,o);D._getFromProperty(a,s,o);n=o.helper.getUnitOfMeasure2(s);if(n){D._getFromProperty(a,n,o)}o.helper.destroy()}return a};D._getFromEntitySet=function(t,e,i){var r;if(e.entitySet){r=i.helper.oAnnotation.getUpdateEntitySetPath(e.entitySet);D._push(r,t,e,i)}};D._push=function(t,e,i,r){var o,n,a,s,l={};if(t){if(r.navigationPathOnly){o=t.split("/");a=o.length;l.entityType=i.entityType;while(a--){n=o.shift();if(n===""){continue}l=r.helper.getNavigationProperty(l.entityType,n);if(!l.entitySet){break}if(s){s=s+"/"+n}else{s=n}}}else{s=t}}if(s){if(i.navigationPath){e.push(i.navigationPath+"/"+s)}else{e.push(s)}}};D._getFromProperty=function(t,e,i){var r;if(e.property.property){r=i.helper.oAnnotation.getText(e.property.property);D._push(r,t,e,i);r=i.helper.oAnnotation.getUnit(e.property.property);D._push(r,t,e,i);r=i.helper.oAnnotation.getFieldControlPath(e.property.property);D._push(r,t,e,i)}};D.prototype.addAssociation=function(t,e,i){if(t==="ariaLabelledBy"&&e){this.getInnerControls().forEach(function(t){if(t.addAriaLabelledBy){t.addAriaLabelledBy(e)}})}else if(t==="ariaDescribedBy"&&e){this.getInnerControls().forEach(function(t){if(t.addAriaDescribedBy){t.addAriaDescribedBy(e)}})}return d.prototype.addAssociation.apply(this,arguments)};D.prototype.removeAssociation=function(t,e,i){var r=d.prototype.removeAssociation.apply(this,arguments);if(t==="ariaLabelledBy"&&r){this.getInnerControls().forEach(function(t){if(t.removeAriaLabelledBy){t.removeAriaLabelledBy(r)}})}else if(t==="ariaDescribedBy"&&r){this.getInnerControls().forEach(function(t){if(t.removeAriaDescribedBy){t.removeAriaDescribedBy(r)}})}return r};D.prototype.getAccessibilityInfo=function(){var t=this.getContent();return t&&t.getAccessibilityInfo?t.getAccessibilityInfo():null};D.prototype.enhanceAccessibilityState=function(t,e){var i=this.getParent();if(i&&i.enhanceAccessibilityState){i.enhanceAccessibilityState(this,e)}};D.prototype._handleAriaLabelledByInSmartTable=function(t){var e,i=this;if(this.getAriaLabelledBy().length>0){this.getInnerControls().forEach(function(r){if(r.addAriaLabelledBy&&r.getAriaLabelledBy){e=r.getAriaLabelledBy().indexOf(i.getAriaLabelledBy()[0])>-1;if(!e&&r.getAriaLabelledBy().length===0){r.addAriaLabelledBy(i.getAriaLabelledBy()[0])}if(t){i._handleUoMAriaLabelledBy(t)}}})}};D.prototype._handleUoMAriaLabelledBy=function(t){this.getInnerControls().forEach(function(e){if(e.addAriaLabelledBy&&e.getAriaLabelledBy&&!t.getEditable()){var i=e.getAriaLabelledBy().indexOf(t.getId()+"-text")>-1;if(!i){e.addAriaLabelledBy(t.getId()+"-text")}}})};D.prototype._isValueInitial=function(){var t,e=this.getBinding("value"),i=e&&e.getDataState();if(!i||this._bValueNotInitial){t=false}else if(this._isValueInValidation()){t=this._getValueInValidation()===i.getOriginalValue()}else{t=i.getValue()===i.getOriginalValue()}return t};D.prototype._setValueInValidation=function(t){this._vValueInValidation=t};D.prototype._getValueInValidation=function(){return this._vValueInValidation};D.prototype._isValueInValidation=function(){return this._vValueInValidation!==undefined};D.prototype.getRequired=function(){if(this.getContextEditable()&&this.getEditable()){return this.getMandatory()}else{return false}};D.prototype.getBindingMode=function(t){var e=this.getBindingInfo(t);return e?e.parts[0].mode:undefined};D.prototype._innerControlHasNoValue=function(){var t,e,i,r,o,a,s,l,u=this.getInnerControls(),d=false;for(t=0;t<u.length;t++){o=u[t];a=o.getMetadata().getName();if(a==="sap.m.ObjectStatus"&&!(o.getText().trim()||o.getIcon().trim()||o.getTitle().trim())){d=true;break}else{l=n.getBoundPropertiesMapInfoForControl(a,{propertyName:"value"});if(!Array.isArray(l)){return false}i=0;for(e=0;e<l.length;e++){r=undefined;s=l[e];r=o.getProperty(s);if(r===""||r===null){i+=1}}if(i===l.length){d=true;break}}}return d};D.prototype._getHistoryEnabled=function(){return this.getHistoryEnabled()};D.prototype.getFormValueProperty=function(){return"value"};D.prototype.getFormFormattedValue=function(){var t,e=this._forceInitialise();if(e instanceof Promise){return e.then(function(){return this.getInnerControls().map(function(e){if(e.isA("sap.m.Text")){t=e.getText();if(!t&&e.getEmptyIndicatorMode()===A.On){t="-"}return t}}).join("")}.bind(this))}};D.prototype.getDataSourceLabel=function(){return this._sAnnotationLabel};D.prototype._isAsync=function(){var t=this._getComputedTextInEditModeSource(),e=i.smartfield.TextInEditModeSource,r;if(t===e.ValueList){return true}else if(t===e.NavigationProperty){return true}else if(t===e.ValueListNoValidation){r=this.getControlFactory()._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour");return r==="descriptionOnly"}return false};D.prototype._getTextArrangementRead=function(){if(!this._oTextArrangementRead){this._oTextArrangementRead=new V}return this._oTextArrangementRead};D.prototype._hasDefaultModel=function(){var t=this.getModel();return t!==undefined};D.prototype._isBoundToDefaultModel=function(){var t=this._hasDefaultModel(),e=this._getEntitySet(undefined,true);return t&&e};D.prototype._isDescriptionBindingPathDefault=function(){var t=this.getFirstInnerControl(),e=t&&t.getBinding("value"),i=e&&e.isA("sap.ui.model.CompositeBinding")&&e.getBindings()[1]&&e.getBindings()[1].getPath()==="__$$SmartFieldNotExistingBindingPath"||false;return i};D.prototype._getControlDescriptionPath=function(t){var e=t&&t.getBindingInfo("value"),i=e&&Array.isArray(e.parts)&&e.parts[1]&&e.parts[1].path;return i};D.prototype._initState=function(){return Object.create({_setProperty:function(t,e){if(this.mProperties===undefined||this.mProperties===null){this.mProperties={}}if(this.mProperties[t]===undefined){this.mProperties[t]={}}this.mProperties[t].previous=this.mProperties[t].current;this.mProperties[t].current=e},_getProperty:function(t){return this.mProperties&&this.mProperties[t]&&this.mProperties[t].current},_resetProperty:function(t){if(this.mProperties[t]!==undefined){this.mProperties[t]={}}},_resetProperties:function(){if(this.mProperties){this.mProperties={}}},isModeInitialized:function(t){var e=t==="edit"?"EDIT":"DISPLAY",i=this._getProperty(e);if(!i){this._setProperty(e,true)}return i},isModeChanged:function(t){var e="MODE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isValuePropertyChanged:function(t){var e="VALUE_PROPERTY_VALUE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isModelChanged:function(t){var e="MODEL_ID",i=t&&t.getId(),r=this._getProperty(e)!==i;if(r){this._setProperty(e,i)}return r},isValueBindingPathChanged:function(t){var e="VALUE_PROPERTY_BINDING_PATH",i=typeof t!=="undefined"&&this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isEntitySetChanged:function(t){var e="ENTITY_SET",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isBindingContextChanged:function(t){var e="BINDING_CONTEXT_PATH",i=t&&t.getPath(),r=typeof i!=="undefined"&&this._getProperty(e)!==i;if(r){this._setProperty(e,i)}return r},isEditableChanged:function(t){var e="EDITABLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isContextEditableChanged:function(t){var e="CONTEXT_EDITABLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i}})};D.prototype.readODataLabel=function(){return new Promise(function(t,e){var i=this.getModel(),r=this.data("configdata"),o,n=i&&i.getMetaModel(),a,s;if(this._sAnnotationLabel){t(this._sAnnotationLabel);return}if(!i&&!r){e();return}a=new l(i,this._oUtil,n);if(r&&r.configdata){this._sAnnotationLabel=a.oAnnotation.getLabel(a.getEdmProperty(r.configdata));t(this._sAnnotationLabel);return}o=this.getBindingPath("value");s=this._getEntitySet();if(o&&s){n.loaded().then(function(){var e=a.oMeta.getODataEntitySet(s),i={entitySet:e,entityType:a.oMeta.getODataEntityType(e.entityType),path:o};a.getProperty(i);this._sAnnotationLabel=a.oAnnotation.getLabel(a.getEdmProperty(i));t(this._sAnnotationLabel)}.bind(this))}else{e()}}.bind(this))};D.prototype._setEmptyIndicator=function(t){if(t&&t.getEmptyIndicatorMode&&t.getEmptyIndicatorMode()!==A.On){t.setEmptyIndicatorMode(A.On)}};D.prototype._getEditableForNotExpandedNavigation=function(){return false};D.prototype._getComputedMetadata=function(){return this._initialStateApplied.promise.then(function(){return this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")&&this._oFactory.getMetaData()}.bind(this))};D.prototype._calculateFieldGroupIDs=function(t){return this._oSideEffects.getFieldGroupIDs(t,this._getView())};D.prototype._setInternalFieldGroupIds=function(t){this.setProperty("_internalFieldGroupIds",t)};D.prototype._isFixedValueList=function(){var t=this._oFactory.getMetaData();if(t&&t.annotations&&t.annotations.valuelistType==="fixed-values"){return true}return false};return D},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SmartLabel", ["sap/ui/core/Control","sap/m/Label","sap/ui/comp/library","./BindingUtil","./AnnotationHelper","./SmartField","sap/base/strings/capitalize"],function(t,e,i,a,n,s,r){"use strict";var l=e.extend("sap.ui.comp.smartfield.SmartLabel",{metadata:{designtime:"sap/ui/comp/designtime/smartfield/SmartLabel.designtime",interfaces:["sap.ui.core.Label","sap.ui.core.IShrinkable","sap.m.IOverflowToolbarContent","sap.m.IHyphenation"],library:"sap.ui.comp"},renderer:{apiVersion:2}});l.prototype.init=function(){this._sSmartFieldId=null;this._bMetaDataApplied=false;this._fInnerControlsCreatedHandlers=null};l.prototype._bindProperties=function(){var t=this._getField();if(t){var e=new a;var i=null;if(!this.isBound("visible")){this.setVisible(t.getVisible())}if(!this._bTextSetExplicitly){i=t.getBindingInfo("textLabel");if(i){this.bindProperty("text",e.toBinding(i))}else if(!this.getBindingInfo("text")){this._setText(t.getComputedTextLabel())}}i=t.getBindingInfo("tooltipLabel");if(i){this.bindProperty("tooltip",e.toBinding(i))}else{this.setTooltip(t.getTooltipLabel())}}};l.prototype.onFieldVisibilityChange=function(t){if(!this.isBound("visible")){this.setVisible(t.getSource().getVisible())}};l.prototype.getLabelInfo=function(){var t,e;var i=this._getField();if(i){this._bindProperties();t=i.getDataProperty();if(t){e=this._getLabelInfo(t);if(e){if(e.text&&!this._bTextSetExplicitly){this._setProperty(this,"text",e.text)}if(e.quickinfo){this._setProperty(this,"tooltip",e.quickinfo)}}}}};l.prototype._setProperty=function(t,e,i){if(t&&e){if(i.match(/{@i18n>.+}/gi)){t.bindProperty(e,i.slice(1,-1))}else{var a=r(e);if(!t.getBindingInfo(e)&&!t["get"+a]()){t["set"+a](i)}}}};l.prototype.setLabelFor=function(t){var i=this._getField();var a="";if(t){if(typeof t==="string"){a=t}else if(t.getId){a=t.getId()}}if(a.length>0&&a===this._sSmartFieldId){return this}if(i){if(this._fChange){i.detachEvent("_change",this._fChange);this._fChange=null}if(this._fInitialized){i.detachInitialise(this._fInitialized);this._fInitialized=null}this.detachFieldVisibilityChange(i);this._bMetaDataApplied=false}if(a.length>0){this._sSmartFieldId=a;this._setLabelFor()}else{this._sSmartFieldId=null}e.prototype.setLabelFor.apply(this,arguments);var n=sap.ui.getCore().byId(this.getLabelFor());this.detachFieldVisibilityChange(n);this.attachFieldVisibilityChange(n);return this};l.prototype._getField=function(){if(this._sSmartFieldId){return sap.ui.getCore().byId(this._sSmartFieldId)}return null};l.prototype._setLabelFor=function(){var t,e=this._getField();if(e&&!this._bMetaDataApplied){this._bMetaDataApplied=true;if(e.getDataProperty){t=e.getDataProperty();if(t){this.getLabelInfo()}else{if(!this._fInitialized){this._fInitialized=this.getLabelInfo.bind(this);e.attachInitialise(this._fInitialized)}if(!this._fChange){this._fChange=function(t){if(t.getParameter("name")==="textLabel"){this.getLabelInfo()}else if(t.getParameter("name")==="mandatory"){this.invalidate()}}.bind(this);e.attachEvent("_change",this._fChange)}}this._lateUpdateLabelFor(e)}}};l.prototype.updateLabelFor=function(t){var i=t.slice(0);if(i&&i.length>0){this.invalidate();e.prototype.setLabelFor.call(this,i.shift());this.updateAriaLabeledBy(i)}};l.prototype.updateAriaLabeledBy=function(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];if(typeof i.addAriaLabelledBy==="function"){i.removeAriaLabelledBy(this);i.addAriaLabelledBy(this)}}}};l.prototype.setText=function(t){this.setProperty("text",t);this._bTextSetExplicitly=true;return this};l.prototype._setText=function(t){this.setProperty("text",t)};l.prototype._getLabelInfo=function(t){var e=new n;if(t&&t.property){return{text:e.getLabel(t.property),quickinfo:e.getQuickInfo(t.property)}}};l.prototype._delayUpdateLabelFor=function(t){var e=this;if(t.attachInnerControlsCreated&&!this._fInnerControlsCreatedHandlers){this._fInnerControlsCreatedHandlers=function(t){e.updateLabelFor(t.getParameters())};t.attachInnerControlsCreated(this._fInnerControlsCreatedHandlers)}};l.prototype._lateUpdateLabelFor=function(t){var e;if(t&&t instanceof s){e=t.getInnerControls();if(e&&e.length>0){this.updateLabelFor(e)}else{this._delayUpdateLabelFor(t)}var i=sap.ui.getCore().byId(this.getLabelFor());this.detachFieldVisibilityChange(i);this.attachFieldVisibilityChange(i)}};l.prototype.onBeforeRendering=function(){if(this._sSmartFieldId){var t=this._getField();if(!this._bMetaDataApplied){this._setLabelFor();if(t.getId()===this.getLabelFor()){this._lateUpdateLabelFor(t)}}}};l.prototype.attachFieldVisibilityChange=function(t){if(t&&typeof t.attachVisibleChanged==="function"){t.attachVisibleChanged(this.onFieldVisibilityChange,this)}};l.prototype.detachFieldVisibilityChange=function(t){if(t&&typeof t.detachVisibleChanged==="function"){t.detachVisibleChanged(this.onFieldVisibilityChange,this)}};l.prototype.destroy=function(t){var i=this._getField();delete this._bTextSetExplicitly;if(i){if(this._fInnerControlsCreatedHandlers&&i.detachInnerControlsCreated){i.detachInnerControlsCreated(this._fInnerControlsCreatedHandlers);this._fInnerControlsCreatedHandlers=null}if(this._fInitialized&&i.detachInitialise){i.detachInitialise(this._fInitialized);this._fInitialized=null}if(this._fChange){i.detachEvent("_change",this._fChange);this._fChange=null}}this._sSmartFieldId=null;return e.prototype.destroy.apply(this,arguments)};l.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this.detachFieldVisibilityChange(sap.ui.getCore().byId(this.getLabelFor()))};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/TextArrangementDelegate", ["sap/ui/comp/library","sap/ui/core/library","sap/ui/core/Core","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/base/assert","sap/base/util/deepEqual"],function(t,e,i,r,a,o,n,s){"use strict";var l=t.smartfield.TextInEditModeSource;var d=r.extend("sap.ui.comp.smartfield.TextArrangementDelegate",{constructor:function(t){r.apply(this,arguments);this.oFactory=t;this.oSmartField=t._oParent;this.bValidMetadata=false;this.sBindingContextPath="";this.sAbsolutePathToVLProperty="";this._mOneTimeDescriptionCache=new Map;this._sTextArrangementLastReadValue=null;this._mTextArrangementLastReadAdditionalFilters=null}});d.prototype.setValue=function(t,e){var i=this.oSmartField,r=i._oControl;if(this.bValidMetadata&&t!==e&&r){var a=r[r.current],o=a&&a.getBinding("value");if(!o){return}var n=i.isPropertyBeingUpdatedByModel("value");switch(i._getComputedTextInEditModeSource()){case l.NavigationProperty:var s=!!i.getModel().getData(o.getBindings()[1].getPath(),i.getBindingContext(),true);if(n&&!s||!n){a.setValue(t)}return;case l.ValueList:case l.ValueListNoValidation:if(!n){a.setValue(t)}else if(this._sTextArrangementLastReadValue!==t){this.fetchIDAndDescriptionCollectionIfRequired()}return}}};d.getPaths=function(t,e){var i=e.property&&e.property.valueListAnnotation;switch(t){case l.NavigationProperty:var r=e.annotations.text;if(!r){return{}}return{keyField:r.entityType.key.propertyRef[0].name,descriptionField:r.property.typePath,entitySetName:r.entitySet.name};case l.ValueList:if(!i){return{}}return{keyField:i.keyField,descriptionField:i.descriptionField,entitySetName:e.property.valueListEntitySet&&e.property.valueListEntitySet.name};case l.ValueListNoValidation:if(!i){return{}}return{valueListNoValidation:true,keyField:i.keyField,descriptionField:i.descriptionField,entitySetName:e.property.valueListEntitySet.name}}};d.prototype.getBindingInfo=function(t){var e,i=t&&t.type,r=t.valueListNoValidation,a={},o=this.oSmartField,n=this.oFactory,s=n._oMetaData;if(!i||!i.isA("sap.ui.comp.smartfield.type.TextArrangement")){var u=o.getBindingInfo("value");i=u&&u.type||{};var p=d.getPaths(n._bTextInDisplayModeValueList?l.ValueList:o._getComputedTextInEditModeSource(),s);i=n._oTypes.getType(s.property,Object.assign(a,i.oFormatOptions),i.oConstraints,{composite:true,keyField:p.keyField,descriptionField:p.descriptionField,valueListNoValidation:r,valueList:o._getComputedTextInEditModeSource()===l.ValueList,delegate:this})}var c=this.oSmartField.getBinding("value").getValue(),y=o._getComputedTextInEditModeSource(),h=d.getPaths(this.oFactory._bTextInDisplayModeValueList?l.ValueList:y,s);var f=this.getTextAnnotationPropertyPath({entitySet:{name:h.entitySetName},entityID:c});if(f===""||f.indexOf("undefined")!==-1){f="__$$SmartFieldNotExistingBindingPath"}e={model:s.model,type:i,parts:[{path:s.path},{path:f}]};return e};d.prototype.getTextAnnotationPropertyPath=function(t){t=t||{};var e=t.textInEditModeSource||this.oSmartField._getComputedTextInEditModeSource(),i=this.oFactory,r=i._oMetaData,a=r.annotations&&r.annotations.text,o=t.textAnnotation||a;if(i._bTextInDisplayModeValueList){e=l.ValueList}switch(e){case l.NavigationProperty:return i._oHelper.getTextAnnotationPropertyPath(o);case l.ValueList:case l.ValueListNoValidation:var n=t.edmValueListKeyProperty||r.property.valueListKeyProperty,s=t.bindingContextPath||this.sBindingContextPath;if(o&&s!=="/undefined"&&this.oSmartField._isValueInitial()){var d=i._oHelper.getTextAnnotationPropertyPath(o);if(d&&d!==this.oFactory.getMetaData().path){return d}}return i._oHelper.getAbsolutePropertyPathToValueListEntity({property:n,bindingContextPath:s,entitySet:t.entitySet,entityID:t.entityID});case l.None:return"";default:return""}};d.prototype.checkRequiredMetadata=function(t,e){var i=this.oFactory,r=i._oMetaData,a=r.property,o=a.property,n=a.valueListKeyProperty,s=this.oSmartField.getTextInEditModeSource(),d=s===l.ValueList||s===l.ValueListWarning,u=o&&o["com.sap.vocabularies.Common.v1.Text"]||n&&n["com.sap.vocabularies.Common.v1.Text"];if(!u&&!d){return false}switch(t){case l.None:return false;case l.NavigationProperty:var p=r.annotations.text,c;if(p){c=p.entityType}var y={propertyName:r.property&&r.property.property&&r.property.property.name,entityType:r.entityType,entityTypeOfNavigationProperty:c,textAnnotation:r.property&&r.property.property&&r.property.property["com.sap.vocabularies.Common.v1.Text"]};if(e){return i._oHelper.checkNavigationPropertyRequiredMetadataNoAsserts(y)}else{return i._oHelper.checkNavigationPropertyRequiredMetadata(y)}case l.ValueList:case l.ValueListNoValidation:var h={propertyName:r.property&&r.property.property&&r.property.property.name,entityType:r.entityType,valueListAnnotation:r.property&&r.property.valueListAnnotation};if(e){return i._oHelper.checkValueListRequiredMetadataForTextArrangmentNoAsserts(h)}else{return i._oHelper.checkValueListRequiredMetadataForTextArrangment(h)}default:return false}};d.prototype.onBeforeValidateValue=function(t,e){var i=this.oSmartField;if(!i.getBindingContext()){return}var r=this.onFetchIDAndDescriptionCollectionSuccess.bind(this,{success:e.success});var a=this.onFetchIDAndDescriptionCollectionError.bind(this,{error:e.error});var o={value:t,success:r,error:a,filterFields:e.filterFields,updateBusyIndicator:true,bCheckValuesValidity:e.bCheckValuesValidity};return this.fetchIDAndDescriptionCollection(o)};d.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){var e=this.oSmartField,i=e.getMode(),r=e._getInnerControlPropertyBinding(i),a=r&&r.getType(),o=a&&a.isA("sap.ui.comp.smartfield.type.TextArrangement")||false,n=e._getComputedTextInEditModeSource(),d=this.oFactory&&this.oFactory.getMetaData(),u=d&&d.annotations&&d.annotations.text,p=n===l.ValueList,c=e._isValueInitial();if(i==="edit"&&d&&d.annotations&&d.annotations.valuelistType==="fixed-values"){return}if(u&&(d&&u.path===d.path||this.sBindingContextPath==="/undefined"||!c)){u=null}if(u&&c&&!e._isValueInValidation()){return}if(p||!u&&n===l.ValueListNoValidation&&this.oFactory._getDisplayBehaviourConfiguration()!=="idOnly"||this.oFactory._bTextInDisplayModeValueList){var y="value",h=e.getModel(),f=e.getBindingContext(),g=e.getBinding(y).getPath(),F=h&&f&&g&&h.getProperty(g,f),m=F==null||F==="";var v=this.getAdditionalFiltersData(e,e.getControlFactory().getMetaData(),{});var P=this._mTextArrangementLastReadAdditionalFilters&&!s(this._mTextArrangementLastReadAdditionalFilters,v);if(!m&&(P||this._sTextArrangementLastReadValue!==F||!o||t)){var V=["keyField"];var D={value:F,oldValue:F,initialRendering:true,mode:i};return this.fetchIDAndDescriptionCollection({value:F,filterFields:V,updateBusyIndicator:false,success:this.onFetchIDAndDescriptionCollectionSuccess.bind(this,D)})}}};d.prototype.fetchIDAndDescriptionCollection=function(t){var e=t.value,i=this.oSmartField;if(e==null||e===""){return Promise.resolve()}if(t.bCheckValuesValidity){t.filterFields=["keyField"]}var r=i._oControl&&i._oControl.edit;if(r&&t.updateBusyIndicator){r.setBusyIndicatorDelay(300);r.setBusy(true)}i._setValueInValidation(e);return this.readODataModel(t).then(function(){i._bValueNotInitial=true}).finally(function(){if(r&&t.updateBusyIndicator){r.setBusyIndicatorDelay(0);r.setBusy(false)}i._setValueInValidation(undefined)})};d.prototype.readODataModel=function(t){var e=this.oSmartField,i,r,a,o,n,s=e._getComputedTextInEditModeSource(),u=e.getControlFactory().getMetaData(),p=d.getPaths(this.oFactory._bTextInDisplayModeValueList?l.ValueList:s,u),c="/"+p.entitySetName,y=u&&u.annotations&&u.annotations.valueListData||null,h=p.keyField,f=p.descriptionField,g=this.oFactory&&this.oFactory.getValueListProvider(),F=y&&y.valueListEntitySetName===p.entitySetName,m=F&&y&&y.outParams?Object.values(y.outParams):[],v=F&&y&&y.fields?y.fields:[],P={success:t.success,error:t.error};if(!f&&(this.oSmartField.getMode()==="display"||!e._isValueListValidationMode())){return Promise.resolve()}this._sTextArrangementLastReadValue=t.value;try{i=this.getAbsolutePathToVLProperty();if(i){r=this.getSelectedEntity(i);if(r){this.clearAbsolutePathToVLProperty();t.success(r);return Promise.resolve()}}}catch(t){return Promise.reject(t)}n=this.getDataForNextDescriptionRequest(t.value);if(n&&n.hasOwnProperty(f)&&g&&g._shouldHaveHistory&&!g._shouldHaveHistory()){t.success(n);return Promise.resolve()}o=this.getAdditionalFiltersData(e,u,n);var V={keyFieldPath:h,aFilterFields:t.filterFields};if(f){V.descriptionFieldPath=f}for(a in o){t.filterFields.push(a)}V.additionalFilters=o;var D=this.getFilters(t.value,V);var x=this.getUrlParameters({keyField:h,descriptionField:f,outParams:m,allFields:v});P.filters=D;P.urlParameters=x;this._mTextArrangementLastReadAdditionalFilters=o;return e._getTextArrangementRead().read(e.getModel(),c,P).then(t.success).catch(t.error)};d.prototype.getSelectedEntity=function(t){return t!==""&&this.oSmartField.getBindingContext().getProperty(t)};d.prototype.clearAbsolutePathToVLProperty=function(){this.sAbsolutePathToVLProperty=""};d.prototype.setAbsolutePathToVLProperty=function(t){this.sAbsolutePathToVLProperty=t};d.prototype.getAbsolutePathToVLProperty=function(){return this.sAbsolutePathToVLProperty};d.prototype.getAdditionalFiltersData=function(t,e,i){var r,a,o,n,s,l={};if(typeof i==="undefined"){i={}}if(e&&e.annotations&&e.annotations.valueListData){a=e.annotations.valueListData.inParams;r=e.annotations.valueListData.constParams}if(r){for(o in r){l[o]=r[o]}}if(a){for(n in a){s=a[n];if(s!==e.annotations.valueListData.keyField){l[s]=i[s]!==undefined?i[s]:t.getBindingContext().getProperty(n)}}}return l};d.prototype._setBindingPath=function(t,e,i,r,a){var o=t.getModel(),s;n(Array.isArray(e)," - "+this.getMetadata().getName());if(o){this.invalidateDescription(i,r,false);if(Array.isArray(e)&&e.length===1){s=o.getKey(e[0])}if(a&&e.length!==1){this.sBindingContextPath="/"+s;this.bindPropertyForValueList(i,r,true)}else if(typeof s==="string"){this.sBindingContextPath="/"+s;this.bindPropertyForValueList(i,r,false,a)}else if(e.length!==1&&i==="text"){this.sBindingContextPath=undefined;this.bindPropertyForValueList(i,r,false)}else if(e.length!==1){this.invalidateDescription(i,r,true)}}};d.prototype.invalidateDescription=function(t,e,i){var r,a=e&&e.getBinding(t),o=a&&a.getType();if(o&&o.isA("sap.ui.comp.smartfield.type.TextArrangement")){r=o.getDescriptionIsInvalid();if(r!==i){o.setDescriptionIsInvalid(i);a.refresh(true)}}};d.prototype.onFetchIDAndDescriptionCollectionSuccess=function(t,e,i){var r,a,o,n,s,d,u,p=this.oSmartField;if(!p){return}o=t.mode||p.getMode();r=e&&Array.isArray(e.results)&&e.results.length===1?e.results[0]:null;a=p&&p.getControlFactory()&&p.getControlFactory().getValueListProvider()||null;n=p._oControl.edit;s=p._oControl.display;d=e&&e.results===undefined?[e]:e.results;if(r&&a){a._calculateAndSetODataModelOutputData(r);if(o==="edit"&&!t.initialRendering&&p._getComputedTextInEditModeSource()!==l.NavigationProperty){a._oHistoryValuesProvider&&a._oHistoryValuesProvider.setFieldData([r])}}if(!t.initialRendering){p.oValidation.handleValueListWarning(d)}if(typeof t.success==="function"){t.success(d)}if(s){this._setBindingPath(p,d,"text",s)}if(n&&p.isTextInEditModeSourceNotNone("edit")){u=p._getComputedTextInEditModeSource()==="ValueListNoValidation";this._setBindingPath(p,d,"value",n,u)}};d.prototype.onFetchIDAndDescriptionCollectionError=function(t,e){if(typeof t.error==="function"){t.error(e)}};d.prototype.bindPropertyForValueList=function(t,e,i,r){var a=this.oSmartField,o={},n,s,d,u=a._getComputedTextInEditModeSource();if(u===l.ValueList||u===l.ValueListNoValidation||this.oFactory._bTextInDisplayModeValueList){s=e&&e.getBindingInfo(t);if(this.oFactory&&s){d=s.type;if((!d||!d.isA("sap.ui.comp.smartfield.type.TextArrangement"))&&this.oFactory._getTextArrangementType){n=this.oFactory._getTextArrangementType();if(n){d=n}}if(d){o={type:d}}o.skipValidation=i;o.bValueListNoValidation=r;e.bindProperty(t,this.getBindingInfo(o))}}};d.prototype.getUrlParameters=function(t){var e=[t.keyField];if(t.descriptionField){e.push(t.descriptionField)}t.outParams.forEach(function(t){if(e.indexOf(t)===-1){e.push(t)}});if(this.oSmartField._getComputedTextInEditModeSource()!==l.NavigationProperty){e=t.allFields.map(function(t){return t.name})}return{$select:e.join(","),$top:2}};d.prototype.getFilters=function(t,e){this.destroyFilters();var i=e.aFilterFields,r;if(Array.isArray(i)&&i.length===1){switch(i[0]){case"keyField":this.oIDFilter=u(t,e);return[this.oIDFilter];case"descriptionField":this.oDescriptionFilter=p(t,e);return[this.oDescriptionFilter]}}this.oIDFilter=u(t,e);r=this._getAdditionalFilters(e);this.oFilters=new a({and:true,filters:[new a({and:false,filters:[this.oIDFilter]})]});if(r.aFilters.length>0){this.oFilters.aFilters.push(r)}return[this.oFilters]};d.prototype.setDataForNextDescriptionRequest=function(t,e){this._mOneTimeDescriptionCache.set(t,e)};d.prototype.getDataForNextDescriptionRequest=function(t){var e=this._mOneTimeDescriptionCache.get(t);this._mOneTimeDescriptionCache.delete(t);return e};function u(t,e){return new a({value1:t,path:e.keyFieldPath,operator:o.EQ})}function p(t,e){return new a({value1:t,path:e.descriptionFieldPath,operator:o.Contains})}d.prototype._getAdditionalFilters=function(t){var e=[],i=this.oSmartField.getControlFactory().getMetaData(),r=i.annotations&&i.annotations.valueListData,o=r&&r.fields;Object.keys(t.additionalFilters).forEach(function(i){var a=t.additionalFilters[i],n=o.find(function(t){return t.name===i}),s=r.aInitialValueIsSignificantFields.indexOf(i)!==-1,l=this._generateFiltersForField(a,i,n,s);if(l){e.push(l)}}.bind(this));return new a({and:true,filters:e})};d.prototype._generateFiltersForField=function(t,e,i,r){if(t===null||t===undefined||t===""){if(r){return this._generateFiltersForEmptyField(e,i&&i.nullable==="false")}}else{return new a({value1:t,path:e,operator:o.EQ})}};d.prototype._generateFiltersForEmptyField=function(t,e){if(e){return new a({value1:"",path:t,operator:o.EQ})}return new a([new a({value1:"",path:t,operator:o.EQ}),new a({value1:null,path:t,operator:o.EQ})],false)};d.prototype.destroyFilters=function(){if(this.oIDFilter){this.oIDFilter.destroy();this.oIDFilter=null}if(this.oDescriptionFilter){this.oDescriptionFilter.destroy();this.oDescriptionFilter=null}if(this.oFilters){this.oFilters.destroy();this.oFilters=null}};d.prototype.destroy=function(){this.oSmartField=null;this.bValidMetadata=false;this.sBindingContextPath="";this.sAbsolutePathToVLProperty="";this._mOneTimeDescriptionCache=null;this._mTextArrangementLastReadAdditionalFilters=null;this.destroyFilters()};return d});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/TextArrangementRead", ["sap/ui/thirdparty/URI"],function(e){"use strict";var t;var r=function(){if(!t){t=this;this.mRequests=new Map;this._iMaxRequests=1e3;if(window.location.search.indexOf("data-sap-ui-xx-disableTextArrangementReadCache=true")!==-1){this.read=function(e,t,r){return this._createReadPromise({model:e,path:t,settings:r})}.bind(this)}}return t};r.prototype.read=function(e,t,r){var s,i={model:e,path:t,settings:r};try{s=this._calculateCacheKey(i)}catch(e){return this._createReadPromise(i)}return this._getPromise(s,i)};r.prototype._getPromise=function(e,t){var r,s;if(this.mRequests.has(e)){r=this.mRequests.get(e);s=this._validateCache(e,r,t);if(s===true){return r.promise}if(s instanceof Promise){return s}}return this._createReadPromise(t,e)};r.prototype._setPromise=function(e,t,r){var s;this.mRequests.set(e,{modelId:r.model.getId(),promise:t});if(this.mRequests.size>this._iMaxRequests){s=this.mRequests.getKeys().next().value;if(s){this.mRequests.delete(s)}}};r.prototype._validateCache=function(e,t,r){if(r&&r.model){if(t.modelId===r.model.getId()){return true}return new Promise(function(s){t.promise.then(function(i){if(i&&Array.isArray(i.results)&&this._probeLocalModelForLoadedData(r,i)){s(t.promise)}else{s(this._createReadPromise(r,e))}}.bind(this))}.bind(this))}return true};r.prototype._probeLocalModelForLoadedData=function(e,t){var r=e.model.getKey(t.results[0]);if(r){return!!e.model.getProperty("/"+r)}return false};r.prototype.exit=function(){this.mRequests.clear()};r.prototype.clearCache=function(){this.mRequests.clear()};r.prototype._createReadPromise=function(e,t){var r=new Promise(function(t,r){e.settings.success=t;e.settings.error=r;e.model.read(e.path,e.settings)}).then(function(e){var r=e&&Array.isArray(e.results)&&e.results.length===1;if(t&&!r){this.mRequests.delete(t)}return e}.bind(this));if(t){this._setPromise(t,r,e)}return r};r.prototype._calculateCacheKey=function(t){var r,s=t.model.sServiceUrl,i=t.model.aUrlParams;if(!s){throw"Can't access service URL. Opt out of value list caching."}s=new e(s).absoluteTo(document.baseURI).pathname().toString();r={path:t.path,service:s,filters:this._flattenFilters(t.settings.filters)};if(Array.isArray(i)&&i.length){r["urlParams"]=i}return JSON.stringify(r)};r.prototype._flattenFilters=function(e){var t=[],r=function(e){if(e.sPath){t.push({p:e.sPath,v:e.oValue1})}if(Array.isArray(e.aFilters)){e.aFilters.forEach(r)}};r(e[0]);return t};return r},false);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/UoMValidateException", ["sap/ui/model/ValidateException"],function(t){"use strict";var e=function(e,i){t.apply(this,arguments)};e.prototype=Object.create(t.prototype);return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap.ui.comp.smartfield.ValidationUtil",["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/library","sap/ui/core/message/Message","sap/ui/core/message/ControlMessageProcessor","sap/ui/model/ValidateException"],function(e,t,s,i,o,r){"use strict";var a=s.smartfield.TextInEditModeSource;var n=function(t){this.oSmartField=t;this.oRB=e.getLibraryResourceBundle("sap.ui.comp")};n.prototype._getPropertyName=function(e){if(e.isA("sap.ui.comp.smartfield.ComboBox")){return"enteredValue"}else if(e.isA("sap.m.ComboBox")){return"selectedKey"}else{return"value"}};n.prototype._createMessage=function(t,s,o){var r=this._getPropertyName(s),a;this._removeMessage();a=new i({message:this.oRB.getText(t),type:o,target:s.getId()+"/"+r,processor:this._getMessageProcessor()});this._oCurrentMessage=a;e.getMessageManager().addMessages(a)};n.prototype._removeMessage=function(){if(this._oCurrentMessage){e.getMessageManager().removeMessages(this._oCurrentMessage);this._oCurrentMessage.destroy();this._oCurrentMessage=null}};n.prototype.handleValueListWarning=function(e){var s=this.oSmartField._oControl.edit;if(s&&this.oSmartField._isValueListWarning()){if(e.length===0){this._createMessage("SMARTFIELD_NOT_FOUND",s,t.MessageType.Warning)}else if(e.length>1){this._createMessage("SMARTFIELD_DUPLICATE_VALUES",s,t.MessageType.Warning)}else{this._removeMessage()}}};n.prototype._getMessageProcessor=function(){var t;if(this._oMessageProcessor){return this._oMessageProcessor}t=new o;e.getMessageManager().registerMessageProcessor(t);this._oMessageProcessor=t;return this._oMessageProcessor};n.prototype.handleComboValidation=function(e){if(!this._isComboBoxValidationWarning()){return}if(e.getEnteredValue()&&!e.getSelectedKey()&&e.getValue()!==""){this._createMessage("SMARTFIELD_NOT_FOUND",e,t.MessageType.Warning)}else{this._removeMessage()}};n.prototype.addValidationToType=function(e){var t;if(!e||!this._isComboBoxValidationStrict()){return}t=e.validateValue;e.validateValue=function(e){var s=this.oSmartField._oControl.edit;if(!s.getSelectedItem()&&s.getValue()){throw new r(this.oRB.getText("SMARTFIELD_NOT_FOUND"))}return t.apply(this,arguments)}.bind(this)};n.prototype._isLegacyMode=function(){var e=this.oSmartField;return e._isFixedValueList()&&e.getFixedValueListValidationEnabled()};n.prototype._isComboBoxValidationStrict=function(){if(this._isLegacyMode()){return false}return this.oSmartField._getComputedTextInEditModeSource()===a.ValueList};n.prototype._isComboBoxValidationWarning=function(){if(this._isLegacyMode()){return false}return this.oSmartField._isValueListWarning()};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/flexibility/ODataV2Delegate", ["sap/ui/model/ListBinding"],function(e){"use strict";var t=true;function n(e){if(e&&e.type){if(e.type.toLowerCase().indexOf("edm")!==0){return true}}return false}function r(e,t){if(!e){return false}var n=e.getBindingInfo(t);var r=n&&n.path;if(!r){return false}return r.indexOf("/")===0}function a(e,t,n){var r;if(t){r=e.getBindingInfo(n);if(typeof r.model==="string"&&r.model!==""){r=undefined}}else{r=e.getBindingContext()}return r}function i(t,n,r,a){var i={name:t.name,bindingPath:t.name,entityType:n.name};var o=t["com.sap.vocabularies.Common.v1.Label"];i.label=o&&o.String;var u=t["com.sap.vocabularies.Common.v1.QuickInfo"];i.tooltip=u&&u.String;var f=t["com.sap.vocabularies.UI.v1.Hidden"];i.hideFromReveal=!!f&&f.Bool==="true";var l;if(!i.hideFromReveal){l=t["com.sap.vocabularies.Common.v1.FieldControl"];if(l&&l.EnumMember){i.hideFromReveal=l.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}else{var m=l&&l.Path;if(m){var p=r.getBinding(a)instanceof e;if(!p){var d=r.getBindingContext().getProperty(m);i.hideFromReveal=d===0}}}}return i}function o(e,t,r,a){var o=e.property.map(function(e){return e["sap:field-control"]}).filter(Boolean);var u=function(e){return!o.includes(e.name)};var f=e.property.map(function(o){var f=i(o,e,r,a);if(n(o)){var l=t.getODataComplexType(o.type);if(l){f.properties=l.property.map(function(t){var n=i(t,e,r,a);n.bindingPath=o.name+"/"+t.name;n.referencedComplexPropertyName=f.label||f.name;return n}).filter(u)}}return f});if(e.navigationProperty){var l=e.navigationProperty.map(function(n){var r=t.getODataAssociationEnd(e,n.name)&&t.getODataAssociationEnd(e,n.name).type;return{name:n.name,entityType:r,bindingPath:n.name,unsupported:true}});f=f.concat(l)}return f.filter(u)}function u(e,t,n){if(n.path){return n.path}var i=r(e,t);var o=a(e,i,t);if(o){return i?o.path:o.getPath()}}function f(e,t){return Promise.resolve().then(function(){var n=e.getModel(t.modelName);if(n){var r=n.getMetadata().getName();if(r==="sap.ui.model.odata.ODataModel"||r==="sap.ui.model.odata.v2.ODataModel"){var a=n.getMetaModel();return a.loaded().then(function(){return a})}}})}function l(e,t){var n=e.getMetaContext(t);return n.getObject()}function m(e,t,n){var r=e.getMetadata().getAggregation();if(r){var a=e.getBindingInfo(r.name);var i=a&&a.template;if(i){var o=e.getBindingPath(r.name);var u=t.getODataAssociationEnd(n,o);var f=u&&u.type;if(f){var l=t.getODataEntityType(f);n=l}}}return n}function p(e,t,n){return f(e,n).then(function(r){var a=[];if(r){var i=u(e,t,n);if(i){var f=l(r,i);f=m(e,r,f);a=o(f,r,e,t)}}return a})}function d(e){return e.modifier.createControl("sap.ui.comp.smartfield.SmartLabel",e.appComponent,e.view,e.labelFor+"-label",{labelFor:e.labelFor},t)}function v(e){return e.modifier.createControl("sap.ui.comp.smartfield.SmartField",e.appComponent,e.view,e.fieldSelector,{value:"{"+e.bindingPath+"}"},t)}var c={};c.getPropertyInfo=function(e){return p(e.element,e.aggregationName,e.payload)};c.createLabel=function(e){return d(e)};c.createControlForProperty=function(e){return v(e).then(function(e){return{control:e,valueHelp:undefined}})};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/flexibility/SmartField.flexibility", ["sap/ui/fl/apply/api/DelegateMediatorAPI"],function(e){"use strict";e.registerDefaultDelegate({modelType:"sap.ui.model.odata.v2.ODataModel",delegate:"sap/ui/comp/smartfield/flexibility/ODataV2Delegate",requiredLibraries:{"sap.ui.comp":{minVersion:"1.81",lazy:false}}});e.registerDefaultDelegate({modelType:"sap.ui.model.odata.ODataModel",delegate:"sap/ui/comp/smartfield/flexibility/ODataV2Delegate",requiredLibraries:{"sap.ui.comp":{minVersion:"1.81",lazy:false}}});return{}},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/AbapBool", ["sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/SimpleType"],function(o,e,t){"use strict";var n=t.extend("sap.ui.comp.smartfield.type.AbapBool",{constructor:function(){t.apply(this,arguments);this.sName="sap.ui.comp.smartfield.type.AbapBool"}});n.prototype.formatValue=function(e,t){if(e===undefined||e===null){return null}switch(t){case"boolean":case"any":return e==="X";default:throw new o("Don't know how to format Boolean to "+t)}};n.prototype.parseValue=function(o,t){switch(t){case"boolean":return o===true?"X":"";default:throw new e("Don't know how to parse Boolean from "+t)}};n.prototype.validateValue=function(o){if(o!==null&&o!==undefined){if(o!=="X"&&o!==""){throw new e("Invalid Boolean "+o)}}};return n});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Byte", ["sap/ui/model/odata/type/Byte"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Byte",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Byte"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Currency", ["sap/ui/core/Core","sap/ui/model/type/Currency","sap/ui/model/odata/type/Currency","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,e,r,i,n){"use strict";var s=/^([-]?)(\d+)(?:\.(\d+))?$/;var o=r.extend("sap.ui.comp.smartfield.type.Currency",{constructor:function(t,e){r.apply(this,[t]);this.oConstraints=e;this.bParseWithValues=true;this.sName="Currency"}});o.prototype.parseValue=function(t,e,i){if(i[1]&&this.shouldConvertUnitToUpperCase(i[1])){arguments[2][1]=arguments[2][1].toUpperCase()}var n=r.prototype.parseValue.apply(this,arguments),s,o,u=Array.isArray(n)&&n[0]&&a(n[0]);if(Array.isArray(u)){s=u[1]+u[2];o=u[3];if(Number.parseInt(o)===0){n[0]=s}}if(n[1]===undefined){n[1]=i[1]}return n};o.prototype.validateValue=function(t){var e,r=t[0],s=t[1],o=r===null,h=0,m=this.oFormatOptions&&this.oFormatOptions.customCurrencies;if(s&&this.shouldConvertUnitToUpperCase(s)){s=s.toUpperCase()}if(this.oConstraints&&this.oConstraints.nullable&&(o||r===this.oFormatOptions.emptyString)){return}if(m&&s&&Object.keys(m).indexOf(s)===-1){throw new n(p("CURRENCY_VALIDATION_FAILS",[s]))}if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}e=a(r);if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}var c=parseInt(e[2]),l=c===0?0:e[2].length,f=(e[3]||"").length,C=this.oConstraints&&this.oConstraints.precision,y=typeof C==="number"?C:Infinity,d=s,U=this.oOutputFormat.oLocaleData.getCurrencyDigits(d),g=this.mCustomUnits&&this.mCustomUnits[d]&&this.mCustomUnits[d].decimals;if(g||g===0){U=g}if(this.oConstraints&&this.oConstraints.variableScale){h=Math.min(y,U)}else{h=Math.min(this.oConstraints&&this.oConstraints.scale||0,U)}if(h>y){h=y}if(f>h){if(h===0){throw new i(u("EnterInt"))}if(l+h>y){throw new i(u("EnterNumberIntegerFraction",[y-h,h]))}throw new i(u("EnterNumberFraction",[h]))}if(l>y-h){throw new i(u("EnterNumberInteger",[y-h]))}};function a(t){return s.exec(t)}function u(e,r){return t.getLibraryResourceBundle().getText(e,r)}function p(e,r){return t.getLibraryResourceBundle("sap.ui.comp").getText(e,r)}o.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Currency"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/DateTime", ["sap/ui/model/odata/type/DateTime"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.DateTime",{constructor:function(e,o){t.apply(this,arguments);this.oFieldControl=null}});e.prototype.parseValue=function(e,o){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,o)}return i};e.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTime"};return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/DateTimeOffset", ["sap/ui/model/odata/type/DateTimeOffset"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.DateTimeOffset",{constructor:function(e,o){t.apply(this,arguments);this.oFieldControl=null}});e.prototype.parseValue=function(e,o){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,o)}return i};e.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTimeOffset"};return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Decimal", ["sap/ui/model/odata/type/Decimal"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Decimal",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Decimal"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Double", ["sap/ui/model/odata/type/Double"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Double",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){o=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return o};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Double"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Guid", ["sap/ui/model/odata/type/Guid","sap/ui/model/ValidateException"],function(t,e){"use strict";var i=/^[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}$/i;function o(t){return sap.ui.getCore().getLibraryResourceBundle(t.resourceBundle).getText(t.text)}function n(t){throw new e(o(t))}var s=t.extend("sap.ui.comp.smartfield.type.Guid",{constructor:function(e,i,o){t.apply(this,arguments);this.oSettings=o;this.oFieldControl=null;this.oValidateExceptionSettings=this.oSettings&&this.oSettings.validateException||{resourceBundle:"",text:"EnterGuid"}}});s.prototype.parseValue=function(e,i){e=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,i)}return e};s.prototype.validateValue=function(t){if(t===null){if(this.oConstraints&&this.oConstraints.nullable===false){n.call(this,this.oValidateExceptionSettings)}return}if(typeof t!=="string"){throw new e("Illegal "+this.getName()+" value: "+t)}if(!i.test(t)){n.call(this,this.oValidateExceptionSettings)}};s.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};s.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Guid"};return s});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int16", ["sap/ui/model/odata/type/Int16"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int16",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int16"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int32", ["sap/ui/model/odata/type/Int32"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int32",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int32"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int64", ["sap/ui/model/odata/type/Int64"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int64",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int64"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/SByte", ["sap/ui/model/odata/type/SByte"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.SByte",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.SByte"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/String", ["sap/ui/model/odata/type/String"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.String",{constructor:function(o,e){t.apply(this,arguments);this.oFormatOptions=o;this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(this.oFormatOptions&&this.oFormatOptions.displayFormat==="UpperCase"&&i&&i.toUpperCase){i=i.toUpperCase()}if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.String"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangement", ["sap/ui/core/Core","sap/ui/model/CompositeType","sap/ui/comp/util/FormatUtil","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/base/util/isPlainObject","sap/base/assert"],function(t,e,i,r,n,s,a){"use strict";var o=e.extend("sap.ui.comp.smartfield.type.TextArrangement",{constructor:function(t,i,r){this.getPrimaryType().call(this,t,i);e.call(this,t,i);this.init(t,i,r);a(r.keyField!==undefined,"Missing value for the keyField. - "+this.getName())},metadata:{abstract:true}});o.prototype.init=function(t,e,i){this.sName="TextArrangement";this.bParseWithValues=true;this.async=true;var r={textArrangement:"idOnly"};var n={onBeforeValidateValue:function(){}};this.oSettings=Object.assign(n,i);this.oFormatOptions=Object.assign(r,t);this.fnParser=this.getValidator({textArrangement:this.oFormatOptions.textArrangement,prefix:"parse"});this.fnValidator=this.getValidator({textArrangement:this.oFormatOptions.textArrangement,prefix:"validate"});this.bValueListNoValidation=i.valueListNoValidation;this.bIsInvalid=false};o.prototype.getSettings=function(){return this.oSettings};o.prototype.parseValue=function(t,e,i){var r,n=this.oFormatOptions.textArrangement;if(typeof t==="string"){t=t.replace(/\u0020+$/,"")}if(t===""||n==="idOnly"){r=this.parseIDOnly(t,e)}else{r=this.fnParser(t,e,i,this.oFormatOptions,this.oSettings)}if(r[0]&&r[0].toUpperCase&&this.oFormatOptions.displayFormat==="UpperCase"){r[0]=r[0].toUpperCase()}return r};o.prototype.parseIDOnly=function(t,e){t=this.getPrimaryType().prototype.parseValue.call(this,t,e);return[t,undefined]};o.prototype.setSelectedValue=function(t){this._sSelectedValue=t};o.prototype._isValueSelected=function(t){return this._sSelectedValue&&this._sSelectedValue===t};o.prototype.parseIDAndDescription=function(t,e,i,r){var n;if(!this._isValueSelected(t)){if(r&&r.textArrangement==="idAndDescription"){n=/^([\S\s]+?)\s\([\S\s]+\)$/.exec(t)}else{n=/^[\S\s]+\s\(([\S\s]+?)\)$/.exec(t)}}this.setSelectedValue("");if(Array.isArray(n)&&n[1]){t=n[1]}return this.parseIDOnly(t,e)};o.prototype.parseDescriptionOnly=function(t,e,i,r,s){return new Promise(function(i,r){if(t===null||t===""){return i([t,""])}if(t&&t.toUpperCase&&this.oFormatOptions.displayFormat==="UpperCase"){t=t.toUpperCase()}function a(a){var o,p=s.keyField,u=s.descriptionField;var d=l(t,{key:u,value:p,data:a});var c=d.length;if(c===1){o=this.getPrimaryType().prototype.parseValue.call(this,d[0],e);i([o,undefined]);return}if(c===0){d=l(t,{key:p,value:u,data:a});c=d.length}if(!this.bValueListNoValidation){if(c===0){r(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return}if(c>1){r(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return}}o=this.getPrimaryType().prototype.parseValue.call(this,t,e);i([o,undefined])}function o(t){r(new n(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var p={filterFields:this.getFilterFields(),success:a.bind(this),error:o.bind(this)};this.onBeforeValidateValue(t,p)}.bind(this))};o.prototype.validateValue=function(t,e){this.validateIDOnly(t);var i=t[0];if(i===null){return}if(this.oFormatOptions.textArrangement==="descriptionOnly"){this.validateDescriptionOnly(t,this.oSettings);return}var r=new Promise(function(r,s){function a(e){var i=Object.assign({},this.oSettings,{data:e,reject:s});var n=this.fnValidator(t,i);if(n){r(t)}}function o(t){s(new n(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var l={filterFields:this.getFilterFields(),success:a.bind(this),error:o.bind(this),bCheckValuesValidity:e};this.onBeforeValidateValue(i,l)}.bind(this));if(this.bValueListNoValidation){return}else{return r}};o.prototype.validateIDOnly=function(t,e){var i=t[0],r,s;this.getPrimaryType().prototype.validateValue.call(this,i);if(this.getSettings().valueList&&e){r=e.data;s=e.reject;if(r.length===0){s(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}if(r.length>1){s(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}}return true};o.prototype.validateIDAndDescription=function(t,e){var i={key:e.keyField,value:e.descriptionField,data:e.data};if(this.oFormatOptions&&this.oFormatOptions.displayFormat){i.displayFormat=this.oFormatOptions.displayFormat}var r=l(t[0],i,this.oConstraints);var s=e.reject;if(!this.bValueListNoValidation){if(r.length===0){s(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}if(r.length>1){s(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}}return true};o.prototype.validateDescriptionOnly=function(t,e){};o.prototype.formatValue=function(t,e){var r;if(!Array.isArray(t)){return t}if(this.bValueListNoValidation&&t[1]===undefined){t.splice(1,1)}r=this.getPrimaryType().prototype.formatValue.call(this,t[0],e);if(r===""||r===null){return r}if(r&&this.oFormatOptions.displayFormat==="UpperCase"){r=r.toUpperCase()}var n=t[1];if(n===""&&this.oFormatOptions.textArrangement!=="idOnly"&&this.oSettings.delegate){this.oSettings.delegate._sTextArrangementLastReadValue=null}if(!n&&this.oFormatOptions.textArrangement==="descriptionOnly"){return r}if(s(n)||this.bIsInvalid){n=""}return i.getFormattedExpressionFromDisplayBehaviour(this.oFormatOptions.textArrangement,r,n)};o.prototype.setDescriptionIsInvalid=function(t){this.bIsInvalid=t};o.prototype.getDescriptionIsInvalid=function(){return this.bIsInvalid};o.prototype.destroy=function(){this.oFormatOptions=null;this.oSettings=null;this.fnParser=null;this.fnValidator=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangement"};o.prototype.onBeforeValidateValue=function(t,e){this.oSettings.onBeforeValidateValue(t,e)};o.prototype.getResourceBundleText=function(e,i){return t.getLibraryResourceBundle("sap.ui.comp").getText(e,i)};o.prototype.getPrimaryType=function(){};o.prototype.getValidator=function(t){switch(t.textArrangement){case"idAndDescription":case"descriptionAndId":return this[t.prefix+"IDAndDescription"];case"descriptionOnly":return this[t.prefix+"DescriptionOnly"];default:return this[t.prefix+"IDOnly"]}};o.prototype.getFilterFields=function(t){return["keyField"]};function l(t,e,i){var r=[];if(e.displayFormat==="UpperCase"){t=t.toLowerCase()}e.data.forEach(function(n,s,a){var o=e.displayFormat==="UpperCase"?n[e.key].toLowerCase():n[e.key],l=i&&i.isDigitSequence&&i.maxLength&&t.lastIndexOf(o)!==-1;if(l||o===t){r.push(n[e.value])}});return r}return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangementGuid", ["sap/ui/comp/smartfield/type/TextArrangement","sap/ui/comp/smartfield/type/Guid","sap/ui/model/ValidateException","sap/base/assert"],function(t,e,i,r){"use strict";var n=t.extend("sap.ui.comp.smartfield.type.TextArrangementGuid");n.prototype.init=function(){t.prototype.init.apply(this,arguments);if(this.oFormatOptions&&this.oFormatOptions.textArrangement==="descriptionOnly"){this.oValidateExceptionSettings={resourceBundle:"sap.ui.comp",text:"ENTER_AN_EXISTING_DESCRIPTION"}}else{this.oValidateExceptionSettings={resourceBundle:"",text:"EnterGuid"}}};n.prototype.parseDescriptionOnly=function(n,s,p,a,u){var l=e.prototype.parseValue.call(this,n,s);if(o(l)){return new Promise(function(t,e){function n(n){if(n.length===1){this.sDescription=n[0][u.descriptionField];t([l,undefined]);return}if(n.length===0){e(new i(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return}r(false,"Duplicate GUID. - "+this.getName())}function o(t){e(new i(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var s={filterFields:this.getFilterFields(l),success:n.bind(this),error:o.bind(this)};this.onBeforeValidateValue(l,s)}.bind(this))}else{n=n.trim();return t.prototype.parseDescriptionOnly.call(this,n,s,p,a,u)}};n.prototype.getFilterFields=function(t){if(this.oFormatOptions.textArrangement==="descriptionOnly"){if(o(t)){return["keyField"]}return["descriptionField"]}return["keyField","descriptionField"]};n.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangementGuid"};n.prototype.getPrimaryType=function(){return e};n.prototype.formatValue=function(e){var i=t.prototype.formatValue.apply(this,arguments);if(this.oFormatOptions.textArrangement==="descriptionOnly"&&i==="00000000-0000-0000-0000-000000000000"){i=""}return i};function o(t){var e=/^[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}$/i;return e.test(t)}return n});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangementString", ["sap/ui/comp/smartfield/type/TextArrangement","sap/ui/comp/smartfield/type/String","sap/ui/model/ValidateException"],function(t,e,r){"use strict";var i=t.extend("sap.ui.comp.smartfield.type.TextArrangementString");i.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangementString"};i.prototype.validateValue=function(e){var i=this.oConstraints||{},n=i.maxLength,a=e[0];if(this.oFormatOptions.textArrangement==="descriptionOnly"&&(a&&a.length>n)){throw new r(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ENTER_A_VALID_VALUE"))}else{return t.prototype.validateValue.apply(this,arguments)}};i.prototype.getPrimaryType=function(){return e};return i});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Time", ["sap/ui/model/odata/type/Time"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Time",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Time"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Unit", ["sap/ui/core/Core","sap/ui/model/odata/type/Unit","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/Byte","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/Double","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,e,i,s,n,a,r,o,p,u,m){"use strict";var l=/^([-]?)(\d+)(?:\.(\d+))?$/;var c=e.extend("sap.ui.comp.smartfield.type.Unit",{constructor:function(t,i){t.decimals=i.scale;e.apply(this,[t,{skipDecimalsValidation:i.skipDecimalsValidation}]);this.oConstraints=i;this.sName="Unit"}});c.prototype.parseValue=function(t,i,s){var n=e.prototype.parseValue.apply(this,arguments),a,r,o=Array.isArray(n)&&n[0]&&h(n[0]);if(Array.isArray(o)){a=o[1]+o[2];r=o[3];if(Number.parseInt(r)===0){n[0]=a}}if(n[1]===undefined&&s){n[1]=s[1]}if(n[1]&&this.shouldConvertUnitToUpperCase(n[1])){n[1]=n[1].toUpperCase()}return n};c.prototype.validateValue=function(t){var i,s=t[0],n=t[1],a=s===null,r=this.oFormatOptions&&this.oFormatOptions.customUnits;if(r&&n&&Object.keys(r).indexOf(n)===-1){throw new m(f("UNIT_VALIDATION_FAILS",[n]))}e.prototype.validateValue.apply(this,arguments);if(this.oConstraints.nullable&&(a||s===this.oFormatOptions.emptyString)){return}i=h(s);if(i===null){throw new u(d("EnterNumber"))}if(this.oConstraints&&this.oConstraints.skipDecimalsValidation){return}y.call(this,this.oConstraints.type,s);var o=parseInt(i[2]),p,l=this.oConstraints&&this.oConstraints.scale,c=l,C=o===0?0:i[2].length,b=(i[3]||"").length,w=this.oConstraints&&this.oConstraints.precision,U=typeof w==="number"?w:Infinity,I=this.mCustomUnits&&this.mCustomUnits[n]&&this.mCustomUnits[n].decimals;if(I||I===0){c=I}if(this.oConstraints&&this.oConstraints.variableScale){p=Math.min(U,c);l=p}else{p=Math.min(l||0,c)}if(p>U){p=U}if(b>p){if(p===0){throw new u(d("EnterInt"))}if(C+p>U){throw new u(d("EnterNumberIntegerFraction",[U-p,p]))}throw new u(d("EnterNumberFraction",[p]))}if(C>U-l){throw new u(d("EnterNumberInteger",[U-l]))}};function h(t){return l.exec(t)}function d(e,i){return t.getLibraryResourceBundle().getText(e,i)}function f(e,i){return t.getLibraryResourceBundle("sap.ui.comp").getText(e,i)}function y(t,e){if(t){var u;switch(t){case"Edm.Double":u=new p({},this.oConstraints);break;case"Edm.Decimal":u=new i({},this.oConstraints);break;case"Edm.Int16":u=new s({},this.oConstraints);break;case"Edm.Int32":u=new n({},this.oConstraints);break;case"Edm.Int64":u=new a({},this.oConstraints);break;case"Edm.Byte":u=new r({},this.oConstraints);break;case"Edm.SByte":u=new o({},this.oConstraints);break}u.validateValue(e)}}c.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};c.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Unit"};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/AdditionalConfigurationHelper", ["sap/ui/comp/library"],function(t){"use strict";var e=function(t,e){this.controlConfiguration=[];this.groupConfiguration=[];this._initialize(t,e)};e.prototype._initialize=function(e,i){var n,o,a,r,l,g,u,p,s,f;if(!e){e=[]}if(!i){i=[]}o=e.length;for(n=0;n<o;n++){r=e[n];l={};l.key=r.getKey();l.groupId=r.getGroupId();l.index=r.getIndex();l.label=r.getLabel();l.isVisible=r.getVisible();l.mandatory=r.getMandatory();l.width=r.getWidth();l.hasValueHelpDialog=r.getHasValueHelpDialog();l.hasTypeAhead=r.getHasTypeAhead();l.controlType=r.getControlType();l.filterType=r.getFilterType();l.customControl=r.getCustomControl();l.visibleInAdvancedArea=r.getVisibleInAdvancedArea();l.preventInitialDataFetchInValueHelpDialog=r.getPreventInitialDataFetchInValueHelpDialog();l.isSetPreventInitialDataFetchInValueHelpDialog=r.isPropertyInitial("preventInitialDataFetchInValueHelpDialog");l.displayBehaviour=r.getDisplayBehaviour();l.defaultFilterValues=[];l.conditionType=r.getConditionType();l.historyEnabled=r.getHistoryEnabled();l.historyEnabledInitial=r.isPropertyInitial("historyEnabled");l.disableNewDateRangeControl=r.getDisableNewDateRangeControl();l.conditionPanelDefaultOperation=!r.isPropertyInitial("conditionPanelDefaultOperation")&&t.valuehelpdialog.ValueHelpRangeOperation[r.getConditionPanelDefaultOperation()]?r.getConditionPanelDefaultOperation():null;l.timezone=r.getTimezone();g=r.getDefaultFilterValues();if(g&&g.length){s=g.length;for(p=0;p<s;p++){u=g[p];f={};f.sign=u.getSign();f.operator=u.getOperator();f.low=u.getLow();f.high=u.getHigh();l.defaultFilterValues.push(f)}}this.controlConfiguration.push(l)}o=i.length;for(n=0;n<o;n++){a=i[n];l={key:a.getKey(),index:a.getIndex(),label:a.getLabel()};this.groupConfiguration.push(l)}};e.prototype.getControlConfigurationByKey=function(t){var e,i;i=this.controlConfiguration.length;for(e=0;e<i;e++){if(this.controlConfiguration[e].key===t){return this.controlConfiguration[e]}}return undefined};e.prototype.getControlConfiguration=function(){return this.controlConfiguration};e.prototype.getGroupConfiguration=function(){return this.groupConfiguration};e.prototype.getGroupConfigurationByKey=function(t){var e,i;i=this.groupConfiguration.length;for(e=0;e<i;e++){if(this.groupConfiguration[e].key===t){return this.groupConfiguration[e]}}return undefined};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/ControlConfiguration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.smartfilterbar.ControlConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},groupId:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},visible:{type:"boolean",group:"Misc",defaultValue:true},hasValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:true},controlType:{type:"sap.ui.comp.smartfilterbar.ControlType",group:"Misc",defaultValue:"auto"},filterType:{type:"sap.ui.comp.smartfilterbar.FilterType",group:"Misc",defaultValue:"auto"},index:{type:"int",group:"Misc",defaultValue:-1},hasTypeAhead:{type:"boolean",group:"Misc",defaultValue:true},mandatory:{type:"sap.ui.comp.smartfilterbar.MandatoryType",group:"Misc",defaultValue:"auto"},width:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false},displayBehaviour:{type:"sap.ui.comp.smartfilterbar.DisplayBehaviour",group:"Misc",defaultValue:"auto"},conditionType:{type:"any",group:"Misc",defaultValue:null},historyEnabled:{type:"boolean",group:"Misc",defaultValue:true},disableNewDateRangeControl:{type:"boolean",group:"Misc",defaultValue:false},conditionPanelDefaultOperation:{type:"sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation",group:"Misc",defaultValue:null},timezone:{type:"string",group:"Misc",defaultValue:null}},aggregations:{defaultFilterValues:{type:"sap.ui.comp.smartfilterbar.SelectOption",multiple:true,singularName:"defaultFilterValue"},customControl:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});a.prototype.setVisible=function(e){this.setProperty("visible",e);this.fireChange({propertyName:"visible"});return this};a.prototype.setLabel=function(e){this.setProperty("label",e);this.fireChange({propertyName:"label"});return this};a.prototype.setVisibleInAdvancedArea=function(e){this.setProperty("visibleInAdvancedArea",e);this.fireChange({propertyName:"visibleInAdvancedArea"});return this};a.FILTERTYPE=e.smartfilterbar.FilterType;a.CONTROLTYPE=e.smartfilterbar.ControlType;a.MANDATORY=e.smartfilterbar.MandatoryType;a.DISPLAYBEHAVIOUR=e.smartfilterbar.DisplayBehaviour;return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/FilterProvider", ["sap/ui/comp/util/DateTimeUtil","sap/m/DateTimePicker","sap/m/Select","sap/ui/core/Item","sap/m/ComboBox","sap/m/DatePicker","sap/m/DateRangeSelection","sap/m/TimePicker","sap/m/Input","sap/m/MultiComboBox","sap/ui/comp/smartfilterbar/SFBMultiInput","sap/ui/comp/smartfilterbar/SortingUtil","sap/m/SearchField","sap/m/Token","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/model/json/JSONModel","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/base/EventProvider","sap/ui/comp/util/IdentifierUtil","sap/ui/comp/providers/TokenParser","sap/ui/core/format/DateFormat","sap/ui/comp/library","sap/ui/core/library","sap/ui/model/analytics/odata4analytics","sap/ui/model/FilterOperator","sap/base/Log","sap/base/util/UriParameters","sap/base/security/encodeURL","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/ui/comp/filterbar/VariantConverterFrom"],function(e,t,i,a,r,n,l,o,s,d,u,f,h,p,m,c,_,g,y,F,D,v,T,V,A,S,C,M,N,P,E,I,B,b,w){"use strict";var x=S.smartfilterbar.ControlType;var O=S.smartfilterbar.DisplayBehaviour;var L=S.smartfilterbar.FilterType;var R=C.ValueState;var k=S.smartfilterbar.MandatoryType;var H=function(e){this._bInitialized=false;this._bPending=true;this._bConsiderAnalyticalParameters=false;this._bAttachInitializedDone=false;this.aFilterAnnotations=[];if(e){this._sSmartContainerId=e.smartContainerId;this._sContext=e.context;this._oParentODataModel=e.model;this._sServiceURL=e.serviceUrl;this._sBasicSearchFieldName=e.basicSearchFieldName;this._isBasicSearchEnabled=e.enableBasicSearch;this._bUseContainsAsDefault=e.useContainsAsDefaultFilter==="true";this.sEntityType=e.entityType;this.sEntitySet=e.entitySet;this._isRunningInValueHelpDialog=e.isRunningInValueHelpDialog;this._oAdditionalConfiguration=e.additionalConfiguration;this.sDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour;this.sDefaultTokenDisplayBehaviour=e.defaultTokenDisplayBehaviour;this.sDefaultSingleFieldDisplayBehaviour=e.defaultSingleFieldDisplayBehaviour;if(typeof e.dateFormatSettings==="string"){try{this._oDateFormatSettings=e.dateFormatSettings?JSON.parse(e.dateFormatSettings):undefined}catch(e){}}else{this._oDateFormatSettings=e.dateFormatSettings}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._oSmartFilter=e.smartFilter;this.filterBarClass=e.filterBarClass;this._bConsiderAnalyticalParameters=e.considerAnalyticalParameters;this._bUseDateRangeType=e.useDateRangeType;this._bConsiderSelectionVariants=e.considerSelectionVariants;this._aConsiderNavigations=e.considerNavigations;this._bSuppressValueListsAssociation=e.suppressValueListsAssociation}this.sFilterModelName=b.FILTER_MODEL_NAME;this._sBasicFilterAreaID=b.BASIC_FILTER_AREA_ID;this._aAnalyticalParameters=[];this._aFilterBarViewMetadata=[];this._oFilterBarViewMetadataExtend={};this._aFilterBarFieldNames=[];this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];this._aFilterBarStringDateFieldNames=[];this._aFilterBarDateFieldNames=[];this._aFilterBarTimeFieldNames=[];this._aFilterBarTimeIntervalFieldNames=[];this._aFilterBarDateTimeMultiValueFieldNames=[];this._aFilterBarStringFieldNames=[];this._aFilterBarDateTimeFieldNames=[];this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=[];this._sSingleInputsTextArrangementData={};this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFieldGroupAnnotation=[];this._oMetadataAnalyser=new m(this._oParentODataModel||this._sServiceURL);this.oModel=new y;this._aValueListProvider=[];this._aValueHelpDialogProvider=[];this._mTokenHandler={};this._mConditionTypeFields={};this._aSelectionVariants=[];this._oParameterization=null;this._oNonAnaParameterization=null;this._aPromises=[]};H._createFilterProvider=function(e){var t=new H(e);return t._intialiseMetadata()};H.prototype._intialiseMetadata=function(){var e,t,i,a,r,n,l,o,s,d,u,f,h;this._aPromises=[];this._aFilterBarViewMetadata.push({groupName:this._sBasicFilterAreaID,index:0,fields:[]});if(!this.sEntitySet&&this.sEntityType){this.sEntitySet=this._oMetadataAnalyser.getEntitySetNameFromEntityTypeName(this.sEntityType)}this.sEntityType=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);n=this._oMetadataAnalyser.getAllFilterableFieldsByEntitySetName(this.sEntitySet,this._bConsiderAnalyticalParameters,this._aConsiderNavigations);this.aAllFields=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);if(n){this._updateDisplayBehaviour();this._aFieldGroupAnnotation=this._oMetadataAnalyser.getFieldGroupsByFilterFacetsAnnotation(this.sEntityType);a=this._oMetadataAnalyser.getSelectionFieldsAnnotation(this.sEntityType);if(a&&a.selectionFields){this._aSelectionFields=a.selectionFields}if(this._aFieldGroupAnnotation){e=this._aFieldGroupAnnotation.length;for(l=0;l<e;l++){r=this._aFieldGroupAnnotation[l];u=this._createGroupMetadata(r);u.index=this._aFilterBarViewMetadata.length;this._aFilterBarViewMetadata.push(u)}}e=n.length;for(l=0;l<e;l++){r=n[l];t=r.fields.length;u=this._createGroupMetadata(r);this._aFilterBarViewMetadata.push(u);for(o=0;o<t;o++){s=r.fields[o];if(s.type.indexOf("Edm.")===0){d=this._createFieldMetadata(s);u.fields.push(d);this._aFilterBarFieldNames.push(d.fieldName)}}i=r.hiddenFields&&r.hiddenFields.length;if(this._isRunningInValueHelpDialog&&i){for(o=0;o<i;o++){s=r.hiddenFields[o];if(s.type.indexOf("Edm.")===0){d=this._createFieldMetadata(s);u.hiddenFields.push(d)}}}}}h=this._getAdditionalConfigurationForCustomGroups(n);e=h.length;for(o=0;o<e;o++){u=this._createGroupMetadataForCustomGroup(h[o]);if(u){this._aFilterBarViewMetadata.push(u)}}f=this._getAdditionalConfigurationForCustomFilterFields();t=f.length;for(o=0;o<t;o++){d=this._createFieldMetadataForCustomFilterFields(f[o]);if(d){this._aFilterBarViewMetadata[0].fields.push(d)}}if(this._hasBasicSearch()){d=this._createBasicSearchFieldMetadata();this._aFilterBarViewMetadata[0].fields.push(d)}if(!this._isRunningInValueHelpDialog){this._createParameters()}return new Promise(function(e){Promise.all(this._aPromises).then(function(){if(this._bConsiderSelectionVariants){this._createSelectionVariants()}this._applyGroupId();this._applyIndexes();this._createInitialModel(true);this._initializeConditionTypeFields();this.setPending(this.isPending());this._bInitialized=true;e(this)}.bind(this))}.bind(this))};H.prototype._createSelectionVariants=function(){this._aSelectionVariants=this._oMetadataAnalyser.getSelectionVariantAnnotationList(this.sEntityType)};H.prototype._createParameters=function(){if(this._oMetadataAnalyser.isSemanticAggregation(this.sEntityType)){if(this._bConsiderAnalyticalParameters){var e=sap.ui.require("sap/ui/model/analytics/odata4analytics");if(e){this._createAnalyticalParameters(e)}else{var t=new Promise(function(e){sap.ui.require(["sap/ui/model/analytics/odata4analytics"],function(t){this._createAnalyticalParameters(t);e()}.bind(this))}.bind(this));this._aPromises.push(t)}}}else{this._createNonAnalyticalParameters()}};H.prototype._createAnalyticalParameters=function(e){this._oParameterization=this._getAnalyticParameterization(e);this._createAnalyticParameters(this._oParameterization)};H.prototype._getAnalyticParameterization=function(e){var t,i;try{t=new e.Model(new e.Model.ReferenceByModel(this._oParentODataModel))}catch(e){throw"Failed to instantiate analytical extensions for given OData model: "+e.message}i=t&&t.findQueryResultByName(this.sEntitySet);return i&&i.getParameterization()};H.prototype._createNonAnalyticalParameters=function(){if(this.sEntitySet){this._oNonAnaParameterization=this._oMetadataAnalyser.getParametersByEntitySetName(this.sEntitySet);if(this._oNonAnaParameterization){this._createParametersByEntitySetName(this._oNonAnaParameterization.entitySetName,this._oNonAnaParameterization.parameters)}}};H.prototype.attachPendingChange=function(e){this._attachEvent("PendingChange",e)};H.prototype.detachPendingChange=function(e){this._detachEvent("PendingChange",e)};H.prototype.setPending=function(e){var t=this._bPending!==e;this._bPending=e;if(t){var i={};i.pending=e;this._fireEvent("PendingChange",i)}};H.prototype.isPending=function(){if(!this._bInitialized){return true}for(var e in this._mConditionTypeFields){if(this._mConditionTypeFields[e].conditionType.isPending()){return true}}return false};H.prototype._updateDisplayBehaviour=function(){this._sTextArrangementDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this.sEntityType);if(!this.sDefaultDropDownDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultDropDownDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultDropDownDisplayBehaviour=O.descriptionOnly}}if(!this.sDefaultTokenDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultTokenDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultTokenDisplayBehaviour=O.descriptionAndId}}if(!this.sDefaultSingleFieldDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultSingleFieldDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultSingleFieldDisplayBehaviour=O.descriptionAndId}}};H.prototype._hasBasicSearch=function(){return this._isBasicSearchEnabled};H.prototype._getAdditionalConfigurationForCustomFilterFields=function(){var e,t,i,a;if(!this._oAdditionalConfiguration){return[]}e=this._oAdditionalConfiguration.getControlConfiguration();if(!this._aFilterBarFieldNames||!this._aFilterBarFieldNames.length){return e}a=[];t=e.length;for(i=0;i<t;i++){if(this._aFilterBarFieldNames.indexOf(e[i].key)<0){a.push(e[i])}}return a};H.prototype._getAdditionalConfigurationForCustomGroups=function(e){var t,i,a,r,n,l,o,s;if(!this._oAdditionalConfiguration){return[]}t=this._oAdditionalConfiguration.getGroupConfiguration();if(!e||!e.length){return t}n=[];a=e.length;i=t.length;for(r=0;r<i;r++){o=false;for(l=0;l<a;l++){s=e[l].groupName||e[l].groupEntitySetName;if(s===t[r].key){o=true;break}}if(!o){n.push(t[r])}}return n};H.prototype._createInitialModelForField=function(e,t,i){var a=false,r,n,l=false,o=false,s=null,d=null,u,f=null,h=[],p=[];if(!t||t.isCustomFilterField){return}if(t.filterRestriction!==L.multiple){o=true}if((t.filterType==="date"||t.filterType==="time"||t.filterType==="datetime")&&!t.isFiscalDate){a=true}if(i){r=t.defaultFilterValues;l=r&&r.length;if(!l){if(t.defaultPropertyValue&&t.isParameter){n=t.defaultPropertyValue;if(t.filterType==="numeric"){n=this._getType(t).parseValue(n,"string")}r=[{low:n}];l=true}else if(t.defaultFilterValue){n=t.defaultFilterValue;r=[{low:n,high:n,operator:"EQ",sign:"I"}];l=true}}}var m=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(t.fieldName):null;if(t.hasFixedValues||m&&m.controlType===x.dropDownList){this._aFilterBarDropdownFieldMetadata.push(t)}if(t.filterRestriction===L.single&&!this._isSingleDynamicDateEnabled(t)){if(l){n=r[0];s=a?this._createDateTimeValue(t,n.low):n.low}if(t.type==="Edm.String"&&t.hasValueListAnnotation&&!t.hasFixedValues&&t.controlType!=="dropDownList"){this._aFilterBarSingleValueWithValueListFieldMetadata.push(t);if(!l&&t.control){t.control.setValue("")}}e[t.fieldName]=s}else if(t.filterRestriction===L.interval&&t.type!=="Edm.Time"){if(l){n=r[0];s=a?this._createDateTimeValue(t,n.low):n.low;d=a?this._createDateTimeValue(t,n.high):n.high}e[t.fieldName]={low:s,high:d}}else{if(l){u=r.length;while(u--){n=r[u];if(o){f={exclude:n.sign==="E",operation:n.operator==="CP"?"Contains":n.operator,keyField:t.fieldName,value1:a?this._createDateTimeValue(t,n.low):n.low,value2:a?null:n.high};if(t.filterType==="time"&&n.high){f.value2=new Date(n.high)}}else{f={key:a?this._createDateTimeValue(t,n.low):n.low,text:a?"":n.low}}h.push(f)}}this._aFilterBarMultiValueFieldMetadata.push(t);e[t.fieldName]={value:null};if(o){p=h.slice(0);h=[];e[t.fieldName].ranges=p}e[t.fieldName].items=h;this._updateMultiValueControl(t.control,h,p)}};H.prototype._createDateTimeValue=function(e,t){switch(e.type){case"Edm.Time":if(t.indexOf("PT")===0){return this._getTime(t)}else{P.error("Default value for "+e.fieldName+" could not be parsed.")}break;case"Edm.DateTime":if(typeof t=="string"&&e.displayFormat&&e.displayFormat.toLowerCase()=="date"){var i=t.split("T");t=i[0]+"T00:00:00";return new Date(t)}else{P.error("Default value for "+e.fieldName+" could not be parsed.")}break;case"Edm.DateTimeOffset":return new Date(t);default:P.error("Default value for "+e.fieldName+" could not be parsed.")}};H.prototype._createInitialModel=function(e){var t,i,a,r,n,l,o,s;t={};this._bCreatingInitialModel=true;this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];if(this._aFilterBarViewMetadata){i=this._aFilterBarViewMetadata.length;for(o=0;o<i;o++){n=this._aFilterBarViewMetadata[o];a=n.fields.length;for(l=0;l<a;l++){this._createInitialModelForField(t,n.fields[l],e)}r=n.hiddenFields&&n.hiddenFields.length;if(this._isRunningInValueHelpDialog&&r){for(l=0;l<r;l++){this._createInitialModelForField(t,n.hiddenFields[l],e)}}}}if(this._aCustomFieldMetadata){for(s=0;s<this._aCustomFieldMetadata.length;s++){this._createInitialModelForField(t,this._aCustomFieldMetadata[s],false)}}if(this._aAnalyticalParameters){a=this._aAnalyticalParameters.length;for(l=0;l<a;l++){this._createInitialModelForField(t,this._aAnalyticalParameters[l],e)}}this.oModel.setData(t);if(!e){this._clearConditionTypeFields()}this._updateConditionTypeFields();this._bCreatingInitialModel=false};H.prototype._updateMultiValueControl=function(t,i,a,r){var n=0,l=null,o=null,s=null,f=null,h=null,m,c,_,g;if(t&&i){n=i.length;if(t instanceof u){l=[];while(n--){f=i[n].text||i[n].key;var o=new p;o.setKey(i[n].key);o.setText(f);o.setTooltip(f);l.push(o)}if(a){n=a.length;while(n--){s=a[n];if((s.value1===""||s.value1===null)&&s.operation===N.EQ){g=w.convertOption(s.operation,s.value1);s.operation=g.op;s.tokenText=D.getFormattedRangeText(s.operation,null,null,s.exclude);s.value1=g.v}if(s.tokenText){f=s.tokenText}else{m=s.value1;c=s.value2;if(r){var y=true;var F=["date","datetime","time"];if(F.indexOf(r.filterType)>-1){_=this._getType(r);if(_){if(m){if(r.filterType==="time"){m=e.dateToEdmTime(e.localToUtc(m))}m=_.formatValue(m,"string",y)}if(c){if(r.filterType==="time"){c=e.dateToEdmTime(e.localToUtc(c))}c=_.formatValue(c,"string",y)}}}else if(r.filterType==="numeric"){_=this._getType(r);if(_){if(m!==""&&m!==undefined){if(typeof m==="string"&&!isNaN(m)){m=parseFloat(m);s.value1=m}m=_.formatValue(m,"string")}if(c!==""&&c!==undefined){if(typeof c==="string"&&!isNaN(c)){c=parseFloat(c);s.value2=c}c=_.formatValue(c,"string")}}}else if(r.filterType==="boolean"){_=this._getType(r);if(_){if(m!==""&&m!==undefined&&m==="false"){m=_.formatValue(false,"string")}else{m=_.formatValue(m,"string")}if(c!==""&&c!==undefined&&c==="false"){c=_.formatValue(false,"string")}else{c=_.formatValue(m,"string")}}}else{var v=r.isCalendarDate||r.isFiscalDate||(m instanceof Date||c instanceof Date);if(v){_=this._getType(r);if(m){m=_.formatValue(m,"string")}if(c){c=_.formatValue(c,"string")}}}}f=D.getFormattedRangeText(s.operation,m,c,s.exclude)}o=new p;o.setText(f);o.setTooltip(f);o.data("range",s);l.push(o)}}t.setTokens(l);t.fireTokenUpdate()}if(t instanceof d){h=[];while(n--){h.push(i[n].key)}t.setSelectedKeys(h)}}};H.prototype._updateSingleValueControl=function(e){var t=e.control,i=e.fieldName,a=e.displayBehaviour||this.sDefaultSingleFieldDisplayBehaviour,r=this.oModel.getData(),n=r[i],l=n,o=this._getSingleInputsTextArrangementData(i);if(o&&o.key===n){l=D.getFormattedExpressionFromDisplayBehaviour(a,o.key,o.text);delete this._oNotValidatedSingleFields[i]}t.setValue(l);if(n&&n===l){this._oSingleFieldSetFromFilterData[i]=true;var s=this._aValueListProvider.find(function(e){return e.sFieldName===i});if(s&&s.bInitialised){s._validateInput(n);delete this._oNotValidatedSingleFields[i]}else{this._oNotValidatedSingleFields[i]=n}}};H.prototype._applyIndexes=function(){if(!this._aFilterBarViewMetadata){return}this._aFilterBarViewMetadata=f.groupSorting(this._aFilterBarViewMetadata)};H.prototype._applyGroupId=function(){var e=Array.isArray(this._aFilterBarViewMetadata)?this._aFilterBarViewMetadata.length:0,t,i,a,r,n,l;for(r=0;r<e;r++){if(!this._aFilterBarViewMetadata[r].fields){continue}t=this._aFilterBarViewMetadata[r].fields.length;for(n=0;n<t;n++){a=this._aFilterBarViewMetadata[r].fields[n];if(a&&a.groupId&&a.groupId!==this._aFilterBarViewMetadata[r].groupName){i=undefined;for(l=0;l<e;l++){if(this._aFilterBarViewMetadata[l].groupName===a.groupId){i=this._aFilterBarViewMetadata[l];break}}if(i){this._aFilterBarViewMetadata[r].fields.splice(n,1);n--;t--;i.fields=i.fields||[];i.fields.push(a)}}}}};H.prototype._createFilterControlId=function(e){var t=this._oSmartFilter?this._oSmartFilter.getId():"FilterPanel";var i=T.replace(e.groupId||"");var a=T.replace(e.fieldName);var r=e.customColumnKey&&T.replace(e.customColumnKey);if(r){a+=r}if(this._sSmartContainerId){a=this._sSmartContainerId+"-"+a}return t+"-filterItemControl"+i+"-"+a};H.prototype._createGroupMetadata=function(e){var t,i=null,a;a=e.groupName||e.groupEntitySetName;if(this._oAdditionalConfiguration){i=this._oAdditionalConfiguration.getGroupConfigurationByKey(a)}t={};t.groupName=a;t.groupLabel=this._getGroupLabel(e,i);t.fields=[];t.hiddenFields=[];t.index=this._getGroupIndex(i);return t};H.prototype._createGroupMetadataForCustomGroup=function(e){var t;t={};t.groupName=e.key;t.groupLabel=e.label;t.fields=[];t.index=this._getGroupIndex(e);return t};H.prototype._getTime=function(e){var t=A.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};H.prototype._checkMetadataDefaultValue=function(e){var t=e.defaultFilterValue||e.defaultPropertyValue;if(t){try{if(e.type==="Edm.Time"&&t.indexOf("PT")===0){this._getTime(t)}else{this._getType(e)}}catch(t){e.defaultPropertyValue=null;e.defaultFilterValue=null;P.error("default value for "+e.fieldName+" could not be parsed.")}}};H.prototype._getType=function(e){var t,i={},a={},r={};if(e.ui5Type){return e.ui5Type}if(e.precision||e.scale){a.precision=e.precision;a.scale=e.scale}if(e.maxLength){a.maxLength=e.maxLength}if(e.displayFormat){a.displayFormat=e.displayFormat}if(e.isDigitSequence){a.isDigitSequence=e.isDigitSequence}if(e.isCalendarDate){r.isCalendarDate=true}if(e.isFiscalDate&&e.fiscalType){r.isFiscalDate=true;r.fiscalType=e.fiscalType}if(e.filterType==="date"||e.filterType==="time"||e.filterType==="datetime"||e.isCalendarDate){i=Object.assign({},this._oDateFormatSettings,{UTC:false})}t=F.getType(e.type,i,a,r);return t};H.prototype._setControlDisplayFormat=function(e,t){var i;if(!t){return}i=t.style||t.pattern;if(!i){return}e.setDisplayFormat(i)};H.prototype._createControl=function(e){var f,h,p=false,m,c,_=e.type!=="Edm.String"||e.isFiscalDate||e.isDigitSequence;if(e.customControl){return e.customControl}h=this._getType(e);f=new e.fControlConstructor(this._createFilterControlId(e));if(e.fControlConstructor===l){this._setControlDisplayFormat(f,this._oDateFormatSettings);if(e.isCalendarDate){f.bindProperty("dateValue",{path:this.sFilterModelName+">/"+e.fieldName+"/low",type:h});f.bindProperty("secondDateValue",{path:this.sFilterModelName+">/"+e.fieldName+"/high",type:h})}else{f.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName+"/low");f.bindProperty("secondDateValue",this.sFilterModelName+">/"+e.fieldName+"/high")}}else if(e.fControlConstructor===r||e.fControlConstructor===i){if(f.setForceSelection){f.setForceSelection(true)}if(e.fControlConstructor===i){f.addItem(new a({key:"",text:""}));f.addItem(new a({key:false,text:h.formatValue(false,"string")}));f.addItem(new a({key:true,text:h.formatValue(true,"string")}))}else{this._associateValueList(f,"items",e,false,this._getSuppressValueListsAssociation());f.attachSelectionChange(function(){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}f.fireChange({filterChangeReason:e.fieldName,value:""})}.bind(this))}f.bindProperty("selectedKey",this.sFilterModelName+">/"+e.fieldName)}else if(e.fControlConstructor===d){this._associateValueList(f,"items",e,false,this._getSuppressValueListsAssociation());f.attachSelectionChange(function(t){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}var i=t.getSource(),a=null,r=[],n;a=i.getSelectedItems();if(a){n=a.length;while(n--){r.push({key:a[n].getKey(),text:a[n].getText()})}}if(this.oModel){this.oModel.setProperty("/"+e.fieldName+"/items",r)}i.fireChange({filterChangeReason:e.fieldName,value:""})}.bind(this));f.bindProperty("value",this.sFilterModelName+">/"+e.fieldName+"/value")}else if(e.fControlConstructor===u){if(e.controlType===x.date||e.type==="Edm.Time"||e.type==="Edm.DateTimeOffset"){f.setValueHelpOnly(true);if(e.filterRestriction===L.interval){this._associateValueHelpDialog(f,e,false,false)}else{this._associateValueHelpDialog(f,e,true,true)}}else{if(e.hasValueHelpDialog){this._associateValueHelpDialog(f,e,e.filterRestriction!==L.multiple,true)}else{f.setShowValueHelp(false)}f.bindProperty("value",{path:this.sFilterModelName+">/"+e.fieldName+"/value",type:h})}this._handleMultiInput(f,e,h)}else if(e.fControlConstructor===s){if(e.filterRestriction===L.interval){p=true;f.bindProperty("value",this.sFilterModelName+">/"+e.fieldName+"/low");if(!this.oResourceBundle){this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}if(!this.sIntervalPlaceholder){this.sIntervalPlaceholder=this.oResourceBundle.getText("INTERVAL_PLACEHOLDER_TEXT")}f.setPlaceholder(this.sIntervalPlaceholder)}else if(e.hasValueListAnnotation){f.attachChange(function(t){var i=t.getParameter("value");f.__sValidationText="";if(!i){this.oModel.setProperty("/"+e.fieldName,"")}}.bind(this))}else{f.bindProperty("value",{path:this.sFilterModelName+">/"+e.fieldName,type:h})}if(e.hasValueHelpDialog){f.setShowValueHelp(true);if(p&&_){f.setValueHelpOnly(true)}this._associateValueHelpDialog(f,e,false,false)}}else if(e.isCalendarDate){this._setControlDisplayFormat(f,this._oDateFormatSettings);f.bindProperty("dateValue",{path:this.sFilterModelName+">/"+e.fieldName,type:h})}else if(e.fControlConstructor===n){f.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName);this._setControlDisplayFormat(f,this._oDateFormatSettings)}else if(e.fControlConstructor===o||e.fControlConstructor===t){f.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName);if(this._oDateFormatSettings&&this._oDateFormatSettings.style){f.setDisplayFormat(this._oDateFormatSettings.style)}}if(f instanceof n){f.attachChange(function(e){var t=e.getParameter("valid");f.data("__mandatoryEmpty",null);if(t){f.setValueState(R.None);f.setValueStateText()}else{var i=f._parseValue(e.getParameter("newValue")),a=this._getSelectedDateRange(i);f.setValueState(R.Error);if(a[0]&&a[1]){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),n=this._getDateFieldOutOfRangeErrorText(f,a,h,r);f.setValueStateText(n)}else if(h){try{h.parseValue("foo","string")}catch(e){f.setValueStateText(e.message)}}}}.bind(this))}if(e.hasTypeAhead){if(e.hasValueListAnnotation){f.setShowSuggestion(true)}f.setFilterSuggests(false);this._associateValueList(f,"suggestionRows",e,true,this._getSuppressValueListsAssociation())}if(e.displayFormat==="UpperCase"&&e.controlType!==x.dropDownList&&f.attachChange&&f.getValue&&f.setValue){f.attachChange(function(t){var i=f.getValue();if(i&&e.filterRestriction!=="single"){f.setValue(i.toUpperCase())}});if(this._mTokenHandler[f.getId()]&&this._mTokenHandler[f.getId()].parser){var g=this._mTokenHandler[f.getId()].parser;g.getKeyFields()[0].displayFormat=e.displayFormat}}if(f instanceof s){if(e.maxLength){m=parseInt(e.maxLength);if(!isNaN(m)){if(this._mTokenHandler[f.getId()]&&this._mTokenHandler[f.getId()].parser){var g=this._mTokenHandler[f.getId()].parser;g.getKeyFields()[0].maxLength=m}else{if(!e.hasValueListAnnotation&&!p){f.setMaxLength(m)}}}}if(e.isFiscalDate){f.setPlaceholder(h.formatter.getPattern())}var y=e.filterRestriction==="auto"||e.filterRestriction==="multi-value"||e.filterRestriction==="multiple";if(e.type==="Edm.String"&&y&&(this._oSmartFilter&&!this._oSmartFilter.getDisableSearchMatchesPatternWarning())){f.attachLiveChange(this._oSmartFilter._onLiveChangeValidateSymbols.bind(this._oSmartFilter))}}c=function(e){var t=e.getParameter("exception");var i=e.getParameter("element");if(f&&i&&f.getId()===i.getId()){if(t){if(f.setValueStateText){f.setValueStateText(t.message)}}if(f.setValueState){f.setValueState(R.Error)}f.data("__mandatoryEmpty",null)}};f.attachParseError(c);f.attachFormatError(c);f.attachValidationError(c);f.attachValidationSuccess(function(e){var t=e.getParameter("element");if(f&&t&&f.getId()===t.getId()){if(f.setValueState){f.setValueState(R.None)}if(f.setValueStateText){f.setValueStateText()}f.data("__mandatoryEmpty",null);delete f.__sValidationText}});return f};H.prototype._getControlConstructor=function(e,a){var f=s,h,p,m;m=a?a+e.fieldName:e.fieldName;if(e.isCustomFilterField){f=undefined}else{h=e.filterRestriction===L.single;p=e.filterRestriction===L.interval;if(e.controlType===x.date){if(h&&!this._isSingleDynamicDateEnabled(e)){f=n}else{f=p?l:u}if(e.isCalendarDate){this._aFilterBarStringDateFieldNames.push(m)}else{this._aFilterBarDateFieldNames.push(m)}if(e.filterRestriction===L.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(m)}}else if(e.controlType===x.dropDownList){if(h){f=this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)?i:r}else{f=d}if(!h){e.filterRestriction=L.multiple}}else if(e.type==="Edm.Time"){if(h){f=o}else{f=u}this._aFilterBarTimeFieldNames.push(m);if(p){this._aFilterBarTimeIntervalFieldNames.push(m)}else if(e.filterRestriction===L.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(m)}}else if(!p&&e.controlType===x.dateTimePicker){if(h){f=t}else{f=u}this._aFilterBarDateTimeFieldNames.push(m);if(e.filterRestriction===L.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(m)}}else if(p&&e.type==="Edm.DateTimeOffset"){var c=this._getFilterTimeZone(m);if(c){var _={key:m,value:c};this._aFilterBarDateTimeOffsetWithTimezoneFieldNames.push(_)}this._aFilterBarDateTimeFieldNames.push(m)}else if(!h&&!p){f=u}}return f};H.prototype._handleTokenUpdate=function(e,t){this._tokenUpdate({control:t.control,fieldViewMetadata:t.fieldViewMetadata,removedTokens:e&&e.getParameter("removedTokens")})};H.prototype._tokenUpdate=function(t){var i=t.removedTokens,a=t.control,r=t.fieldViewMetadata,n,l=[],o,s,d,u=[],f="/"+r.fieldName;if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}n=a.getTokens();if(i){n=n.filter(function(e){return i.indexOf(e)===-1})}if(Array.isArray(n)&&n.length>0){o=n.length;while(o--){s=n[o];d=s.data("range");if(d){d.tokenText=s.getText();if(r.customColumnKey){d.customColumnKey=r.customColumnKey}if(d&&s.getKey().indexOf("range_")===0){if(r.type==="Edm.Time"){if(d.value1&&(d.value1.ms||d.value1.ms===0)){d.value1=e.utcToLocal(e.edmTimeToDate(d.value1))}if(d.value2&&(d.value2.ms||d.value2.ms===0)){d.value2=e.utcToLocal(e.edmTimeToDate(d.value2))}}}u.push(d)}else{l.push({key:s.getKey(),text:s.getText()})}}}if(this.oModel){this.oModel.setProperty(f+"/items",l);this.oModel.setProperty(f+"/ranges",u)}if(a.__bValidatingToken){delete a.__bValidatingToken}if(!a._pendingAutoTokenGeneration){a.fireChange({filterChangeReason:r.fieldName,value:""})}};H.prototype._handleMultiInput=function(e,t,i){e._setFilterProvider(this);e._setFieldViewMetadata(t);e.attachTokenUpdate({control:e,fieldViewMetadata:t},this._handleTokenUpdate,this);var a,r=t.type==="Edm.DateTime"&&t.displayFormat==="Date";if(t.hasValueListAnnotation||t.type==="Edm.String"||r){e.attachEvent("_validateOnPaste",function(n){var l=n.getParameter("texts"),o,s,d,u,f;s=l?l.length:0;if(s>1){n.preventDefault();o=this.oModel.getProperty("/"+t.fieldName);f=o.ranges||[];e.setValue("");while(s--){d=l[s];if(d){u=null;if(r){a=this._getDateValue(d,i);if(isNaN(a.getDate())){continue}else{u=d;d=a}}var h=V._createRangeByText(d);f.push(Object.assign({keyField:t.fieldName,tokenText:u,value1:d,value2:null},h))}}this.oModel.setProperty("/"+t.fieldName+"/ranges",f);this._updateMultiValueControl(e,o.items,f,t)}}.bind(this))}};H.prototype._associateValueHelpDialog=function(e,t,i,a){var r=t.visibleInAdvancedArea||t.groupId===b.BASIC_FILTER_AREA_ID;if(this._getSuppressValueListsAssociation()&&r){this._attachEventOnce(b.ASSOCIATE_VALUE_LISTS,function(){this._associateValueHelpDialogHandler(e,t,i,a)}.bind(this))}else{this._associateValueHelpDialogHandler(e,t,i,a)}};H.prototype._associateValueHelpDialogHandler=function(e,t,i,a){var r,n,l={fieldName:t.fieldName,control:e,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,dateFormatSettings:this._oDateFormatSettings,fieldViewMetadata:t,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:t.hasValueListAnnotation,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,preventInitialDataFetchInValueHelpDialog:t.preventInitialDataFetchInValueHelpDialog,supportMultiSelect:a,supportRanges:i,isSingleIntervalRange:t.filterRestriction===L.interval,isSearchExpressionFilterRestriction:t.filterRestriction===L.searchExpression,isUnrestrictedFilter:t.filterRestriction!==L.multiple,type:t.filterType,maxLength:t.maxLength,scale:t.scale,precision:t.precision,context:"SmartFilterBar",filterBarClass:this.filterBarClass,defaultOperation:t.conditionPanelDefaultOperation,_onBeforeOpenValueHelpDialog:function(e){if(this._oSmartFilter){this._oSmartFilter.fireEvent("_beforeOpenVHD",e)}}.bind(this)};if(l.isSearchExpressionFilterRestriction){n={defaultOperation:m._getSearchExpressionTypeOperations().string[0],typeOperations:m._getSearchExpressionTypeOperations(),rangeOperationsKeys:m._getSearchExpressionRangeOperationsKeys()}}if(t.isCalendarDate){l.oType=this._getType(t)}var o=new _(l);o.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(t.visibleInAdvancedArea||t.groupId===b.BASIC_FILTER_AREA_ID){this.aFilterAnnotations.push(o.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(t,e)}.bind(this)))}this._aValueHelpDialogProvider.push(o);if(i&&e.addValidator){r=new V(n);r.addKeyField({key:t.fieldName,label:t.label,type:t.filterType,oType:t.ui5Type});if(t.filterType==="numeric"){r.setDefaultOperation("EQ")}r.associateInput(e);this._mTokenHandler[e.getId()]={parser:r}}};H.prototype._determineFieldLabel=function(e){var t,i=e.label;if(this._oSmartFilter&&this._oSmartFilter.determineFilterItemByName){t=this._oSmartFilter.determineFilterItemByName(e.name,e.groupName);if(t){i=t.getLabel()}}return i};H.prototype._associateValueList=function(e,t,i,a,r){var n=i.visibleInAdvancedArea||i.groupId===b.BASIC_FILTER_AREA_ID,l={control:e,aggregation:t,fieldViewMetadata:i,hasTypeAhead:a,annotaionIsToBeLoaded:n};if(r&&n){this._attachEventOnce(b.ASSOCIATE_VALUE_LISTS,function(){this._associateValueListHandler(l)}.bind(this))}else{this._associateValueListHandler(l)}};H.prototype._associateValueListHandler=function(e){var t,i=e.control,a=e.aggregation,r=e.fieldViewMetadata,n=e.hasTypeAhead,l=e.annotaionIsToBeLoaded;if(this._oSmartFilter&&!this._bAttachInitializedDone&&E.fromQuery(window.location.search).get("sap-ui-comp-filterbar-data-defer")){var o=this._oParentODataModel;this._sDeferredGroupId="sapUiCompFilterBarData";var s=o.getDeferredGroups?this._oParentODataModel.getDeferredGroups():null;if(s!==null){s.push(this._sDeferredGroupId);o.setDeferredGroups(s);var d=function(){o.submitChanges({groupId:this._sDeferredGroupId});var e=o.getDeferredGroups().filter(function(e){return e!==this._sDeferredGroupId}.bind(this));o.setDeferredGroups(e);delete this._sDeferredGroupId;this._oSmartFilter.detachInitialized(d)}.bind(this);this._oSmartFilter.attachInitialized(d);this._bAttachInitializedDone=true}}if(r.hasValueListAnnotation){t=new g({fieldName:r.fieldName,control:i,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,displayFormat:r.displayFormat,dateFormatSettings:this._oDateFormatSettings,fieldViewMetadata:r,displayBehaviour:r.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:r.fullName,metadataAnalyser:this._oMetadataAnalyser,type:r.filterType,aggregation:a,typeAheadEnabled:n,enableShowTableSuggestionValueHelp:r.hasValueHelpDialog,deferredGroupId:this._sDeferredGroupId,context:this._sContext?this._sContext:"SmartFilterBar",fieldHistoryEnabled:r.historyEnabled!==undefined?r.historyEnabled:true,fieldHistoryEnabledInitial:r.historyEnabledInitial!==undefined?r.historyEnabledInitial:true});t.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(l){this.aFilterAnnotations.push(t.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(r,e)}.bind(this)))}this._aValueListProvider.push(t)}else if(this._mTokenHandler[i.getId()]&&this._mTokenHandler[i.getId()].parser&&r.filterRestriction!=="searchExpression"){this._mTokenHandler[i.getId()].parser.setDefaultOperation("EQ")}};H.prototype._createAnalyticParameters=function(e){var t,i;if(e){i=e.getAllParameterNames();t=e.getEntitySet();if(t){this._createParametersByEntitySetName(t.getQName(),i)}}};H.prototype._createParametersByEntitySetName=function(e,t){var i,a=this._oMetadataAnalyser.getFieldsByEntitySetName(e);for(var r=0;r<a.length;r++){if(t.indexOf(a[r].name)>=0){i=this._createAnalyticParameterMetadata(a[r]);if(i&&i.visible){if(this._oNonAnaParameterization&&i.isCustomFilterField){continue}this._aAnalyticalParameters.push(i)}}}};H.prototype._createAnalyticParameterMetadata=function(e){var t,i=S.ANALYTICAL_PARAMETER_PREFIX,a=function(e){return e.type==="Edm.String"&&e["sap:parameter"]==="optional"};e.filterRestriction="single-value";t=this._createFieldMetadata(e,i);if(t){t.fieldName=i+e.name;t.isMandatory=a(t)?false:true;t.isParameter=true;t.visibleInAdvancedArea=true}else{P.error("_createAnalyticParameterMetadata issue with property: "+e.name)}return t};H.prototype.getAnalyticParameters=function(){return this._aAnalyticalParameters};H.prototype.getSelectionVariants=function(){return this._aSelectionVariants};H.prototype.getAnalyticBindingPath=function(){var e,t=[],i=this.getAnalyticParameters();i.forEach(function(e){t.push(e.fieldName)});e=this.getFilledFilterData(t);if(this._oParameterization){return this._createAnalyticBindingPath(i,e)}else{return this._createNonAnalyticBindingPath(i,e)}};H.prototype._createAnalyticBindingPath=function(t,i){var a,r="",n;n=this._getParameterizationRequest(this._oParameterization);if(n){t.forEach(function(t){a=i[t.fieldName];if(!a){a=""}else if(t.type==="Edm.Time"&&a instanceof Date){if(this._oDateFormatSettings&&!this._oDateFormatSettings.UTC){a=e.utcToLocal(a)}a=e.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(t.type==="Edm.DateTime"&&i[t.fieldName]&&i[t.fieldName].conditionTypeInfo&&i[t.fieldName].ranges&&i[t.fieldName].ranges[0]){a=i[t.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}}else if(t.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}n.setParameterValue(t.name,a)}.bind(this));r=n.getURIToParameterizationEntry()+"/"+this._oParameterization.getNavigationPropertyToQueryResult()}return r};H.prototype._createNonAnalyticBindingPath=function(t,i){var a,r="",n="";if(this._oNonAnaParameterization){r="/"+this._oNonAnaParameterization.entitySetName+"(";t.forEach(function(t){a=i[t.fieldName];if(!a){a=""}else if(t.type==="Edm.Time"&&a instanceof Date){a=e.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(t.type==="Edm.DateTime"&&i[t.fieldName]&&i[t.fieldName].conditionTypeInfo&&i[t.fieldName].ranges&&i[t.fieldName].ranges[0]){a=i[t.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}}else if(t.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}r+=n+t.name+"="+I(this._oParentODataModel.formatValue(a,t.type));n=","}.bind(this));r+=")/"+this._oNonAnaParameterization.navPropertyName}return r};H.prototype._getParameterizationRequest=function(){return this._oParameterization?new M.ParameterizationRequest(this._oParameterization):null};H.prototype._constructContextUrl=function(e,t){var i=e._getServerUrl();if(i&&i.lastIndexOf("/")===i.length-1){i=i.substr(0,i.length-1)}return i+e.sServiceUrl+"/$metadata#"+t};H.prototype.getFilterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){e=this._oParentODataModel.getMetaModel().getODataEntitySet(this.sEntitySet);if(e){t=this._constructContextUrl(this._oParentODataModel,e.name)}}return t};H.prototype.getParameterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){if(this._oParameterization&&this._oParameterization.getEntitySet()){e=this._oParameterization.getEntitySet().getQName()}else if(this._oNonAnaParameterization){e=this._oNonAnaParameterization.entitySetName}if(e){t=this._constructContextUrl(this._oParentODataModel,e)}}return t};H.prototype._createFieldMetadata=function(e,t){var i,a,r,n,o;e.fieldName=this._getFieldName(e);e.fieldNameOData=e.fieldName.replace(b.FIELD_NAME_REGEX,"/");a=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName):null;i=Object.assign({},e);i.filterRestriction=this._getFilterRestriction(e.filterRestriction,a);this._updateValueListMetadata(i,e);i.hasValueHelpDialog=this._hasValueHelpDialog(i,a);if(a){i.disableNewDateRangeControl=a.disableNewDateRangeControl;i.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(i,a);i.conditionPanelDefaultOperation=a.conditionPanelDefaultOperation;if(a.displayBehaviour&&a.displayBehaviour!=="auto"){i.displayBehaviour=a.displayBehaviour}i.isCustomFilterField=!!a.customControl;i.visibleInAdvancedArea=!!a.visibleInAdvancedArea;i.defaultFilterValues=a.defaultFilterValues;i.customControl=a.customControl;r=a.conditionType;i.width=this._getWidth(a);i.isVisible=this._isVisible(a);i.historyEnabled=a.historyEnabled;i.historyEnabledInitial=a.historyEnabledInitial}else{i.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(i);i.isVisible=true;i.isCustomFilterField=false;i.visibleInAdvancedArea=false}i.controlType=this._getControlType(i,a);i.label=this._getLabel(e,a);i.isMandatory=this._isMandatory(e,a);i.groupId=this._getGroupID(e,a);i.index=this._getIndex(e,a);i.fControlConstructor=this._getControlConstructor(i,t);i.isFiscalDate=c.isFiscalValue(i);i.fiscalType=c.getFiscalAnotationType(i);if(i.isFiscalDate){c.updateViewMetadata(i)}i.filterType=this._getFilterType(i);i.hasTypeAhead=this._hasTypeAhead(i,e,a);i.ui5Type=this._getType(i);if(i.ui5Type&&i.ui5Type.isA("sap.ui.model.odata.type.DateTime")){i.ui5Type.formatValue(new Date,"string");i.ui5Type.oFormat.oFormatOptions.UTC=false}i.fCreateControl=function(e){var t;e.control=this._createControl(e);t=this.oModel.getData()[e.fieldName];if(t){this._updateMultiValueControl(e.control,t.items,t.ranges,e);var a=this._aFilterBarSingleValueWithValueListFieldMetadata.some(function(t){return t.name===e.fieldName||S.ANALYTICAL_PARAMETER_PREFIX+t.name===i.fieldName});if(a){this._updateSingleValueControl(e)}}}.bind(this);this._applyWidth(i);if(i.type==="Edm.String"){this._aFilterBarStringFieldNames.push(i.fieldName)}i.conditionType=null;var s=i.filterRestriction===L.single&&(i.type==="Edm.DateTime"&&i.displayFormat==="Date"||i.type==="Edm.String"&&i.isCalendarDate);var d=i.type==="Edm.DateTimeOffset"&&i.filterRestriction==="interval";if(!r&&this._bUseDateRangeType&&(i.fControlConstructor===l||s||d)){r="sap.ui.comp.config.condition.DateRangeType"}if(r){n="";if(typeof r==="object"){if(this._bUseDateRangeType&&!r.module&&i.fControlConstructor===l||s||d){r.module="sap.ui.comp.config.condition.DateRangeType"}n=r.module}else{n=r;r=null}try{n=n.replace(/\./g,"/");var u=sap.ui.require(n);if(u){this._enhanceConditionTypeInfo(u,n,r,i,t)}else{o=new Promise(function(e){sap.ui.require([n],function(a){this._enhanceConditionTypeInfo(a,n,r,i,t);e()}.bind(this))}.bind(this));this._aPromises.push(o)}}catch(e){P.error("Module "+n+" could not be loaded")}}else{this._checkMetadataDefaultValue(i)}return i};H.prototype._requireConditionType=function(e,t,i){var e=e.replace(/\./g,"/");var a=sap.ui.require(e);if(a){this._enhanceConditionTypeInfo(a,e,t,i)}else{sap.ui.require([e],function(a){this._enhanceConditionTypeInfo(a,e,t,i)}.bind(this))}};H.prototype._enhanceConditionTypeInfo=function(e,t,i,a,r){var n=e;var l=r===S.ANALYTICAL_PARAMETER_PREFIX&&a.fieldName.indexOf(S.ANALYTICAL_PARAMETER_PREFIX)===-1?r+a.fieldName:a.fieldName;a.conditionType=new n(l,this,a);this._mConditionTypeFields[l]=a;if(i&&!this._bUseDateRangeType){if(a.defaultValue&&r===S.ANALYTICAL_PARAMETER_PREFIX){i=Object.assign({},i,{defaultDate:a.defaultValue})}a.conditionType.applySettings(i)}if(this._bUseDateRangeType&&i&&r!==S.ANALYTICAL_PARAMETER_PREFIX){var o={};if(i.defaultOperation){o=Object.assign({},o,{defaultOperation:i.defaultOperation})}if(i.operations){o=Object.assign({},o,{operations:i.operations})}a.conditionType.applySettings(o)}if(this._bUseDateRangeType&&r===S.ANALYTICAL_PARAMETER_PREFIX&&a.defaultValue){var o={defaultDate:a.defaultValue};if(i){o=Object.assign({},o,{operations:i.operations,defaultOperation:i.defaultOperation})}a.conditionType.applySettings(o)}this._checkMetadataDefaultValue(a)};H.prototype._getFilterType=function(e){return D._getFilterType(e)};H.prototype._updateValueListMetadata=function(e,t){e.hasValueListAnnotation=t["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=t["sap:value-list"]==="fixed-values"}else if(t["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(t["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=m.isValueListWithFixedValues(t)}}};H.prototype._createBasicSearchFieldMetadata=function(){var e;var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");e={};e.filterRestriction=L.single;e.name=b.BASIC_SEARCH_FIELD_ID;e.fieldName=b.BASIC_SEARCH_FIELD_ID;e.label=undefined;e.isMandatory=false;e.isVisible=true;e.groupId=b.BASIC_FILTER_AREA_ID;e.index=-1;e.control=new h(this._oSmartFilter.getId()+"-btnBasicSearch",{showSearchButton:true});if(!this._isRunningInValueHelpDialog){e.control.setPlaceholder(t.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER"))}e.control.bindProperty("value",this.sFilterModelName+">/"+e.fieldName);this._oBasicSearchControl=e.control;return e};H.prototype._applyWidth=function(e){if(e&&e.width&&e.control&&typeof e.control.setWidth==="function"){e.control.setWidth(e.width)}};H.prototype._createFieldMetadataForCustomFilterFields=function(e){var t;if(!e||!e.customControl){return undefined}t={};t.name=e.key;t.fieldName=e.key;t.label=e.label;t.visibleInAdvancedArea=!!(e&&e.visibleInAdvancedArea);t.isVisible=this._isVisible(e);t.groupId=e.groupId;t.isMandatory=this._isMandatory(undefined,e);t.index=e.index;t.width=this._getWidth(e);t.control=e.customControl;t.isCustomFilterField=true;this._applyWidth(t);return t};H.prototype._getFieldName=function(e){if(!e.parentPropertyName){return e.name}else{return e.parentPropertyName+"."+e.name}};H.prototype._getPreventInitialDataFetchInValueHelpDialog=function(e,t){if(t&&!t.isSetPreventInitialDataFetchInValueHelpDialog){return t.preventInitialDataFetchInValueHelpDialog}if(m.isValueList(e)&&e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};H.prototype._hasValueHelpDialog=function(e,t){var i=true;if(t){if(t.controlType===x.dropDownList){i=false}else if(t.hasValueHelpDialog!==true){i=false}}if(e&&!e.hasValueListAnnotation){if(e.filterRestriction===L.single||e.filterRestriction===L.multiple){i=false}}return i};H.prototype._isVisible=function(e){if(e&&e.isVisible===false){return false}return true};H.prototype._getWidth=function(e){if(e&&e.width){return e.width}return undefined};H.prototype._isMandatory=function(e,t){if(t&&t.mandatory!==k.auto){return t.mandatory===k.mandatory}if(e){return e.requiredFilterField}return false};H.prototype._getFilterRestriction=function(e,t){if(t&&t.filterType&&t.filterType!==L.auto){return t.filterType}switch(e){case"single-value":return L.single;case"multi-value":return L.multiple;case"interval":return L.interval;case"search-expression":return L.searchExpression;default:return L.auto}};H.prototype._getControlType=function(e,t){var i;if(t&&t.controlType&&t.controlType!==x.auto){i=t.controlType}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){i=x.date}else if(e.type==="Edm.DateTimeOffset"){i=x.dateTimePicker}else if(e.hasValueListAnnotation&&e.hasFixedValues){i=x.dropDownList}else if(this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)){i=x.dropDownList}else{i=x.input}return i};H.prototype._isBooleanWithFixedValuedButWithoutValueListAnnotation=function(e){if(e.type==="Edm.Boolean"&&!e.hasFixedValues&&!e.hasValueListAnnotation&&e.filterRestriction==="single"){return true}return false};H.prototype._getGroupID=function(e,t){if(t&&t.groupId){return t.groupId}else if(e&&(e.requiredFilterField||this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1)){return this._sBasicFilterAreaID}return this._getGroupIDFromFieldGroup(e)};H.prototype._getGroupIDFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.groupName;break}}}return a};H.prototype._getLabel=function(e,t){if(t&&t.label){return t.label}return this._getLabelFromFieldGroup(e)||e.fieldLabel||e.fieldName};H.prototype._getLabelFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.labels[e.fieldNameOData];break}}}return a};H.prototype._getIndex=function(e,t){if(t&&t.index>=0){return t.index}else if(this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1){return this._aSelectionFields.indexOf(e.fieldNameOData)}return this._getIndexFromFieldGroup(e)};H.prototype._getIndexFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields){a=i.fields.indexOf(e.fieldNameOData);if(a>-1){break}a=undefined}}}return a};H.prototype._getGroupIndex=function(e){if(e&&(e.index||e.index===0)){return e.index}};H.prototype._getGroupLabel=function(e,t){if(t&&t.label){return t.label}return e.groupLabel||e.groupName||e.groupEntitySetName};H.prototype._hasTypeAhead=function(e,t,i){var a;a=true;if(i){a=i.hasTypeAhead}else if(t.type!=="Edm.String"){return false}if(!(e.fControlConstructor===s||e.fControlConstructor===u)){return false}return a};H.prototype.getModel=function(){return this.oModel};H.prototype.getFilterBarViewMetadata=function(){return this._aFilterBarViewMetadata};H.prototype._getFilterBarViewMetadataExtend=function(){return this._oFilterBarViewMetadataExtend};H.prototype.getAssociatedValueHelpProviders=function(){return this._aValueHelpDialogProvider};H.prototype.getAssociatedValueListProviders=function(){return this._aValueListProvider};H.prototype.getParameters=function(){var e,t=null;if(this.oModel){t=this.oModel.getProperty("/"+b.BASIC_SEARCH_FIELD_ID)}if(this._sBasicSearchFieldName||t){e={custom:{}};if(this._sBasicSearchFieldName){e.custom["search-focus"]=this._sBasicSearchFieldName}e.custom["search"]=t||""}return e};H.prototype.getFilters=function(e){var t=null;if(this.oModel){t=this.oModel.getData()}return b.generateFilters(e,t,{dateSettings:this._oDateFormatSettings,useContainsAsDefault:this._bUseContainsAsDefault,stringFields:this._aFilterBarStringFieldNames,timeFields:this._aFilterBarTimeFieldNames,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata})};H.prototype.getFilterData=function(){return this.oModel?this.oModel.getData():null};H.prototype.getFilterDataAsString=function(){return this.oModel?this.oModel.getJSON():null};H.prototype.getFilledFilterData=function(e){var t,i={},a,r,n;t=this.oModel?this.oModel.getData():null;if(t&&e){a=e.length;while(a--){r=e[a];if(r&&r!==b.BASIC_SEARCH_FIELD_ID){n=t[r];if(n&&n.hasOwnProperty("low")){if(n.low){i[r]=n}}else if(n&&n.hasOwnProperty("items")){if(n.value&&typeof n.value==="string"){n.value=n.value.trim()}if(n.items.length||n.ranges&&n.ranges.length||n.value||typeof n.value==="boolean"){i[r]=n}}else if(n){if(typeof n==="string"){n=n.trim()}if(n){i[r]=n}}}if(a===0){r=b.CUSTOM_FIELDS_MODEL_PROPERTY;n=t[r];if(n){i[r]=n}}}}return B({},i)};H.prototype.getFilledFilterDataAsString=function(e){return JSON.stringify(this.getFilledFilterData(e))};H.prototype.setFilterData=function(e,t){var i=null,a=null,r=null;if(this.oModel&&e){this._bUpdatingFilterData=true;try{if(t){this._createInitialModel(false)}i=this._parseFilterData(e,t);if(i){this.oModel.setData(i,true);a=[];var n=arguments[2];if(n){a.push(n)}for(r in i){a.push(r)}this._handleFilterDataUpdate(a)}}finally{this._bUpdatingFilterData=false}}};H.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};H.prototype._parseFilterData=function(e,t){return H.parseFilterData(this.oModel.getData(),e,{stringDateFields:this._aFilterBarStringDateFieldNames,dateFields:this._aFilterBarDateFieldNames,timeFields:this._aFilterBarTimeFieldNames,timeIntervalFields:this._aFilterBarTimeIntervalFieldNames,dateTimeMultiValueFields:this._aFilterBarDateTimeMultiValueFieldNames,conditionTypeFields:this._mConditionTypeFields,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata,filterProvider:this},t)};H.prototype._handleFilterDataUpdate=function(e){var t=0,i,a,r=this.oModel.getData();var n=function(e,t){var i=t;e.forEach(function(e){t.forEach(function(a){if(a.operation===N.EQ&&a.value1===e.key){i.splice(t.indexOf(a),1)}})});return i};if(this._aFilterBarMultiValueFieldMetadata){t=this._aFilterBarMultiValueFieldMetadata.length;while(t--){if(r){i=this._aFilterBarMultiValueFieldMetadata[t];if(e.indexOf(i.fieldName)>-1){a=r[i.fieldName];if(a){if(a.items&&a.items.length>0&&a.ranges&&a.ranges.length>0){a.ranges=n(a.items,a.ranges)}this._updateMultiValueControl(i.control,a.items,a.ranges,i)}}}}this._updateConditionTypeFields()}if(this._aFilterBarSingleValueWithValueListFieldMetadata&&r){this._aFilterBarSingleValueWithValueListFieldMetadata.forEach(function(t){var i=t.control,a=t.fieldName;if(!i||m.isHiddenFilter(t)){return}if(e.includes(a)){this._updateSingleValueControl(t)}else if(!r[a]){i.setValue("");i.__sValidationText=""}}.bind(this))}};H.prototype.clear=function(){this._createInitialModel(false)};H.prototype.reset=function(){this._createInitialModel(true)};H.prototype._initializeConditionTypeFields=function(){var e=function(e){this.setPending(this.isPending())}.bind(this);for(var t in this._mConditionTypeFields){this._mConditionTypeFields[t].conditionType.initialize(this.oModel.getData()[t]);if(this._mConditionTypeFields[t].conditionType.getAsync()){this._mConditionTypeFields[t].conditionType.attachPendingChange(e)}}};H.prototype._updateConditionTypeFields=function(){var e=this._oldData;var t=this.oModel.getData();this._oldData=B({},t);if(e!==undefined){var i=[],a;for(a in t){var r=JSON.stringify(t[a]);var n=JSON.stringify(e[a]);if(r!==n){i.push(a)}}if(i.length>0){for(a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.providerDataUpdated(i,t)}}}};H.prototype._clearConditionTypeFields=function(){var e=this.oModel.getData();for(var t in this._mConditionTypeFields){if(!e[t]){this._mConditionTypeFields[t].conditionType.initialize({})}else{this._mConditionTypeFields[t].conditionType.initialize(e[t])}}};H.prototype._validateConditionTypeFields=function(){var e=false;for(var t in this._mConditionTypeFields){var i=this._mConditionTypeFields[t].conditionType.validate();if(!i&&!e){e=true}}return e};H.prototype._getFieldMetadata=function(e){return b._getFieldMetadata(this.getFilterBarViewMetadata(),e)};H.prototype._getSelectedDateRange=function(e){if(!Array.isArray(e)){e=[e,e]}return e};H.prototype._getDateFieldOutOfRangeErrorText=function(e,t,i,a){var r=e.getMinDate()||e._oMinDate,n=e.getMaxDate()||e._oMaxDate;if(t[0].getTime()<r.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MIN_DATE_ERROR",[i.formatValue(r,"string")])}if(t[1].getTime()>n.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MAX_DATE_ERROR",[i.formatValue(n,"string")])}};H.generateFilters=function(e,t,i){return b.generateFilters(e,t,i)};H.parseFilterData=function(e,t,i,a){var r={},n=null,l=null,o=null,s,d,u,f,h,p,m,c,_,g,y,F,D,v,T;if(i){p=i.stringDateFields;m=i.dateFields;c=i.timeFields;_=i.timeIntervalFields;g=i.dateTimeMultiValueFields;n=i.conditionTypeFields||{};y=i.dateTimeOffsetValueFields;F=i.viewMetadataData||[];v=i.filterProvider||null}if(!p){p=[]}if(!m){m=[]}if(!c){c=[]}if(!_){_=[]}if(!g){g=[]}if(!y){y=[]}if(e&&t){d=Object.assign({},t,true);for(l in d){D=b._getFieldMetadata(F,l);if(e.hasOwnProperty(l)&&l!==b.CUSTOM_FIELDS_MODEL_PROPERTY){o=e[l];s=d[l];if(l in n){if(n[l]&&typeof s==="string"){var V=new Date(s);if(V instanceof Date&&!isNaN(V)){n[l].conditionType.initialize({value1:V})}else if(n[l].type==="Edm.String"&&n[l].ui5Type&&typeof n[l].ui5Type.formatValue==="function"){var V=n[l].ui5Type.formatValue(s);n[l].conditionType.initialize({value1:V})}}else if(s&&(s.low||s.low===0)&&(s.high||s.high===0)){var A=new Date(s.low),S=new Date(s.high);if(A instanceof Date&&!isNaN(A)&&S instanceof Date&&!isNaN(S)){n[l].conditionType.initialize({value1:A,value2:S})}else if(n[l].type==="Edm.String"&&n[l].ui5Type&&typeof n[l].ui5Type.formatValue==="function"){var A=n[l].ui5Type.formatValue(s.low),S=n[l].ui5Type.formatValue(s.high);n[l].conditionType.initialize({value1:A,value2:S})}}else if(s&&("conditionTypeInfo"in s||!("conditionTypeInfo"in s)&&s.ranges)){if(s.ranges&&s.ranges.length>1&&n[l].isParameter){var C=s.ranges.find(function(e){return e.semantic!==undefined});if(C){s.ranges=[C]}}n[l].conditionType.initialize(s)}}else if(o&&o.hasOwnProperty("low")){r[l]=s;if(s){if((s.low||s.low===0)&&(s.high||s.high===0)){if(m.indexOf(l)>-1||c.indexOf(l)>-1){if(!(s.low instanceof Date)){r[l].low=new Date(s.low)}if(!(s.high instanceof Date)){r[l].high=new Date(s.high)}}else if(v&&D&&y.indexOf(l)>-1){r[l].low=D.ui5Type.formatValue(new Date(s.low),"string")+"-"+D.ui5Type.formatValue(new Date(s.high),"string");r[l].high=null}else if(p.indexOf(l)===-1){r[l].low=s.low+"-"+s.high;r[l].high=null}}else if((s.low||s.low===0||s.value)&&!s.high){if(!s.low&&s.value){s.low=s.value}if((m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1)&&!(s.low instanceof Date)){T=Date.parse(s.low);if(!Number.isNaN(T)){r[l].low=new Date(T)}}r[l].low=s.low;r[l].high=null}}}else if(o&&o.hasOwnProperty("items")){if(s&&(s.items||s.ranges)){if(s.ranges&&s.ranges.length){if(_.indexOf(l)>-1){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(!h.exclude&&(h.operation==="EQ"||h.operation==="BT")){break}h=null}if(h){if(h.value1&&typeof h.value1==="string"){h.value1=new Date(h.value1)}if(h.value2&&typeof h.value2==="string"){h.value2=new Date(h.value2)}r[l]={ranges:[h],items:[],value:""}}continue}else if(m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(h.value1&&typeof h.value1==="string"){h.value1=new Date(h.value1)}if(h.value2&&typeof h.value2==="string"){h.value2=new Date(h.value2)}}}else if(D&&D.isCalendarDate){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(h.value1&&typeof h.value1==="string"&&!h.value1.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){h.value1=D.ui5Type.parseValue(new Date(h.value1),"date")}if(h.value2&&typeof h.value2==="string"&&!h.value2.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){h.value2=D.ui5Type.parseValue(new Date(h.value2),"date")}}}else if(D&&D.filterType==="boolean"){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(h.hasOwnProperty("value1")){if(typeof h.value1==="string"){h.value1=h.value1==="true"}}if(h.hasOwnProperty("value2")){if(typeof h.value2==="string"){h.value2=h.value2==="true"}}}}}r[l]=s;if(!a&&r[l].ranges){for(u=0;u<r[l].ranges.length;u++){r[l].ranges[u].tokenText=null}}}else if(typeof s==="string"||typeof s==="boolean"||typeof s==="number"||s instanceof Date){if(s&&(m.indexOf(l)>-1||c.indexOf(l)>-1)){if(typeof s==="string"){s=new Date(s)}r[l]={ranges:[{exclude:false,operation:"EQ",keyField:l,value1:s,value2:null}],items:[],value:""}}else{r[l]={value:s,items:[]}}}}else{r[l]=null;if(typeof s==="string"||typeof s==="boolean"||typeof s==="number"||s instanceof Date){if(typeof s==="string"&&(m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1)){r[l]=new Date(s)}else{r[l]=s}}else if(s&&(s.value||s.value===0||s.value===false)){r[l]=s.value}else if(s&&s.items&&s.items.length){r[l]=s.items[0].key}else if(s&&s.ranges&&s.ranges.length){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(!h.exclude&&h.operation==="EQ"){break}h=null}if(h&&h.value1){if(typeof h.value1==="string"&&(m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1)){r[l]=new Date(h.value1)}else{r[l]=h.value1}}}}}else if(a||l===b.CUSTOM_FIELDS_MODEL_PROPERTY){r[l]=d[l]}}}return r};H.prototype._attachEvent=function(e,t){if(!this._oEventProvider){this._oEventProvider=new v}this._oEventProvider.attachEvent(e,t)};H.prototype._attachEventOnce=function(e,t){if(!this._oEventProvider){this._oEventProvider=new v}this._oEventProvider.attachEventOnce(e,t)};H.prototype._detachEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.detachEvent(e,t)};H.prototype._fireEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.fireEvent(e,t||{})};H.prototype._getSuppressValueListsAssociation=function(){return this._bSuppressValueListsAssociation};H.prototype._getCurrentValidationPromises=function(){return this._aValueListProvider.concat(this._aValueHelpDialogProvider).reduce(function(e,t){return e.concat(t._getCurrentValidationPromises())},[])};H.prototype._enrichFieldViewMetadata=function(e,t){var i,a,r,n,l,o,s={},d="com.sap.vocabularies.Common.v1.ValueList";if(t===undefined||e===undefined){return}a=e["groupName"];r=e["fullName"];n=t.primaryValueListAnnotation!==undefined;l=Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0;if(n){s[d]=t.primaryValueListAnnotation.annotation}if(l){for(i=0;i<t.additionalAnnotations.length;i++){o=t.additionalAnnotations[i];s[d+"#"+o.qualifier]=o.annotation}}if(n||l){if(this._oFilterBarViewMetadataExtend[a]===undefined){this._oFilterBarViewMetadataExtend[a]={}}if(this._oFilterBarViewMetadataExtend[a][r]===undefined){this._oFilterBarViewMetadataExtend[a][r]={}}this._oFilterBarViewMetadataExtend[a][r]=s}};H.prototype._isSingleDynamicDateEnabled=function(e){var t=this._bUseDateRangeType&&(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.type==="Edm.String"&&e.isCalendarDate);if(t){return true}var i=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName)||this._oAdditionalConfiguration.getControlConfigurationByKey(e.name):null;var a=i&&(i.conditionType==="sap.ui.comp.config.condition.DateRangeType"||i.conditionType&&i.conditionType&&typeof i.conditionType==="object"&&i.conditionType.module==="sap.ui.comp.config.condition.DateRangeType")&&(e.type==="Edm.DateTime"||e.type==="Edm.String"&&e.isCalendarDate);return a};H.prototype._setSingleInputsTextArrangementData=function(e){this._sSingleInputsTextArrangementData=Object.assign({},e);return this};H.prototype._setSingleInputsTextArrangementFieldData=function(e,t,i){this._sSingleInputsTextArrangementData[e]={key:t,text:i};return this};H.prototype._getSingleInputsTextArrangementData=function(e){if(e){return this._sSingleInputsTextArrangementData[e]}return this._sSingleInputsTextArrangementData};H.prototype._getFilterTimeZone=function(e){var t=this._oAdditionalConfiguration,i=t?t.getControlConfigurationByKey(e):null,a=null;if(i){a=i.timezone}return a};H.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};this._oParentODataModel=null;this._aAnalyticalParameters=null;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._oParameterization=null;this._oNonAnaParameterization=null;this._aFilterBarFieldNames=null;this._aFilterBarStringDateFieldNames=null;this._aFilterBarDateFieldNames=null;this._aFilterBarTimeFieldNames=null;this._aFilterBarTimeIntervalFieldNames=null;this._aFilterBarDateTimeMultiValueFieldNames=null;this._aFilterBarStringFieldNames=null;this._aFilterBarMultiValueFieldMetadata=null;this._aFilterBarDropdownFieldMetadata=null;this._sSingleInputsTextArrangementData=null;this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFilterBarDateTimeFieldNames=null;this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=null;this._aFieldGroupAnnotation=null;this._aSelectionFields=null;this._aSelectionVariants=null;if(this._oBasicSearchControl&&this._oBasicSearchControl.destroy){this._oBasicSearchControl.destroy()}this._oBasicSearchControl=null;if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;e(this._aValueHelpDialogProvider);this._aValueHelpDialogProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;if(this._mTokenHandler){for(var t in this._mTokenHandler){var i=this._mTokenHandler[t];if(i.parser){i.parser.destroy();i.parser=null}}delete this._mTokenHandler}this.oResourceBundle=null;this.sIntervalPlaceholder=null;this.sDefaultDropDownDisplayBehaviour=null;this.sDefaultTokenDisplayBehaviour=null;this.sDefaultSingleFieldDisplayBehaviour=null;this._oSmartFilter=null;if(this._oEventProvider){if(this._oEventProvider.destroy){this._oEventProvider.destroy()}this._oEventProvider=null}for(var a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.destroy()}this._mConditionTypeFields=null;if(this.oModel){this.oModel.destroy();this.oModel=null}this._aPromises=[];this.bIsDestroyed=true};return H},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/FilterProviderUtils", ["sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FilterUtil","sap/ui/comp/library"],function(e,i,t,a,l,n,o){"use strict";var s=o.smartfilterbar.FilterType,r=o.valuehelpdialog.ValueHelpRangeOperation;var f=e.extend("sap.ui.comp.smartfilterbar.FilterProviderUtils");f.FIELD_NAME_REGEX=/\./g;f.BASIC_SEARCH_FIELD_ID="_BASIC_SEARCH_FIELD";f.BASIC_FILTER_AREA_ID="_BASIC";f.FILTER_MODEL_NAME="fi1t3rM0d31";f.CUSTOM_FIELDS_MODEL_PROPERTY="_CUSTOM";f.ASSOCIATE_VALUE_LISTS="AssociateValueLists";f.INTL_TIMEZONE=Intl.DateTimeFormat().resolvedOptions().timeZone;f.UI_TIMEZONE=sap.ui.getCore().getConfiguration().getTimezone();f._getStringEmptyFilter=function(e,a,l){var n=l?t.NE:t.EQ;if(a&&a.nullable==="false"){return new i(e,n,"")}else{return new i({and:!!l,filters:[new i(e,n,""),new i(e,n,null)]})}};f._getFieldMetadata=function(e,i){var t=null;e.some(function(e){if(e&&e.fields){e.fields.some(function(e){if(e&&e.fieldName===i){t=e}return t!==null})}return t!==null});return t};f._getTimezone=function(e,i){var t=e&&e.find(function(e){return e.key===i});if(t){return t.value}return null};f.adaptTime=function(e,i){var t;if(!(e instanceof Date)||!i){return e}if(i.filterRestriction===s.single&&i.control&&i.control.isA("sap.m.DynamicDateRange")){return a.normalizeDate(e,true)}if(i.displayFormat==="Date"){return a.normalizeDate(e,true)}t=parseInt(i.precision);return a.adaptPrecision(e,t)};f.generateFilters=function(e,o,s){var u=[],c=null,p=null,m=null,T=null,E=f.FIELD_NAME_REGEX,d=null,g,I,h=null,w=0,D=0,_,O,C,F,v,U,S,y,L,N,A,M=[],V,z,R;if(s){_=s.dateSettings;O=s.useContainsAsDefault;C=s.stringFields;F=s.timeFields;S=s.dateTimeOffsetValueFields;M=s.viewMetadataData||[];y=s.dateTimeOffsetWithTimeZone}if(e){if(o){D=e.length;while(D--){U=false;L=false;T=e[D];N=this._getTimezone(y,T);A=f._getFieldMetadata(M,T);if(A&&A.isCustomFilterField){continue}if(T&&T!==f.BASIC_SEARCH_FIELD_ID){h=null;v=false;if(O&&C){if(C.indexOf(T)>-1){v=true}}else if(F&&F.indexOf(T)>-1){U=true}else if(S&&S.indexOf(T)>-1){L=true}d=o[T];T=T.replace(E,"/");if(d&&d.hasOwnProperty("low")){if(d.low&&d.high){g=d.low;I=d.high;if(!L&&_&&_.UTC&&g instanceof Date&&I instanceof Date){g=a.localToUtc(g);I=a.localToUtc(I)}g=f.adaptTime(g,A);I=f.adaptTime(I,A);u.push(new i(T,t.BT,g,I))}else if(d.low){if(d.low instanceof Date){g=d.low;if(!L&&_&&_.UTC){g=a.localToUtc(g)}g=f.adaptTime(g,A);u.push(new i(T,t.EQ,g))}else if(typeof d.low==="string"){if(L&&A){h=l.parseDateTimeOffsetInterval(d.low);h[0]=A.ui5Type.parseValue(h[0],"string");if(h.length===2){h[1]=A.ui5Type.parseValue(h[1],"string")}}else{h=l.parseFilterNumericIntervalData(d.low)}if(h&&h.length===2){d[0]=f.adaptTime(d[0],A);d[1]=f.adaptTime(d[1],A);u.push(new i(T,t.BT,h[0],h[1]))}else if(h&&h.length===1){d[0]=f.adaptTime(d[0],A);u.push(new i(T,t.EQ,h[0]))}else{u.push(new i(T,v?t.Contains:t.EQ,d.low))}}}}else if(d&&d.hasOwnProperty("items")){c=[];m=[];p=null;if(d&&d.hasOwnProperty("ranges")){h=d.ranges;w=h.length;while(w--){V=h[w];g=V.value1;I=V.value2;if(U){if(g instanceof Date){g=l.getEdmTimeFromDate(g)}if(I instanceof Date){I=l.getEdmTimeFromDate(I)}}else if(A&&A.isCalendarDate){if(g instanceof Date){g=A.ui5Type.parseValue(g)}if(I instanceof Date){I=A.ui5Type.parseValue(I)}}else if(!L&&_&&_.UTC){if(g instanceof Date){g=a.localToUtc(g)}if(I instanceof Date){I=a.localToUtc(I)}}else if(L&&N){if(g){if(f.UI_TIMEZONE!==f.INTL_TIMEZONE){g=a.localToTimezone(g,N)}else{g=a.toTimezone(g,N)}g=a.localToUtc(g)}if(I){if(f.UI_TIMEZONE!==f.INTL_TIMEZONE){I=a.localToTimezone(I,N)}else{I=a.toTimezone(I,N)}I=a.localToUtc(I)}}else if(L&&!N){if(g){if(_&&_.UTC){g=a.uiTimezoneToUtc(g);g=a.localToUtc(g)}else{g=a.toTimezone(g,f.INTL_TIMEZONE)}}if(I){if(_&&_.UTC){I=a.uiTimezoneToUtc(I);I=a.localToUtc(I)}else{I=a.toTimezone(I,f.INTL_TIMEZONE)}}}g=f.adaptTime(g,A);I=f.adaptTime(I,A);z=V.exclude?m:c;if(V.operation===r.Empty){if(A&&["Edm.DateTime","Edm.DateTimeOffset"].indexOf(A.type)>-1){z.push(new i(T,V.exclude?t.NE:t.EQ,null))}else{z.push(f._getStringEmptyFilter(T,A,V.exclude))}}else{if(V.operation!==t.BT&&V.operation!==t.NB){I=undefined}R=V.exclude?n.getTransformedExcludeOperation(V.operation):V.operation;z.push(new i(T,R,g,I))}}if(m.length){p=new i(m,true)}}h=d.items;w=h.length;while(w--){c.push(new i(T,t.EQ,h[w].key))}if(d.value||d.value===0||d.value===false){if(typeof d.value==="string"){d.value=d.value.trim()}c.push(new i(T,v?t.Contains:t.EQ,d.value))}if(c.length){if(p){u.push(new i([new i(c,false),p],true))}else{u.push(new i(c,false))}}else if(p){u.push(p)}}else if(A&&A.control&&A.control.isA("sap.m.ComboBox")&&this.isValueSignificant(A)){if(d===null&&A.control.getSelectedKey()===""){d=""}if(A.control.getSelectedItem()){d=f.adaptTime(d,A);u.push(new i(T,v?t.Contains:t.EQ,d))}}else if(d||d===0||d===false){if(typeof d==="string"){d=d.trim()}if(d&&d instanceof Date){if(U){d=l.getEdmTimeFromDate(d)}else if(!L&&_&&_.UTC){d=a.localToUtc(d)}}if(d||d===0||d===false){d=f.adaptTime(d,A);u.push(new i(T,v?t.Contains:t.EQ,d))}}}}}}return u.length>1?[new i(u,true)]:u};f.isValueSignificant=function(e){var i=e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].Parameters,t;if(i){t=i.find(function(e){return e.hasOwnProperty("InitialValueIsSignificant")})}if(t&&t["InitialValueIsSignificant"]){return t["InitialValueIsSignificant"].Bool.toLocaleLowerCase()==="true"}return false};return f});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/GroupConfiguration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var r=t.extend("sap.ui.comp.smartfilterbar.GroupConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},index:{type:"any",group:"Misc",defaultValue:undefined},label:{type:"any",group:"Misc",defaultValue:undefined}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});r.prototype.setLabel=function(e){this.setProperty("label",e);this.fireChange({propertyName:"label"});return this};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBMultiInput", ["sap/m/MultiInput","sap/m/MultiInputRenderer","sap/base/strings/whitespaceReplacer"],function(t,e,i){"use strict";var n=t.extend("sap.ui.comp.smartfilterbar.SFBMultiInput",{metadata:{library:"sap.ui.comp"},renderer:e});n.prototype.setTokens=function(e){e.map(function(t){return t.setText(i(t.getText()))});t.prototype.setTokens.apply(this,arguments);this._pendingAutoTokenGeneration=true;this._getFilterProvider()._tokenUpdate({control:this,fieldViewMetadata:this._getFieldViewMetadata()});this._pendingAutoTokenGeneration=false;this._isOninputTriggered=false};n.prototype._setFilterProvider=function(t){this.oFilterProvider=t};n.prototype._getFilterProvider=function(){return this.oFilterProvider};n.prototype._setFieldViewMetadata=function(t){this.oFieldViewMetadata=t};n.prototype._getFieldViewMetadata=function(){return this.oFieldViewMetadata};n.prototype.oninput=function(){t.prototype.oninput.apply(this,arguments);this._isOninputTriggered=true};n.prototype.addToken=function(){t.prototype.addToken.apply(this,arguments);this._isOninputTriggered=false;return this};n.prototype.insertToken=function(){t.prototype.insertToken.apply(this,arguments);this._isOninputTriggered=false;return this};n.prototype.onBeforeRendering=function(){t.prototype.onBeforeRendering.apply(this,arguments);if(!this._isOninputTriggered&&this.getValue()){this._pendingAutoTokenGeneration=true;this._validateCurrentText(true);this._pendingAutoTokenGeneration=false}};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SelectOption", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/model/FilterOperator"],function(e,t,r){"use strict";var i=t.extend("sap.ui.comp.smartfilterbar.SelectOption",{metadata:{library:"sap.ui.comp",properties:{sign:{type:"sap.ui.comp.smartfilterbar.SelectOptionSign",group:"Misc",defaultValue:"I"},operator:{type:"sap.ui.model.FilterOperator",group:"Misc",defaultValue:"EQ"},low:{type:"string",group:"Misc",defaultValue:null},high:{type:"string",group:"Misc",defaultValue:null}}}});i.SIGN=e.smartfilterbar.SelectOptionSign;i.OPERATOR=r;return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SmartFilterBar", ["sap/ui/thirdparty/jquery","sap/m/MessageBox","sap/ui/comp/util/DateTimeUtil","sap/ui/base/ManagedObjectObserver","sap/ui/comp/filterbar/FilterBar","sap/ui/comp/smartfilterbar/SmartFilterBarFilterGroupItem","sap/ui/comp/filterbar/FilterItem","sap/ui/comp/library","./AdditionalConfigurationHelper","./ControlConfiguration","./FilterProvider","sap/ui/comp/smartfilterbar/FilterProviderUtils","./GroupConfiguration","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/comp/odata/ODataModelUtil","sap/ui/core/library","sap/ui/comp/variants/VariantItem","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context","sap/ui/comp/filterbar/VariantConverterFrom","sap/base/Log","sap/base/util/merge","sap/ui/Device"],function(jQuery,e,t,i,r,a,n,o,s,l,d,h,u,p,f,c,g,_,m,y,F,S,v,V,b){"use strict";var C=_.ValueState;var P=o.smartfilterbar.FilterType;var A=o.ANALYTICAL_PARAMETER_PREFIX;var M=r.extend("sap.ui.comp.smartfilterbar.SmartFilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartfilterbar/SmartFilterBar.designtime",properties:{entityType:{type:"string",group:"Misc",defaultValue:null,deprecated:true},entitySet:{type:"string",group:"Misc",defaultValue:null},resourceUri:{type:"string",group:"Misc",defaultValue:null},basicSearchFieldName:{type:"string",group:"Misc",defaultValue:null},enableBasicSearch:{type:"boolean",group:"Misc",defaultValue:false},liveMode:{type:"boolean",group:"Misc",defaultValue:false},showMessages:{type:"boolean",group:"Misc",defaultValue:false},considerAnalyticalParameters:{type:"boolean",group:"Misc",defaultValue:false},useDateRangeType:{type:"boolean",group:"Misc",defaultValue:null},suppressSelection:{type:"boolean",group:"Misc",defaultValue:false},considerSelectionVariants:{type:"boolean",group:"Misc",defaultValue:false},defaultSelectionVariantName:{type:"string",group:"Misc",defaultValue:null},useProvidedNavigationProperties:{type:"boolean",group:"Misc",defaultValue:false},navigationProperties:{type:"string",group:"Misc",defaultValue:""}},associations:{smartVariant:{type:"sap.ui.comp.smartvariants.SmartVariantManagement",multiple:false}},aggregations:{controlConfiguration:{type:"sap.ui.comp.smartfilterbar.ControlConfiguration",multiple:true,singularName:"controlConfiguration"},groupConfiguration:{type:"sap.ui.comp.smartfilterbar.GroupConfiguration",multiple:true,singularName:"groupConfiguration"}},events:{pendingChange:{pendingValue:{type:"boolean"}}}},renderer:{apiVersion:2}});M.LIVE_MODE_INTERVAL=300;M.SELECTION_VARIANT_KEY_PREFIX="#";M.prototype.init=function(){if(!d){d=sap.ui.require("sap/ui/comp/smartfilterbar/FilterProvider")}this._bCreateFilterProviderCalled=false;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._bSetFilterDataSuspended=false;this._oStoredFilterData={};this._oObservers=[];r.prototype.init.apply(this);sap.ui.getCore().getMessageManager().registerObject(this,true);this.getMetadata().addPublicMethods(["suspendSelection","resumeSelection"])};M.prototype._initializeMetadata=function(){if(!this.bIsInitialised){g.handleModelInit(this,this._onMetadataInitialised,!this.getIsRunningInValueHelpDialog())}};M.prototype._onMetadataInitialised=function(){var e,t,i,r;this._bMetaModelLoadAttached=false;if(!this.bIsInitialised&&!this._bCreateFilterProviderCalled){t=this.getModel();e=this.getResourceUri();i=this.getEntityType();r=this.getEntitySet();if((t||e)&&(i||r)){this._bCreateFilterProviderCalled=true;this._createFilterProvider(t,e,i,r).then(function(e){if(!e){return}if(this.bIsDestroyed){e.destroy();return}this._oFilterProvider=e;this._aFilterBarViewMetadata=e.getFilterBarViewMetadata();this._oFilterBarViewMetadataExtend=e._getFilterBarViewMetadataExtend();if(this._aFilterBarViewMetadata){this._attachAdditionalConfigurationChanged();this.bIsInitialised=true;this.setModel(e.oModel,e.sFilterModelName);this.registerGetFiltersWithValues(this.getFiltersWithValues.bind(this));this.registerFetchData(function(e){return this.getFilterDataAsStringForVariant(true,e)}.bind(this));this.registerApplyData(function(e,t){this.setFilterDataAsStringFromVariant(e,true,t)}.bind(this));this._initializeVariantManagement()}e.attachPendingChange(function(e){this.firePendingChange({pendingValue:e.getParameter("pending")})}.bind(this))}.bind(this))}}};M.prototype._setInitialFocus=function(){var e=this.getAssociation("smartVariant")||this.getConsiderSelectionVariants(),t=this.getBasicSearchControl(),i=this.getAllFilterItems(true),r;if(!e){if(this.getEnableBasicSearch()){this._onAfterRenderingBasicSearchDelegate={onAfterRendering:function(){setTimeout(function(){t.focus();t.removeDelegate(this._onAfterRenderingBasicSearchDelegate)}.bind(this))}.bind(this)};t.addDelegate(this._onAfterRenderingBasicSearchDelegate,this)}else if(i.length>0){r=i[0]._getControl();this._onAfterRenderingFirstFilterVisibleFieldDelegate={onAfterRendering:function(){setTimeout(function(){r.focus();r.removeDelegate(this._onAfterRenderingFirstFilterVisibleFieldDelegate)}.bind(this))}.bind(this)};r.addDelegate(this._onAfterRenderingFirstFilterVisibleFieldDelegate,this)}}};M.prototype.getModelData=function(){return this._oFilterProvider?this._oFilterProvider.getModel().getData():null};M.prototype.getFilterContextUrl=function(){return this._oFilterProvider?this._oFilterProvider.getFilterContextUrl():null};M.prototype.getParameterContextUrl=function(){return this._oFilterProvider?this._oFilterProvider.getParameterContextUrl():null};M.prototype.getFilterBarViewMetadata=function(e){var t;if(this._aFilterBarViewMetadata===null){return[]}t=Object.assign({},this._aFilterBarViewMetadata);t=this._aFilterBarViewMetadata.map(function(t){var i=Object.assign({},t);if(e&&this._oFilterBarViewMetadataExtend!==null){i.fields=i.fields.map(function(e){var t,i=e.groupName,r=e.fullName,a=this._oFilterBarViewMetadataExtend[i]&&this._oFilterBarViewMetadataExtend[i][r];if(a!==undefined){t=Object.assign({},e,a)}else{t=Object.assign({},e)}return t}.bind(this))}return i}.bind(this));return t};M.prototype.getAnalyticalParameters=function(){return this._oFilterProvider?this._oFilterProvider.getAnalyticParameters():[]};M.prototype.getSelectionVariants=function(){var e=null;if(this._oFilterProvider){e=this._oFilterProvider.getSelectionVariants();if(Object.keys(e).length<1){e=null}}return e};M.prototype._createFilterProvider=function(e,t,i,r){return d._createFilterProvider({basicSearchFieldName:this.getBasicSearchFieldName(),enableBasicSearch:this.getEnableBasicSearch(),entityType:i,entitySet:r,serviceUrl:t,isRunningInValueHelpDialog:this.getIsRunningInValueHelpDialog(),model:e,additionalConfiguration:this.getAdditionalConfiguration(),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.data("defaultTokenDisplayBehaviour"),defaultSingleFieldDisplayBehaviour:this.data("defaultSingleFieldDisplayBehaviour"),dateFormatSettings:this.data("dateFormatSettings"),useContainsAsDefaultFilter:this.data("useContainsAsDefaultFilter"),smartFilter:this,filterBarClass:M,considerAnalyticalParameters:this.getConsiderAnalyticalParameters(),useDateRangeType:this.getUseDateRangeType(),considerSelectionVariants:this.getConsiderSelectionVariants(),considerNavigations:this.getUseProvidedNavigationProperties()?this._createArrayFromString(this.getNavigationProperties()):null,suppressValueListsAssociation:this.getSuppressValueListsAssociation()})};M.prototype._createArrayFromString=function(e){return!e?[]:e.split(",").filter(function(e){return e!==""?e.trim():false})};M.prototype._attachAdditionalConfigurationChanged=function(){var e,t,i,r;t=this.getGroupConfiguration();r=t.length;for(i=0;i<r;i++){t[i].attachChange(this._handleGroupConfigurationChanged.bind(this))}e=this.getControlConfiguration();r=e.length;for(i=0;i<r;i++){e[i].attachChange(this._handleControlConfigurationChanged.bind(this))}};M.prototype._handleControlConfigurationChanged=function(e){var t,i,r,a,n;t=e.getParameter("propertyName");i=e.oSource;if(!i){return}a=i.getKey();r=this._getFilterItemByName(a);if(!r){this._handleControlConfigurationChangedForDelayedFilterItems(a,i,t);return}if(t==="visible"){n=i.getVisible();r.setVisible(n)}else if(t==="label"){n=i.getLabel();r.setLabel(n)}else if(t==="visibleInAdvancedArea"){n=i.getVisibleInAdvancedArea();if(r.setVisibleInAdvancedArea){r.setVisibleInAdvancedArea(n)}}};M.prototype._handleControlConfigurationChangedForDelayedFilterItems=function(e,t,i){var r,a;if(this._aFilterBarViewMetadata){this._aFilterBarViewMetadata.some(function(t){t.fields.some(function(t){if(t.fieldName===e){a=t}return!!a});return!!a})}if(a){if(i==="visible"){r=t.getVisible();a.isVisible=r}else if(i==="label"){r=t.getLabel();a.label=r}else if(i==="visibleInAdvancedArea"){r=t.getVisibleInAdvancedArea();a.visibleInAdvancedArea=r}}};M.prototype._handleGroupConfigurationChanged=function(e){var t,i;t=e.getParameter("propertyName");i=e.oSource;if(t==="label"){this._handleGroupConfigurationLabelChanged(i)}};M.prototype._handleGroupConfigurationLabelChanged=function(e){var t,i,r;if(!e){return}r=e.getLabel();i=e.getKey();t=this._getFilterGroupItemByGroupName(i);if(t){t.setGroupTitle(r)}else{this._handleGroupConfigurationLabelChangedForDelayedFilterItems(i,r)}};M.prototype._handleGroupConfigurationLabelChangedForDelayedFilterItems=function(e,t){var i=null;if(this._aFilterBarViewMetadata){this._aFilterBarViewMetadata.some(function(t){if(t.groupName===e){i=t}return!!i})}if(i){i.groupLabel=t}};M.prototype._getFilterItemByName=function(e){return this.determineFilterItemByName(e)};M.prototype._getFilterGroupItemByGroupName=function(e){return this.determineFilterItemByName(e)};M.prototype.determineControlByFilterItem=function(e,t){v.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#determinControlByFilterItem. Consider changing it with proper one.");return this._determineControlByFilterItem.apply(this,arguments)};M.prototype._determineControlByFilterItem=function(e,t){return r.prototype.determineControlByFilterItem.apply(this,arguments)};M.prototype.determineControlByName=function(e,t){v.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#determineControlByName. Consider changing it with proper one.");return this._determineControlByName.apply(this,arguments)};M.prototype._determineControlByName=function(e,t){return r.prototype.determineControlByName.apply(this,arguments)};M.prototype.getAdditionalConfiguration=function(){return new s(this.getControlConfiguration(),this.getGroupConfiguration())};M.prototype.setEntityType=function(e){this.setProperty("entityType",e);this._initializeMetadata();return this};M.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initializeMetadata();return this};M.prototype.setResourceUri=function(e){this.setProperty("resourceUri",e);this._initializeMetadata();return this};M.prototype.propagateProperties=function(){r.prototype.propagateProperties.apply(this,arguments);this._initializeMetadata()};M.prototype._getFilterInformation=function(){var e=this.data("hiddenFields"),t,i,a,n=0,o=0,s,l=[],d;if(this._aFilterBarViewMetadata){n=this._aFilterBarViewMetadata.length;for(i=0;i<n;i++){t=this._aFilterBarViewMetadata[i];s=t.fields;o=s.length;for(a=0;a<o;a++){d=s[a];if(Array.isArray(e)&&e.indexOf(d.name)!==-1){continue}else if(d.name===h.BASIC_SEARCH_FIELD_ID){this.setBasicSearch(d.control);this._attachToBasicSearch(d.control);continue}else if(t.groupName===h.BASIC_FILTER_AREA_ID){this._createFieldInAdvancedArea({groupName:r.INTERNAL_GROUP,groupLabel:""},d)}else{this._createFieldInAdvancedArea(t,d)}l.push(d)}}var u=this.getAnalyticalParameters();n=u.length;for(i=0;i<n;i++){d=u[i];this._createAnalyticParameter(d);l.push(d)}}return l};M.prototype._validateState=function(){var e,t,i,r=false;e=this.getAllFilterItems(true);if(Array.isArray(e)){t=e.length;while(t--){i=this._determineControlByFilterItem(e[t],true);if(i){if(i.__bValidatingToken){this.bIsSearchPending=true;r=true;break}else if(i.getValueState&&i.getValueState()===C.Error&&!i.data("__mandatoryEmpty")){r=true;break}}}}if(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields){var a=Object.keys(this._oFilterProvider._mConditionTypeFields);for(var n=0;n<a.length;n++){var o=a[n];var s=this._oFilterProvider._mConditionTypeFields[o].conditionType;i=s&&s._oInput;if(i&&i.getValueState&&i.getValueState()===C.Error&&!i.data("__mandatoryEmpty")){r=true;break}}}if(this._oFilterProvider){return!r&&!this._oFilterProvider._validateConditionTypeFields()}else{return!r}};M.prototype._isDateRangeTypeFilter=function(e){return!!(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields[e])};M.prototype._specialControls=function(e,t){return!!(e.setValue&&(this._isDateRangeTypeFilter(t)||e.isA("sap.m.DatePicker")))};M.prototype._clearErroneusControlValues=function(){var e,t,i,r;e=this.getAllFilterItems(true);if(e){t=e.length;while(t--){i=this._determineControlByFilterItem(e[t],true);if(i){if(i.getValueState&&i.getValueState()===C.Error){r=i.getBinding("value");if(r&&!this._specialControls(i,e[t].getName())){r.checkUpdate(true)}else if(i.setValue){i.setValue("");i.setValueState(C.None)}}}}}};M.prototype._attachToBasicSearch=function(e){if(e){e.attachSearch(function(e){if(e&&e.getParameter("clearButtonPressed")){return}if(!this.isDialogOpen()){this._searchFromFilterBar()}}.bind(this));e.attachChange(this._onChange.bind(this))}};M.prototype._onLiveChange=function(e){var t=e.getSource();if(t.data("__validationError")&&!t.getValue()){t.data("__validationError",null);t.setValueState(C.None);delete t.__sValidationText}};M.prototype._onChange=function(e){var t=e.getSource();var i=this._oFilterProvider._bUpdatingFilterData||this._oFilterProvider._bCreatingInitialModel;if(t.data("__mandatoryEmpty")){t.data("__mandatoryEmpty",null);t.setValueState(C.None)}if(t.data("__validationError")&&!t.getValue()){t.data("__validationError",null);t.setValueState(C.None)}if(t.isA("sap.m.ComboBox")&&t.getValue()){this._filterSetInErrorState(t);if(!t.getSelectedItem()){t.data("__validationError",true);t.setValueState(C.Error);if(!i){this.fireFilterChange(e)}return}if(t.data("__validationError")){t.data("__validationError",null);t.setValueState(C.None)}}if(i){return}if(!t||t&&!t.__bValidatingToken){this.fireFilterChange(e);this._oFilterProvider._updateConditionTypeFields(e.getParameter("filterChangeReason"))}else{this._filterSetInErrorState(t)}if(this.isLiveMode()){if(e.getSource().isA("sap.m.MultiComboBox")||e.getSource().isA("sap.m.ComboBox")){this.triggerSearch()}else{this._searchFromFilterBar()}}};M.prototype._handleChange=function(e){if(e){if(e.attachChange){e.attachChange(this._onChange.bind(this))}if(e.attachLiveChange){e.attachLiveChange(this._onLiveChange.bind(this))}}};M.prototype._handleSelectionChange=function(e){if(e){if(e.attachSelectionChange){e.attachSelectionChange(this._onChange.bind(this))}}};M.prototype._handleEnter=function(e){if(this.isLiveMode()){return}e.attachBrowserEvent("keydown",function(t){if(t.which===13){e.__bSuggestInProgress=e._oSuggestionPopup&&e._oSuggestionPopup.isOpen()}});e.attachBrowserEvent("keyup",function(t){if(t.which===13&&!e.__bSuggestInProgress&&(e.isA("sap.m.InputBase")||e.isA("sap.m.Select")||e.isA("sap.m.DynamicDateRange"))){this._searchFromFilterBar()}}.bind(this))};M.prototype._createFilterFieldControl=function(e){if(e.conditionType){e.control=e.conditionType.initializeFilterItem()}else if(!e.control&&e.fCreateControl){e.fCreateControl(e);delete e.fCreateControl}this._handleEnter(e.control);this._handleChange(e.control);if(e.isCustomFilterField&&e.control.isA("sap.m.MultiComboBox")){this._handleSelectionChange(e.control)}};M.prototype._createAnalyticParameter=function(e){e.factory=function(){this._createFilterFieldControl(e);if(!e.control){return}var t=new a({controlTooltip:e.quickInfo,name:e.fieldName,mandatory:e.isMandatory,visible:e.isVisible,control:e.control,hiddenFilter:false});this._setLabel(t,e.label);this._addParameter(t)}.bind(this);e.groupName=r.INTERNAL_GROUP;return e};M.prototype._createFieldInAdvancedArea=function(e,t){t.factory=function(){this._createFilterFieldControl(t);var i=new a({controlTooltip:t.quickInfo,name:t.fieldName,groupName:e.groupName,groupTitle:e.groupLabel,entitySetName:t.groupEntitySet,entityTypeName:t.groupEntityType,mandatory:t.isMandatory,visible:t.isVisible,visibleInAdvancedArea:t.visibleInAdvancedArea||e.groupName===r.INTERNAL_GROUP,control:t.control,hiddenFilter:t.hiddenFilter});if(t.isCustomFilterField){i.data("isCustomField",true);this._attachCustomControlCustomDataChange(i._getControl().getCustomData())}if(t.control&&t.control.getTooltip&&t.control.getTooltip()){i.setControlTooltip(t.control.getTooltip())}if(t.quickInfo){this._setLabelTooltip(i,t.quickInfo)}this._setLabel(i,t.label);this.addFilterGroupItem(i)}.bind(this);t.groupName=e.groupName;t.groupTitle=e.groupLabel;return t};M.prototype._setLabel=function(e,t){if(t.match(/{@i18n>.+}/gi)){e.bindProperty("label",t.substring(1,t.length-1))}else{e.setLabel(t)}};M.prototype._setLabelTooltip=function(e,t){var i=/{(@?i18n>.+)}/i.exec(t);if(i&&i[1]){e.bindProperty("labelTooltip",i[1])}else{e.setLabelTooltip(t)}};M.prototype._logAccessWhenNotInitialized=function(e){if(!this.bIsInitialised){v.error("SmartFilterBar."+e+": called before the SmartFilterBar is initialized")}};M.prototype.ensureLoadedValueHelp=function(e){this._logAccessWhenNotInitialized("ensureLoadedValueHelp");if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueHelpProviders().some(function(t){if(t.sFieldName===e){this._ensureLoadedValueHelpList(t);return true}}.bind(this))}};M.prototype.ensureLoadedValueList=function(e){if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueListProviders().some(function(t){if(t.sFieldName===e){this._ensureLoadedValueHelpList(t);return true}}.bind(this))}};M.prototype._ensureLoadedValueHelpList=function(e){if(!e._bValueListRequested){e.loadAnnotation()}};M.prototype._getValueListHelpProvider=function(e){var t=null;if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueListProviders().some(function(i){if(i.sFieldName===e){t=i}return t!=null});if(!t){this._oFilterProvider.getAssociatedValueHelpProviders().some(function(i){if(i.sFieldName===e){t=i}return t!=null})}}return t};M.prototype.getDescriptionForKeys=function(e){var t=[];if(e){e.forEach(function(e){var i=this._getValueListHelpProvider(e.filterName);if(i){if(!i._bValueListRequested){i.loadAnnotation()}e.provider=i;t.push(e)}}.bind(this));if(t&&t.length>0){t.forEach(function(e){if(e.provider){e.provider.readData(e.keys)}})}}};M.prototype.ensureLoadedValueHelpList=function(e){this.ensureLoadedValueHelp(e);this.ensureLoadedValueList(e)};M.prototype.getFilters=function(e){this._logAccessWhenNotInitialized("getFilters");if(!e||!e.length){if(this.getIsRunningInValueHelpDialog()){e=this._getAllFieldNames()}else{e=this._getVisibleFieldNames(true)}}return this._oFilterProvider?this._oFilterProvider.getFilters(e):[]};M.prototype.getParameters=function(){this._logAccessWhenNotInitialized("getParameters");return this._oFilterProvider?this._oFilterProvider.getParameters():{}};M.prototype.getAnalyticBindingPath=function(){var e="";this._logAccessWhenNotInitialized("getAnalyticBindingPath");if(this._oFilterProvider){e=this._oFilterProvider.getAnalyticBindingPath()}return e};M.prototype.getParameterBindingPath=function(){return this.getAnalyticBindingPath()};M.prototype.getControlByKey=function(e){v.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#getControlByKey. Consider changing it with proper one.");this._logAccessWhenNotInitialized("getControlByKey");return this._determineControlByName(e)};M.prototype._getAllFieldNames=function(){var e,t=[],i,r,a;if(this._oFilterProvider&&this._oFilterProvider._oMetadataAnalyser){e=this._oFilterProvider._oMetadataAnalyser.getFieldsByEntitySetName(this.getEntitySet())}if(e){r=e.length;for(i=0;i<r;i++){a=e[i];if(a){t.push(a.name)}}}return t};M.prototype._getAllFilterAndParameterNames=function(e){var t=[],i=this.getAllFilterItems(false),r=i.length,a;while(r--){a=i[r];if(a){if(e&&a._isParameter()){continue}t.push(a.getName())}}return t};M.prototype._getVisibleFieldNames=function(e){var t=[],i=this.getAllFilterItems(true),r=i.length,a;while(r--){a=i[r];if(a){if(e&&a._isParameter()){continue}t.push(a.getName())}}return t};M.prototype._checkHasValueData=function(e){if(!e||e==="false"){return false}if(typeof e==="boolean"){return e}else if(typeof e==="string"&&e.toLowerCase()==="true"){return true}return false};M.prototype._checkForValues=function(e,t,i){var r=null,a;if(e&&t&&i){if(!t.data("isCustomField")){r=e[t.getName()];if(!r&&i.getSelectedItem&&i.getSelectedItem()){a=h._getFieldMetadata(this._aFilterBarViewMetadata,t.getName());if(a&&a.type==="Edm.Boolean"){if(i.getSelectedItem().getKey()===""){return false}}return true}if(!r&&i.getSelectedKey&&i.getSelectedKey()){return true}if(r&&i.isA("sap.m.ComboBox")&&!i.getItemByKey(r.toString())){return false}if(r===undefined){return false}}else{var n=i.data("hasValue");if(n!==undefined&&n!=null){return this._checkHasValueData(n)}else{if(i.getValue){if(i.getValue()){return true}}if(i.getSelectedItem&&i.getSelectedItem()){return true}if(i.getSelectedKey&&i.getSelectedKey()){return true}if(i.getSelectedKeys&&i.getSelectedKeys().length>0){return true}if(i.getTokens&&i.getTokens().length>0){return true}}}}return!!r};M.prototype.getFiltersWithValues=function(){this._logAccessWhenNotInitialized("getFiltersWithValues");return this._getFiltersWithAssignedValues(true)};M.prototype.getAllFiltersWithValues=function(){return this._getFiltersWithAssignedValues(false)};M.prototype._getFiltersWithAssignedValues=function(e){var t=[];var i=this.getAllFilterItems(e),r,a,n=0,o;if(e){r=this.getFilterData()}else if(this._oFilterProvider){r=this._bSetFilterDataSuspended?this._oStoredFilterData:this._oFilterProvider.getFilledFilterData(this._getAllFilterAndParameterNames())}if(i&&r){n=i.length;while(n--){a=i[n];o=this._determineControlByFilterItem(a,true);if(this._checkForValues(r,a,o)){t.push(a)}}}return t.reverse()};M.prototype._checkIfFilterHasValue=function(e,t){var i=t||this._oFilterProvider.getFilterData();var r=i[e]||i._CUSTOM&&i._CUSTOM[e];if(r===null||typeof r==="undefined"){return false}if(typeof r==="string"&&r){return true}if(typeof r==="number"){return true}if(typeof r==="object"&&Object.prototype.toString.call(r)==="[object Date]"){return true}if(typeof r==="object"&&(r.hasOwnProperty("low")||r.hasOwnProperty("high"))){return!!r.low||!!r.high}if(typeof r==="object"&&(r.hasOwnProperty("value")||r.hasOwnProperty("items")||r.hasOwnProperty("ranges"))){return!!r.value||r.items&&!!r.items.length||r.ranges&&!!r.ranges.length}return false};M.prototype._checkIfCustomControlFilterHasValue=function(e){if(!e.control){return false}return e.control.data("hasValue")};M.prototype._removeEmptyFilters=function(e){var t=JSON.parse(e);var i={};Object.keys(t).forEach(function(e){if(e==="_CUSTOM"||this._checkIfFilterHasValue(e)){i[e]=t[e]}}.bind(this));return JSON.stringify(i)};M.prototype._removeValuesForNonPartOfCurrentVariants=function(e){var t=[];if(this._oFilterProvider&&e&&e.length>0){var i=this._oFilterProvider.getFilterData();e.forEach(function(e){var r=e.getName();if(!e.data("isCustomField")){var a=this._oFilterProvider._getFieldMetadata(r);if(a.conditionType){t.push(a)}this._oFilterProvider._createInitialModelForField(i,a,false)}else if(i._CUSTOM&&i._CUSTOM[r]){delete i._CUSTOM[r]}},this);this.setFilterData(i);t.forEach(function(e){var t=e.fieldName;this._oFilterProvider._mConditionTypeFields[t].conditionType.initialize(i[t])},this)}};M.prototype.getFilterDataAsStringForVariant=function(e,t){var i={},r=this._oFilterProvider._aFilterBarDateTimeFieldNames;if(r.length>0){i=V(i,this.getFilterData(e));r.forEach(function(e){var t,r,a=h._getFieldMetadata(this._aFilterBarViewMetadata,e);if(a&&a.type==="Edm.DateTimeOffset"){r=i[e];if(r&&r.low){if(a.filterRestriction===P.interval){t=p.parseDateTimeOffsetInterval(r.low);if(t&&t.length===2){r.low=a.ui5Type.parseValue(t[0],"string");r.high=a.ui5Type.parseValue(t[1],"string")}}}}}.bind(this));if(t==="V3"){this._oFilterProvider._aFilterBarDateFieldNames.concat(this._oFilterProvider._aFilterBarTimeFieldNames).forEach(function(e){var t,r=h._getFieldMetadata(this._aFilterBarViewMetadata,e);if(!r){r=this.getParameterMetadata(e)}if(r&&(r.filterType==="date"||r.filterType==="time")){t=i[e];var a=this._oFilterProvider._isSingleDynamicDateEnabled(r);if(t){if(r.filterRestriction===P.multiple||r.filterRestriction===P.auto){this._processDateRanges(t.ranges)}else if(r.filterRestriction===P.single&&a){this._processDateRanges(t.ranges)}else if(r.filterRestriction===P.single){i[e]=this._dateConvert(t)}else if(r.filterRestriction===P.interval){if(t.ranges){this._processDateRanges(t.ranges)}else{if(t.low){t.low=this._dateConvert(t.low)}if(t.high){t.high=this._dateConvert(t.high)}}}}}}.bind(this))}return JSON.stringify(i)}else{return this.getFilterDataAsString(e)}};M.prototype._dateConvert=function(e){if(this.isInUTCMode()){if(typeof e==="string"){e=new Date(e)}e=t.localToUtc(e).toJSON()}if(e.indexOf&&e.indexOf("Z")===e.length-1){e=e.substr(0,e.length-1)}return e};M.prototype._processDateRanges=function(e){if(!Array.isArray(e)){return}e.forEach(function(e){e.tokenText=null;if(e.value1){e.value1=this._dateConvert(e.value1)}if(e.value2){e.value2=this._dateConvert(e.value2)}}.bind(this))};M.prototype.getFilterData=function(e){if(this._bSetFilterDataSuspended){return Object.assign({},this._oStoredFilterData)}var t=this._oFilterProvider;this._logAccessWhenNotInitialized("getFilterData");if(!t){return null}return e?t.getFilterData():t.getFilledFilterData(this._getVisibleFieldNames())};M.prototype.getFilterDataAsString=function(e){var t=this._oFilterProvider;this._logAccessWhenNotInitialized("getFilterDataAsString");if(!t){return null}return e?t.getFilterDataAsString():t.getFilledFilterDataAsString(this._getVisibleFieldNames())};M.prototype.getParameterMetadata=function(e){var t=null,i=this.getAnalyticalParameters();if(e.indexOf(o.ANALYTICAL_PARAMETER_PREFIX)===0){e=e.substring(o.ANALYTICAL_PARAMETER_PREFIX.length)}if(Array.isArray(i)){i.some(function(i){if(i.name===e){t=i}return t!==null})}return t};M.prototype.setFilterDataAsStringFromVariant=function(e,t,i){var r,a=this._oFilterProvider._aFilterBarDateTimeFieldNames;if(e){if(a.length>0){r=JSON.parse(e);a.forEach(function(e){var t,i=h._getFieldMetadata(this._aFilterBarViewMetadata,e);if(i&&i.type==="Edm.DateTimeOffset"){t=r[e];if(t&&(i.filterRestriction===P.multiple||i.filterRestriction===P.auto)){if(t.ranges){for(var a=0;a<t.ranges.length;a++){delete t.ranges[a].tokenText}}}}}.bind(this));if(i==="V3"){this._oFilterProvider._aFilterBarDateFieldNames.concat(this._oFilterProvider._aFilterBarTimeFieldNames).forEach(function(e){var t,i=h._getFieldMetadata(this._aFilterBarViewMetadata,e);if(!i){i=this.getParameterMetadata(e)}if(i&&(i.filterType==="date"||i.filterType==="time")){t=r[e];if(t){if(t.ranges){for(var a=0;a<t.ranges.length;a++){delete t.ranges[a].tokenText}}}}}.bind(this))}this.setFilterData(r,t)}else{this.setFilterDataAsString(e,t)}}};M.prototype.setFilterData=function(e,t){if(this._bSetFilterDataSuspended){if(t){this._oStoredFilterData=e}else{this._oStoredFilterData=Object.assign({},this._oStoredFilterData,e)}return}this._setFilterData(e,t)};M.prototype.suspendSetFilterData=function(){this._bSetFilterDataSuspended=true};M.prototype.resumeSetFilterData=function(){if(this._bSetFilterDataSuspended){this._bSetFilterDataSuspended=false;this.setFilterData(this._oStoredFilterData,true);this._oStoredFilterData={}}};M.prototype._setFilterData=function(e,t){var i;this._logAccessWhenNotInitialized("setFilterData");if(e){Object.keys(e).forEach(function(t){i=this._getFilterMetadata(t);if(i&&this._checkIfFilterHasValue(t,e)){this._instanciateFilterItem(i)}}.bind(this))}if(this._oFilterProvider){this._oFilterProvider.setFilterData(e,t)}if(e&&Object.keys(e).length===1&&e._CUSTOM){return}this.fireFilterChange({afterFilterDataUpdate:true})};M.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};M.prototype.fireClear=function(){this._clearFilterFields();this.fireEvent("clear",arguments)};M.prototype._clearFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.clear();this._clearErroneusControlValues()}this.fireFilterChange({afterFilterDataUpdate:true})};M.prototype.fireReset=function(){this._resetFilterFields();this.fireEvent("reset",arguments)};M.prototype._resetFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.reset();this._clearErroneusControlValues()}this.fireFilterChange({afterFilterDataUpdate:true})};M.prototype._suspendedTriggerSearch=function(e){if(this.getSuppressSelection()){return}this._oSuspendedTriggerSearch={delay:e};return true};M.prototype._regularTriggerSearch=function(e){if(this.getSuppressSelection()){return}this._clearDelayedSearch();this._iDelayedSearchId=setTimeout(function(){var e=this._getVisibleControlsLoadingPromises();if(!this._bSearchTriggeredOnce&&e.length){Promise.all(e).then(this._search.bind(this)).catch(this._search.bind(this))}else{this._search()}}.bind(this),e||0)};M.prototype.suspendSelection=function(){this.triggerSearch=this._suspendedTriggerSearch};M.prototype.resumeSelection=function(){this.triggerSearch=this._regularTriggerSearch;if(this._oSuspendedTriggerSearch){this.triggerSearch(this._oSuspendedTriggerSearch.delay);this._oSuspendedTriggerSearch=undefined}};M.prototype.triggerSearch=M.prototype._regularTriggerSearch;M.prototype._getVisibleControlsLoadingPromises=function(){var e=[];this.determineMandatoryFilterItems().forEach(function(t){var r=t._getControl();if(r&&r.isA("sap.m.ComboBox")&&!r.getItems().length){e.push(new Promise(function(e){var t=r.getBinding("items"),a;if(t){t.attachEventOnce("dataReceived",e);return}a=new i(function(t){if(t&&t.mutation==="ready"){r.getBinding("items").attachEventOnce("dataReceived",e);a.unobserve(r,{bindings:["items"]})}});a.observe(r,{bindings:["items"]});this._oObservers.push(a)}.bind(this)))}}.bind(this));return e};M.prototype.search=function(e){if(this.getSuppressSelection()){return undefined}this._logAccessWhenNotInitialized("search");if(e&&!this.isLiveMode()){return this._search()}this.triggerSearch(0);return true};M.prototype._search=function(){var t=true,i=false,r,a,n;this._bSearchTriggeredOnce=true;a=this.verifySearchAllowed();if(a.hasOwnProperty("pending")){if(this._iDelayedSearchId&&!this.getSuppressSelection()){this.triggerSearch()}return undefined}else if(a.hasOwnProperty("error")){t=false;i=true}else if(a.hasOwnProperty("mandatory")){t=false}if(this.isPending()&&!this._bIsPendingChangeAttached){n=function(e){if(e.getParameter("pendingValue")===false){this.detachPendingChange(n);this._bIsPendingChangeAttached=false;this.triggerSearch()}}.bind(this);this._bIsPendingChangeAttached=true;this.attachPendingChange(n);return undefined}this._clearDelayedSearch();if(t){if(this._isTablet()&&this.getUseToolbar()&&!this.getAdvancedMode()){this.setFilterBarExpanded(false)}this.fireSearch([{selectionSet:this._retrieveCurrentSelectionSet(false,true),firedFromFilterBar:this._bSearchFiredFromFilterBar}]);this._bSearchFiredFromFilterBar=false}else{if(!this._oResourceBundle){this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}if(!i){if(!this._sMandatoryErrorMessage){this._sMandatoryErrorMessage=this._oResourceBundle.getText("EMPTY_MANDATORY_MESSAGE")}r=this._sMandatoryErrorMessage}else{if(!this._sValidationErrorMessage){this._sValidationErrorMessage=this._oResourceBundle.getText("VALIDATION_ERROR_MESSAGE")}r=this._sValidationErrorMessage}if(this.getShowMessages()&&!this.getLiveMode()){try{e.error(r,{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:this._setFocusOnFirstErroneousField.bind(this)})}catch(e){return undefined}}else{this._setFocusOnFirstErroneousField();v.warning("search was not triggered. "+r);if(b.system.desktop){this.setFilterBarExpanded(true)}}if(this._bExpandAdvancedFilterArea&&this.rerenderFilters){this.rerenderFilters(true)}}return t};M.prototype.validateMandatoryFields=function(){this._logAccessWhenNotInitialized("validateMandatoryFields");return this._validateMandatoryFields()};M.prototype.verifySearchAllowed=function(){this._logAccessWhenNotInitialized("verifySearchAllowed");this.bIsSearchPending=false;if(this._validateState()){if(this.validateMandatoryFields()){return{}}return{mandatory:true}}if(this.bIsSearchPending){return{pending:true}}return{error:true}};M.prototype._setFocusOnFirstErroneousField=function(){var e,t,i,r;e=this.getAllFilterItems(true);if(Array.isArray(e)){t=e.length;for(r=0;r<t;r++){i=this._determineControlByFilterItem(e[r],true);if(i&&i.getValueState&&i.getValueState()===C.Error){setTimeout(i["focus"].bind(i),0);break}}}};M.prototype.setLiveMode=function(e){if(!this._isPhone()){if(e){this.hideGoButton()}else{this.restoreGoButton()}}if(this._oSmartVariantManagement){if(e){if(this._bShowShareState===undefined){this._bShowShareState=this._oSmartVariantManagement.getShowExecuteOnSelection()}this._oSmartVariantManagement.setShowExecuteOnSelection(false)}else if(this._bShowShareState!==undefined){this._oSmartVariantManagement.setShowExecuteOnSelection(this._bShowShareState)}}return this.setProperty("liveMode",e)};M.prototype.isLiveMode=function(){return this._isPhone()?false:this.getLiveMode()};M.prototype._clearDelayedSearch=function(){if(this._iDelayedSearchId){clearTimeout(this._iDelayedSearchId);this._iDelayedSearchId=null}};M.prototype.isPending=function(){return!this._oFilterProvider?false:this._oFilterProvider.isPending()};M.prototype._validateMandatoryFields=function(){var e=true,t=this.determineMandatoryFilterItems(),i,r=this.getFilterData(),a=0,n;this._bExpandAdvancedFilterArea=false;if(t&&r){a=t.length;while(a--){i=t[a];n=this._determineControlByFilterItem(i,true);if(n&&n.setValueState){if(this._checkForValues(r,i,n)){if(n.data("__mandatoryEmpty")){n.data("__mandatoryEmpty",null);n.setValueState(C.None)}}else{e=false;n.setValueState(C.Error);n.data("__mandatoryEmpty",true);if(i.getGroupName){this._bExpandAdvancedFilterArea=true}}}}}return e};M.prototype._setSmartVariant=function(e){var t;if(!e){return}t=sap.ui.getCore().byId(e);if(t){if(t.isA("sap.ui.comp.smartvariants.SmartVariantManagement")){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._replaceVariantManagement(t);this._oSmartVariantManagement=t}}else{v.error("Control with the id="+e+" not of expected type")}}else{v.error("Control with the id="+e+" not found")}};M.prototype.setSmartVariant=function(e){if(this.getAdvancedMode()){v.error("not supported for the advanced mode");return this}this.setAssociation("smartVariant",e);this._setSmartVariant(e);return this};M.prototype.getSmartVariant=function(){if(this.getAdvancedMode()){v.error("not supported for the advanced mode");return null}var e=this.getAssociation("smartVariant");if(e){return sap.ui.getCore().byId(e)}return this._oSmartVariantManagement};M.prototype._createVariantManagement=function(){if(this.getAdvancedMode()){return r.prototype._createVariantManagement.apply(this)}this._setSmartVariant(this.getSmartVariant());if(!this._oSmartVariantManagement){this._oSmartVariantManagement=new c(this.getId()+"-variant",{showExecuteOnSelection:true,showShare:true})}return this._oSmartVariantManagement};M.prototype._initializeVariantManagement=function(){if(!this.getIsRunningInValueHelpDialog()&&this._oSmartVariantManagement&&this.getPersistencyKey()){var e=new f({type:"filterBar",keyName:"persistencyKey",dataSource:this.getEntitySet()||this.getEntityType()});e.setControl(this);if(this.getConsiderSelectionVariants()&&!this._oSmartVariantManagement.isPageVariant()){this._oSmartVariantManagement._createMetadataPromise();this._prepareSelectionVariants();this._oSmartVariantManagement._resolveMetadataPromise()}this._oSmartVariantManagement.addPersonalizableControl(e);if(this._checkHasValueData(this.data("executeStandardVariantOnSelect"))){this._oSmartVariantManagement._executeOnSelectForStandardVariantByXML(true)}r.prototype._initializeVariantManagement.apply(this,arguments)}else{this.fireInitialise();this.fireInitialized()}};M.prototype.fireInitialized=function(){if(this.getConsiderSelectionVariants()&&this._oSmartVariantManagement&&!this._oSmartVariantManagement.isPageVariant()){if(this._oStandardSelectionVariant){this._oSmartVariantManagement._oStandardVariant=V({},this._defaultSelectionVariantHandling(this._oStandardSelectionVariant))}if(!this._oSmartVariantManagement._getDefaultVariantKey()){if(this.getDefaultSelectionVariantName()){var e=M.SELECTION_VARIANT_KEY_PREFIX+this.getDefaultSelectionVariantName();this._oSmartVariantManagement.setInitialSelectionKey(e);this._oSmartVariantManagement.fireSelect({key:e})}else if(this._oStandardSelectionVariant){this._oSmartVariantManagement.fireSelect({key:this._oSmartVariantManagement.STANDARDVARIANTKEY})}}this._oStandardSelectionVariant=null}r.prototype.fireInitialized.apply(this,arguments)};M.prototype._prepareSelectionVariants=function(){var e,t=M.SELECTION_VARIANT_KEY_PREFIX,i=[],r=this._oSmartVariantManagement;e=this.getSelectionVariants();if(e){var a={callback:this.getSelectionVariant,handler:this};e.forEach(function(e){var r=t+e.qualifier;if(e.qualifier){i.push({id:r,favorite:true,name:e.annotation.Text.String})}else{this._oStandardSelectionVariant=e}}.bind(this));if(i.length>0){a.variants=i;r.registerSelectionVariantHandler(a,t)}}};M.prototype._defaultSelectionVariantHandling=function(e){var t={},i=this._oSmartVariantManagement,r,a;if(!i||i._sAppStandardVariantKey||!(e&&e.annotation)){return t}t=this.convertSelectionVariantToInternalVariant(e.annotation);if(!t){return t}if(!i.isPageVariant()){t.version="V1";a=JSON.parse(t.filterBarVariant);if(i._oStandardVariant){r=JSON.parse(i._oStandardVariant.filterBarVariant);if(r._CUSTOM){a._CUSTOM=r._CUSTOM;t.filterBarVariant=JSON.stringify(a)}}}return t};M.prototype._adaptFilterVisibilityProperties=function(e){var t,i=[];if(this._oSmartVariantManagement&&this._oSmartVariantManagement._oStandardVariant&&this._oSmartVariantManagement._oStandardVariant.filterbar){V(i,this._oSmartVariantManagement._oStandardVariant.filterbar)}Object.keys(e).forEach(function(e){t=false;i.some(function(i){if(i.name===e){t=true;i.partOfCurrentVariant=true}return t});if(!t){i.push({group:this._determineGroupNameByName(e),name:e,partOfCurrentVariant:true,visibleInFilterBar:false,visible:true})}}.bind(this));return i};M.prototype.getSelectionVariant=function(e){var t=null,i=null,r=e.substring(M.SELECTION_VARIANT_KEY_PREFIX.length);this.getSelectionVariants().some(function(e){if(e.qualifier===r){i=e;return true}return false});if(i){if(i.variantContent){t=i.variantContent}else{t=this.convertSelectionVariantToInternalVariant(i.annotation);i.variantContent=t}}return t};M.prototype.convertSelectionVariantToInternalVariant=function(e){var t=JSON.parse(JSON.stringify(e)),i,r,a,n=t.SelectOptions,o=t.Parameters,s;if(n||o){a=new F(null,"/")}if(n){n.forEach(function(e){e.PropertyName=e.PropertyName.PropertyPath;e.Ranges.forEach(function(e){e.Sign=e.Sign.EnumMember.split("/")[1];e.Option=e.Option.EnumMember.split("/")[1];e.Low=e.Low&&y.format(a,e.Low)||null;e.High=e.High&&y.format(a,e.High)||null})})}if(o){o.forEach(function(e){e.PropertyName=e.PropertyName.PropertyPath.split("/")[1]||e.PropertyName.PropertyPath;e.PropertyValue=y.format(a,e.PropertyValue)||null})}s=new S;i=s.convert(JSON.stringify(t),this,true);r=JSON.parse(i.payload);i={version:"V2",filterbar:this._adaptFilterVisibilityProperties(r),filterBarVariant:JSON.stringify(r)};return i};M.prototype.getBasicSearchControl=function(){return sap.ui.getCore().byId(this.getBasicSearch())};M.prototype.addFieldToAdvancedArea=function(e){var t;this._logAccessWhenNotInitialized("addFieldToAdvancedArea");t=this._getFilterItemByName(e);if(t&&t.setVisibleInAdvancedArea){t.setVisibleInAdvancedArea(true)}};M.prototype._onCustomFieldCustomDataChange=function(e){var t=e.getParameter("newValue"),i=e.getParameter("oldValue"),r=e.getParameter("name");if(i!==t&&r==="value"){this._updateToolbarText()}};M.prototype._attachCustomControlCustomDataChange=function(e){var t,i;for(i=0;i<e.length;i++){t=e[i];if(t.getKey()==="hasValue"){t.attachEvent("_change",this._onCustomFieldCustomDataChange,this);break}}};M.prototype.getConditionTypeByKey=function(e){if(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields[e]){return this._oFilterProvider._mConditionTypeFields[e].conditionType}if(this._oFilterProvider&&e.indexOf(A)===-1&&this._oFilterProvider._mConditionTypeFields[A+e]){return this._oFilterProvider._mConditionTypeFields[A+e].conditionType}};M.prototype.getDateRangeTypeByKey=function(e){return this.getInitializedPromise().then(function(){if(this._oFilterProvider._mConditionTypeFields[e]){return this._oFilterProvider._mConditionTypeFields[e].conditionType}if(e.indexOf(A)===-1&&this._oFilterProvider._mConditionTypeFields[A+e]){return this._oFilterProvider._mConditionTypeFields[A+e].conditionType}}.bind(this))};M.prototype.setDateRangeTypeOperationByKey=function(e,t){return this.getDateRangeTypeByKey(e).then(function(e){if(e&&typeof e.setOperation==="function"){e.setOperation(t)}})};M.prototype.isInUTCMode=function(){if(this._oFilterProvider&&this._oFilterProvider._oDateFormatSettings){return this._oFilterProvider._oDateFormatSettings.UTC}return false};M.prototype.isInitialised=function(){return!!this.bIsInitialised};M.prototype.associateValueLists=function(){if(this.getSuppressValueListsAssociation()&&this._oFilterProvider){this._oFilterProvider._fireEvent(h.ASSOCIATE_VALUE_LISTS);this._oFilterProvider._bSuppressValueListsAssociation=false;this._valueListAnnotationsLoaded();if(typeof this._enhanceFilterItemsWithTextOnValueListAssociation==="function"){this._enhanceFilterItemsWithTextOnValueListAssociation()}}};M.prototype._refreshFiltersCountOnValueListAnnotationLoaded=function(){for(var e=0;e<this._oFilterProvider._aFilterBarDropdownFieldMetadata.length;e++){var t=this._oFilterProvider._aFilterBarDropdownFieldMetadata[e].control;if(t&&t.isA("sap.m.ComboBox")){t.addEventDelegate({onAfterRendering:function(){this.refreshFiltersCount()}.bind(this)})}}};M.prototype._enhanceFilterItemsWithTextValue=function(e,t){if(!this._enhanceFilterItemsWithTextOnValueListAssociation&&this.getSuppressValueListsAssociation()){this._enhanceFilterItemsWithTextOnValueListAssociation=function(){var e=this.getUiState();r.prototype._enhanceFilterItemsWithTextValue.call(this,e.getValueTexts(),e.getSelectionVariant())}.bind(this)}else{r.prototype._enhanceFilterItemsWithTextValue.apply(this,arguments)}};M.prototype._createVisibleFilters=function(){r.prototype._createVisibleFilters.apply(this,arguments);if(!this.getSuppressValueListsAssociation()&&this._oFilterProvider){this._valueListAnnotationsLoaded()}this._setInitialFocus()};M.prototype._valueListAnnotationsLoaded=function(){return this._fireValueListAnnotationLoaded().then(this._refreshFiltersCountOnValueListAnnotationLoaded.bind(this))};M.prototype._attachValueListAnnotationLoaded=function(e,t,i){this.attachEvent("valueListAnnotationLoaded",e,t,i)};M.prototype._fireValueListAnnotationLoaded=function(e){var t=this._oFilterProvider&&Array.isArray(this._oFilterProvider.aFilterAnnotations)?this._oFilterProvider.aFilterAnnotations:[];return Promise.all(t).then(function(){this.fireEvent("valueListAnnotationLoaded",e)}.bind(this))};M.prototype.getSuppressValueListsAssociation=function(){return false};M.prototype.setCustomFilterData=function(e){if(this._oFilterProvider&&this._oFilterProvider.getModel()){this._oFilterProvider.getModel().setProperty("/"+h.CUSTOM_FIELDS_MODEL_PROPERTY,e)}};M.prototype.getCustomFilterData=function(){if(this._oFilterProvider&&this._oFilterProvider.getModel()){return this._oFilterProvider.getModel().getProperty("/"+h.CUSTOM_FIELDS_MODEL_PROPERTY)}};M.prototype.refreshFiltersCount=function(){return Promise.all(this._oFilterProvider._getCurrentValidationPromises()).then(function(){return this._updateToolbarText()}.bind(this))};M.prototype.hasDateRangeTypeFieldsWithValue=function(){var e=this._oFilterProvider,t=this.getFilterData(),i=Object.keys(e._mConditionTypeFields).some(function(e){return!!t[e]});return this.getInitializedPromise().then(function(){return i})};M.prototype.destroy=function(){this._clearDelayedSearch();if(this._oFilterProvider&&this._oFilterProvider.destroy){this._oFilterProvider.destroy()}this._oFilterProvider=null;if(this._oSmartVariantManagement&&this.getConsiderSelectionVariants()){this._oSmartVariantManagement.unregisterSelectionVariantHandler(this)}r.prototype.destroy.apply(this,arguments);sap.ui.getCore().getMessageManager().unregisterObject(this);this._oObservers.forEach(function(e){e.disconnect();e.destroy()});this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._bExpandAdvancedFilterArea=null;this._oResourceBundle=null;this._sMandatoryErrorMessage=null;this._sValidationErrorMessage=null;this._oSmartVariantManagement=null};return M});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SmartFilterBarFilterGroupItem", ["sap/ui/comp/filterbar/FilterGroupItem","sap/ui/comp/library","sap/base/Log"],function(t,r,e){"use strict";var o=t.extend("sap.ui.comp.smartfilterbar.SmartFilterBarFilterGroupItem",{metadata:{library:"sap.ui.comp"}});o.prototype.getControl=function(){e.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBarFilterGroupItem#getControl. Use sap.ui.core.Core.byId instead.");return o.prototype._getControl.apply(this,arguments)};o.prototype._getControl=function(){return t.prototype.getControl.apply(this,arguments)};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SortingUtil", [],function(){"use strict";var e={sortByIndex:function(e){var n,r,t,i;if(!e||!e.length){return e}r=[];n=[];for(var s=0;s<e.length;s++){i=e[s];t=i.index;if(t>=0){n.push(i)}else{r.push(i)}}if(n.length){n=n.sort(function(e,n){return e.index-n.index});if(!r.length){r=n}else{for(var f=0;f<n.length;f++){i=n[f];if(i.index>=r.length){r.push(i)}else{r.splice(i.index,0,i)}}}}return r},groupSorting:function(e){var n=[];n=this.sortByIndex(e);for(var r=0;r<n.length;r++){if(n[r].fields){n[r].fields=this.sortByIndex(n[r].fields)}}return n},destroy:function(){}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/ColumnLayout", ["sap/ui/comp/library","sap/ui/core/Element"],function(a,e){"use strict";var u=e.extend("sap.ui.comp.smartform.ColumnLayout",{metadata:{interfaces:["sap.ui.comp.smartform.SmartFormLayout"],library:"sap.ui.comp",properties:{columnsXL:{type:"sap.ui.layout.form.ColumnsXL",group:"Appearance",defaultValue:2},columnsL:{type:"sap.ui.layout.form.ColumnsL",group:"Appearance",defaultValue:2},columnsM:{type:"sap.ui.layout.form.ColumnsM",group:"Appearance",defaultValue:1},labelCellsLarge:{type:"sap.ui.layout.form.ColumnCells",group:"Appearance",defaultValue:4},emptyCellsLarge:{type:"sap.ui.layout.form.EmptyCells",group:"Appearance",defaultValue:0}}}});return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/Group", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/layout/form/FormContainer","sap/base/Log"],function(t,e,i,r){"use strict";var o;var a=i.extend("sap.ui.comp.smartform.Group",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/Group.designtime",properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"groupElements",aggregations:{groupElements:{type:"sap.ui.comp.IFormGroupElement",multiple:true,singularName:"groupElement"},layout:{type:"sap.ui.layout.GridData",multiple:false}},_bVisibleElements:false}});a.prototype.init=function(){i.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","label"]})};function s(t){var e=this.getGroupElements();for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartform.SemanticGroupElement")){r.error("useHorizontalLayout can't be used for SemanticGroupElement",this)}else if(e[i].getUseHorizontalLayout()!=t){e[i].setUseHorizontalLayout(t)}}this._updateLayoutData()}a.prototype._updateLayoutData=function(){if(this.getUseHorizontalLayout()){var t=this.getParent();while(t&&!t.addGroup&&t.getParent){t=t.getParent()}if(t){var e=t.getLayout();if(!e||!e.getGridDataSpan()){if(!this.getLayoutData()){if(!o&&!this._bResponsiveFlowLayoutDataRequested){o=sap.ui.require("sap/ui/layout/ResponsiveFlowLayoutData");if(!o){sap.ui.require(["sap/ui/layout/ResponsiveFlowLayoutData"],n.bind(this));this._bResponsiveFlowLayoutDataRequested=true}}if(o&&!this._bResponsiveFlowLayoutDataRequested){var i=new o({linebreak:true,linebreakable:true});i._bCreatedByGroup=true;this.setLayoutData(i)}}}else{this._updateLineBreaks()}}}else{var r=this.getLayoutData();if(r&&r._bCreatedByGroup){this.destroyLayoutData()}}};function n(t){o=t;this._bResponsiveFlowLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._updateLayoutData()}}function l(t){r.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroupElements();for(var i=0;i<e.length;i++){e[i].setHorizontalLayoutGroupElementMinWidth(t)}}a.prototype.setEditMode=function(t){this._setEditable(t);return this};a.prototype._updateLineBreaks=function(){if(!this.getUseHorizontalLayout()){return}var t=this.getParent();if(!t){return}while(t&&!t._getGridDataSpanNumbers&&t.getParent){t=t.getParent()}if(!t._getGridDataSpanNumbers){return}var e=t._getGridDataSpanNumbers();if(!e){return}var i=this.getGroupElements();i=i.filter(function(t){return t.isVisible()});var r=0;var o=0;var a=0;var s=0;var n=false;var l=false;var u=false;var p=false;for(var h=0;h<i.length;h++){var m=i[h];r++;o++;a++;s++;if(e.XL*r>12){n=true;r=1}else{n=false}if(e.L*o>12){l=true;o=1}else{l=false}if(e.M*a>12){u=true;a=1}else{u=false}if(e.S*s>12){p=true;s=1}else{p=false}m._setLinebreak(n,l,u,p)}};a.prototype._updateGridDataSpan=function(){if(!this.getUseHorizontalLayout()){return}var t=this.getGroupElements();for(var e=0;e<t.length;e++){t[e]._updateGridDataSpan()}};a.prototype._updateFormContainerVisibility=function(){var t=this.getGroupElements();var e=false;e=t.some(function(t){return t.isVisible()});if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){this.fireEvent("_visibleChanged")}}};function u(t){var e=this.getTitle();if(e&&typeof e!=="string"){r.error("Title already set, Label can not be set",this)}else{this.setTitle(t)}}a.prototype.setVisible=function(t){var e=this.getVisible();i.prototype.setVisible.apply(this,arguments);if(t!=e||t!=this._bVisibleElements){this.fireEvent("_visibleChanged")}return this};a.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};a.prototype.addGroupElement=function(t){return this.addFormElement(t)};a.prototype.insertGroupElement=function(t,e){return this.insertFormElement(t,e)};a.prototype.getGroupElements=function(){return this.getFormElements()};a.prototype.indexOfGroupElement=function(t){return this.indexOfFormElement(t)};a.prototype.removeGroupElement=function(t){return this.removeFormElement(t)};a.prototype.removeAllGroupElements=function(){return this.removeAllFormElements()};a.prototype.destroyGroupElements=function(){return this.destroyFormElements()};a.prototype.addFormElement=function(t){if(!t){return this}t=this.validateAggregation("groupElements",t,true);p.call(this,t);i.prototype.addFormElement.apply(this,arguments);h.call(this,t);return this};a.prototype.insertFormElement=function(t,e){if(!t){return this}t=this.validateAggregation("groupElements",t,true);p.call(this,t);i.prototype.insertFormElement.apply(this,arguments);h.call(this,t);return this};a.prototype.removeFormElement=function(t){var e=i.prototype.removeFormElement.apply(this,arguments);if(e){e.detachVisibleChanged(this._updateFormContainerVisibility,this);f.call(this,e);this._updateFormContainerVisibility();this._updateLineBreaks()}return e};a.prototype.removeAllFormElements=function(){var t=i.prototype.removeAllFormElements.apply(this,arguments);for(var e=0;e<t.length;e++){var r=t[e];r.detachVisibleChanged(this._updateFormContainerVisibility,this);f.call(this,r)}this._updateFormContainerVisibility();this._updateLineBreaks();return t};a.prototype.destroyFormElements=function(){i.prototype.destroyFormElements.apply(this,arguments);this._updateFormContainerVisibility();this._updateLineBreaks();return this};function p(t){var e=this.getUseHorizontalLayout();var i=this.getHorizontalLayoutGroupElementMinWidth();if(i!=t.getHorizontalLayoutGroupElementMinWidth){t.setHorizontalLayoutGroupElementMinWidth(i)}if(e!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(e)}t.attachVisibleChanged(this._updateFormContainerVisibility,this);m.call(this,t)}function h(t){this._updateFormContainerVisibility();if(this.getUseHorizontalLayout()){t._updateGridDataSpan();this._updateLineBreaks()}}a.prototype.setLayout=function(t){t=this.validateAggregation("layout",t,false);return this.setLayoutData(t)};a.prototype.getLayout=function(){return this.getLayoutData()};a.prototype.destroyLayout=function(t){return this.destroyLayoutData()};a.prototype.addCustomData=function(t){if(!t){return this}i.prototype.addCustomData.apply(this,arguments);var e=this.getGroupElements();for(var r=0;r<e.length;r++){y.call(this,e[r],t)}return this};a.prototype.insertCustomData=function(t,e){if(!t){return this}i.prototype.insertCustomData.apply(this,arguments);var r=this.getGroupElements();for(var o=0;o<r.length;o++){y.call(this,r[o],t)}return this};a.prototype.removeCustomData=function(t){var e=i.prototype.removeCustomData.apply(this,arguments);if(e){var r=this.getGroupElements();for(var o=0;o<r.length;o++){f.call(this,r[o],e.getId())}}return e};a.prototype.removeAllCustomData=function(){var t=i.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){var e=this.getGroupElements();for(var r=0;r<e.length;r++){f.call(this,e[r])}}return t};a.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);var t=this.getGroupElements();for(var e=0;e<t.length;e++){f.call(this,t[e])}return this};function m(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){y.call(this,t,e[i])}}function y(e,i){if(t.smartform.inheritCostomDataToFields(i)){var r=i.clone();r._bFromGroup=true;r._sOriginalId=i.getId();e.addCustomData(r)}}function f(t,e){var i=t.getCustomData();for(var r=0;r<i.length;r++){var o=i[r];if(o._bFromGroup&&(!e||e==o._sOriginalId)){t.removeCustomData(o)}}}a.prototype.clone=function(t,e){var r=this.removeAllGroupElements();var o=i.prototype.clone.apply(this,arguments);for(var a=0;a<r.length;a++){var s=r[a];var n=s.clone(t,e);this.addGroupElement(s);o.addGroupElement(n)}return o};a.prototype._observeChanges=function(t){i.prototype._observeChanges.apply(this,arguments);if(t.name=="label"){u.call(this,t.current)}else if(t.name=="useHorizontalLayout"){s.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){l.call(this,t.current)}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/GroupElement", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/core/Control","sap/ui/layout/form/FormElement","sap/m/Label","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/SmartField","sap/base/Log"],function(e,t,i,a,l,s,r,o){"use strict";var n;var f;var u;var h;var p;var b=e.smartfield.ControlContextType;var d=a.extend("sap.ui.comp.smartform.GroupElement",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IFormGroupElement"],properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}},designtime:"sap/ui/comp/designtime/smartform/GroupElement.designtime"},_bVisibleElements:false,_bHorizontalLayoutUsed:false});d._myVBox=undefined;d.prototype.init=function(){a.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","elementForLabel","_editable"]})};d.prototype._getFieldRelevantForLabel=function(){var e=this.getElements();var t=this.getElementForLabel();if(e.length>t&&e[t]instanceof r){return e[t]}return null};d.prototype._extractFields=function(e,t){var i=[];e.forEach(function(e){if(e instanceof n||e instanceof f){i=i.concat(e.getItems())}else{i.push(e)}});if(i.some(function(e){return e instanceof n||e instanceof f})){i=this._extractFields(i)}if(t){i=i.filter(function(e){return!(e instanceof l)})}return i};d.prototype.setTooltip=function(e){a.prototype.setTooltip.apply(this,[e]);var t=this._getFieldRelevantForLabel();var i=this._getLabel();m.call(this,i,t);return this};function m(e,t){if(e==this._oSetLabel){return}var a;if(this._oSetLabel&&this._oSetLabel instanceof i){a=k.call(this._oSetLabel)}if(!a){a=k.call(this)}if(a){if(e instanceof s){if(t&&t.setTooltipLabel){t.setTooltipLabel(a)}}else{e.setTooltip(a)}}}d.prototype.setLabel=function(e){if(!e&&this._bMoveLabelToVBox){return this.setAggregation("label",e)}if(this._oSetLabel&&typeof this._oSetLabel!=="string"){this._oSetLabel.detachEvent("_change",g,this)}var t;var i;var l;if(typeof e==="string"){t=this._getLabel();if(t){i=t.getText()}}else if(!e&&this._oSetLabel){i=this.getLabelText()}a.prototype.setLabel.apply(this,[e]);this._oSetLabel=e;L.call(this);if(typeof e==="string"){if(this._oLabel instanceof s&&e!=i&&(e.length>0||i.length>0)){l=this._getFieldRelevantForLabel();if(l&&e!=null){if(l.getComputedTextLabel){if(!l._oTextLabelSetByGroupElement){l._oTextLabelSetByGroupElement={oldText:l.getComputedTextLabel()}}l.setTextLabel(e)}}}if(!this._bHorizontalLayoutUsed){this.setAggregation("_label",this._oLabel,true)}this._oLabel.isRequired=c;this._oLabel.isDisplayOnly=y}else{if(e){if(e.isRequired){e.isRequired=c}if(e.isDisplayOnly){e.isDisplayOnly=y}e.attachEvent("_change",g,this)}else{l=this._getFieldRelevantForLabel();if(l){U.call(this,l,i)}}this.updateLabelOfFormElement()}return this};d.prototype.destroyLabel=function(){var e=this.getLabelText();a.prototype.destroyLabel.apply(this);delete this._oSetLabel;L.call(this);var t=this._getFieldRelevantForLabel();if(t){U.call(this,t,e)}this.updateLabelOfFormElement();return this};function g(e){if(e.getParameter("name")=="text"){var t=e.oSource;var i=t.getText();if(this._oLabel){this._oLabel.setText(i)}var a=this._getFieldRelevantForLabel();if(a&&a.getComputedTextLabel){if(!a._oTextLabelSetByGroupElement){a._oTextLabelSetByGroupElement={oldText:a.getComputedTextLabel()}}a.setTextLabel(i)}}}function L(){if(!this._bHorizontalLayoutUsed){return}var e=this.getFields();var t;if(e.length>0){var i=this.getFields()[0];if(i instanceof n){var a=i.getItems();var s=this._getLabel();if(a.length>0&&a[0]instanceof l){t=a[0]}this._bMoveLabelToVBox=true;if(t&&t!=s){i.removeItem(0);if(t._bCreatedByGroupElement){this.setAggregation("_label",t,true)}else{this.setAggregation("label",t)}}if(s&&t!=s){i.insertItem(s,0)}this._bMoveLabelToVBox=false;_.call(this)}}}function c(){if(this.getRequired&&this.getRequired()){return true}var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}var t=e.getElements();for(var i=0;i<t.length;i++){var a=t[i];if(a.getRequired&&a.getRequired()===true&&(!a.getEditable||a.getEditable())&&(!a.getContextEditable||a.getContextEditable())){return true}}return false}function y(){if(this.getDisplayOnly){if(!this.isPropertyInitial("displayOnly")){return this.getDisplayOnly()}var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}var t=e.getParent();if(t){var i=t.getParent();if(i){return!i.getEditable()}}}return false}function v(){var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}if(e._oSetLabel&&!(typeof e._oSetLabel==="string")&&e._oSetLabel.getWrapping&&!e._oSetLabel.isPropertyInitial("wrapping")){return e._oSetLabel.getWrapping()}return true}function _(){var e=this._getFieldRelevantForLabel();if(e){if(this._oLabel){this._oLabel.setLabelFor(e)}return}var t=this.getFields();e=t.length>0?t[0]:null;if(e instanceof n){var a=e.getItems();if(a[1]instanceof f){e=a[1].getItems()[0]}else{e=a[1]}}var l=this._oLabel;if(l){l.setLabelFor(e)}else{l=this.getLabel();if(l instanceof i){l.setAlternativeLabelFor(e)}}}d.prototype.getLabel=function(){return this._oSetLabel};d.prototype._getLabel=function(){if(this._oLabel){return this._oLabel}else{return this._oSetLabel}};d.prototype.getLabelControl=function(){if(this._bHorizontalLayoutUsed){return null}else{return this._getLabel()}};d.prototype.getLabelText=function(){var e="";var t=this._getLabel();if(t){e=t.getText()}return e};d.prototype.getDataSourceLabel=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return e.getDataSourceLabel()}};d.prototype._createLabel=function(e){var t=null;var i=this._getFieldRelevantForLabel();if(i){if(i.getShowLabel&&i.getShowLabel()){t=new s(i.getId()+"-label");if(e){if(!i._oTextLabelSetByGroupElement){i._oTextLabelSetByGroupElement={oldText:i.getComputedTextLabel()}}i.setTextLabel(e);t.setText(e)}t.setLabelFor(i)}}else{t=new l(this.getId()+"-label",{text:e})}if(t){t._bCreatedByGroupElement=true;t.isRequired=c;t.isDisplayOnly=y;t.isWrapping=v;this._oLabel=t;if(!this._bHorizontalLayoutUsed){this.setAggregation("_label",t,true)}if(this._oSetLabel&&typeof this._oSetLabel!=="string"){this._oSetLabel.setAlternativeLabelFor(null)}}return t};d.prototype.updateLabelOfFormElement=function(){var e=false,t=null;var i=this.getElements();var l=this._getFieldRelevantForLabel();var r=this._getLabel();var o=false;if(r&&r._bCreatedByGroupElement){if(r instanceof s){if(!l||r._sSmartFieldId&&r._sSmartFieldId!=l.getId()){o=true}}else if(l){o=true}if(o){r.destroy();delete this._oLabel;r=null;if(this._oSetLabel&&!l){if(typeof this._oSetLabel==="string"){a.prototype.setLabel.apply(this,[this._oSetLabel]);r=this._oLabel;this._oLabel.isRequired=c;this._oLabel.isDisplayOnly=y}else{r=this._oSetLabel}L.call(this)}}}else if(r&&l){if(r==this._oLabel){r.destroy();delete this._oLabel}r=null}if(!r){if(this._oSetLabel){if(typeof this._oSetLabel==="string"){t=this._oSetLabel}else{t=this._oSetLabel.getText()}}else{t=""}}if(!r&&i.length>0){r=this._createLabel(t);e=true}if(r){if(r instanceof s){if(l&&l.setTextLabel&&l.getComputedTextLabel()){r.setText(l.getComputedTextLabel())}}m.call(this,r,l)}if(e){L.call(this);if(r&&r.setLabelFor&&!(r instanceof s)&&!l&&i.length>0){r.setLabelFor(i[0])}}};d.prototype.setEditMode=function(e){this._setEditable(e);return this};function F(e){var t=this.getElements();for(var i=0;i<t.length;i++){var a=t[i];E.call(this,a,e)}}function E(e,t){if(e instanceof r){if(!(e.data("editable")===false)){e.setContextEditable(t)}}}d.prototype.invalidateLabel=function(){var e=this._getLabel();if(e){e.invalidate()}};d.prototype._updateFormElementVisibility=function(){var e=this.getVisibleBasedOnElements();if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){G.call(this);this.invalidate()}}};d.prototype._updateLayout=function(){var e=null;var t=null;var i=null;var a=this.getUseHorizontalLayout();var l;var s=0;var r;if(a==this._bHorizontalLayoutUsed){return}if(a&&!x.call(this)){return}var o=this.getElements();var u=this._getLabel();this._bNoObserverChange=true;if(a){if(o.length>0){if(o[0].getLayoutData()){i=o[0].getLayoutData()}this.removeAllFields();if(o.length>1){for(s=0;s<o.length;s++){r=o[s];if(s>0){S.call(this,r)}}t=T.call(this,o.slice(0))}if(t){l=[t]}else{l=o.slice(0)}e=D.call(this,l,u,i);this.addField(e);if(u){_.call(this)}}}else{var h=this.getFields();if(h[0]instanceof n){e=h[0];l=e.getItems();if(o.length>1&&l.length>0){if(u){if(l.length>1&&l[1]instanceof f){t=l[1]}}else if(l[0]instanceof f){t=l[0]}if(t){t.removeAllItems();t.destroy()}}e.removeAllItems();e.destroy()}this.removeAllFields();for(s=0;s<o.length;s++){r=o[s];I.call(this,r);this.addField(r)}if(u){if(u==this._oLabel){this.setAggregation("_label",u,true)}else{this.setAggregation("label",u)}}}this._bHorizontalLayoutUsed=a;this._bNoObserverChange=false};function x(){if((!n||!f||!u||!h||!p)&&!this._bVBoxRequested){n=sap.ui.require("sap/m/VBox");f=sap.ui.require("sap/m/HBox");u=sap.ui.require("sap/m/FlexItemData");h=sap.ui.require("sap/ui/core/VariantLayoutData");p=sap.ui.require("sap/ui/layout/GridData");if(!n||!f||!u||!h||!p){sap.ui.require(["sap/m/VBox","sap/m/HBox","sap/m/FlexItemData","sap/ui/core/VariantLayoutData","sap/ui/layout/GridData"],C.bind(this));this._bVBoxRequested=true}}if(n&&f&&u&&h&&p&&!this._bVBoxRequested){return true}else{return false}}function C(e,t,i,a,l){n=e;f=t;u=i;h=a;p=l;this._bVBoxRequested=false;if(!this._bIsBeingDestroyed){this._updateLayout()}}function S(e){var t=e.getLayoutData();if(t){if(t.getStyleClass&&!t.getStyleClass()){t.setStyleClass("sapUiCompGroupElementHBoxPadding")}}else{t=new u({styleClass:"sapUiCompGroupElementHBoxPadding"});t._bCreatedByGroupElement=true;e.setLayoutData(t)}}function I(e){var t=e.getLayoutData();if(t){if(t._bCreatedByGroupElement){t.destroy()}else if(t.getStyleClass&&t.getStyleClass()=="sapUiCompGroupElementHBoxPadding"){t.setStyleClass()}}}function D(e,t,i){if(!d._myVBox){d._myVBox=n.extend("SmartFormVBox",{metadata:{interfaces:["sap.ui.core.IFormContent"]},enhanceAccessibilityState:B,renderer:{apiVersion:2}})}this._bMoveLabelToVBox=true;var a=e.slice(0);if(t){a.splice(0,0,t)}var l=new d._myVBox(this.getId()+"--VBox",{items:a});this._bMoveLabelToVBox=false;l.addStyleClass("sapUiCompGroupElementVBox");l._oGroupElement=this;if(i&&(i instanceof p||i instanceof h||i.isA("sap.ui.layout.ResponsiveFlowLayoutData"))){l.setLayoutData(i.clone())}V.call(this,l);return l}function T(e){var t=new f(this.getId()+"--HBox",{items:e});t._oGroupElement=this;t.enhanceAccessibilityState=B;return t}function B(e,t){var i=this._oGroupElement._getLabel();if(i&&i!=e&&!(e instanceof f)){var a=t["labelledby"];if(!a){a=i.getId()}else{var l=a.split(" ");if((l?Array.prototype.indexOf.call(l,i.getId()):-1)<0){l.splice(0,0,i.getId());a=l.join(" ")}}t["labelledby"]=a}}d.prototype._updateGridDataSpan=function(){if(!this._bHorizontalLayoutUsed){return}var e=this.getFields();if(e.length>0){var t=e[0];if(t instanceof n){V.call(this,t)}}};function V(e){var t=this.getParent();if(!t||!t.addGroupElement){return}var i=t.getParent();while(i&&!i.addGroup&&i.getParent){i=i.getParent()}if(!i){return}var a="";var l=i.getLayout();if(l){a=l.getGridDataSpan()}var s=e.getLayoutData();var r;if(s){if(!(s instanceof p)&&!(s instanceof h)&&a){r=new p({span:a});r._bFromGroupElement=true;var o=new h({multipleLayoutData:[s,r]});o._bFromGroupElement=true;e.setLayoutData(o)}else if(s instanceof p){if(s._bFromGroupElement){if(!a){s.destroy()}else{s.setSpan(a)}}}else if(s instanceof h){var n=false;s.getMultipleLayoutData().forEach(function(e){if(e instanceof p){n=true;if(e._bFromGroupElement){if(!a){e.destroy()}else{e.setSpan(a)}}}});if(!n&&a){r=new p({span:a});r._bFromGroupElement=true;s.addMultipleLayoutData(r)}if(s._bFromGroupElement&&s.getMultipleLayoutData().length==1){r=s.getMultipleLayoutData()[0];e.setLayoutData(r);s.destroy()}}}else if(a){r=new p({span:a});r._bFromGroupElement=true;e.setLayoutData(r)}var f=this.getElements();for(var u=0;u<f.length;u++){var d=f[u];if(d&&d.setControlContext){if(a){d.setControlContext(b.SmartFormGrid)}else{d.setControlContext(b.Form)}}}}d.prototype._setLinebreak=function(e,t,i,a){if(!this._bHorizontalLayoutUsed){return}var l=this.getFields();if(l.length>0){var s=l[0];if(!(s instanceof n)){return}var r=s.getLayoutData();if(r){if(r instanceof h){var o=r.getMultipleLayoutData();for(var f=0;f<o.length;f++){r=o[f];if(r instanceof p){r.setLinebreakXL(e);r.setLinebreakL(t);r.setLinebreakM(i);r.setLinebreakS(a)}}}else if(r instanceof p){r.setLinebreakXL(e);r.setLinebreakL(t);r.setLinebreakM(i);r.setLinebreakS(a)}}}};d.prototype.setVisible=function(e){var t=this.isVisible();a.prototype.setVisible.apply(this,arguments);if(t!=e){G.call(this)}return this};d.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};function G(){this.fireVisibleChanged({visible:this.isVisible()});if(this.getParent()){this.getParent()._updateLineBreaks()}}d.prototype.getFormElement=function(){return this};d.prototype.addElement=function(e){if(!e){return this}e=this.validateAggregation("elements",e,true);O.call(this,e);var t;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){t=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){A.call(this,e,undefined,true)}else{this.addField(e)}if(t&&t!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(t)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};d.prototype.insertElement=function(e,t){if(!e){return this}e=this.validateAggregation("elements",e,true);O.call(this,e);var i;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){A.call(this,e,t,false)}else{this.insertField(e,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};d.prototype.getElements=function(){var e;var t;if(this._bHorizontalLayoutUsed){e=this.getFields();t=this._extractFields(e,true)}else{t=this.getFields()}return t};d.prototype.indexOfElement=function(e){var t=-1;if(this._bHorizontalLayoutUsed){var i=this.getElements();for(var a=0;a<i.length;a++){if(e==i[a]){t=a;break}}}else{t=this.indexOfField(e)}return t};d.prototype.removeElement=function(e){var t;var i;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){t=z.call(this,e,false)}else{t=this.removeField(e)}if(t){M.call(this,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return t};d.prototype.removeAllElements=function(){var e;if(this._bHorizontalLayoutUsed){e=z.call(this,undefined,true)}else{e=this.removeAllFields()}if(e&&Array.isArray(e)){for(var t=0;t<e.length;t++){M.call(this,e[t])}}this.updateLabelOfFormElement();this._updateFormElementVisibility();return e};d.prototype.destroyElements=function(){if(this._bHorizontalLayoutUsed){var e=this.getFields();if(e.length>0){var t=this._getLabel();if(t){e[0].removeItem(t);if(t==this._oLabel){this.setAggregation("_label",t,true)}else{this.setAggregation("label",t)}}this.destroyFields()}}else{this.destroyFields()}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};d.prototype._observeChanges=function(e){a.prototype._observeChanges.apply(this,arguments);if(e.object==this){switch(e.name){case"useHorizontalLayout":this._updateLayout();break;case"horizontalLayoutGroupElementMinWidth":o.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);this._updateLayout();break;case"elementForLabel":this.updateLabelOfFormElement();break;case"_editable":F.call(this,e.current);break;default:break}}else{R.call(this,e)}};function A(e,t,i){var a=this._getLabel();var l=this.getFields();var s;var r;var o;if(l.length>0){s=l[0]}else{o=[e];var u=e.getLayoutData();s=D.call(this,o,a,u);this.addField(s);if(a){_.call(this)}return}if(!(s instanceof n)){return}o=s.getItems();if(a){if(o.length>1){r=o[1]}}else if(o.length>0){r=o[0]}if(r instanceof f){o=r.getItems();if((i||t>0)&&o.length>0){S.call(this,e)}if(i){r.addItem(e)}else{if(t==0&&o.length>0){S.call(this,o[0])}r.insertItem(e,t)}}else{var h=r;o=[];if(h){s.removeItem(h);if(i||t>0){o.push(h);o.push(e);S.call(this,e)}else{o.push(e);o.push(h);S.call(this,h)}r=T.call(this,o);s.addItem(r)}else{s.addItem(e)}if(a){_.call(this)}}}function O(e){if(e.getEditable){if(!e.getEditable()){e.data("editable",false)}}this._oObserver.observe(e,{properties:["visible"]});if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(b.Form)}if(e.getMetadata().getProperty("mandatory")){this._oObserver.observe(e,{properties:["mandatory"]})}E.call(this,e,this.getProperty("_editable"));H.call(this,e)}function H(e){if(e instanceof r){var t=this.getCustomData();for(var i=0;i<t.length;i++){P.call(this,e,t[i])}}}function P(t,i){if(t instanceof r&&e.smartform.inheritCostomDataToFields(i)){var a=i.clone();a._bFromGroupElement=true;a._sOriginalId=i.getId();t.addCustomData(a)}}function R(e){if(e.name=="mandatory"){this.invalidateLabel()}else if(e.name=="visible"){this._updateFormElementVisibility()}}function z(e,t){var i=this._getLabel();var a=this.getFields();var l;var s;var r;var o;var u=false;var h;if(a.length>0){l=a[0]}if(!(l instanceof n)){return null}r=l.getItems();if(i){if(r.length>1){s=r[1]}}else if(r.length>0){s=r[0]}if(s instanceof f){if(t){o=s.removeAllItems();u=true}else{o=s.removeItem(e);r=s.getItems();if(r.length>0){I.call(this,r[0]);if(r.length==1){h=r[0];s.removeAllItems();l.removeItem(s);s.destroy();l.addItem(h)}}}}else{if(t){o=l.removeAllItems()}else{o=l.removeItem(e)}if(o){u=true}}if(u){if(i){l.removeItem(i);if(i==this._oLabel){this.setAggregation("_label",i,true)}else{this.setAggregation("label",i)}}this.removeField(l);l.destroy()}if(o){if(Array.isArray(o)){for(var p=0;p<o.length;p++){h=o[p];I.call(this,h)}}else{I.call(this,o)}}return o}function M(e){if(e.detachInnerControlsCreated){e.detachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(b.None)}q.call(this,e);U.call(this,e,this.getLabelText())}function U(e,t){if(e._oTextLabelSetByGroupElement){if(e.getComputedTextLabel()==t){e.setTextLabel(e._oTextLabelSetByGroupElement.oldText)}delete e._oTextLabelSetByGroupElement}}function q(e,t){if(e instanceof r){var i=e.getCustomData();for(var a=0;a<i.length;a++){var l=i[a];if(l._bFromGroupElement&&(!t||t==l._sOriginalId)){e.removeCustomData(l);l.destroy()}}}}d.prototype._updateFormElementLabel=function(e){var t=this._getFieldRelevantForLabel();var i=this._getLabel();var a=e.oSource;var l=e.getParameters();if(i instanceof s&&a&&l&&a===t){i.updateLabelFor(l)}};d.prototype.addCustomData=function(e){if(!e){return this}a.prototype.addCustomData.apply(this,arguments);var t=this.getElements();for(var i=0;i<t.length;i++){P.call(this,t[i],e)}return this};d.prototype.insertCustomData=function(e,t){if(!e){return this}a.prototype.insertCustomData.apply(this,arguments);var i=this.getElements();for(var l=0;l<i.length;l++){P.call(this,i[l],e)}return this};d.prototype.removeCustomData=function(e){var t=a.prototype.removeCustomData.apply(this,arguments);if(t){var i=this.getElements();for(var l=0;l<i.length;l++){q.call(this,i[l],t.getId())}}return t};d.prototype.removeAllCustomData=function(){var e=a.prototype.removeAllCustomData.apply(this,arguments);if(e.length>0){var t=this.getElements();for(var i=0;i<t.length;i++){q.call(this,t[i])}}return e};d.prototype.destroyCustomData=function(){a.prototype.destroyCustomData.apply(this,arguments);var e=this.getElements();for(var t=0;t<e.length;t++){q.call(this,e[t])}return this};d.prototype.getVisibleBasedOnElements=function(){var e=false;var t=this.getElements();if(t&&t.length>0){e=t.some(function(e){return e.getVisible()})}return e};function k(){var e=this.getTooltip();if(!e||typeof e==="string"||e instanceof String){return e}else{return e.getText()}}d.prototype.clone=function(e,t){var i=this.removeAllElements();var l=a.prototype.clone.apply(this,arguments);for(var s=0;s<i.length;s++){var r=i[s];var o=r.clone(e,t);this.addElement(r);l.addElement(o)}return l};return d});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/Layout", ["sap/ui/comp/library","sap/ui/core/Element"],function(t,e){"use strict";var a=e.extend("sap.ui.comp.smartform.Layout",{metadata:{interfaces:["sap.ui.comp.smartform.SmartFormLayout"],library:"sap.ui.comp",properties:{labelSpanXL:{type:"int",group:"Misc",defaultValue:null},labelSpanL:{type:"int",group:"Misc",defaultValue:null},labelSpanM:{type:"int",group:"Misc",defaultValue:null},labelSpanS:{type:"int",group:"Misc",defaultValue:null},emptySpanXL:{type:"int",group:"Misc",defaultValue:null},emptySpanL:{type:"int",group:"Misc",defaultValue:null},emptySpanM:{type:"int",group:"Misc",defaultValue:null},emptySpanS:{type:"int",group:"Misc",defaultValue:null},columnsXL:{type:"int",group:"Misc",defaultValue:null},columnsL:{type:"int",group:"Misc",defaultValue:null},columnsM:{type:"int",group:"Misc",defaultValue:null},singleGroupFullSize:{type:"boolean",group:"Misc",defaultValue:true},breakpointXL:{type:"int",group:"Misc",defaultValue:null},breakpointL:{type:"int",group:"Misc",defaultValue:null},breakpointM:{type:"int",group:"Misc",defaultValue:null},gridDataSpan:{type:"sap.ui.layout.GridSpan",group:"Misc",defaultValue:""}}},_oSpan:{XL:0,L:0,M:0,S:0}});a.prototype.setGridDataSpan=function(t){var e=[];var a=/XL([1-9]|1[0-2])(?:\s|$)/i;e=a.exec(t);if(e&&e[1]){this._oSpan.XL=parseInt(e[1])}else{this._oSpan.XL=0}a=/\bL([1-9]|1[0-2])(?:\s|$)/i;e=a.exec(t);if(e&&e[1]){this._oSpan.L=parseInt(e[1]);if(!this._oSpan.XL){this._oSpan.XL=this._oSpan.L}}a=/M([1-9]|1[0-2])(?:\s|$)/i;e=a.exec(t);if(e&&e[1]){this._oSpan.M=parseInt(e[1])}a=/S([1-9]|1[0-2])(?:\s|$)/i;e=a.exec(t);if(e&&e[1]){this._oSpan.S=parseInt(e[1])}this.setProperty("gridDataSpan",t);return this};a.prototype._getGridDataSpanNumbers=function(){return this._oSpan};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/SemanticGroupElement", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/layout/form/SemanticFormElement","sap/m/Label","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/SmartField","sap/base/Log"],function(e,t,i,a,r,o,l){"use strict";var s;var n;var u=e.smartfield.ControlContextType;var h=i.extend("sap.ui.comp.smartform.SemanticGroupElement",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IFormGroupElement"],properties:{elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}}},_bVisibleElements:false});function p(e,i){if(e==this._oSetLabelFromOutside){return}var a;if(this._oSetLabelFromOutside&&this._oSetLabelFromOutside instanceof t){a=m.call(this._oSetLabelFromOutside)}if(!a){a=m.call(this)}if(a){if(e instanceof r){if(i&&i.setTooltipLabel){i.setTooltipLabel(a)}}else{e.setTooltip(a)}}}function m(){var e=this.getTooltip();if(!e||typeof e==="string"||e instanceof String){return e}else{return e.getText()}}function f(e){if(e.getParameter("name")=="text"){var t=e.oSource;var i=t.getText();if(this._oLabel){this._oLabel.setText(i)}var a=this._getFieldRelevantForLabel();if(a&&a.getComputedTextLabel){if(!a._oTextLabelSetBySemanticGroupElement){a._oTextLabelSetBySemanticGroupElement={oldText:a.getComputedTextLabel()}}a.setTextLabel(i)}}}function b(){if(this.getRequired&&this.getRequired()){return true}var e=this.getParent();var t=e.getElements();for(var i=0;i<t.length;i++){var a=t[i];if(a.getRequired&&a.getRequired()===true&&(!a.getEditable||a.getEditable())&&(!a.getContextEditable||a.getContextEditable())){return true}}return false}function d(){if(this.getDisplayOnly){if(!this.isPropertyInitial("displayOnly")){return this.getDisplayOnly()}var e=this.getParent();var t=e.getParent();if(t){var i=t.getParent();if(i){return!i.getEditable()}}}return false}function c(){var e=this.getParent();if(e._oSetLabelFromOutside&&!(typeof e._oSetLabelFromOutside==="string")&&e._oSetLabelFromOutside.getWrapping&&!e._oSetLabelFromOutside.isPropertyInitial("wrapping")){return e._oSetLabelFromOutside.getWrapping()}return true}function g(e,t){if(e._oTextLabelSetBySemanticGroupElement){if(e.getComputedTextLabel()==t){e.setTextLabel(e._oTextLabelSetBySemanticGroupElement.oldText)}delete e._oTextLabelSetBySemanticGroupElement}}function L(e){e._bCreatedBySemanticGroupElement=true;e.isRequired=b;e.isDisplayOnly=d;e.isWrapping=c;return e}function y(e){if(e.getEditable){if(!e.getEditable()){e.data("editable",false)}}this._oObserver.observe(e,{properties:["visible"]});if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(u.Form)}if(e.getMetadata().getProperty("mandatory")){this._oObserver.observe(e,{properties:["mandatory"]})}E.call(this,e,this.getProperty("_editable"));S.call(this,e);if(e.isA("sap.ui.comp.smartfield.SmartField")&&e._isInnerControlCreationDelayed&&e.getMode()==="display"){e._forceInitialise()}if(e.isA("sap.ui.comp.smartfield.SmartField")){e.attachInnerControlsCreated(function(){this._observeChanges({object:e,name:"visible"});e.getInnerControls().forEach(function(t){var i=t.getBinding("text");if(i){i.attachChange(function(){this._observeChanges({object:e,name:"visible"})}.bind(this))}}.bind(this))}.bind(this))}}function _(e){if(e.name=="mandatory"){this.invalidateLabel()}else if(e.name=="visible"){this._updateFormElementVisibility()}}function v(){this.fireVisibleChanged({visible:this.isVisible()});if(this.getParent()){this.getParent()._updateLineBreaks()}}function F(e){var t=this.getElements();for(var i=0;i<t.length;i++){var a=t[i];E.call(this,a,e)}}function E(e,t){if(e instanceof o){if(!(e.data("editable")===false)){e.setContextEditable(t)}}}function S(e){if(e instanceof o){var t=this.getCustomData();for(var i=0;i<t.length;i++){O.call(this,e,t[i])}}}function C(e,t){if(e instanceof o){var i=e.getCustomData();for(var a=0;a<i.length;a++){var r=i[a];if(r._bFromSemanticGroupElement&&(!t||t==r._sOriginalId)){e.removeCustomData(r);r.destroy()}}}}function O(t,i){if(t instanceof o&&e.smartform.inheritCostomDataToFields(i)){var a=i.clone();a._bFromSemanticGroupElement=true;a._sOriginalId=i.getId();t.addCustomData(a)}}function x(e){if(e.detachInnerControlsCreated){e.detachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(u.None)}C.call(this,e);g.call(this,e,this.getLabelText())}h.prototype.init=function(){i.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["elementForLabel","_editable","delimiter"]})};h.prototype._getFieldRelevantForLabel=function(){var e=this.getElements();var t=this.getElementForLabel();if(e.length>t&&e[t]instanceof o){return e[t]}return null};h.prototype._extractFields=function(e,t){var i=[];e.forEach(function(e){i.push(e)});if(t){i=i.filter(function(e){return!(e instanceof a)})}return i};h.prototype._observeChanges=function(e){i.prototype._observeChanges.apply(this,arguments);if(e.object==this){switch(e.name){case"useHorizontalLayout":l.error("useHorizontalLayout can't be used with SemanticGroupElement",this);break;case"elementForLabel":this.updateLabelOfFormElement();break;case"_editable":F.call(this,e.current);break;default:break}}else{_.call(this,e)}};h.prototype._getLabel=function(){if(this._oLabel){return this._oLabel}else{return this._oSetLabelFromOutside}};h.prototype._createLabel=function(e){var t=null;var i=this._getFieldRelevantForLabel();if(i){if(i.getShowLabel&&i.getShowLabel()){t=new r(i.getId()+"-label");if(e){if(!i._oTextLabelSetBySemanticGroupElement){i._oTextLabelSetBySemanticGroupElement={oldText:i.getComputedTextLabel()}}i.setTextLabel(e);t.setText(e)}t.setLabelFor(i)}}else{t=new a(this.getId()+"-label",{text:e})}if(t){t=L(t);this._oLabel=t;this.setAggregation("_label",t,true);if(this._oSetLabelFromOutside&&typeof this._oSetLabelFromOutside!=="string"){this._oSetLabelFromOutside.setAlternativeLabelFor(null)}}return t};h.prototype._updateFormElementLabel=function(e){var t=this._getFieldRelevantForLabel();var i=this._getLabel();var a=e.oSource;var o=e.getParameters();if(i instanceof r&&a&&o&&a===t){i.updateLabelFor(o)}};h.prototype._updateFormElementVisibility=function(){var e=this.getVisibleBasedOnElements();if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){v.call(this);this.invalidate()}}};h.prototype._updateGridDataSpan=function(){};h.prototype._setLinebreak=function(e,t,i,a){var r=this.getFields();if(r.length>0){var o=r[0];if(!(o instanceof s)){return}var l=o.getLayoutData();if(l instanceof n){l.setLinebreakXL(e);l.setLinebreakL(t);l.setLinebreakM(i);l.setLinebreakS(a)}}};h.prototype.setTooltip=function(e){i.prototype.setTooltip.apply(this,[e]);var t=this._getFieldRelevantForLabel();var a=this._getLabel();p.call(this,a,t);return this};h.prototype.setLabel=function(e){if(this._oSetLabelFromOutside&&typeof this._oSetLabelFromOutside!=="string"){this._oSetLabelFromOutside.detachEvent("_change",f,this)}var t;var a;var o;if(typeof e==="string"){t=this._getLabel();if(t){a=t.getText()}}else if(!e&&this._oSetLabelFromOutside){a=this.getLabelText()}i.prototype.setLabel.apply(this,[e]);this._oSetLabelFromOutside=e;if(typeof e==="string"){if(this._oLabel instanceof r&&e!=a&&(e.length>0||a.length>0)){o=this._getFieldRelevantForLabel();if(o&&e!=null){if(o.getComputedTextLabel){if(!o._oTextLabelSetBySemanticGroupElement){o._oTextLabelSetBySemanticGroupElement={oldText:o.getComputedTextLabel()}}o.setTextLabel(e)}}}this.setAggregation("_label",this._oLabel,true);this._oLabel.isRequired=b;this._oLabel.isDisplayOnly=d}else{if(e){if(e.isRequired){e.isRequired=b}if(e.isDisplayOnly){e.isDisplayOnly=d}e.attachEvent("_change",f,this)}else{o=this._getFieldRelevantForLabel();if(o){g.call(this,o,a)}}this.updateLabelOfFormElement()}return this};h.prototype.destroyLabel=function(){var e=this.getLabelText();i.prototype.destroyLabel.apply(this);delete this._oSetLabelFromOutside;var t=this._getFieldRelevantForLabel();if(t){g.call(this,t,e)}this.updateLabelOfFormElement();return this};h.prototype.getLabel=function(){return this._oSetLabelFromOutside};h.prototype.getLabelControl=function(){return this._getLabel()};h.prototype.getLabelText=function(){var e="";var t=this._getLabel();if(t){e=t.getText()}return e};h.prototype.getDataSourceLabel=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return e.getDataSourceLabel()}};h.prototype.updateLabelOfFormElement=function(){var e=false,t=null;var a=this.getElements();var o=this._getFieldRelevantForLabel();var l=this._getLabel();var s=false;if(l&&l._bCreatedBySemanticGroupElement){if(l instanceof r){if(!o||l._sSmartFieldId&&l._sSmartFieldId!=o.getId()){s=true}}else if(o){s=true}if(s){l.destroy();delete this._oLabel;l=null;if(this._oSetLabelFromOutside&&!o){if(typeof this._oSetLabelFromOutside==="string"){i.prototype.setLabel.apply(this,[this._oSetLabelFromOutside]);l=this._oLabel;this._oLabel.isRequired=b;this._oLabel.isDisplayOnly=d}else{l=this._oSetLabelFromOutside}}}}else if(l&&o){if(l==this._oLabel){l.destroy();delete this._oLabel}l=null}if(!l){if(this._oSetLabelFromOutside){if(typeof this._oSetLabelFromOutside==="string"){t=this._oSetLabelFromOutside}else{t=this._oSetLabelFromOutside.getText()}}else{t=""}}if(!l&&a.length>0){l=this._createLabel(t);e=true}if(l){if(l instanceof r){if(o&&o.setTextLabel&&o.getComputedTextLabel()){l.setText(o.getComputedTextLabel())}}p.call(this,l,o)}if(e){if(l&&l.setLabelFor&&!(l instanceof r)&&!o&&a.length>0){l.setLabelFor(a[0])}}};h.prototype.invalidateLabel=function(){var e=this._getLabel();if(e){e.invalidate()}};h.prototype.getUseHorizontalLayout=function(){l.error("getUseHorizontalLayout can't be used with SemanticGroupElement",this)};h.prototype.setUseHorizontalLayout=function(){l.error("setUseHorizontalLayout can't be used with SemanticGroupElement",this)};h.prototype.getHorizontalLayoutGroupElementMinWidth=function(){l.error("getHorizontalLayoutGroupElementMinWidth can't be used with SemanticGroupElement",this)};h.prototype.setHorizontalLayoutGroupElementMinWidth=function(){l.error("setHorizontalLayoutGroupElementMinWidth can't be used with SemanticGroupElement",this)};h.prototype.setVisible=function(e){var t=this.isVisible();i.prototype.setVisible.apply(this,arguments);if(t!=e){v.call(this)}return this};h.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};h.prototype.getVisibleBasedOnElements=function(){var e=false;var t=this.getElements();if(t&&t.length>0){e=t.some(function(e){return e.getVisible()})}return e};h.prototype.getFormElement=function(){return this};h.prototype.addElement=function(e){if(!e){return this}e=this.validateAggregation("elements",e,true);y.call(this,e);var t;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){t=this._oLabel._sSmartFieldId}this.addField(e);if(t&&t!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(t)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};h.prototype.insertElement=function(e,t){if(!e){return this}e=this.validateAggregation("elements",e,true);y.call(this,e);var i;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}this.insertField(e,t);if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};h.prototype.getElements=function(){var e;e=this.getFields();return e};h.prototype.indexOfElement=function(e){var t=-1;t=this.indexOfField(e);return t};h.prototype.removeElement=function(e){var t;var i;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}t=this.removeField(e);if(t){x.call(this,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return t};h.prototype.removeAllElements=function(){var e=this.removeAllFields();if(e&&Array.isArray(e)){for(var t=0;t<e.length;t++){x.call(this,e[t])}}this.updateLabelOfFormElement();this._updateFormElementVisibility();return e};h.prototype.destroyElements=function(){this.destroyFields();this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};h.prototype.addCustomData=function(e){if(!e){return this}i.prototype.addCustomData.apply(this,arguments);var t=this.getElements();for(var a=0;a<t.length;a++){O.call(this,t[a],e)}return this};h.prototype.insertCustomData=function(e,t){if(!e){return this}i.prototype.insertCustomData.apply(this,arguments);var a=this.getElements();for(var r=0;r<a.length;r++){O.call(this,a[r],e)}return this};h.prototype.removeCustomData=function(e){var t=i.prototype.removeCustomData.apply(this,arguments);if(t){var a=this.getElements();for(var r=0;r<a.length;r++){C.call(this,a[r],t.getId())}}return t};h.prototype.removeAllCustomData=function(){var e=i.prototype.removeAllCustomData.apply(this,arguments);if(e.length>0){var t=this.getElements();for(var a=0;a<t.length;a++){C.call(this,t[a])}}return e};h.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);var e=this.getElements();for(var t=0;t<e.length;t++){C.call(this,e[t])}return this};h.prototype.clone=function(e,t){var a=this.removeAllElements();var r=i.prototype.clone.apply(this,arguments);for(var o=0;o<a.length;o++){var l=a[o];var s=l.clone(e,t);this.addElement(l);r.addElement(s)}return r};return h});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/SmartForm", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/core/theming/Parameters","sap/ui/layout/form/Form","sap/ui/base/ManagedObjectObserver","sap/base/Log"],function(t,e,i,o,s,a){"use strict";var r;var n;var l;var u;var h;var p;var c;var f;var g=t.smartform.SmartFormValidationMode;var d=t.smartform.Importance;var m={ResponsiveGridLayout:{layout:undefined,path:"sap/ui/layout/form/ResponsiveGridLayout",name:"sap.ui.layout.form.ResponsiveGridLayout",requested:false,loaded:rt,promise:undefined},ResponsiveLayout:{layout:undefined,path:"sap/ui/layout/form/ResponsiveLayout",name:"sap.ui.layout.form.ResponsiveLayout",requested:false,loaded:nt,promise:undefined},ColumnLayout:{layout:undefined,path:"sap/ui/layout/form/ColumnLayout",name:"sap.ui.layout.form.ColumnLayout",requested:false,loaded:lt,promise:undefined}};var y={apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartForm");t.openEnd();var i=e.getAggregation("content");t.renderControl(i);t.close("div")}};var b=e.extend("sap.ui.comp.smartform.SmartForm",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/SmartForm.designtime",properties:{title:{type:"string",group:"Misc",defaultValue:null},useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},checkButton:{type:"boolean",group:"Misc",defaultValue:false},entityType:{type:"string",group:"Misc",defaultValue:null},expandable:{type:"boolean",group:"Misc",defaultValue:false},expanded:{type:"boolean",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},editable:{type:"boolean",group:"Misc",defaultValue:false},ignoredFields:{type:"string",group:"Misc",defaultValue:null},flexEnabled:{type:"boolean",group:"Misc",defaultValue:true},validationMode:{type:"sap.ui.comp.smartform.SmartFormValidationMode",group:"Misc",defaultValue:g.Standard},importance:{type:"sap.ui.comp.smartform.Importance",group:"Misc",defaultValue:d.Low}},defaultAggregation:"groups",aggregations:{groups:{type:"sap.ui.comp.smartform.Group",multiple:true,singularName:"group"},content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},layout:{type:"sap.ui.comp.smartform.SmartFormLayout",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},customToolbar:{type:"sap.m.Toolbar",multiple:false},toolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{editToggled:{parameters:{editable:{type:"boolean"}}},checked:{parameters:{erroneousFields:{type:"sap.ui.comp.smartfield.SmartField[]"}}}}},renderer:y});b.prototype.init=function(){this._oForm=new o(this.getId()+"--Form");this._oForm.getToolbar=function(){var t=this.getParent();if(t&&!t.getExpandable()){return t._getToolbar()}};this.setAggregation("content",this._oForm);this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oObserver=new s(E.bind(this));this._oObserver.observe(this,{properties:["editTogglable","title","checkButton","useHorizontalLayout","horizontalLayoutGroupElementMinWidth","expandable","expanded"],aggregations:["layout","customData"],associations:["ariaLabelledBy"]})};b.prototype.onBeforeRendering=function(){st.call(this)};b.prototype.onAfterRendering=function(){var t=this.getSmartFields(false,false),e=this.getImportance();if(!this.isPropertyInitial("importance")){t.forEach(function(t){t._setVisibilityBasedOnImportance(e)})}};b.prototype.addGroup=function(t){var e=this,i,o,s;if(!t){return this}s=this._getSmartFieldsByGroup(t,false);s.forEach(function(t){i=t.setImportance;t.setImportance=function(){i.apply(this,arguments);o=e.getImportance();this._setVisibilityBasedOnImportance(o)}});t=this.validateAggregation("groups",t,true);V.call(this,t);this._oForm.addFormContainer(t);_.call(this,t);return this};b.prototype.getGroups=function(){return this._oForm.getFormContainers()};b.prototype.indexOfGroup=function(t){return this._oForm.indexOfFormContainer(t)};b.prototype.insertGroup=function(t,e){if(!t){return this}t=this.validateAggregation("groups",t,true);V.call(this,t);this._oForm.insertFormContainer(t,e);_.call(this,t);return this};b.prototype.removeGroup=function(t){var e=this._oForm.removeFormContainer(t);if(e){e.detachEvent("_visibleChanged",pt,this);z.call(this,e);pt.call(this)}return e};b.prototype.removeAllGroups=function(){var t=this._oForm.removeAllFormContainers();for(var e=0;e<t.length;e++){t[e].detachEvent("_visibleChanged",pt,this);z.call(this,t[e])}pt.call(this);return t};b.prototype.destroyGroups=function(){var t=this.getGroups();for(var e=0;e<t.length;e++){t[e].detachEvent("_visibleChanged",pt,this)}this._oForm.destroyFormContainers();pt.call(this);return this};function _(t){var e=this.getUseHorizontalLayout();var i=this.getHorizontalLayoutGroupElementMinWidth();t.attachEvent("_visibleChanged",pt,this);if(i!=t.getHorizontalLayoutGroupElementMinWidth){t.setHorizontalLayoutGroupElementMinWidth(i)}if(e!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(e)}if(e){t._updateGridDataSpan();t._updateLineBreaks()}else{pt.call(this)}}b.prototype._getToolbar=function(){var t=this.getCustomToolbar();return t||this.getAggregation("toolbar")};b.prototype.propagateGridDataSpan=function(){var t=this.getGroups();for(var e=0;e<t.length;e++){var i=t[e];i._updateGridDataSpan();i._updateLineBreaks()}return this};b.prototype._getGridDataSpanNumbers=function(){var t=this.getLayout();var e;if(t&&t._getGridDataSpanNumbers){e=t._getGridDataSpanNumbers()}return e};b.prototype._toggleEditMode=function(){var t=this.getEditable();this.setEditable(!t)};b.prototype.check=function(t){var e={considerOnlyVisible:true,handleSuccess:false};if(typeof t==="boolean"){e.considerOnlyVisible=t}else{e=Object.assign(e,t)}if(this.getValidationMode()===g.Standard){return this._checkClientError(e)}else{return this._checkClientErrorAsync(e)}};b.prototype._checkClientError=function(t){if(t.considerOnlyVisible===undefined){t.considerOnlyVisible=true}var e=this.getSmartFields(t.considerOnlyVisible,t.considerOnlyVisible);var i=[];var o=null;e.forEach(function(e){if(e.checkClientError({handleSuccess:t.handleSuccess})){if(t.considerOnlyVisible&&e.getVisible){if(!e.getVisible()){return}}o=e.getParent();while(o.getParent){o=o.getParent();if(o.isA("sap.ui.comp.smartform.Group")){if(!o.getExpanded()){o.setExpanded(true)}break}}i.push(e.getId())}});return i};b.prototype._checkClientErrorAsync=function(t){var e=this.getSmartFields(t.considerOnlyVisible,t.considerOnlyVisible),i,o=[],s;this.setBusy(true);if(t.considerOnlyVisible===undefined){t.considerOnlyVisible=true}i=e.map(function(e){if(t.considerOnlyVisible&&!e.getVisible()){return false}return e.checkValuesValidity({handleSuccess:t.handleSuccess}).catch(function(){s=e.getParent();while(s.getParent){s=s.getParent();if(s.isA("sap.ui.comp.smartform.Group")){if(!s.getExpanded()){s.setExpanded(true)}break}}o.push(e.getId())})});return Promise.all(i).then(function(){this.setBusy(false);return o}.bind(this))};b.prototype._displayError=function(t){var e=this._oRb.getText("FORM_CLIENT_CHECK_ERROR_TITLE");var i=this._oRb.getText("FORM_CLIENT_CHECK_ERROR");if(!c&&!this._bMessageBoxRequested){c=sap.ui.require("sap/m/MessageBox");if(!c){sap.ui.require(["sap/m/MessageBox"],v.bind(this));this._bMessageBoxRequested=true}}if(c){c.show(i,{icon:c.Icon.ERROR,title:e,styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""})}};function v(t){c=t;this._bMessageBoxRequested=false;if(!this._bIsBeingDestroyed){L.call(this)}}function L(){var t=this.check(true);if(t&&t.length>0){this._displayError(t);return true}return false}function C(){return this.check(true).then(function(t){if(t&&t.length){this._displayError(t)}return t}.bind(this))}b.prototype.setEditable=function(t){var e=this.getEditable();t=this.validateProperty("editable",t);if(e===t){return this}if(!t&&this.hasListeners("editToggled")){if(this.getValidationMode()===g.Standard){if(L.call(this)){return this}}else{C.call(this).then(function(e){if(e.length){return this.setProperty("editable",true)}T.call(this,t)}.bind(this));return this.setProperty("editable",t)}}this.setProperty("editable",t);T.call(this,t);return this};function T(t){if(this._oForm){this._oForm.setEditable(t)}this.fireEditToggled({editable:t});if(this._oEditToggleButton){this._oEditToggleButton.setIcon(t?"sap-icon://display":"sap-icon://edit");var e=this._oRb.getText(t?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton.setTooltip(e)}if(this.getCheckButton()&&t){J.call(this)}else{Q.call(this)}}function E(t){if(t.object==this){if(t.name=="editTogglable"){S.call(this,t.current)}else if(t.name=="title"){B.call(this,t.current)}else if(t.name=="checkButton"){F.call(this,t.current)}else if(t.name=="useHorizontalLayout"){M.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){I.call(this,t.current)}else if(t.name=="expanded"){q.call(this,t.current)}else if(t.name=="expandable"){R.call(this,t.current)}else if(t.name=="layout"){k.call(this,t.child,t.mutation)}else if(t.name=="customData"){A.call(this,t.child,t.mutation)}else if(t.name=="ariaLabelledBy"){D.call(this,t.ids,t.mutation)}}else if(t.object.isA("sap.ui.comp.smartform.SmartFormLayout")){gt.call(this,t.object,t.name,t.current,t.old)}}function S(t){if(t){Y.call(this)}else{$.call(this)}w.call(this)}function B(t){if(this._oPanel){this._oPanel.setHeaderText(t)}w.call(this)}function F(t){if(t){J.call(this)}else{Q.call(this)}w.call(this)}function M(t){if(t){this.addStyleClass("sapUiCompSmartFormHorizontalLayout")}else{this.removeStyleClass("sapUiCompSmartFormHorizontalLayout")}var e=this.getGroups();if(e){e.forEach(function(e){if(e.getUseHorizontalLayout()!=t){e.setUseHorizontalLayout(t)}})}var i=this.getLayout();if(t){ut.call(this,i)}else{st.call(this);ut.call(this,i)}}function k(t,e){if(e==="remove"){this._oObserver.unobserve(t)}else{this._oObserver.observe(t,{properties:true})}if(t.isA("sap.ui.comp.smartform.Layout")){this.propagateGridDataSpan()}st.call(this);ut.call(this,e==="insert"?t:null)}function I(t){a.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroups();if(e){e.forEach(function(e){e.setHorizontalLayoutGroupElementMinWidth(t)})}}b.prototype.getVisibleProperties=function(){var t=[];var e=this.getGroups();if(e){e.forEach(function(e){var i=e.getGroupElements();if(i.length>0){i.forEach(function(e){var i=e.getElements();if(i.length>0){i.forEach(function(e){if(e.getVisible()){var i=e.getBindingPath("value");if(i){t.push(i)}}})}})}})}return t};b.prototype.setCustomToolbar=function(t){var e=this.getCustomToolbar();if(e==t){return this}W.call(this);$.call(this);Q.call(this);this.setAggregation("customToolbar",t);if(this.getTitle()){w.call(this)}if(this.getEditTogglable()){Y.call(this)}if(this.getCheckButton()){J.call(this)}return this};b.prototype.destroyCustomToolbar=function(){var t=this.getCustomToolbar();if(t){W.call(this);$.call(this);Q.call(this)}this.destroyAggregation("customToolbar");if(this.getTitle()){w.call(this)}if(this.getEditTogglable()){Y.call(this)}if(this.getCheckButton()){J.call(this)}return this};function R(t){if(t){if(!r&&!this._bPanelRequested){r=sap.ui.require("sap/m/Panel");if(!r){sap.ui.require(["sap/m/Panel"],O.bind(this));this._bPanelRequested=true}}if(r){G.call(this)}}else if(this._oPanel){this.setAggregation("content",this._oForm);this._oPanel.destroy();this._oPanel=null}w.call(this)}function G(){this._oPanel=new r(this.getId()+"--Panel",{expanded:this.getExpanded(),expandable:true,headerText:this.getTitle(),expandAnimation:false});this._oPanel.getHeaderToolbar=function(){var t=this.getParent();if(t){return t._getToolbar()}};this._oPanel.attachExpand(P,this);this.setAggregation("content",this._oPanel);this._oPanel.addContent(this._oForm)}function O(t){r=t;this._bPanelRequested=false;if(this.getExpandable()&&!this._bIsBeingDestroyed){G.call(this)}}function P(t){this.setProperty("expanded",t.getParameter("expand"),true)}function q(t){if(this._oPanel){this._oPanel.setExpanded(t)}}function A(t,e){var i=this.getGroups();for(var o=0;o<i.length;o++){if(e==="insert"){x.call(this,i[o],t)}else{z.call(this,i[o],t.getId())}}}function V(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){x.call(this,t,e[i])}}function x(e,i){if(t.smartform.inheritCostomDataToFields(i)){var o=i.clone();o._bFromSmartForm=true;o._sOriginalId=i.getId();e.addCustomData(o)}}function z(t,e){var i=t.getCustomData();for(var o=0;o<i.length;o++){var s=i[o];if(s._bFromSmartForm&&(!e||e==s._sOriginalId)){t.removeCustomData(s)}}}function D(t,e){var i;if(Array.isArray(t)){i=t}else{i=[t]}for(var o=0;o<i.length;o++){var s=i[o];if(e==="insert"){this._oForm.addAriaLabelledBy(s)}else{this._oForm.removeAriaLabelledBy(s)}}}b.prototype._getSmartFieldsByGroup=function(t,e){var i=[],o=[],s=[];i=t.getGroupElements();for(var a=0;a<i.length;a++){var r=i[a];if(!e||e&&r.isVisible()){o=r.getElements();for(var n=0;n<o.length;n++){var l=o[n];if(l.isA("sap.ui.comp.smartfield.SmartField")){s.push(l)}}}}return s};b.prototype.getSmartFields=function(t,e){var i=[],o,s=[];if(t===undefined){t=true}i=this.getGroups();for(var a=0;a<i.length;a++){var r=i[a];if(!t||t&&r.isVisible()){o=this._getSmartFieldsByGroup(r,e);s=s.concat(o)}}return s};b.prototype.setFocusOnEditableControl=function(){var t=[];this.getGroups().forEach(function(e){if(e.isVisible()){e.getGroupElements().forEach(function(e){if(e.isVisible()){t=t.concat(e.getElements())}})}});t.some(function(t){if(t.getEditable&&t.getEditable()&&t.focus&&t.getVisible()){if(t.isA("sap.ui.comp.smartfield.SmartField")){t.attachEventOnce("innerControlsCreated",function(t){setTimeout(t.oSource._oControl[t.oSource._oControl.current]["focus"].bind(t.oSource._oControl[t.oSource._oControl.current]),0)})}else{t.focus()}return true}})};b.prototype.clone=function(t,i){this.setAggregation("content",null);var o=this.getAggregation("toolbar");var s=this.getCustomToolbar();var a=this.getCustomData();var r=this.getGroups();var n=0;if(s){W.call(this);$.call(this);Q.call(this)}else if(o){this.setAggregation("toolbar",null)}if(a.length>0){for(n=0;n<r.length;n++){z.call(this,r[n])}}var l=e.prototype.clone.apply(this,arguments);for(n=0;n<r.length;n++){var u=r[n].clone(t,i);l.addGroup(u)}if(this.getExpandable()&&this._oPanel){this.setAggregation("content",this._oPanel)}else{this.setAggregation("content",this._oForm)}if(s){if(this.getTitle()){w.call(this)}if(this.getEditTogglable()){Y.call(this)}if(this.getCheckButton()){J.call(this)}}else if(o){this.setAggregation("toolbar",o)}if(a.length>0){for(n=0;n<r.length;n++){V.call(this,r[n])}}return l};b.prototype.exit=function(){if(this._oForm){this._oForm.destroy()}if(this._oPanel){this._oPanel.destroy()}if(this._oTitle){this._oTitle.destroy()}if(this._oEditToggleButton){this._oEditToggleButton.destroy()}this._oForm=null;this._oPanel=null;this._oTitle=null;this._oRb=null;this._oEditToggleButton=null;this._oObserver.disconnect();this._oObserver=undefined};function H(){var t=this.getAggregation("toolbar");if(!t){t=new l(this.getId()+"-toolbar-sfmain",{height:"3rem",design:f.ToolbarDesign.Transparent});t._bCreatedBySmartForm=true;this.setAggregation("toolbar",t)}return t}function X(t){var e=this.getAggregation("toolbar");if(e){if(t){var i=e.getContent();if(i.length>0){return}}this.destroyAggregation("toolbar")}}function w(){var t=this.getTitle();if(t){if(!this.getCustomToolbar()&&!this.getCheckButton()&&!this.getEditTogglable()){if(this._oTitle){if(this._getToolbar()){W.call(this)}this._oForm.removeAriaLabelledBy(this._oTitle);this._oTitle.destroy();this._oTitle=null}this._oForm.setTitle(t)}else{this._oForm.setTitle();if(!this._oTitle){if((!n||!l||!u||!h||!f)&&!this._bTitleRequested){n=sap.ui.require("sap/m/Title");l=sap.ui.require("sap/m/OverflowToolbar");u=sap.ui.require("sap/m/ToolbarSpacer");h=sap.ui.require("sap/m/ToolbarSeparator");f=sap.ui.require("sap/m/library");if(!n||!l||!u||!h||!f){sap.ui.require(["sap/m/Title","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library"],U.bind(this));this._bTitleRequested=true}}if(n&&!this._bTitleRequested){var e=i.get("sap.ui.layout.FormLayout:_sap_ui_layout_FormLayout_FormTitleSize");this._oTitle=new n(this.getId()+"-title-sfmain",{level:e.toUpperCase()})}}if(this._oTitle){this._oTitle.setText(t);this._oForm.addAriaLabelledBy(this._oTitle);N.call(this)}}}else{if(this._oTitle){W.call(this);this._oForm.removeAriaLabelledBy(this._oTitle);this._oTitle.destroy();this._oTitle=null}else{this._oForm.setTitle()}}}function U(t,e,i,o,s){n=t;l=e;u=i;h=o;f=s;this._bTitleRequested=false;if(!this._bIsBeingDestroyed){w.call(this)}}function N(){if(!this._oTitle){return}var t=this._getToolbar();if(!t){t=H.call(this)}t.insertContent(this._oTitle,0)}function W(){if(!this._oTitle){return}var t=this._getToolbar();t.removeContent(this._oTitle);X.call(this,true)}function j(){if((!p||!l||!u||!h||!f)&&!this._bButtonRequested){p=sap.ui.require("sap/m/Button");l=sap.ui.require("sap/m/OverflowToolbar");u=sap.ui.require("sap/m/ToolbarSpacer");h=sap.ui.require("sap/m/ToolbarSeparator");f=sap.ui.require("sap/m/library");if(!p||!l||!u||!h||!f){sap.ui.require(["sap/m/Button","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library"],K.bind(this));this._bButtonRequested=true}}if(p&&!this._bButtonRequested){return true}return false}function K(t,e,i,o,s){p=t;l=e;u=i;h=o;f=s;this._bButtonRequested=false;if(!this._bIsBeingDestroyed){if(this._bEditRequested){this._bEditRequested=false;Y.call(this)}if(this._bCheckRequested){this._bCheckRequested=false;J.call(this)}}}function Y(){if(!this.getEditTogglable()){return}if(!j.call(this)){this._bEditRequested=true;return}var t=this._getToolbar();if(!t){t=H.call(this)}if(!this._oCheckButton){et.call(this,t)}if(!this._oEditToggleButton){var e=this.getEditable()?"sap-icon://display":"sap-icon://edit";var i=this._oRb.getText(this.getEditable()?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton=new p(t.getId()+"-button-sfmain-editToggle",{icon:e,tooltip:i});this._oEditToggleButton.attachPress(this._toggleEditMode,this)}var o=t.getContent().length;if(this._oCheckButton){o--}t.insertContent(this._oEditToggleButton,o)}function $(){if(!this._oEditToggleButton){return}var t=this._getToolbar();t.removeContent(this._oEditToggleButton);this._oEditToggleButton.destroy();this._oEditToggleButton=null;it.call(this,t);X.call(this,true)}function J(){if(!this.getCheckButton()||!this.getEditable()){return}if(!j.call(this)){this._bCheckRequested=true;return}var t=this._getToolbar();if(!t){t=H.call(this)}if(!this._oEditToggleButton){et.call(this,t)}if(!this._oCheckButton){this._oCheckButton=new p(this.getId()+"-"+t.getId()+"-button-sfmain-check",{text:this._oRb.getText("SMART_FORM_CHECK")});this._oCheckButton.attachPress(this.getValidationMode()===g.Standard?Z:tt,this)}var e=t.getContent().length;t.insertContent(this._oCheckButton,e)}function Q(){if(!this._oCheckButton){return}var t=this._getToolbar();t.removeContent(this._oCheckButton);this._oCheckButton.destroy();this._oCheckButton=null;it.call(this,t);X.call(this,true)}function Z(t){var e=[];e=this.check(true);this.fireChecked({erroneousFields:e})}function tt(t){this.check(true).then(function(t){this.fireChecked({erroneousFields:t})}.bind(this))}function et(t){var e;if(!t._bCreatedBySmartForm){var i=t.getContent();var o=false;for(var s=0;s<i.length;s++){if(i[s]instanceof u){o=true;break}}if(!o){e=new u(this.getId()+"-"+t.getId()+"-spacer");e._bCreatedBySmartForm=true;t.addContent(e)}if(!(i[i.length-1]instanceof h)){var a=new h(this.getId()+"-"+t.getId()+"-separator");a._bCreatedBySmartForm=true;t.addContent(a)}}else{e=new u(t.getId()+"-spacer");e._bCreatedBySmartForm=true;t.addContent(e)}}function it(t){var e=t.getContent();var i;if(!t._bCreatedBySmartForm){i=e[e.length-1];if(i instanceof h&&i._bCreatedBySmartForm){i.destroy()}e=t.getContent()}i=e[e.length-1];if(i instanceof u&&i._bCreatedBySmartForm){i.destroy()}}function ot(t,e){if(!t.layout&&!t.requested){t.layout=sap.ui.require(t.path);if(!t.layout){t.promise=new Promise(function(e){sap.ui.require([t.path],t.loaded.bind(this));t.resolve=e;t.requestIds=[this.getId()]}.bind(this));t.requested=true}}else if(!t.layout&&t.requested&&t.promise&&t.requestIds.indexOf(this.getId())<0){t.promise.then(function(){if(!this._bIsBeingDestroyed){st.call(this)}}.bind(this));t.requestIds.push(this.getId())}if(t.layout&&!t.requested&&!(e instanceof t.layout)){if(e){e.destroy()}e=new t.layout(this._oForm.getId()+"-layout");this._oForm.setLayout(e);return true}return false}function st(){var t=this.getLayout();var e=this._oForm.getLayout();var i=this.getUseHorizontalLayout();var o=false;if(t&&t.isA("sap.ui.comp.smartform.ColumnLayout")){if(i){throw new Error("ColumnLayout and useHorizontalLayout must not ne used at the same time on "+this)}o=ot.call(this,m.ColumnLayout,e);if(o){ft.call(this,t)}}else if(i&&(!t||!t.getGridDataSpan())){o=ot.call(this,m.ResponsiveLayout,e)}else if(!e||!m.ResponsiveGridLayout.layout||!(e instanceof m.ResponsiveGridLayout.layout)){o=ot.call(this,m.ResponsiveGridLayout,e);if(o){this._oFormLayoutNotInitial=true;ht.call(this,t)}}if(o){var s=this.getGroups();for(var a=0;a<s.length;a++){var r=s[a];r._updateLayoutData()}}}function at(t,e){t.layout=e;t.requested=false;t.resolve();delete t.resolve;delete t.requestIds;t.promise=undefined;if(!this._bIsBeingDestroyed){st.call(this)}}function rt(t){at.call(this,m.ResponsiveGridLayout,t)}function nt(t){at.call(this,m.ResponsiveLayout,t)}function lt(t){at.call(this,m.ColumnLayout,t)}function ut(t){if(!t||t.isA("sap.ui.comp.smartform.Layout")){ht.call(this,t)}else if(t.isA("sap.ui.comp.smartform.ColumnLayout")){ft.call(this,t)}}function ht(t){var e=this._oForm.getLayout();if(!e||!e.isA(m.ResponsiveGridLayout.name)){return}if(this.getUseHorizontalLayout()){if(t&&t.getGridDataSpan()){ct.call(this,e);e.setColumnsL(1);e.setColumnsM(1);if(t.getBreakpointM()>0){e.setBreakpointM(t.getBreakpointM())}if(t.getBreakpointL()>0){e.setBreakpointL(t.getBreakpointL())}if(t.getBreakpointXL()>0){e.setBreakpointXL(t.getBreakpointXL())}this._oFormLayoutNotInitial=true}}else{if(t){e.setLabelSpanXL(t.getLabelSpanXL()?t.getLabelSpanXL():-1);e.setLabelSpanL(t.getLabelSpanL()?t.getLabelSpanL():4);e.setLabelSpanM(t.getLabelSpanM()?t.getLabelSpanM():4);e.setLabelSpanS(t.getLabelSpanS()?t.getLabelSpanS():12);e.setEmptySpanXL(t.getEmptySpanXL()?t.getEmptySpanXL():-1);e.setEmptySpanL(t.getEmptySpanL()?t.getEmptySpanL():0);e.setEmptySpanM(t.getEmptySpanM()?t.getEmptySpanM():0);e.setColumnsXL(t.getColumnsXL()?t.getColumnsXL():-1);e.setColumnsL(t.getColumnsL()?t.getColumnsL():3);e.setColumnsM(t.getColumnsM()?t.getColumnsM():2);e.setSingleContainerFullSize(t.getSingleGroupFullSize());e.setBreakpointXL(t.getBreakpointXL()?t.getBreakpointXL():1440);e.setBreakpointL(t.getBreakpointL()?t.getBreakpointL():1024);e.setBreakpointM(t.getBreakpointM()?t.getBreakpointM():600);this._oFormLayoutNotInitial=true}else{ct.call(this,e)}pt.call(this,t,e)}}function pt(t,e){if(this.getUseHorizontalLayout()){return}if(!e){e=this._oForm.getLayout();t=this.getLayout()}if(!e||!e.isA(m.ResponsiveGridLayout.name)){return}var i=this.getGroups();var o=-1;var s=3;var a=true;var r=0;for(var n=0;n<i.length;n++){if(i[n].isVisible()){r++}}if(t){s=t.getColumnsL()?t.getColumnsL():3;o=t.getColumnsXL()>0?t.getColumnsXL():-1;a=t.getSingleGroupFullSize()}if(i&&r>0&&r<o&&a){e.setColumnsXL(r)}else if(e.getColumnsXL()!=o){e.setColumnsXL(o)}if(i&&r>0&&r<s&&a){e.setColumnsL(r)}else if(e.getColumnsL()!=s){e.setColumnsL(s)}}function ct(t){if(this._oFormLayoutNotInitial){t.setLabelSpanXL(-1);t.setLabelSpanL(4);t.setLabelSpanM(4);t.setLabelSpanS(12);t.setEmptySpanXL(-1);t.setEmptySpanL(0);t.setEmptySpanM(0);t.setColumnsXL(-1);t.setColumnsL(3);t.setColumnsM(2);t.setSingleContainerFullSize(true);t.setBreakpointXL(1440);t.setBreakpointL(1024);t.setBreakpointM(600);this._oFormLayoutNotInitial=false}}function ft(t){var e=this._oForm.getLayout();if(!e||!e.isA(m.ColumnLayout.name)){return}if(this.getUseHorizontalLayout()){throw new Error("ColumnLayout and useHorizontalLayout must not ne used at the same time on "+this)}else{e.setColumnsXL(t.getColumnsXL());e.setColumnsL(t.getColumnsL());e.setColumnsM(t.getColumnsM());e.setLabelCellsLarge(t.getLabelCellsLarge());e.setEmptyCellsLarge(t.getEmptyCellsLarge())}}function gt(t,e,i,o){ut.call(this,t);if(e==="gridDataSpan"){this.propagateGridDataSpan();if(i===""||o===""){st.call(this)}}}b.prototype._suggestTitleId=function(t){this._oForm._suggestTitleId(t);return this};return b});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/SmartForm.flexibility", ["sap/ui/comp/smartform/flexibility/changes/RemoveGroup","sap/ui/comp/smartform/flexibility/changes/AddGroup","sap/ui/comp/smartform/flexibility/changes/MoveGroups","sap/ui/comp/smartform/flexibility/changes/RenameTitle","sap/ui/comp/smartform/flexibility/changes/CombineFields","sap/ui/comp/smartform/flexibility/changes/SplitField","sap/ui/comp/smartform/flexibility/changes/MoveFields"],function(i,e,o,s,m,r,a){"use strict";return{removeGroup:i,addGroup:e,moveGroups:o,renameField:s,combineFields:m,splitField:r,moveControls:a}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddField", ["sap/ui/fl/changeHandler/Base","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(e,r,t){"use strict";var i={};i.applyChange=function(r,i,n){var l=r.getTexts();var o=r.getContent();var a=function(){var e=l&&l.fieldLabel&&l.fieldLabel.value;var r=o;var t=false;if(r){t=o.field&&(o.field.selector||o.field.id)&&o.field.jsType&&o.field.value&&o.field.valueProperty}return e&&r&&t};var f=n.modifier;var d=n.appComponent;var u=n.view;if(a()){var s=o.field.selector;var p=o.field.id;var c=l.fieldLabel.value;var v=o.field.jsType;var C=o.field.valueProperty;var g=o.field.value;var h=o.field.entitySet;var y=o.field.index;if(f.bySelector(s||p,d,u)){return e.markAsNotApplicable("Control to be created already exists:"+s||p,true)}return Promise.resolve().then(f.createControl.bind(f,"sap.ui.comp.smartform.GroupElement",d,u,s||p)).then(function(e){if(!s){s=f.getSelector(p,d)}r.setRevertData({newFieldSelector:s});f.setProperty(e,"label",undefined);f.setProperty(e,"label",c);return Promise.resolve().then(f.insertAggregation.bind(f,i,"groupElements",e,y,u)).then(function(){return t.addElementIntoGroupElement(f,u,e,v,C,g,h,y,d)})})}return Promise.resolve()};i.completeChangeContent=function(e,t,i){var n=i.appComponent;if(t.fieldLabel){e.setText("fieldLabel",t.fieldLabel,"XFLD")}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required")}var l={field:{}};if(t.fieldValue){l.field.value=t.fieldValue}else{throw new Error("oSpecificChangeInfo.fieldValue attribute required")}if(t.valueProperty){l.field.valueProperty=t.valueProperty}else{throw new Error("oSpecificChangeInfo.valueProperty attribute required")}if(t.newControlId){l.field.selector=r.getSelector(t.newControlId,n,{index:t.index})}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(t.jsType){l.field.jsType=t.jsType}else{throw new Error("oSpecificChangeInfo.jsType attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{l.field.index=t.index}if(t.entitySet){l.field.entitySet=t.entitySet}e.setContent(l)};i.revertChange=function(e,r,i){return t.revertChange(e,r,i)};i.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().field.selector]}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddFields", ["sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/ui/core/util/reflection/JsControlTreeModifier","sap/base/util/merge","sap/base/util/ObjectPath"],function(e,t,r,n,o){"use strict";function i(e){return typeof e==="function"}function a(e,t){return e+"-element"+t}function l(e){var t=false;t=e.field&&(e.field.selector||e.field.id)&&e.field.jsTypes&&e.field.value&&e.field.valueProperty;if(!t){throw new Error("Change does not contain sufficient information to be applied.")}}function u(e,t){var r=n({},e);r.fieldSelector.id=a(r.fieldSelector.id,0);return t.createControlForProperty(r).then(function(r){var n=e.modifier.getId(r.control);e.labelFor=n;return t.createLabel(e).then(function(e){return{label:e,control:r.control}})})}function f(e,t){var r=n({aggregationName:"formElements",payload:e.payload||{}},t);var a=e.instance;return Promise.resolve().then(function(){if(i(a.createLayout)){return a.createLayout(r)}}).then(function(e){if(o.get("control",e)){e.layoutControl=true;return e}return u(r,a)})}var d={};d.applyChange=function(t,r,n){var o=t.getContent();var i=n.modifier;var a=n.appComponent;var u=o.field.selector;var f=n.view;var s=o.field.id;if(i.bySelector(u||s,a,f)){return e.markAsNotApplicable("Control to be created already exists:"+u||s,true)}var c=o.field.index;var g=t.getDependentControl("form",n);var p=g&&i.getFlexDelegate(g);if(!p){l(o);var v;return Promise.resolve().then(i.createControl.bind(i,"sap.ui.comp.smartform.GroupElement",a,f,u||s)).then(function(e){v=e;if(!u){u=i.getSelector(s,a)}t.setRevertData({newFieldSelector:u});return o.field.jsTypes.reduce(function(e,t,r){var n=o.field.valueProperty[r];var l=o.field.value[r];var u=o.field.entitySet;return e.then(this.addElementIntoGroupElement.bind(this,i,f,v,t,n,l,u,r,a))}.bind(this),Promise.resolve())}.bind(this)).then(function(){return i.insertAggregation(r,"groupElements",v,c)})}return d._addFieldFromDelegate(g,r,u,s,c,o.field.value[0],t,i,f,a)};d._addFieldFromDelegate=function(e,r,n,o,i,a,l,u,d,s){var c;var g;return t.getDelegateForControl({control:e,modifier:u}).then(function(t){var r={appComponent:s,view:d,fieldSelector:n||o,bindingPath:a,modifier:u,element:e};return f(t,r)}).then(function(e){g=e;if(!g.layoutControl){return Promise.resolve().then(u.createControl.bind(u,"sap.ui.comp.smartform.GroupElement",s,d,n||o)).then(function(e){c=e;return Promise.resolve().then(u.insertAggregation.bind(u,c,"label",g.label,0,d)).then(u.insertAggregation.bind(u,c,"fields",g.control,0,d)).then(function(){return c})})}return g.control}).then(function(e){return u.insertAggregation(r,"groupElements",e,i,d)}).then(function(){if(g.valueHelp){return u.insertAggregation(e,"dependents",g.valueHelp,0,d)}}).then(function(){if(!n){n=u.getSelector(o,s)}l.setRevertData({newFieldSelector:n,valueHelpSelector:g.valueHelp&&u.getSelector(g.valueHelp,s)})})};d.addElementIntoGroupElement=function(t,r,n,o,i,l,u,f,d){var s;var c=t.getId(n);var g=a(c,f);return Promise.resolve().then(t.createControl.bind(t,o,d,r,g)).then(function(e){s=e;t.bindProperty(s,i,l);t.setProperty(s,"expandNavigationProperties",true);return t.insertAggregation(n,"elements",s,f,r,true)}).then(function(){if(u){t.setProperty(s,"entitySet",u)}}).catch(function(t){return e.markAsNotApplicable(t&&t.message||"Control couldn't be created",true)})};d.completeChangeContent=function(e,t,n){var o=n.appComponent;var i={field:{}};if(t.fieldValues){i.field.value=t.fieldValues}else if(t.bindingPath){i.field.value=[t.bindingPath]}else{throw new Error("oSpecificChangeInfo.fieldValue or bindingPath attribute required")}if(t.valueProperty){i.field.valueProperty=t.valueProperty}else if(t.bindingPath){i.field.valueProperty=["value"]}else{throw new Error("oSpecificChangeInfo.valueProperty or bindingPath attribute required")}if(t.newControlId){i.field.selector=r.getSelector(t.newControlId,o)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(t.jsTypes){i.field.jsTypes=t.jsTypes}else if(t.bindingPath){i.field.jsTypes=["sap.ui.comp.smartfield.SmartField"]}else{throw new Error("oSpecificChangeInfo.jsTypes or bindingPath attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{i.field.index=t.index}if(t.entitySet){i.field.entitySet=t.entitySet}e.setContent(i);if(t.relevantContainerId){e.addDependentControl(t.relevantContainerId,"form",n)}};d.revertChange=function(e,t,r){var n=r.appComponent;var o=r.view;var i=r.modifier;var a=e.getRevertData();var l=a.newFieldSelector;var u=i.bySelector(l,n,o);return Promise.resolve().then(i.removeAggregation.bind(i,t,"groupElements",u)).then(function(){i.destroy(u);var t=a.valueHelpSelector;if(t){var l=i.bySelector(t,n,o);var f=e.getDependentControl("form",r);return Promise.resolve().then(i.removeAggregation.bind(i,f,"dependents",l)).then(function(){i.destroy(l)})}}).then(function(){e.resetRevertData()})};d.getCondenserInfo=function(e){return{affectedControl:e.getContent().field.selector,classification:sap.ui.fl.condenser.Classification.Create,targetContainer:e.getSelector(),targetAggregation:"groupElements",setTargetIndex:function(e,t){e.getContent().field.index=t},getTargetIndex:function(e){return e.getContent().field.index}}};d.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().field.selector]}};return d},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddGroup", ["sap/ui/core/util/reflection/JsControlTreeModifier"],function(e){"use strict";var r={};r.applyChange=function(e,r,o){var t=o.modifier;var n=o.appComponent;var i=o.view;var a=e.getContent();var u=e.getTexts();if(u&&u.groupLabel&&u.groupLabel.value&&a&&a.group&&(a.group.selector||a.group.id)){var p=u.groupLabel.value;var l=a.group.index;var g=a.group.selector;return Promise.resolve().then(t.createControl.bind(t,"sap.ui.comp.smartform.Group",n,i,a.group.selector||a.group.id)).then(function(o){if(!g){g=t.getSelector(a.group.id,n)}e.setRevertData({newGroupSelector:g});t.setProperty(o,"visible",true);t.setProperty(o,"label",p);return t.insertAggregation(r,"groups",o,l,i)})}return Promise.resolve()};r.completeChangeContent=function(r,o,t){var n=t.appComponent;var i={group:{}};if(o.newLabel){r.setText("groupLabel",o.newLabel,"XFLD")}else{throw new Error("oSpecificChangeInfo.groupLabel attribute required")}if(o.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{i.group.index=o.index}if(o.newControlId){i.group.selector=e.getSelector(o.newControlId,n)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}r.setContent(i)};r.revertChange=function(e,r,o){var t=o.appComponent;var n=o.view;var i=o.modifier;var a=e.getRevertData().newGroupSelector;var u=i.bySelector(a,t,n);return Promise.resolve().then(i.removeAggregation.bind(i,r,"groups",u)).then(function(){i.destroy(u);e.resetRevertData()})};r.getChangeVisualizationInfo=function(e){var r=e.getText("groupLabel");return{affectedControls:[e.getContent().group.selector],descriptionPayload:{originalLabel:r}}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/CombineFields", ["sap/ui/comp/smartform/flexibility/changes/RenameField"],function(e){"use strict";var n={};function t(e,n,t){return Promise.all(n.map(function(n){if(!t.found){t.index++;return e.getProperty(n,"mandatory").then(function(e){t.found=t.found||e})}return undefined}))}function r(e,n){var r={found:false,index:-1};return n.reduce(function(n,o){return n.then(e.getAggregation.bind(e,o,"fields")).then(function(n){if(!r.found){return t(e,n,r)}return undefined})},Promise.resolve()).then(function(){return r.found?r.index:-1})}n._getPreviousLabelPropertyOnControl=function(e,n,t){return Promise.resolve().then(n.getProperty.bind(n,e,t)).then(function(r){if(r&&typeof r!=="string"){t="text";e=r}return n.getPropertyBindingOrProperty(e,t)}).then(function(e){return e?e:"$$Handled_Internally$$"})};function o(e){return!!e.newElementId}function i(e,n,t){var r=e.modifier;var i=e.appComponent;var l=e.view;if(o(n)){return r.getAggregation(t,"dependents").then(function(o){var u=o.find(function(e){return r.bySelector(n.newElementId,i,l)});if(u){return r.removeAggregation(t,"dependents",u).then(function(){return u})}return r.createControl("sap.ui.comp.smartform.GroupElement",e.appComponent,e.view,n.newElementId)})}return Promise.resolve(r.bySelector(n.sourceSelector,i,l))}function l(e,n,t,r){return r.getAggregation(e,"groupElements").then(function(e){var r=e.indexOf(n);return t.reduce(function(n,t){var o=e.indexOf(t);if(o>-1&&o<r){n=n-1}return n},r)})}function u(e,n,t,r,o,i,l){if(o.newElementId||e!==n){var u=t.getParent(e);return l.reduce(function(o,l,u){return o.then(t.removeAggregation.bind(t,e,"elements",l)).then(t.insertAggregation.bind(t,n,"elements",l,i+u,r))},Promise.resolve()).then(t.removeAggregation.bind(t,u,"groupElements",e)).then(t.insertAggregation.bind(t,u,"dependents",e,0,r)).then(function(){return i+(l.length||0)})}return Promise.resolve(0)}n.applyChange=function(n,t,a){var g=n.getContent();var s=a.modifier;var c=a.appComponent;var d=a.view;var f=s.bySelector(g.sourceSelector,c,d);var m=s.getParent(f);var v=[];var p;var h;var b;var S;var C=g.combineFieldSelectors.map(function(e){return s.bySelector(e,c,d)});return i(a,g,m).then(function(e){if(e){return l(m,f,C,s).then(function(n){if(n>-1){S=n;f=e}}).then(this._collectRevertDataForElements.bind(this,s,C,c,e,m))}return this._collectRevertDataForElements(s,C,c)}.bind(this)).then(function(e){b=e}).then(function(){return r(s,C).then(function(e){if(e>0){s.setProperty(f,"elementForLabel",e)}})}).then(function(){var e=sap.ui.getCore().getConfiguration().getRTL();var t=0;return C.reduce(function(r,o,i){return r.then(function(r){t=t+r;var l="fieldLabel"+i.toString();h=n.getText(l);if(h&&h!==p){if(e){v.unshift(h)}else{v.push(h)}p=h}return s.getAggregation(o,"elements")}).then(function(e){return u(o,f,s,d,g,t,e)})},Promise.resolve(0))}).then(function(){return e.setLabelPropertyOnControl(f,v.join("/"),s,"label")}).then(function(){if(o(g)){return s.insertAggregation(m,"groupElements",f,S,d)}return undefined}).then(function(){n.setRevertData(b)})};n._collectRevertDataForElements=function(e,n,t,r,o){var i={elementStates:[]};var l=0;var u=0;var a=[];if(r){a.push(r);a=a.concat(n)}return Promise.all(a.map(function(n){var r=e.getParent(n)||o;return Promise.all([e.getAggregation(n,"elements"),e.getAggregation(r,"groupElements"),this._getPreviousLabelPropertyOnControl(n,e,"label"),e.getProperty(n,"elementForLabel")]).then(function(o){u=l+o[0].length-1;i.elementStates.push({groupElementSelector:e.getSelector(e.getId(n),t),parentSelector:e.getSelector(e.getId(r),t),groupElementIndex:o[1].indexOf(n),firstFieldIndex:l,lastFieldIndex:u,label:o[2],elementForLabel:o[3]});l=u+1})}.bind(this))).then(function(){return i})};n.revertChange=function(n,t,r){var i=n.getRevertData();var l=r.modifier;var u=r.appComponent;var a=[];i.elementStates=i.elementStates.sort(function(e,n){return e.groupElementIndex-n.groupElementIndex});return i.elementStates.reduce(function(e,t){var r=l.bySelector(t.parentSelector,u);var i=l.bySelector(t.groupElementSelector,u);return e.then(l.getAggregation.bind(l,r,"groupElements")).then(function(e){if(e.indexOf(i)===-1){return Promise.resolve().then(l.removeAggregation.bind(l,r,"dependents",i)).then(l.insertAggregation.bind(l,r,"groupElements",i,t.groupElementIndex))}else{return Promise.resolve().then(l.getAggregation.bind(l,i,"elements")).then(function(e){a=e;return l.removeAllAggregation(i,"elements")}).then(function(){if(o(n.getContent())){return l.removeAggregation(r,"groupElements",i).then(l.insertAggregation.bind(l,r,"dependents",i))}return undefined})}})},Promise.resolve()).then(function(){return i.elementStates.reduce(function(n,t){var r;var o;return n.then(function(){r=l.bySelector(t.groupElementSelector,u);var e=[];for(var n=t.firstFieldIndex;n<=t.lastFieldIndex;n++){e.push(l.insertAggregation(r,"elements",a[n],a.length))}return Promise.all(e)}).then(function(){o=t.label;if(o==="$$Handled_Internally$$"){o=undefined;return l.getAggregation(r,"fields")}return undefined}).then(function(n){if(n&&n.length){var i=n[t.elementForLabel];l.setProperty(i,"textLabel",undefined)}l.setProperty(r,"elementForLabel",t.elementForLabel);return e.setLabelPropertyOnControl(r,o,l,"label")})},Promise.resolve())}).then(n.resetRevertData.bind(n))};n.completeChangeContent=function(e,n,t){var r=t.modifier;var o=t.view;var i=t.appComponent;var l={};if(n.newElementId){l.newElementId=n.newElementId}var u=n.combineElementIds;if(u&&u.length>=2){l.combineFieldSelectors=u.map(function(e){return r.getSelector(e,i)});e.addDependentControl(u,"combinedFields",t)}else{throw new Error("oSpecificChangeInfo.combineElementIds attribute required")}if(n.sourceControlId){l.sourceSelector=r.getSelector(n.sourceControlId,i);e.addDependentControl(n.sourceControlId,"sourceControl",t)}else{throw new Error("oSpecificChangeInfo.sourceControlId attribute required")}var a;var g;var s;for(var c=0;c<l.combineFieldSelectors.length;c++){var d=l.combineFieldSelectors[c];s=r.bySelector(d,i,o);a=s.getLabelText();if(a){g="fieldLabel"+c;e.setText(g,a,"XFLD")}}e.setContent(l)};n.getChangeVisualizationInfo=function(e){var n=e.getContent();return{displayControls:[n.newElementId],affectedControls:[n.sourceSelector],descriptionPayload:{originalSelectors:n.combineFieldSelectors}}};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/MoveFields", ["sap/ui/fl/changeHandler/MoveControls"],function(e){"use strict";var n=Object.assign({},e);n.applyChange=function(n,t,r){var g=Object.assign({},r,{targetAggregation:"groupElements",sourceAggregation:"groupElements"});return e.applyChange.call(this,n,t,g)};n.getCondenserInfo=function(n){var t=e.getCondenserInfo.call(this,n);t.targetAggregation="groupElements";return t};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/MoveGroups", ["sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,n){"use strict";var r={};r._checkCompleteChangeContentConditions=function(e){if(!e.movedElements){throw new Error("oSpecificChangeInfo.movedElements attribute required")}if(e.movedElements.length===0){throw new Error("MovedElements array is empty")}e.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedElements element has no id attribute")}if(typeof e.targetIndex!=="number"){throw new Error("Index attribute at MovedElements element is no number")}})};r._buildStableChangeInfo=function(e){var n=e.source.id;var r=e.target.id;var t={changeType:e.changeType,selector:{id:n},targetId:r!==n?r:null};t[e.changeType]=[];e.movedElements.forEach(function(n){t[e.changeType].push({id:n.id,sourceIndex:n.sourceIndex,index:n.targetIndex})});return t};r.applyChange=function(n,r,t){function o(n,t){if(!n){return Promise.reject(new Error("No change instance"))}var o=n.getContent();return Promise.resolve().then(t.getAggregation.bind(t,r,"groups")).then(function(n){if(!n){e.error("Object has no smartform elements aggregation",t.getId(r))}if(!o||!o.moveGroups||o.moveGroups.length===0){return Promise.reject(new Error("Change format invalid"))}return undefined})}function i(e,n,r,t){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveGroups element has no id attribute"))}if(typeof e.index!=="number"){return Promise.reject(new Error("Change format invalid - moveGroups element index attribute is no number"))}return Promise.resolve(n.bySelector(e.selector||e.id,r,t))}var u=t.modifier;var a=t.view;var s=t.appComponent;var d=[];function c(n,t){if(!t){return Promise.resolve(e.warning("Group to move not found"))}return Promise.resolve().then(u.findIndexInParentAggregation.bind(u,t)).then(function(e){if(e===n.index&&typeof n.sourceIndex==="number"){e=n.sourceIndex}d.push({selector:u.getSelector(t,s),index:e})}).then(u.removeAggregation.bind(u,r,"groups",t,a)).then(u.insertAggregation.bind(u,r,"groups",t,n.index))}return o(n,u).then(function(){var e=n.getContent();return e.moveGroups.reduce(function(e,n){return e.then(i.bind(null,n,u,s,a)).then(function(e){return c(n,e)})},Promise.resolve())}).then(function(){n.setRevertData({movedGroups:d})})};r.completeChangeContent=function(e,r,t){this._checkCompleteChangeContentConditions(r);r=this._buildStableChangeInfo(r);var o={moveGroups:[]};var i=r.moveGroups.map(function(e){var r=sap.ui.getCore().byId(e.id);var i=n.getSelector(r,t.appComponent);o.moveGroups.push({selector:i,sourceIndex:e.sourceIndex,index:e.index});return r});e.addDependentControl(i,"movedGroups",t);e.setContent(o)};r.revertChange=function(e,n,r){var t=r.appComponent;var o=r.view;var i=r.modifier;var u=e.getRevertData().movedGroups;return u.reduce(function(e,r){var u=i.bySelector(r.selector,t,o);return e.then(i.removeAggregation.bind(i,n,"groups",u,o)).then(i.insertAggregation.bind(i,n,"groups",u,r.index))},Promise.resolve()).then(function(){e.resetRevertData()})};r.getChangeVisualizationInfo=function(e){var n=e.getContent();return{affectedControls:[n.moveGroups[0].selector],dependentControls:[n.moveGroups[0].selector.source||e.getSelector()]}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RemoveField", [],function(){"use strict";var e={};e.applyChange=function(e,r,n){var t=n.modifier;var i=n.view;var a=t.getParent(r);if(a){return Promise.resolve().then(t.findIndexInParentAggregation.bind(t,r)).then(function(n){e.setRevertData({fieldIndex:n});return t.removeAggregation(a,"groupElements",r,i)})}return Promise.resolve()};e.completeChangeContent=function(e,r){};e.revertChange=function(e,r,n){var t=n.view;var i=n.modifier;var a=e.getRevertData().fieldIndex;var o=i.getParent(r);return Promise.resolve().then(i.insertAggregation.bind(i,o,"groupElements",r,a,t)).then(e.resetRevertData.bind(e))};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RemoveGroup", [],function(){"use strict";var e={};e.applyChange=function(e,n,r){var t=r.modifier;var a=r.view;var o=t.getParent(n);var i;var g;return Promise.resolve().then(t.findIndexInParentAggregation(n)).then(function(e){g=e;if(t.getControlType(o)==="sap.ui.layout.form.Form"){i="formContainers";return t.removeAggregation(o,"formContainers",n,a)}i="groups";return t.removeAggregation(o,"groups",n,a)}).then(t.insertAggregation.bind(t,o,"dependents",n,0,a)).then(function(){e.setRevertData({groupIndex:g,aggregation:i})})};e.completeChangeContent=function(e,n){};e.revertChange=function(e,n,r){var t=r.view;var a=r.modifier;var o=e.getRevertData();var i=a.getParent(n);return Promise.resolve().then(a.removeAggregation.bind(a,i,"dependents",n)).then(a.insertAggregation.bind(a,i,o.aggregation,n,o.groupIndex,t)).then(e.resetRevertData.bind(e))};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameField", ["sap/ui/fl/changeHandler/BaseRename","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t,r){"use strict";var n="label";var a="fieldLabel";var i="XFLD";var o=e.createRenameChangeHandler({changePropertyName:a,translationTextType:i});o.applyChange=function(e,t,r){var i=e.getText(a);if(typeof i==="string"){return this.setLabelPropertyOnControl(t,i,r.modifier,n).then(function(t){e.setRevertData(t)})}return Promise.resolve()};o.revertChange=function(e,r,a){var i=e.getRevertData();if(i||i===""){if(i==="$$Handled_Internally$$"){i=undefined}return this.setLabelPropertyOnControl(r,i,a.modifier,n).then(function(){e.resetRevertData()})}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");return Promise.resolve()};o.setLabelPropertyOnControl=function(e,t,r,n){return Promise.resolve().then(r.getProperty.bind(r,e,n)).then(function(t){if(t&&typeof t!=="string"){n="text";e=t}}).then(r.getPropertyBindingOrProperty.bind(r,e,n)).then(function(a){r.setPropertyBindingOrProperty(e,n,t);return a||"$$Handled_Internally$$"})};o.getChangeVisualizationInfo=function(e,t){var n=e.getText(a),i=e.getRevertData(),o,l,s;if(i==="$$Handled_Internally$$"){i=undefined;o=e.getSelector();l=r.bySelector(o,t);if(l.isA("sap.ui.comp.smartform.GroupElement")){s=l.getDataSourceLabel();if(s){i=s}}}return{descriptionPayload:{originalLabel:i,newLabel:n}}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameGroup", ["sap/ui/fl/changeHandler/BaseRename","sap/base/Log"],function(e,t){"use strict";var r="label";var n="groupLabel";var a="XFLD";var i=e.createRenameChangeHandler({propertyName:r,changePropertyName:n,translationTextType:a});i.applyChange=function(e,t,a){var i=e.getText(n);if(typeof i==="string"){return this.setLabelOrTitleOnControl(t,i,a.modifier,r).then(function(t){e.setRevertData(t)})}return Promise.resolve()};i.revertChange=function(e,n,a){var i=e.getRevertData();if(i||i===""){return this.setLabelOrTitleOnControl(n,i,a.modifier,r).then(e.resetRevertData())}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");return Promise.resolve()};i.setLabelOrTitleOnControl=function(e,t,r,n){return Promise.all([r.getProperty(e,n),r.getAggregation(e,"title")]).then(function(t){var a=t[0];var i=t[1];if(!a&&i){if(typeof i==="string"){n="title"}else{n="text";e=i}}return r.getPropertyBindingOrProperty(e,n)}).then(function(a){r.setPropertyBindingOrProperty(e,n,t);return a})};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameTitle", ["sap/ui/fl/changeHandler/BaseRename"],function(e){"use strict";var a=e.createRenameChangeHandler({propertyName:"title",changePropertyName:"fieldLabel",translationTextType:"XFLD"});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/SplitField", [],function(){"use strict";var e={};e.applyChange=function(e,t,r){var n=e.getContent();var o=r.modifier;var i=r.appComponent;var l=r.view;var a=o.bySelector(n.sourceSelector,i,l);var s;var u=function(e,t){if(e.index>t.index){return 1}else if(e.index<t.index){return-1}};var g=o.bySelector(n.parentSelector,i,l);var c=n.newElementIds.slice();var p=[];var d;var f;var m;var v;return Promise.all([o.getAggregation(a,"elements"),o.getProperty(a,"elementForLabel"),o.getAggregation(g,"groupElements")]).then(function(e){d=e[0];f=e[1];m=e[2];v=m.indexOf(a);return o.getProperty(a,"label")}).then(function(e){if(e&&typeof e!=="string"){return o.getProperty(e,"text")}return e}).then(function(e){s=e;return d.reduce(function(e,t,n){if(n!==f){var u=c.pop();var d;return e.then(o.createControl.bind(o,"sap.ui.comp.smartform.GroupElement",r.appComponent,l,u)).then(function(e){d=e;p.push({groupElementSelector:o.getSelector(d,i),index:n});return Promise.resolve().then(o.removeAggregation.bind(o,a,"elements",t)).then(o.insertAggregation.bind(o,d,"elements",t,0,l)).then(o.insertAggregation.bind(o,g,"groupElements",d,v+n,l)).then(o.getProperty.bind(o,d,"label")).then(function(e){if(e&&typeof e!=="string"){o.setProperty(e,"text",s)}else{o.setProperty(d,"label",s)}})})}else{p.push({groupElementSelector:o.getSelector(a,i),index:n});if(f!==0){o.setProperty(a,"elementForLabel",0)}return e.then(o.removeAggregation.bind(o,a,"elements",t)).then(o.insertAggregation.bind(o,a,"elements",t,0,l)).then(o.getProperty.bind(o,a,"label")).then(function(e){if(e&&typeof e!=="string"){o.setProperty(e,"text",s)}else{o.setProperty(a,"label",s)}})}},Promise.resolve())}).then(function(){e.setRevertData({sourceControlSelector:n.sourceSelector,labelText:s,splittedFields:p.sort(u)})})};e.completeChangeContent=function(e,t,r){var n=r.modifier;var o=r.appComponent;var i={};if(t.newElementIds){i.newElementIds=t.newElementIds.slice(0,-1)}else{throw new Error("oSpecificChangeInfo.newElementIds attribute required")}if(t.sourceControlId){i.sourceSelector=n.getSelector(t.sourceControlId,o);e.addDependentControl(t.sourceControlId,"sourceControl",r)}else{throw new Error("oSpecificChangeInfo.sourceControlId attribute required")}if(t.parentId){i.parentSelector=n.getSelector(t.parentId,o);e.addDependentControl(t.parentId,"parent",r)}else{throw new Error("oSpecificChangeInfo.parentId attribute required")}e.setContent(i)};e.revertChange=function(e,t,r){var n=r.view;var o=r.modifier;var i=r.appComponent;var l=e.getRevertData();var a=l.splittedFields;var s=o.bySelector(l.sourceControlSelector,i,n);return a.reduce(function(e,t){var r=o.bySelector(t.groupElementSelector,i,n);return e.then(o.getAggregation.bind(o,r,"elements")).then(function(e){var i=e[0];return Promise.resolve().then(o.removeAggregation.bind(o,r,"elements",i)).then(o.insertAggregation.bind(o,s,"elements",i,t.index,n))}).then(function(){if(r!==s){o.destroy(r)}})},Promise.resolve()).then(o.getProperty.bind(o,s,"label")).then(function(t){if(t&&typeof t!=="string"){o.setProperty(t,"text",l.labelText)}else{o.setProperty(s,"label",l.labelText)}e.resetRevertData()})};e.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().sourceSelector],dependentControls:e.getContent().newElementIds}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/UnhideControl", [],function(){"use strict";var e={};e.applyChange=function(e,t,n){var i=n.modifier;var r;var s=[];return Promise.resolve().then(i.getAggregation.bind(i,t,"elements")).then(function(e){s=e;return s.reduce(function(e,t){return e.then(function(e){return e||i.getVisible(t)})},Promise.resolve(false))}).then(function(e){r=e;if(!r){s.forEach(function(e){i.setVisible(e,true)})}return i.getAggregation(t,"label")}).then(function(n){var s=false;if(n&&typeof n!=="string"){i.setVisible(n,true);s=true}i.setVisible(t,true);e.setRevertData({partiallyVisible:r,visibleLabel:s})})};e.completeChangeContent=function(e,t){};e.revertChange=function(e,t,n){var i=n.modifier;var r=e.getRevertData();return Promise.resolve().then(i.getAggregation.bind(i,t,"elements")).then(function(e){if(!r.partiallyVisible){e.forEach(function(e){i.setVisible(e,false)})}if(r.visibleLabel){return Promise.resolve().then(i.getAggregation.bind(i,t,"label")).then(function(e){i.setVisible(e,false)})}}).then(function(){i.setVisible(t,false);e.resetRevertData()})};e.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:sap.ui.fl.condenser.Classification.Reverse,uniqueKey:"visible"}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartlist/SmartList", ["sap/ui/comp/library","sap/m/library","sap/m/VBox","sap/m/FlexItemData","sap/m/List","sap/m/Tree","sap/m/Title","sap/m/Toolbar","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/core/format/NumberFormat","sap/base/util/deepEqual"],function(t,e,i,s,o,r,a,n,l,h,u,d,p,_,c){"use strict";var g=e.ToolbarDesign;var f=i.extend("sap.ui.comp.smartlist.SmartList",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},selectFields:{type:"string",group:"Misc",defaultValue:null},expandFields:{type:"string",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},listBindingPath:{type:"string",group:"Misc",defaultValue:null},listType:{type:"sap.ui.comp.smartlist.ListType",group:"Misc",defaultValue:null},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false}},associations:{smartFilter:{type:"sap.ui.core.Control"}},aggregations:{listItemTemplate:{type:"sap.m.ListItemBase",multiple:false}},events:{initialise:{},beforeRebindList:{},dataReceived:{}}},renderer:{apiVersion:2},constructor:function(){i.apply(this,arguments);this.addStyleClass("sapUiCompSmartList");this._createToolbar();this._createList();this.attachModelContextChange(this._initialiseMetadata,this)}});f.prototype._sAggregation="items";f.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();return this};f.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};f.prototype.setShowFullScreenButton=function(t){this.setProperty("showFullScreenButton",t,true);if(this._oFullScreenButton){this._oFullScreenButton.setVisible(this.getShowFullScreenButton())}return this};f.prototype.setEntitySet=function(t){this.setProperty("entitySet",t);this._initialiseMetadata();return this};f.prototype._refreshHeaderText=function(){if(!this._headerText){return}var t=this.getHeader();var e=!!t;this._headerText.setVisible(e);if(e&&this.getShowRowCount()){var i=parseInt(this._getRowCount(true));if(i>0){if(!this._oNumberFormatter){this._oNumberFormatter=_.getFloatInstance()}var s=this._oNumberFormatter.format(i);t+=" ("+s+")"}}this._headerText.setText(t)};f.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new u(this.getId()+"-btnFullScreen",{press:function(){this._toggleFullScreen(!this.bFullScreen)}.bind(this)})}this._toggleFullScreen(this.bFullScreen,true);this._oToolbar.addContent(this._oFullScreenButton)}};f.prototype._createToolbar=function(){var t,e,i;if(!this._oToolbar){t=this.getItems();e=t?t.length:0;while(e--){i=t[e];if(i instanceof n){break}i=null}if(i){this._oToolbar=i}else{this._oToolbar=new l(this.getId()+"-toolbar",{design:g.Transparent});this.insertItem(this._oToolbar,0)}if(!this._oToolbar.getLayoutData()){this._oToolbar.setLayoutData(new s({shrinkFactor:0}))}}};f.prototype._toggleFullScreen=function(t,e){var i=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),s;if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;p.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);s=this.bFullScreen?i.getText("CHART_MINIMIZEBTN_TOOLTIP"):i.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(s);this._oFullScreenButton.setText(s);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};f.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addHeaderToToolbar();this._addSpacerToToolbar();this._addFullScreenButton();this._oToolbar.addStyleClass("sapMTBHeader-CTX")};f.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new a(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader")}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};f.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,s;if(e){s=e.length;i=0;for(i;i<s;i++){if(e[i]instanceof h){t=true;break}}}if(!t){this._oToolbar.addContent(new h(this.getId()+"-toolbarSpacer"))}};f.prototype._getRowCount=function(t){var e=this._getRowBinding();if(!e){return t?undefined:0}var i;if(!t){i=e.getLength()}else{if(typeof e.getCount==="function"){i=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){i=e.getLength()}}if(i<0||i==="0"){i=0}return i};f.prototype._getRowBinding=function(){if(this._oList){return this._oList.getBinding(this._sAggregation)}};f.prototype._initialiseMetadata=function(){if(!this.bIsInitialised){d.handleModelInit(this,this._onMetadataInitialised)}};f.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;this._listenToSmartFilter();this._createToolbarContent();this._createContent();this.fireInitialise();this._checkAndTriggerBinding()}};f.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindList()}}}};f.prototype._listenToSmartFilter=function(){var t=null;t=this.getSmartFilter();if(typeof t==="string"){this._oSmartFilter=sap.ui.getCore().byId(t)}else{this._oSmartFilter=t}if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindList,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);this._oSmartFilter.attachCancel(this._cancelEvent,this);this._setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA"))}};f.prototype._filterChangeEvent=function(){if(this._isListBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()){this._showOverlay(true)}};f.prototype._cancelEvent=function(){if(this._oSmartFilter&&!this._oSmartFilter.getLiveMode()){this._showOverlay(false)}};f.prototype._showOverlay=function(t){};f.prototype.rebindList=function(t){this._reBindList(null,t)};f.prototype._reBindList=function(t,e){var i,s,o,r,a,n={},l={preventListBind:false};if(this._oSmartFilter){o=this._oSmartFilter.getFilters();n=this._oSmartFilter.getParameters()||{}}r=o;if(!a){a=[]}n["select"]=this.getSelectFields();n["expand"]=this.getExpandFields();n["useBatchRequests"]=true;l.filters=r;l.sorter=a;l.parameters=n;l.length=undefined;l.startIndex=undefined;this.fireBeforeRebindList({bindingParams:l});if(!l.preventListBind){a=l.sorter;r=l.filters;n=l.parameters;s=this.getListBindingPath()||"/"+this.getEntitySet();this._bDataLoadPending=true;this._bIgnoreChange=false;if(!e){i=this._oList.getBinding(this._sAggregation);if(i&&i.mParameters){e=!(c(n,i.mParameters,true)&&c(n.custom,i.mParameters.custom)&&!l.length&&!l.startIndex&&s===i.getPath())}}if(!i||!this._bIsListBound||e){this._oList.bindItems({path:s,filters:r,sorter:a,parameters:n,length:l.length,startIndex:l.startIndex,template:this._oTemplate,events:{dataRequested:function(){this._bIgnoreChange=true}.bind(this),dataReceived:function(t){this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)}.bind(this),change:function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}}.bind(this)}});this._bIsListBound=true}else{i.sort(a);i.filter(r,"Application")}this._showOverlay(false)}};f.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;if(!this._bNoDataUpdated&&!this._getRowCount()){this._bNoDataUpdated=true;this._setNoDataText()}this._refreshHeaderText()}};f.prototype._isListBound=function(){if(this._bIsListBound){return true}if(this._oList){return this._oList.isBound(this._sAggregation)}return false};f.prototype._setNoDataText=function(t){if(this._oList){if(!t){t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS")}this._oList.setNoDataText(t)}};f.prototype._createContent=function(){if(!this._oTemplate){this._oTemplate=this.getListItemTemplate()}};f.prototype._createList=function(){var t=this.getItems(),e=t?t.length:0,i,a;while(e--){i=t[e];if(i instanceof o||i instanceof r){break}i=null}if(i){this._oList=i;if(i instanceof r){this._isTree=true}else{this._isList=true}this._oTemplate=i.getItems()&&i.getItems().length>0?i.getItems()[0]:this.getListItemTemplate();i.removeAllItems()}else{a=this.getId()+"-ui5list";if(this.getListType()==="Tree"){this._oList=new r(a);this._isTree=true}else{this._oList=new o(a,{growing:true,growingScrollToLoad:true});this._isList=true}this.insertItem(this._oList,2)}if(!this._oList.getLayoutData()){this._oList.setLayoutData(new s({growFactor:1,baseSize:"auto"}))}};f.prototype.getList=function(){return this._oList};f.prototype.isInitialised=function(){return!!this.bIsInitialised};f.prototype.exit=function(){if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindList,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter.detachCancel(this._cancelEvent,this);this._oSmartFilter=null}p.cleanUpFullScreen(this);if(!this._bIsListBound&&this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;this._oToolbar=null;this._headerText=null;this._oFullScreenButton=null;this._oNumberFormatter=null;this._oList=null};return f});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartAreaMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/AreaMicroChart","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartLabel","sap/ui/core/Control","sap/m/library","sap/ui/model/odata/CountMode","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,e,a,r,i,o,n,h,s,c){"use strict";var g=n.ValueColor;var l=s.extend("sap.ui.comp.smartmicrochart.SmartAreaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartAreaMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:true}}},renderer:c});l.prototype._CHART_TYPE=["Area","Line"];l.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Area",true);this.setAggregation("_chart",new e,true)};l.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true);t.setSize(this.getSize(),true)};l.prototype.setShowLabel=function(t){if(this.getShowLabel()!==t){this.setProperty("showLabel",t,true);this.getAggregation("_chart").setProperty("showLabel",t,true);this.invalidate()}return this};l.prototype.setEnableAutoBinding=function(){return this.setProperty("enableAutoBinding",true,true)};l.prototype.bindElement=function(){return this};l.prototype._createAndBindInnerChart=function(){this._createChartLabels();this._createChartItem("chart",this._oDataPointAnnotations.Value.Path);this._createChartItem("target",this._oDataPointAnnotations.TargetValue.Path);this._buildThreshold()};l.prototype._buildThreshold=function(){var t=this._oDataPointAnnotations.CriticalityCalculation;if(this._hasMember(t,"ImprovementDirection.EnumMember")){switch(t.ImprovementDirection.EnumMember){case s._MINIMIZE:this._createChartItem("minThreshold",t.ToleranceRangeHighValue.Path,g.Good);this._createChartItem("maxThreshold",t.DeviationRangeHighValue.Path,g.Error);break;case s._MAXIMIZE:this._createChartItem("minThreshold",t.DeviationRangeLowValue.Path,g.Error);this._createChartItem("maxThreshold",t.ToleranceRangeLowValue.Path,g.Good);break;case s._TARGET:this._createChartItem("minThreshold",t.DeviationRangeLowValue.Path,g.Error);this._createChartItem("maxThreshold",t.DeviationRangeHighValue.Path,g.Error);this._createChartItem("innerMinThreshold",t.ToleranceRangeLowValue.Path,g.Good);this._createChartItem("innerMaxThreshold",t.ToleranceRangeHighValue.Path,g.Good);break;default:break}}};l.prototype._createChartLabels=function(){var t,e=this._getLabelsMap();for(var a in e){t=new i;this.getAggregation("_chart").setAggregation(e[a],t,true)}};l.prototype._createChartItem=function(t,e,i){var o,n;o=new a({x:{path:this._oChartViewMetadata.dimensionFields[0],formatter:this._formatDimension.bind(this)},y:{path:e,type:"sap.ui.model.odata.type.Decimal"}});n=new r({points:{path:this._getBindingPath(),template:o,parameters:{countMode:h.None},events:{change:this._onBindingDataChange.bind(this)}},color:i});this.getAggregation("_chart").setAggregation(t,n,true)};l.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getAggregation("chart").getBinding("points");this._updateAssociations(t);this.updateChartLabels.call(this,t)};l.prototype._updateLabel=function(t,e){var a=this.getAggregation("_chart").getAggregation(t);a.setProperty("label",e.text,true);if(e.color){a.setProperty("color",e.color,true)}};l.prototype._getLabelsMap=function(){return{leftTop:"firstYLabel",rightTop:"lastYLabel",leftBottom:"firstXLabel",rightBottom:"lastXLabel"}};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartBulletMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/suite/ui/microchart/BulletMicroChart","sap/suite/ui/microchart/BulletMicroChartData","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,e,i,o,n,r,s){"use strict";var h=n.ValueColor;var l=r.extend("sap.ui.comp.smartmicrochart.SmartBulletMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartBulletMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:s});l._CRITICAL_COLOR=h.Critical;l._ERROR_COLOR=h.Error;l.prototype._CHART_TYPE=["Bullet"];l.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Bullet",true);this.setAggregation("_chart",new i({showValueMarker:true}),true)};l.prototype.setShowLabel=function(t){if(this.getShowLabel()!==t){this.setProperty("showLabel",t,true);var a=this.getAggregation("_chart");a.setProperty("showActualValue",t,true);a.setProperty("showTargetValue",t,true);a.setProperty("showDeltaValue",t,true);a.setProperty("showValueMarker",t,true);this.invalidate()}return this};l.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};l.prototype._createAndBindInnerChart=function(){this._bindValueProperties();this._bindActualValue();this._bindChartThresholds();this._updateAssociations.call(this);this._setMode()};l.prototype._setMode=function(){if(this._hasMember(this,"_oDataPointAnnotations.Visualization.EnumMember")){if(this._oDataPointAnnotations.Visualization.EnumMember===r._DELTABULLET){this.getAggregation("_chart").setMode(e.BulletMicroChartModeType.Delta)}}};l.prototype._bindValueProperties=function(){var t,a,e=this.getAggregation("_chart");if(this._hasMember(this,"_oDataPointAnnotations.TargetValue.Path")){e.bindProperty("targetValue",{path:this._oDataPointAnnotations.TargetValue.Path,type:"sap.ui.model.odata.type.Decimal"});var i=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.TargetValue.Path);e.bindProperty("targetValueLabel",{path:this._oDataPointAnnotations.TargetValue.Path,formatter:i.format.bind(i)})}if(this._hasMember(this,"_oDataPointAnnotations.ForecastValue.Path")){e.bindProperty("forecastValue",{path:this._oDataPointAnnotations.ForecastValue.Path,type:"sap.ui.model.odata.type.Decimal"})}if(this._oDataPointAnnotations.MaximumValue){if(this._oDataPointAnnotations.MaximumValue.hasOwnProperty("Path")){e.bindProperty("maxValue",{path:this._oDataPointAnnotations.MaximumValue.Path,type:"sap.ui.model.odata.type.Decimal"})}else if(this._oDataPointAnnotations.MaximumValue.hasOwnProperty("Decimal")){t=parseFloat(this._oDataPointAnnotations.MaximumValue.Decimal);e.setMaxValue(t,true)}}if(this._oDataPointAnnotations.MinimumValue){if(this._oDataPointAnnotations.MinimumValue.hasOwnProperty("Path")){e.bindProperty("minValue",{path:this._oDataPointAnnotations.MinimumValue.Path,type:"sap.ui.model.odata.type.Decimal"})}else if(this._oDataPointAnnotations.MinimumValue.hasOwnProperty("Decimal")){a=parseFloat(this._oDataPointAnnotations.MinimumValue.Decimal);e.setMinValue(a,true)}}};l.prototype._bindActualValue=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.Value.Path);var e=new o({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"},color:{parts:[this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path||"",this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path||""],formatter:this._getValueColor.bind(this)}});t.setAggregation("actual",e,true);t.bindProperty("actualValueLabel",{path:this._oDataPointAnnotations.Value.Path,formatter:a.format.bind(a)})};l.prototype._bindChartThresholds=function(){var t,a;if(this._hasMember(this._oDataPointAnnotations,"CriticalityCalculation.ImprovementDirection.EnumMember")){a=this._oDataPointAnnotations.CriticalityCalculation;t=a.ImprovementDirection.EnumMember;if(t!==r._MINIMIZE&&a.DeviationRangeLowValue&&a.DeviationRangeLowValue.Path){this._bindThresholdAggregation(a.DeviationRangeLowValue.Path,l._ERROR_COLOR)}if(t!==r._MINIMIZE&&a.ToleranceRangeLowValue&&a.ToleranceRangeLowValue.Path){this._bindThresholdAggregation(a.ToleranceRangeLowValue.Path,l._CRITICAL_COLOR)}if(t!==r._MAXIMIZE&&a.ToleranceRangeHighValue&&a.ToleranceRangeHighValue.Path){this._bindThresholdAggregation(a.ToleranceRangeHighValue.Path,l._CRITICAL_COLOR)}if(t!==r._MAXIMIZE&&a.DeviationRangeHighValue&&a.DeviationRangeHighValue.Path){this._bindThresholdAggregation(a.DeviationRangeHighValue.Path,l._ERROR_COLOR)}}};l.prototype._bindThresholdAggregation=function(t,a){var e=new o({value:{path:t,type:"sap.ui.model.odata.type.Decimal"},color:a});this.getAggregation("_chart").addAggregation("thresholds",e,true)};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartColumnMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/ColumnMicroChart","sap/suite/ui/microchart/ColumnMicroChartData","sap/suite/ui/microchart/ColumnMicroChartLabel","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n,s,h,l,c,p){"use strict";var u=c.extend("sap.ui.comp.smartmicrochart.SmartColumnMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartColumnMicroChart.designtime"},renderer:p});u.prototype._CHART_TYPE=["Column"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Column",true);this.setAggregation("_chart",new s,true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype.setShowLabel=function(t){var a;if(this.getShowLabel()!==t){a=this.getAggregation("_chart");this.setProperty("showLabel",t,true);a.setProperty("showTopLabels",t,true);a.setProperty("showBottomLabels",t,true);a.invalidate()}return this};u.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}var t=this.getAggregation("_chart"),a=new h({value:{path:this._aDataPointAnnotations[0].Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){a.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){a.bindProperty("label",this._aDataPointAnnotations[0].Title.Path)}var i=this._getPropertyAnnotation.call(this,this._aDataPointAnnotations[0].Value.Path);var e=i["com.sap.vocabularies.Common.v1.Text"];if(e&&e.Path){t.setAllowColumnLabels(true);a.bindProperty("displayValue",e.Path)}t.bindAggregation("columns",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}});this._createChartLabels()};u.prototype._createChartLabels=function(){var t,a=this._getLabelsMap();for(var i in a){t=new l;this.getAggregation("_chart").setAggregation(a[i],t,true)}};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("columns");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,a){var i=this.getAggregation("_chart").getAggregation(t);i.setProperty("label",a.text,true);if(a.color){i.setProperty("color",a.color,true)}};u.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartComparisonMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/ComparisonMicroChart","sap/suite/ui/microchart/ComparisonMicroChartData","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,o,n,e,r,s,h,p){"use strict";var c=h.extend("sap.ui.comp.smartmicrochart.SmartComparisonMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartComparisonMicroChart.designtime"},renderer:p});c.prototype._CHART_TYPE=["Comparison"];c.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Comparison",true);this.setAggregation("_chart",new a,true)};c.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};c.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartComparisonMicroChart");return}var t=this.getAggregation("_chart"),a=new i({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("color",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._oDataPointAnnotations.Title&&this._oDataPointAnnotations.Title.Path){a.bindProperty("title",this._oDataPointAnnotations.Title.Path)}var o=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var n=o["com.sap.vocabularies.Common.v1.Text"];if(n&&n.Path){a.bindProperty("displayValue",n.Path)}t.bindAggregation("data",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}})};c.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("data");this._updateAssociations(t)};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartDeltaMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/DeltaMicroChart","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer"],function(t,a,i,n,e,o){"use strict";var r=n.extend("sap.ui.comp.smartmicrochart.SmartDeltaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartDeltaMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:o});r.prototype._CHART_TYPE=["Delta"];r.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType",this._CHART_TYPE,true);this.setAggregation("_chart",new i,true)};r.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true)};r.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length<2){e.error("Two DataPoint annotation are needed! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path&&this._aDataPointAnnotations[1].Value&&this._aDataPointAnnotations[1].Value.Path)){e.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}this.bindProperties();this._updateAssociations()};r.prototype.bindProperties=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[0].Value.Path),i=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[1].Value.Path);t.bindProperty("value1",{path:this._aDataPointAnnotations[0].Value.Path,type:"sap.ui.model.odata.type.Decimal",events:{change:this._onBindingDataChange.bind(this)}});t.bindProperty("value2",{path:this._aDataPointAnnotations[1].Value.Path,type:"sap.ui.model.odata.type.Decimal",events:{change:this._onBindingDataChange.bind(this)}});t.bindProperty("displayValue1",{path:this._aDataPointAnnotations[0].Value.Path,formatter:a.format.bind(a)});t.bindProperty("displayValue2",{path:this._aDataPointAnnotations[1].Value.Path,formatter:a.format.bind(i)});if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){t.bindProperty("title1",{path:this._aDataPointAnnotations[0].Title.Path})}if(this._aDataPointAnnotations[1].Title&&this._aDataPointAnnotations[1].Title.Path){t.bindProperty("title2",{path:this._aDataPointAnnotations[1].Title.Path})}if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){t.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}};r.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[0].Value.Path);t.setDeltaDisplayValue(a.format(t._getDeltaValue()));this._updateAssociations()};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartHarveyBallMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/suite/ui/microchart/HarveyBallMicroChart","sap/suite/ui/microchart/HarveyBallMicroChartItem","sap/base/Log","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n,s,h){"use strict";var l=o.extend("sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartHarveyBallMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}},associations:{freeText:{type:"sap.m.Label",group:"Misc",multiple:false}}},renderer:h});l._CHART_TYPE=["Pie"];l.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Pie",true);this.setAggregation("_chart",new r,true)};l.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};l.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartHarveyBallMicroChart");return}var t=this.getAggregation("_chart"),a=new n({fraction:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});var i=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.Value.Path);a.bindProperty("fractionLabel",{path:this._oDataPointAnnotations.Value.Path,formatter:i.format.bind(i)});var e=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.MaximumValue.Path);if(this._oDataPointAnnotations.MaximumValue&&this._oDataPointAnnotations.MaximumValue.Path){t.bindProperty("total",{path:this._oDataPointAnnotations.MaximumValue.Path,type:"sap.ui.model.odata.type.Decimal"});t.bindProperty("totalLabel",{path:this._oDataPointAnnotations.MaximumValue.Path,formatter:e.format.bind(e)})}if(this._getAnnotation("unitOfMeasure").Path){t.bindProperty("totalScale",{path:this._getAnnotation("unitOfMeasure").Path});a.bindProperty("fractionScale",{path:this._getAnnotation("unitOfMeasure").Path})}if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("color",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}t.addItem(a);this._updateAssociations()};l.prototype._getSupportedChartTypes=function(){return l._CHART_TYPE};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartLineMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/LineMicroChart","sap/suite/ui/microchart/LineMicroChartLine","sap/suite/ui/microchart/LineMicroChartPoint","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,i,e,a,r,o,n,s,h,c,g,p){"use strict";var u=g.extend("sap.ui.comp.smartmicrochart.SmartLineMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartLineMicroChart.designtime"},renderer:p});u.prototype._CHART_TYPE=["Line"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Line",true);this.setAggregation("_chart",new s({showThresholdLine:false}),true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype.setShowLabel=function(t){var i;if(this.getShowLabel()!==t){i=this.getAggregation("_chart");this.setProperty("showLabel",t,true);i.setProperty("showTopLabels",t,true);i.setProperty("showBottomLabels",t,true);i.invalidate()}return this};u.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartLineMicroChart");return}for(var t=0;t<this._aDataPointAnnotations.length;t++){if(!(this._aDataPointAnnotations[t].Value&&this._aDataPointAnnotations[t].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartLineMicroChart");return}}var i=this.getAggregation("_chart"),e;this._aDataPointAnnotations.forEach(function(t,a){e=new h(this.getId()+"-line-"+a,{points:{path:this._getBindingPath(),factory:this._pointFactory.bind(this),events:{change:this._onBindingDataChange.bind(this)}}});i.addLine(e)},this)};u.prototype._pointFactory=function(t,i){var e,a,r,o=t.split("-").slice(-2,-1),n=this.getAggregation("_chart").getLines()[o],s=this._aDataPointAnnotations[o],h;e=i.getProperty(this._oChartViewMetadata.dimensionFields[o]);e=this._formatDimension.call(this,e);a=i.getProperty(s.Value.Path);a=Number(a);r=new c({x:e,y:a});if(n&&s.Criticality&&s.Criticality.Path){h=this._mapCriticalityTypeWithColor(i.getProperty(s.Criticality.Path));this.getAggregation("_chart").getLines()[o].setColor(h)}return r};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getLines()[0].getBinding("points");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,i){this.getAggregation("_chart").setProperty(t,i.text,true)};u.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/comp/providers/ChartProvider","sap/suite/ui/microchart/library","sap/m/library","sap/ui/core/CustomData","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer"],function(t,e,a,i,r,o,s,n,h){"use strict";var l=r.Size;var c=e.extend("sap.ui.comp.smartmicrochart.SmartMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartMicroChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},freeText:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:h});c.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false};c.prototype.setChartType=function(){return this};c.prototype.getChartType=function(){return this.getAggregation("_chart").getChartType()};c.prototype.propagateProperties=function(){if(e.prototype.propagateProperties){e.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata()};c.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");if(t){if(t.getMetadata().hasProperty("height")){t.setHeight(this.getHeight(),true)}if(t.getMetadata().hasProperty("width")){t.setWidth(this.getWidth(),true)}if(t.getMetadata().hasProperty("size")){t.setSize(this.getSize(),true)}i._passParentContextToChild(this,t);if(t.getMetadata().hasProperty("showLabel")){t.setShowLabel(this.getShowLabel(),true)}if(t.getMetadata().hasAssociation("chartTitle")){t.setAssociation("chartTitle",this.getChartTitle(),true)}if(t.getMetadata().hasAssociation("chartDescription")){t.setAssociation("chartDescription",this.getChartDescription(),true)}if(t.getMetadata().hasAssociation("unitOfMeasure")){t.setAssociation("unitOfMeasure",this.getUnitOfMeasure(),true)}if(t.getMetadata().hasAssociation("freeText")){t.setAssociation("freeText",this.getFreeText(),true)}}};c.prototype.setSize=function(t){if(this.getSize()!==t){if(t===l.Responsive){this.setProperty("isResponsive",true)}else{this.setProperty("isResponsive",false)}this.setProperty("size",t)}return this};c.prototype.setIsResponsive=function(t){var e,a=this.getSize();this.setProperty("isResponsive",t);if(t){e=l.Responsive}else{e=a===l.Responsive?l.Auto:a}this.setProperty("size",e);return this};c.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};c.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};c.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};c.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized()}}};c.prototype._createChartProvider=function(){var t=this.getEntitySet(),e=this.getModel();if(e&&t){this._oChartProvider=new a({entitySet:t,model:e,chartQualifier:this.data("chartQualifier")})}};c.prototype._onMetadataInitialized=function(){var t,e;this._bMetaModelLoadAttached=false;if(!this._bIsInitialized){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._bIsInitialized=true;this._createInnerChart()}else{t=this.data("chartQualifier");e=this._oChartProvider.getChartDataPointMetadata();if(e){e=t?e.additionalAnnotations[t]:e.primaryAnnotation;if(e){this._bIsInitialized=true;this._createInnerChartFromDataPoint(e)}else{n.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}else{n.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}}}};c.prototype._createInnerChartFromDataPoint=function(t){var e=t.Visualization.EnumMember;if(s._isBulletVizualizationType(e)){this._buildSmartBulletMicroChart()}else{n.error("Only Bullet chart can be initialize with just DataPoint annotation. Type: "+e+" is not a Bullet chart type.");return}this.invalidate()};c.prototype._createInnerChart=function(){if(!this._checkChartMetadata()){n.error("Created annotations not valid. Please review the annotations and metadata.");return}var t=this._oChartViewMetadata.chartType;switch(t){case"line":case"area":var e=this._oChartViewMetadata.annotation.ChartType.EnumMember.split("/").pop().toLowerCase();if(e==="area"){this._buildSmartAreaMicroChart()}else if(e==="line"){this._buildSmartLineMicroChart()}else{n.error("Not supported chart type used.");return}break;case"bullet":this._buildSmartBulletMicroChart();break;case"donut":this._buildSmartRadialMicroChart();break;case"stacked_bar":this._buildSmartStackedBarMicroChart();break;case"column":this._buildSmartColumnMicroChart();break;case"pie":this._buildSmartHarveyBallMicroChart();break;default:n.error("Not supported chart type used.");return}this.invalidate()};c.prototype._buildSmartLineMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartLineMicroChart)};c.prototype._buildSmartAreaMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartAreaMicroChart)};c.prototype._buildSmartBulletMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartBulletMicroChart)};c.prototype._buildSmartRadialMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartRadialMicroChart)};c.prototype._buildSmartStackedBarMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartStackedBarMicroChart)};c.prototype._buildSmartColumnMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartColumnMicroChart)};c.prototype._buildSmartHarveyBallMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartHarveyBallMicroChart)};c.prototype._buildSmartMicroChart=function(t){var e=new t({entitySet:this.getEntitySet(),chartBindingPath:this.getChartBindingPath(),initialize:[this._onChartInitialized,this],customData:[new o({key:"chartQualifier",value:this.data("chartQualifier")})]});if(e.getMetadata().hasProperty("enableAutoBinding")){e.setProperty("enableAutoBinding",this.getEnableAutoBinding(),true)}this.setAggregation("_chart",e,true)};c.prototype._onChartInitialized=function(){this.fireInitialize()};c.prototype._checkChartMetadata=function(){if(this._oChartViewMetadata.chartType&&this._oChartViewMetadata.annotation&&this._oChartViewMetadata.annotation.ChartType&&this._oChartViewMetadata.annotation.ChartType.EnumMember&&this._oChartViewMetadata.annotation.ChartType.EnumMember.length>0){return true}else{return false}};c.prototype.getAccessibilityInfo=function(){var t={};var e=this.getAggregation("_chart");if(e&&e.getAccessibilityInfo){t=e.getAccessibilityInfo()}return t};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChartBase", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/m/library","sap/ui/comp/providers/ChartProvider","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/model/BindingMode","sap/ui/model/type/Date","sap/base/Log","sap/ui/core/Control","./SmartMicroChartRenderer"],function(jQuery,t,e,i,a,r,o,n,s,l,h){"use strict";var p=e.ValueColor;var u=e.Size;var c=l.extend("sap.ui.comp.smartmicrochart.SmartMicroChartBase",{metadata:{abstract:true,library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc"},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:h});c._MINIMIZE="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Minimize";c._MAXIMIZE="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Maximize";c._TARGET="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Target";c._DELTABULLET="com.sap.vocabularies.UI.v1.VisualizationType/DeltaBulletChart";c._BULLET="com.sap.vocabularies.UI.v1.VisualizationType/BulletChart";c._CALENDAR_TERMS_PATTERNS={"com.sap.vocabularies.Common.v1.IsCalendarYear":"yyyy","com.sap.vocabularies.Common.v1.IsCalendarQuarter":"Q","com.sap.vocabularies.Common.v1.IsCalendarMonth":"MM","com.sap.vocabularies.Common.v1.IsCalendarWeek":"ww","com.sap.vocabularies.Common.v1.IsCalendarDate":"yyyyMMdd","com.sap.vocabularies.Common.v1.IsCalendarYearMonth":"yyyyMM"};c._ASSOCIATIONS=["chartTitle","chartDescription","unitOfMeasure","freeText"];c._ASSOCIATIONS_ANNOTATIONS_MAP={chartDescription:"Description",chartTitle:"Title",unitOfMeasure:{propertyAnnotationPath:"Value",propertyAnnotationProperties:["ISOCurrency","Unit"]},freeText:{propertyAnnotationPath:"Value",propertyAnnotationProperties:["Label"]}};c._isBulletVizualizationType=function(t){return t===c._BULLET||t===c._DELTABULLET};c.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized.call(this)}}};c.prototype._onMetadataInitialized=function(){this._bMetaModelLoadAttached=false;if(this._bIsInitialized){return}this._createChartProvider.call(this);this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();this._oDataPointMetadata=this._oChartProvider.getChartDataPointMetadata();this._bIsInitialized=true;this.fireInitialize();if(this.getEnableAutoBinding&&this.getEnableAutoBinding()){if(this.getChartBindingPath()){this.bindElement(this.getChartBindingPath())}else{s.error("The property chartBindingPath needs to be set in order for property enableAutoBinding to be applied.")}}if(this._checkChartMetadata.call(this)){this._aDataPointAnnotations=this._getDataPointAnnotations.call(this);this._oDataPointAnnotations=this._aDataPointAnnotations[0];if(this._aDataPointAnnotations.every(this._checkDataPointAnnotation.bind(this))){this._createAndBindInnerChart()}}else{s.error("Created annotations not valid. Please review the annotations and metadata.")}};c.prototype._getDataPointAnnotations=function(){var t=[],e;if(this._oChartViewMetadata&&this._oChartViewMetadata.measureFields){for(var i=0;i<this._oChartViewMetadata.measureFields.length;i++){e=this._getDataPointAnnotation.call(this,this._oChartViewMetadata.measureFields[i]);t.push(e)}}else{e=this._getDataPointAnnotation.call(this);t.push(e)}return t};c.prototype._cleanup=function(){if(this._oDateType){this._oDateType.destroy();this._oDateType=null}};c.prototype._createChartProvider=function(){var t,e;e=this.getEntitySet();t=this.getModel();if(t&&e){this._oChartProvider=new i({entitySet:e,model:t,chartQualifier:this.data("chartQualifier")})}else{s.error("Property entitySet is not set or no model has been attached to the control.")}};c.prototype._checkChartMetadata=function(){if(jQuery.isEmptyObject(this._oChartViewMetadata)){if(jQuery.isEmptyObject(this._oDataPointMetadata)){s.error("DataPoint annotation must be provided if chart annotation is missing.");return false}return true}else{if(!this._oChartViewMetadata.fields||this._oChartViewMetadata.fields.length===0){s.error("No fields exist in the metadata.");return false}if(this._hasMember(this,"_oChartViewMetadata.annotation.ChartType")){return this._checkChartType.call(this)}else if(this.getChartType()==="Comparison"||this.getChartType()==="Delta"){return true}else{s.error("The Chart annotation is invalid.");return false}}};c.prototype._checkChartType=function(){var t=this._getSupportedChartTypes();for(var e=0;e<t.length;e++){if(this._oChartViewMetadata.annotation.ChartType.EnumMember==="com.sap.vocabularies.UI.v1.ChartType/"+t[e]){return true}}s.error('The ChartType property in the Chart annotation is not part of the list of valid types: "'+t.toString()+'".');return false};c.prototype._getDataPointQualifier=function(t){var e;if(!this._oChartViewMetadata&&this._oDataPointMetadata){return this.data("chartQualifier")}if(!this._hasMember(this,"_oChartViewMetadata.annotation.MeasureAttributes.length")||!this._oChartViewMetadata.annotation.MeasureAttributes.length){return""}if(t&&this._oChartViewMetadata.measureAttributes&&this._oChartViewMetadata.measureAttributes[t]){return(this._oChartViewMetadata.measureAttributes[t].dataPoint.match(/\#([^\#]*)$/)||[])[1]||""}e=this._oChartViewMetadata.annotation.MeasureAttributes[0];if(this._hasMember(e,"DataPoint.AnnotationPath")){return(e.DataPoint.AnnotationPath.match(/\#([^\#]*)$/)||[])[1]||""}};c.prototype._getDataPointAnnotation=function(t){var e=this._getDataPointQualifier.call(this,t),i;if(e){i=this._oDataPointMetadata.additionalAnnotations[e]}else{i=this._oDataPointMetadata.primaryAnnotation}return i};c.prototype._checkDataPointAnnotation=function(t){var e=null;if(jQuery.isEmptyObject(t)){s.error("The DataPoint annotation is empty. Please check it!");return false}if(this._hasMember(t,"Visualization.EnumMember")){e=t.Visualization.EnumMember;if(!c._isBulletVizualizationType(e)){s.error("The only support visualization types for micro charts are BulletChart and DeltaBulletChart.");return false}}if(jQuery.isEmptyObject(this._oChartViewMetadata)&&e===null){s.error("If only DataPoint annotation is provided the VisualizationType is expected to be set.");return false}if(this._hasMember(t,"Value.Path")){if(jQuery.isEmptyObject(t.Criticality)){this._checkCriticalityMetadata(t.CriticalityCalculation)}return true}else{s.error("The Value property does not exist in the DataPoint annotation. This property is essential for creating the smart chart.");return false}};c.prototype._checkCriticalityMetadata=function(t){if(jQuery.isEmptyObject(t)){s.warning("The CriticalityCalculation property in DataPoint annotation is not provided.");return false}if(this._hasMember(t,"ImprovementDirection.EnumMember")){var e=t.ImprovementDirection.EnumMember;switch(e){case c._MINIMIZE:return this._checkCriticalityMetadataForMinimize(t);case c._MAXIMIZE:return this._checkCriticalityMetadataForMaximize(t);case c._TARGET:return this._checkCriticalityMetadataForTarget(t);default:s.warning("The improvement direction in DataPoint annotation must be either Minimize, Maximize or Target.")}}else{s.warning("The ImprovementDirection property in DataPoint annotation is not provided.")}return false};c.prototype._checkCriticalityMetadataForMinimize=function(t){if(!this._hasMember(t,"ToleranceRangeHighValue.Path")){s.warning("The ToleranceRangeHighValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeHighValue.Path")){s.warning("The DeviationRangeHighValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}return true};c.prototype._checkCriticalityMetadataForMaximize=function(t){if(!this._hasMember(t,"ToleranceRangeLowValue.Path")){s.warning("The ToleranceRangeLowValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeLowValue.Path")){s.warning("The DeviationRangeLowValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}return true};c.prototype._checkCriticalityMetadataForTarget=function(t){if(!this._hasMember(t,"ToleranceRangeLowValue.Path")){s.warning("The DeviationRangeLowValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"ToleranceRangeHighValue.Path")){s.warning("The ToleranceRangeHighValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeLowValue.Path")){s.warning("The ToleranceRangeLowValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeHighValue.Path")){s.warning("The DeviationRangeHighValue property in DataPoint annotation is missing for Target improvement direction.");return false}return true};c.prototype._mapCriticalityTypeWithColor=function(t){var e;if(!t){return p.Neutral}else{e=t.toString()}e=(e.match(/(?:CriticalityType\/)?([^\/]*)$/)||[])[1]||"";switch(e){case"Negative":case"1":return p.Error;case"Critical":case"2":return p.Critical;case"Positive":case"3":return p.Good;default:return p.Neutral}};c.prototype._getThresholdValues=function(t){var e={},i=this.getBindingContext();for(var a in t){if(t.hasOwnProperty(a)&&a!=="ImprovementDirection"){e[a]=t[a].Path&&i&&i.getProperty(t[a].Path)||t[a].Decimal||0}}return e};c.prototype._getValueColorForMinimize=function(t,e,i){if(t<=e){return this._mapCriticalityTypeWithColor("Positive")}else if(t>e&&t<=i){return this._mapCriticalityTypeWithColor("Critical")}else if(t>i){return this._mapCriticalityTypeWithColor("Negative")}};c.prototype._getValueColorForMaximize=function(t,e,i){if(t>=e){return this._mapCriticalityTypeWithColor("Positive")}else if(t<e&&t>=i){return this._mapCriticalityTypeWithColor("Critical")}else if(t<i){return this._mapCriticalityTypeWithColor("Negative")}};c.prototype._getValueColorForTarget=function(t,e,i,a,r){if(t>=e&&t<=a){return this._mapCriticalityTypeWithColor("Positive")}else if(t>=i&&t<e||t>a&&t<=r){return this._mapCriticalityTypeWithColor("Critical")}else if(t<i||t>r){return this._mapCriticalityTypeWithColor("Negative")}};c.prototype._getValueColor=function(t,e){var i=this._oDataPointAnnotations.CriticalityCalculation,a,r;t=parseFloat(t)||0;if(typeof e==="string"){r=this._mapCriticalityTypeWithColor(e)}else if(i&&typeof t!=="undefined"&&t!==null){a=this._getThresholdValues.call(this,i);r=this._criticalityCalculation(t,i.ImprovementDirection.EnumMember,a)}return r||this._mapCriticalityTypeWithColor()};c.prototype._getTopLabelColor=function(t,e,i){var a=this._aDataPointAnnotations[i].CriticalityCalculation,r=parseFloat(t)||0,o={},n;for(var s in a){if(a.hasOwnProperty(s)&&s!=="ImprovementDirection"){o[s]=e[a[s].Path]}}if(a&&typeof r!=="undefined"&&r!==null){n=this._criticalityCalculation(r,a.ImprovementDirection.EnumMember,o)}return n};c.prototype._criticalityCalculation=function(t,e,i){var a;switch(e){case c._MINIMIZE:a=this._getValueColorForMinimize(t,i.ToleranceRangeHighValue,i.DeviationRangeHighValue);break;case c._MAXIMIZE:a=this._getValueColorForMaximize(t,i.ToleranceRangeLowValue,i.DeviationRangeLowValue);break;case c._TARGET:a=this._getValueColorForTarget(t,i.ToleranceRangeLowValue,i.DeviationRangeLowValue,i.ToleranceRangeHighValue,i.DeviationRangeHighValue);break;default:s.warning("The improvement direction in DataPoint annotation must be either Minimize, Maximize or Target.")}return a};c.prototype._getAnnotation=function(t){var e=c._ASSOCIATIONS_ANNOTATIONS_MAP[t];if(!e){s.warning('No annotation connected to association "'+t+'".');return{}}if(!jQuery.isEmptyObject(this._oChartViewMetadata)&&typeof e==="string"){return this._oChartViewMetadata.annotation[e]}if(!jQuery.isEmptyObject(this._oDataPointAnnotations)&&this._hasMember(e,"propertyAnnotationPath")&&this._hasMember(e,"propertyAnnotationProperties")){var i;if(this._hasMember(this._oDataPointAnnotations,e.propertyAnnotationPath+".Path")){i=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations[e.propertyAnnotationPath].Path)}if(i){return this._getValueFromPropertyAnnotation(i,e.propertyAnnotationProperties)}}return{}};c.prototype._getValueFromPropertyAnnotation=function(t,e){for(var i in t){for(var a=0;a<e.length;a++){if(i.indexOf(e[a])>-1){return t[i]}}}return{}};c.prototype._updateAssociation=function(t,e){var i,a;if(this.getMetadata().hasAssociation(t)){i=sap.ui.getCore().byId(this.getAssociation(t));if(i&&i.getMetadata().hasProperty("text")){a=this._getAnnotation.call(this,t);this._setAssociationText(i,a,e)}}};c.prototype._updateAssociations=function(t){var e=t&&t.getContexts(0,1)[0],i=e&&e.getObject();var a=c._ASSOCIATIONS.length;for(var r=0;r<a;r++){this._updateAssociation.call(this,c._ASSOCIATIONS[r],i)}};c.prototype.updateChartLabels=function(t){var e={value:Infinity},i={value:-Infinity},a={value:Infinity},r={value:-Infinity},o,n,s,l,h;h=t.getContexts();h.forEach(function(t){for(var h=0;h<this._oChartViewMetadata.dimensionFields.length;h++){s=this._oChartViewMetadata.dimensionFields[h];o=t.getProperty(s);l=this._oChartViewMetadata.measureFields[h];n=t.getProperty(l);e=o<e.value?{context:t,value:o,index:h}:e;i=o>i.value?{context:t,value:o,index:h}:i;a=n<a.value?{context:t,value:n,index:h}:a;r=n>r.value?{context:t,value:n,index:h}:r}},this);if(a.context&&e.context&&r.context&&i.context){this._updateTopLabel.call(this,this._getLabelsMap()["leftTop"],a.context.getObject(),a.index);this._updateBottomLabel.call(this,this._getLabelsMap()["leftBottom"],e.context.getObject(),e.index);this._updateTopLabel.call(this,this._getLabelsMap()["rightTop"],r.context.getObject(),r.index);this._updateBottomLabel.call(this,this._getLabelsMap()["rightBottom"],i.context.getObject(),i.index)}};c.prototype._updateTopLabel=function(t,e,i){var a=e[this._aDataPointAnnotations[i].Value.Path],r=this._getTopLabelColor.call(this,a,e,i),o=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[i].Value.Path),n;n=o.format(a);this._updateLabel(t,{text:n,color:r})};c.prototype._updateBottomLabel=function(t,e,i){var a,r,o,n;a=this._oChartViewMetadata.dimensionFields[i];if(a){o=e[a];r=this._getPropertyAnnotation.call(this,this._oChartViewMetadata.dimensionFields[i]);if(r.hasOwnProperty("sap:text")||r.hasOwnProperty("com.sap.vocabularies.Common.v1.Text")){var s=r["sap:text"]||r["com.sap.vocabularies.Common.v1.Text"].Path;n=e[s]}else{n=this._formatBottomLabel.call(this,o,r)}if(n){this._updateLabel(t,{text:n})}}};c.prototype._formatBottomLabel=function(t,e){var i=this._getSemanticsPattern.call(this,e);if(i){return this._formatSemanticsValue.call(this,t,i)}i=this._getCalendarPattern.call(this,e);if(i){return this._formatSemanticsValue.call(this,t,i)}return this._formatDateAndNumberValue.call(this,t)};c.prototype._formatSemanticsValue=function(t,e){if(e){if(!this._oDateType){this._oDateType=new n({style:"short",source:{pattern:e}})}return this._oDateType.formatValue(t,"string")}return null};c.prototype._formatDateAndNumberValue=function(t){if(t instanceof Date){return this._getLabelDateFormatter.call(this).format(t)}else if(!isNaN(t)){return this._getLabelNumberFormatter.call(this,this._oChartViewMetadata.dimensionFields[0]).format(t)}else{return null}};c.prototype._getSemanticsPattern=function(t){if(t.hasOwnProperty("sap:semantics")){switch(t["sap:semantics"]){case"yearmonthday":return"yyyyMMdd";case"yearmonth":return"yyyyMM";case"year":return"yyyy";default:return null}}return null};c.prototype._getCalendarPattern=function(t){for(var e in c._CALENDAR_TERMS_PATTERNS){if(t.hasOwnProperty(e)){return c._CALENDAR_TERMS_PATTERNS[e]}}return null};c.prototype._getLabelNumberFormatter=function(t){var e=this._getPropertyAnnotation.call(this,t).precision||null;return a.getFloatInstance({style:"short",showScale:true,precision:e})};c.prototype._getLabelDateFormatter=function(){return r.getInstance({style:"short"})};c.prototype._setAssociationText=function(t,e,i){if(!e){return}if(e.Path&&i){t.setProperty("text",i[e.Path],false)}else if(e.Path){t.bindProperty("text",{path:e.Path,mode:o.OneWay});t.invalidate()}else if(e.String){if(e.String.indexOf("{")===0){var a=e.String.split(">");t.bindProperty("text",{path:a[1].substr(0,a[1].length-1),model:a[0].substr(1),mode:o.OneWay});t.invalidate()}else{t.setProperty("text",e.String,false)}}};c.prototype._getPropertyAnnotation=function(t){var e,i,a,r;e=this.getModel().getMetaModel();i=this._oChartProvider._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.getEntitySet());a=e.getODataEntityType(i);r=e.getODataProperty(a,t);return r};c.prototype._hasMember=function(t,e){var i=".",a=e.split(i),r=a.shift();return!!t&&(a.length>0?this._hasMember(t[r],a.join(i)):t.hasOwnProperty(r))};c.prototype.getAccessibilityInfo=function(){var t={};var e=this.getAggregation("_chart");if(e&&e.getAccessibilityInfo){t=e.getAccessibilityInfo()}return t};c.prototype._formatDimension=function(t){if(typeof t==="string"){var e=this._getPropertyAnnotation.call(this,this._oChartViewMetadata.dimensionFields[0]),i=this._getSemanticsPattern.call(this,e);if(i){t=r.getInstance({pattern:i}).parse(t)}}if(t instanceof Date){return parseFloat(t.getTime())}else if(!isNaN(t)){return parseFloat(t)}else{this.getAggregation("_chart").enableXIndexing(true);return 0}};c.prototype.exit=function(){this._cleanup.call(this)};c.prototype.setEntitySet=function(t){if(this.getProperty("entitySet")!==t){this.setProperty("entitySet",t,true);this._initializeMetadata.call(this)}return this};c.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};c.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};c.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};c.prototype.setChartType=function(){return this};c.prototype.propagateProperties=function(){if(l.prototype.propagateProperties){l.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata.call(this)};c.prototype._getBindingPath=function(){if(this.getChartBindingPath()){return this.getChartBindingPath()}else if(this.getEntitySet()){return"/"+this.getEntitySet()}else{return""}};c.prototype._getSupportedChartTypes=function(){return this._CHART_TYPE};c.prototype.setSize=function(t){if(this.getSize()!==t){if(t===u.Responsive){this.setProperty("isResponsive",true)}else{this.setProperty("isResponsive",false)}this.setProperty("size",t)}return this};c.prototype.setIsResponsive=function(t){var e,i=this.getSize();this.setProperty("isResponsive",t);if(t){e=u.Responsive}else{e=i===u.Responsive?u.Auto:i}this.setProperty("size",e);return this};c.prototype.setAssociation=function(t,e,i){if(l.prototype.setAssociation){l.prototype.setAssociation.apply(this,arguments)}this._updateAssociation.call(this,t);return this};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChartRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,i){if(i._bIsInitialized){e.openStart("div",i);if(i.getIsResponsive()){e.class("sapSuiteUiSmartMicroChartResponsive")}e.openEnd();e.renderControl(i.getAggregation("_chart"));e.close("div")}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartRadialMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/suite/ui/microchart/RadialMicroChart","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n){"use strict";var s=r.extend("sap.ui.comp.smartmicrochart.SmartRadialMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartRadialMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}},associations:{freeText:{type:"sap.m.Label",group:"Misc",multiple:false}}},renderer:n});s.prototype._CHART_TYPE=["Donut"];s.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Donut",true);this.setAggregation("_chart",new e,true)};s.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);i._passParentContextToChild(this,t)};s.prototype._createAndBindInnerChart=function(){this._bindProperties();this._updateAssociations.call(this)};s.prototype._bindProperties=function(){var t=this.getAggregation("_chart");if(this._oDataPointAnnotations.Value&&!this._oDataPointAnnotations.TargetValue){if(this._hasMember(this._oDataPointAnnotations.Value,"Path")){t.bindProperty("percentage",{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"})}}else if(this._hasMember(this,"_oDataPointAnnotations.TargetValue.Path")&&this._hasMember(this,"_oDataPointAnnotations.Value.Path")){t.bindProperty("total",{path:this._oDataPointAnnotations.TargetValue.Path,type:"sap.ui.model.odata.type.Decimal"});t.bindProperty("fraction",{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"})}t.bindProperty("valueColor",{parts:[this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path||"",this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path||""],formatter:this._getValueColor.bind(this)})};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartStackedBarMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/StackedBarMicroChart","sap/suite/ui/microchart/StackedBarMicroChartBar","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,r,o,n,s,h,c){"use strict";var p=h.extend("sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartStackedBarMicroChart.designtime"},renderer:c});p.prototype._CHART_TYPE=["BarStacked"];p.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","BarStacked",true);this.setAggregation("_chart",new a,true)};p.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};p.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartStackedBarMicroChart");return}var t=this.getAggregation("_chart"),a=new i({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("valueColor",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}var e=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var r=e["com.sap.vocabularies.Common.v1.Text"];if(r&&r.Path){a.bindProperty("displayValue",r.Path)}t.bindAggregation("bars",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}})};p.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("bars");this._updateAssociations(t)};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/Container", ["sap/ui/thirdparty/jquery",".././library","sap/ui/core/Control","sap/ui/comp/smartmultiedit/Field","sap/ui/model/Context","sap/base/Log"],function(jQuery,t,e,i,o,a){"use strict";var n=e.extend("sap.ui.comp.smartmultiedit.Container",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",defaultValue:null},contexts:{type:"sap.ui.model.Context[]",defaultValue:[]}},defaultAggregation:"layout",aggregations:{layout:{type:"sap.ui.comp.smartform.SmartForm",multiple:false}},designTime:"sap/ui/comp/designtime/smartmultiedit/Container.designtime"},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartMultiEditContainer");t.openEnd();if(e._bReadyToRender){t.renderControl(e.getLayout())}t.close("div")}}});n.prototype.init=function(){this._bIsInitialized=false;this._bReadyToRender=false;this._aFields=null;this.attachEvent("modelContextChange",this._initializeMetadata,this)};n.prototype.setEntitySet=function(t){if(t!==this.getProperty("entitySet")){this.setProperty("entitySet",t,true);if(t){this._initializeMetadata()}}return this};n.prototype.setContexts=function(t){if(Array.isArray(t)){for(var e=0;e<t.length;e++){if(!(t[e]instanceof o)){return this}}this.setProperty("contexts",t,true);this._getFields().forEach(function(t){t._updateContextItems()})}else{a.error("Parameter contexts is expected to be an array.")}return this};n.prototype.setLayout=function(t){this.setAggregation("layout",t,true);this._refreshFields();return this};n.prototype.addCustomData=function(t){var i;if(!t){return this}e.prototype.addCustomData.apply(this,arguments);this._getFields().forEach(function(e){i=t.clone();e._oSmartField.addCustomData(i)});return this};n.prototype.insertCustomData=function(t,i){var o;if(!t){return this}e.prototype.insertCustomData.apply(this,arguments);this._getFields().forEach(function(e){o=t.clone();e._oSmartField.addCustomData(o)});return this};n.prototype.removeCustomData=function(t){var i=e.prototype.removeCustomData.apply(this,arguments);if(i){this._getFields().forEach(function(t){t._oSmartField.removeCustomData(i)})}return i};n.prototype.removeAllCustomData=function(){var t=e.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){this._getFields().forEach(function(e){t.forEach(function(t){e._oSmartField.removeCustomData(t)})})}return t};n.prototype.destroyCustomData=function(){e.prototype.destroyCustomData.apply(this,arguments);this._getFields().forEach(function(t){t._oSmartField.destroyCustomData()});return this};n.prototype.getAllUpdatedContexts=function(t){var e=this.getContexts(),i=[],o=this,a=0,n=10;if(e.length===0){return Promise.resolve(i)}return new Promise(function(r){function s(l,u,d){for(a=u;a<Math.min(d,l.length);a++){i.push({context:l[a],data:o._getUpdatedDataObject(l[a].getObject(),t)})}if(a<l.length){setTimeout(s.bind(null,e,a,a+n),0)}else{r(i)}}s(e,a,a+n)})};n.prototype.getErroneousFields=function(){return this._getFields().filter(function(t){t._performValidation();return t.hasClientError()})};n.prototype.getErroneousFieldsAndTokens=function(){var t=this._getFields().map(function(t){return t._performValidation()});return Promise.all(t).then(function(){var t=this._getFields().filter(function(t){return t.hasClientError()});return t}.bind(this))};n.prototype.indexField=function(t){var e;if(!(t instanceof i)){a.error("Container.indexField","Element '"+JSON.stringify(t)+"' must be of type sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container");return}this._aFields.push(t);t._setContainer(this);this.getCustomData().forEach(function(i){if(t.getSmartField()){e=i.clone();t.getSmartField().addCustomData(e)}})};n.prototype._getUpdatedDataObject=function(t,e){var i=e?Object.assign({},t):{},o,n,r,s;this._getFields().forEach(function(e){o=e.getPropertyName();n=e.getUnitOfMeasurePropertyName();s=e.getRawValue();if(s.hasOwnProperty(o)){if(e.isDate()||e.isDateTime()){if(!t[o]){if(s[o]){i[o]=s[o]}}else if(!s[o]){i[o]=null}else if(!t[o].getTime){a.error("Container._getUpdatedDataObject","Field "+o+" has incompatible data and metadata, expected: Date/DateTime, but found "+typeof i[o],"sap.ui.comp.smartmultiedit.Container");return}else if(s[o].getTime()!==t[o].getTime()){i[o]=s[o]}}else{if(s[o]!==t[o]&&(s[o]!==""&&s[o]!=null||t[o]!==""&&t[o]!=null)){i[o]=s[o]}}}if(e.isComposite()&&s.hasOwnProperty(n)&&s[n]!==t[n]){i[n]=s[n]}else if(e.isComboBox()){r=e.getRecordTextPath();if(s.hasOwnProperty(r)&&s[r]!==t[r]){i[r]=s[r]}}});return i};n.prototype.getFields=function(t){return this._getFields(t)};n.prototype._getFields=function(t){var e=[];if((t||!this._aFields||Array.isArray(this._aFields)&&!this._aFields.length)&&this.getLayout()){this._aFields=[];this.getLayout().getGroups().forEach(function(o){o.getGroupElements().forEach(function(o){o.getElements().forEach(function(o){if(o instanceof i){this.indexField(o)}else if(t){e.push(o)}}.bind(this))}.bind(this))}.bind(this))}return e.concat(this._aFields||[])};n.prototype._initializeMetadata=function(){var t=this.getModel();if(!this._bIsInitialized&&this.getEntitySet()&&t&&t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"){if(!this.getBindingContext()){var e=t.createEntry("/"+this.getEntitySet());this.setBindingContext(e);this.getModel().deleteCreatedEntry(e)}t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this))}};n.prototype._onMetadataInitialized=function(){if(this._bIsInitialized){return}this._bIsInitialized=true;this._bReadyToRender=true;this.invalidate()};n.prototype.resetContainer=function(){this._aFields.forEach(function(t){t.resetField()});this.setBindingContext(null);this._bIsInitialized=false};n.prototype._refreshFields=function(){this._aFields=null;this._getFields()};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/Field", ["../library","sap/ui/core/library","sap/ui/core/Control","sap/ui/core/Item","sap/m/Select","sap/ui/comp/smartfield/SmartField","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/ODataControlFactory","sap/ui/model/BindingMode","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/HBox","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/CheckBox","sap/m/Label","sap/m/Input","sap/base/Log","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/ComboBox","sap/ui/comp/smartfield/type/Decimal"],function(t,e,i,o,s,a,r,n,l,u,p,h,d,m,c,_,f,g,y,S,C){"use strict";var I=e.ValueState;var F=n.extend("sap.ui.comp.smartmultiedit.HackedControlFactory");F.prototype.createAttributes=function(t,e,i,o){var s=n.prototype.createAttributes.apply(this,arguments);if(t&&s[t]){s[t].mode=l.OneWay}return s};F.prototype._createEdmUOMAttributes=function(){var t=n.prototype._createEdmUOMAttributes.apply(this,arguments);if(t.value){t.value.mode=l.OneWay}return t};F.prototype._createEdmDateTime=function(){var t=n.prototype._createEdmDateTime.apply(this);t.params.getValue=function(){if(t.control.getDateValue()){return t.params.type.type.parseValue(t.control.getValue(),"string")}else{return null}};return t};F.prototype._createEdmDateTimeOffset=function(){var t=n.prototype._createEdmDateTimeOffset.apply(this);t.params.getValue=function(){if(t.control.getDateValue()){return t.params.type.type.parseValue(t.control.getValue(),"string")}else{return null}};return t};F.prototype._onCreate=function(t,e){var i;if(e&&typeof e.getValue==="function"){i=e.getValue;e.getValue=null}if(n.prototype._onCreate){n.prototype._onCreate.call(this,t,e)}if(i){e.getValue=i}};F.createFromFactory=function(t){if(!t){return null}return new F(t._oModel,t._oParent,t._oMeta)};var T=10;var E=i.extend("sap.ui.comp.smartmultiedit.Field",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmultiedit/Field.designtime",properties:{propertyName:{type:"string",defaultValue:null},useApplyToEmptyOnly:{type:"boolean",defaultValue:false},applyToEmptyOnly:{type:"boolean",defaultValue:false},description:{type:"string",defaultValue:null},validateTokenExistence:{type:"boolean",defaultValue:true}},aggregations:{configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false}},associations:{},events:{change:{parameters:{selectedItem:{type:"sap.ui.core.Item"}}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartMultiEditField");t.openEnd();t.renderControl(e._oSelect);t.openStart("div");t.class("sapUiCompSmartMultiEditFieldSFWrapper");t.openEnd();if(e._oSmartField&&e._oSmartField.aCustomStyleClasses.indexOf("sapUiCompSmartMultiEditSmartField")>=0){t.renderControl(e._oSmartField)}t.close("div");if(e.getDescription()){t.openStart("div");t.class("sapUiCompSmartMultiEditSmartFieldDescription");t.openEnd();e._oDescription.setText(e.getDescription());t.renderControl(e._oDescription);t.close("div")}if(e.getUseApplyToEmptyOnly()){t.renderControl(e._oApplyToEmptyOnlyCheckBox)}t.close("div")}}});E.ACTION_ITEM_KEY={KEEP:"keep",BLANK:"blank",NEW:"new",TRUE:"true",FALSE:"false"};E.prototype.init=function(){this._createSelect();this._createSpecialSelectItems();this._createDescription();this._createApplyToEmptyOnlyCheckBox();this._oContainer=null;this._bNullable=true;this._bShowValueHelp=true;this._bClientError=null;this._oAnnotations=null;this._aDistinctValues=[];this._mRecordKeyTextMap={}};E.prototype.onBeforeRendering=function(){this._updateSpecialSelectItems()};E.prototype.getNullable=function(){return this._bNullable};E.prototype.getShowValueHelp=function(){return this._bShowValueHelp};E.prototype.getLabel=function(){if(this.getParent()&&this.getParent().getLabel){return this.getParent().getLabel()}else{return null}};E.prototype.getSmartField=function(){return this._oSmartField};E.prototype.getValue=function(){return this._oSmartField?this._oSmartField.getValue():null};E.prototype.getDataType=function(){if(!this._oSmartField){return null}try{return this._oSmartField.getDataType()}catch(t){return null}};E.prototype.isComposite=function(){return!!this._oAnnotations.uom};E.prototype.isString=function(){return this.getDataType()==="Edm.String"};E.prototype.isInteger=function(){return this.getDataType()==="Edm.Byte"||this.getDataType()==="Edm.Int16"||this.getDataType()==="Edm.Int32"||this.getDataType()==="Edm.Int64"||this.getDataType()==="Edm.SByte"};E.prototype.isFloat=function(){return this.getDataType()==="Edm.Decimal"||this.getDataType()==="Edm.Double"||this.getDataType()==="Edm.Float"||this.getDataType()==="Edm.Single"};E.prototype.isDate=function(){return this.getDataType()==="Edm.DateTime"};E.prototype.isDateTime=function(){return this.getDataType()==="Edm.DateTimeOffset"};E.prototype.isTime=function(){return this.getDataType()==="Edm.Time"};E.prototype.isBoolean=function(){return this.getDataType()==="Edm.Boolean"};E.prototype.isComboBox=function(){var t=this._getCurrentValueControl();return t&&t.isA("sap.m.ComboBox")||false};E.prototype.getRecordTextPath=function(){if(this._oAnnotations&&this._oAnnotations.text){return this._oAnnotations.text.path}else{return null}};E.prototype.getUnitOfMeasure=function(){return this._oSmartField?this._oSmartField.getUnitOfMeasure():null};E.prototype.getUnitOfMeasurePropertyName=function(){return this._oAnnotations&&this._oAnnotations.uom?this._oAnnotations.uom.path:null};E.prototype.setParent=function(t,e,o){i.prototype.setParent.call(this,t,e,o);if(t&&t.getLabel&&!t.getLabel()){this._oLabel=new r(this.getId()+"-SmartLabel");this._oLabel.onFieldVisibilityChange=function(){};this._oLabel.setLabelFor(this._oSmartField.getId());t.setLabel(this._oLabel);this._oSelect.addAriaLabelledBy(this._oLabel);if(this.getDescription()){this._oSelect.addAriaLabelledBy(this._oDescription)}}return this};E.prototype.addCustomData=function(t){var e;if(!t){return this}i.prototype.addCustomData.apply(this,arguments);e=t.clone();this._oSmartField.addCustomData(e);return this};E.prototype.insertCustomData=function(t,e){var o;if(!t){return this}i.prototype.insertCustomData.apply(this,arguments);o=t.clone();this._oSmartField.addCustomData(o);return this};E.prototype.removeCustomData=function(t){var e=i.prototype.removeCustomData.apply(this,arguments);if(e){this._oSmartField.removeCustomData(e)}return e};E.prototype.removeAllCustomData=function(){var t=i.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){t.forEach(function(t){this._oSmartField.removeCustomData(t)}.bind(this))}return t};E.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);this._oSmartField.destroyCustomData();return this};E.prototype.setPropertyName=function(t){this.setProperty("propertyName",t,true);this._createSmartField();return this};E.prototype.setConfiguration=function(t){var e;this.setAggregation("configuration",t,true);if(this._oSmartField){e=t?t.clone():null;this._oSmartField.setConfiguration(e)}return this};E.prototype.getSelectedItem=function(){return this._oSelect.getSelectedItem()};E.prototype.setSelectedItem=function(t,e){this._handleSelectionChange(t,e);return this};E.prototype.setSelectedIndex=function(t){this.setSelectedItem(this._oSelect.getItems()[t]);return this};E.prototype.exit=function(){this._getKeep().destroy();this._getBlank().destroy();this._getValueHelp().destroy();this._getBoolTrueItem().destroy();this._getBoolFalseItem().destroy()};E.prototype.isBlankSelected=function(){return this._oSelect.getSelectedItem()===this._getBlank()};E.prototype.isKeepExistingSelected=function(){return this._oSelect.getSelectedItem()===this._getKeep()};E.prototype.isValueHelpSelected=function(){return this._oSelect.getSelectedItem()===this._getValueHelp()};E.prototype.getRawValue=function(){var t={},e,i,o,s=this.getSelectedItem(),a=this.getPropertyName();if(s===this._getBoolTrueItem()){e=true}else if(s===this._getBoolFalseItem()){e=false}else if(this.isBlankSelected()){e=null}else if(s===this._getValueHelp()){if(this.isComposite()){i=this.getValue();if(i==null||typeof i==="string"&&!i.trim()){e={value:null}}else{e={value:d.getFloatInstance().parse(i).toString()}}o=this.getUnitOfMeasure();if(o==null||typeof o==="string"&&!o.trim()){e.unit=null}else{e.unit=o}}else if(this.isInteger()&&this.getDataType()!=="Edm.Int64"){e=d.getIntegerInstance().parse(this.getValue())}else if(this.getDataType()==="Edm.Decimal"){e=C.prototype.parseValue(this.getValue(),"string")}else{e=this.getValue()}}else if(s){e=this._mContextItemsData[s.getKey()]}if(!this.isKeepExistingSelected()&&typeof e!=="undefined"){if(this.isComposite()){if(e!=null){t[a]=e.value;t[this.getUnitOfMeasurePropertyName()]=e.unit}else{t[a]=null;t[this.getUnitOfMeasurePropertyName()]=null}}else{t[a]=e;if(this.isComboBox()&&this.getRecordTextPath()){if(e!=null){t[this.getRecordTextPath()]=this._mRecordKeyTextMap[e]}else{t[this.getRecordTextPath()]=null}}}}return t};E.prototype.hasClientError=function(){return this._bClientError};E.prototype._setNullable=function(t){if(t!==this._bNullable){this._bNullable=t;this._updateSpecialSelectItems();this.getLabel().setRequired(true);this._oSelect.setRequired(!t)}return this};E.prototype._setShowValueHelp=function(t){if(t!==this._bShowValueHelp){this._bShowValueHelp=t;this._updateSpecialSelectItems()}return this};E.prototype._isSpecialValueItem=function(t){return t===this._getKeep()||t===this._getBlank()||t===this._getValueHelp()};E.prototype._handleSelectionChangeEvent=function(t){var e=t.getParameter("selectedItem");this._handleSelectionChange(e)};E.prototype._handleSelectionChange=function(t,e){this._oSelect.setSelectedItem(t);if(this.isKeepExistingSelected()||this.isBlankSelected()){this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")}else{this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")}if(e){return}var i=this.isValueHelpSelected();this._oSmartField.setContextEditable(i);this._oSmartField._updateInnerControlsIfRequired();this._oApplyToEmptyOnlyCheckBox.setVisible(i);this._bClientError=null;if(this._isSpecialValueItem(t)){this._setSmartFieldDisplayText(null,null)}else{this._oApplyToEmptyOnlyCheckBox.setVisible(true);if(!this.isBoolean()){this._oSmartField.setContextEditable(true);this._oSmartField._updateInnerControlsIfRequired()}var o=this._mContextItemsData[t.getKey()];if(this.isComposite()){if(this._isCurrencyValue()){this._setSmartFieldDisplayText(this._formatCurrencyValue(d.getFloatInstance().format(o.value),o.unit,true),o.unit)}else{this._setSmartFieldDisplayText(d.getFloatInstance().format(o.value),o.unit)}}else if(this.isBoolean()){this._setSmartFieldDisplayText(t.getText())}else if(this.isDate()){this._setSmartFieldDisplayText(m.getDateInstance().format(o))}else if(this.isDateTime()){this._setSmartFieldDisplayText(m.getDateTimeInstance().format(o))}else if(this.isInteger()){this._setSmartFieldDisplayText(d.getIntegerInstance().format(o))}else if(this.isFloat()){this._setSmartFieldDisplayText(d.getFloatInstance().format(o))}else{this._setSmartFieldDisplayText(o.toString())}if(!this.isBoolean()){this.setSelectedItem(this._getValueHelp(),true)}this._performValidation()}this.fireChange({selectedItem:t});this.invalidate()};E.prototype._extractValueDisplayText=function(t){var e;if(t==null||t==undefined){return null}if(this.isComposite()){if(this._isCurrencyValue()){e=this._formatCurrencyValue(d.getFloatInstance().format(t.value),t.unit)}else{e=d.getFloatInstance().format(t.value)+" "+t.unit}}else if(this.isBoolean()){e=t?this._getBoolTrueItem().getText():this._getBoolFalseItem().getText()}else if(this.isDate()){e=m.getDateInstance().format(t)}else if(this.isDateTime()){e=m.getDateTimeInstance().format(t)}else if(this.isInteger()){e=d.getIntegerInstance().format(t)}else if(this.isFloat()){e=d.getFloatInstance().format(t)}else{e=String(t)}return e};E.prototype._createSelect=function(){this._oSelect=new s(this.getId()+"-select");this._oSelect.setWidth("100%");this._oSelect.attachChange(this._handleSelectionChangeEvent,this);this.addDependent(this._oSelect)};E.prototype._getResourceBundle=function(){if(this._oRb==null){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}return this._oRb};E.prototype._createSpecialSelectItems=function(){var t=new o({key:E.ACTION_ITEM_KEY.KEEP,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_KEEP_TEXT")+" >"});this._getKeep=function(){return t};var e=new o({key:E.ACTION_ITEM_KEY.BLANK,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_BLANK_TEXT")+" >"});this._getBlank=function(){return e};var i=new o({key:E.ACTION_ITEM_KEY.NEW,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_NEW_TEXT")+" >"});this._getValueHelp=function(){return i};var s=new o({key:E.ACTION_ITEM_KEY.TRUE,text:this._getResourceBundle().getText("SMARTFIELD_CB_YES")});this._getBoolTrueItem=function(){return s};var a=new o({key:E.ACTION_ITEM_KEY.FALSE,text:this._getResourceBundle().getText("SMARTFIELD_CB_NO")});this._getBoolFalseItem=function(){return a}};E.prototype._createDescription=function(){if(!this._oDescription){this._oDescription=new _;this.addDependent(this._oDescription)}};E.prototype._createApplyToEmptyOnlyCheckBox=function(){this._oApplyToEmptyOnlyCheckBox=new c(this.getId()+"-ApplyToEmptyOnly");this._oApplyToEmptyOnlyCheckBox.setText(this._getResourceBundle().getText("MULTI_EDIT_APPLY_TO_EMPTY_ONLY"));this._oApplyToEmptyOnlyCheckBox.attachSelect(function(t){this.setApplyToEmptyOnly(t.getSource().getSelected())}.bind(this));this.addDependent(this._oApplyToEmptyOnlyCheckBox)};E.prototype._createSmartField=function(){this._bIsSmartFieldInitialized=false;this._oSmartField=new a({id:this.getId()+"-SmartField",value:{path:this.getPropertyName(),mode:"OneWay"}});this._oSmartField.addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden");this._oSmartField._createFactory=function(){var t=a.prototype._createFactory.apply(this,arguments);return F.createFromFactory(t)};this.addDependent(this._oSmartField);this._oSmartField.setValue=this._handleSmartFieldSetValue;this._pInitialised=new Promise(function(t,e){this._oSmartField.attachInitialise({resolve:t,reject:e},this._handleSmartFieldInitialized,this)}.bind(this));this._oSmartField.attachInnerControlsCreated(this._handleInnerControlsCreation.bind(this),this);if(this.getConfiguration()){this._oSmartField.setConfiguration(this.getConfiguration().clone())}this._oSmartFieldValue=null};E.prototype._getCurrentValueControl=function(){return this._oSmartField?this._oSmartField._oControl[this._oSmartField._oControl.current]:null};E.prototype._setSmartFieldDisplayText=function(t,e){var i,o;this._oSmartFieldValue=t;this._oSmartField.setValue(t);var s=this._getCurrentValueControl();if(s){if(this.isComboBox()){s.setSelectedKey(t)}else if(this.isComposite()&&s.getItems){i=s.getItems()[0];if(i.setValue){i.setValue(t)}else if(i.setText){i.setText(t)}else if(i.setSelectedKey){i.setSelectedKey(t)}i=s.getItems()[1];if(i._oControl.current==="display"){o=i._oControl.display;if(o.setText){o.setText(e)}}else if(i._oControl.current==="edit"){o=i._oControl.edit;if(o.setEnteredValue){o.setEnteredValue(e)}else if(o.setValue){o.setValue(e)}}}else if(s.setText){s.setText(t)}else if(s.setValue){s.setValue(t)}}};E.prototype._getSmartFieldDisplayText=function(){var t=this._oSmartField._oControl.display,e="";if(t){if(this.isComposite()&&t.getItems){if(t.getItems()[0].getText){e+=t.getItems()[0].getText()}var i=t.getItems()[1]._oControl.display;if(i&&i.getText){e+=t.getItems()[1]._oControl.display.getText()}return e}else if(t.isA("sap.m.ComboBox")){return this._mRecordKeyTextMap[t.getSelectedKey()]||""}else if(t.getText){return t.getText()}else{return null}}else{return null}};E.prototype._handleSmartFieldSetValue=function(t){if(t===this.getParent()._oSmartFieldValue){a.prototype.setValue.call(this.getParent()._oSmartField,t)}};E.prototype._setSFUserInteraction=function(){if(this._oSmartField._oControl.edit&&this._oSmartField._oControl.edit._setPreferUserInteraction){this._oSmartField._oControl.edit._setPreferUserInteraction(false)}};E.prototype._handleSmartFieldInitialized=function(t,e){if(this.isTime()){g.error("Field._handleSmartFieldInitialized","Edm.Time data type is not supported, field: '"+this.getPropertyName()+"'","sap.ui.comp.smartmultiedit.Field");return}this._oAnnotations=this._oSmartField._oFactory._oMetaData.annotations;this._bIsSmartFieldInitialized=true;this._oSmartField.setContextEditable(false);this._oSmartField._updateInnerControlsIfRequired();this._updateContextItems();this._setSFUserInteraction();this._oApplyToEmptyOnlyCheckBox.setVisible(false);e.resolve()};E.prototype._handleInnerControlsCreation=function(t){var e;t.mParameters.forEach(function(t){if(t.getParent()&&t.getParent()._oControl){if(t.getParent()._oControl.display===t){if(t.mBindingInfos.text){t.mBindingInfos.text.skipModelUpdate=true}}else if(t.getParent()._oControl.edit===t){if(t.mBindingInfos.value){t.mBindingInfos.value.skipModelUpdate=true;t.setValue(null)}else if(t.mBindingInfos.selected){t.mBindingInfos.selected.skipModelUpdate=true;t.setSelected(false)}}}if(t===this._oSmartField._oControl.display){return}if(t.attachChange){t.attachChange(this._performValidation,this)}if(t.getParent()&&t.getParent().getParent()instanceof a&&t.getParent().getParent()._oControl.edit instanceof h&&this._oAnnotations&&this.isComposite()){var e=t.getParent().getParent()._oControl.edit;var i=e.getItems();i[0].attachChange(this._handleCompositeInputChange,this);if(i[1]&&i[1]._oControl&&i[1]._oControl.edit){i[1]._oControl.edit.attachChange(this._handleCompositeInputChange,this)}}else if(t.getParent()instanceof a&&!(t.getParent().getParent()instanceof h)&&t.getParent()._oControl.edit instanceof f){t.getParent()._oControl.edit.attachChange(this._handleInputChange,this)}}.bind(this));e=this._oSmartField.getMandatory();this._setNullable(!e)};E.prototype._getInnerEdit=function(){return this._oSmartField._oControl.edit};E.prototype._getFirstInnerEdit=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[0]:null};E.prototype._getSecondInnerEdit=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[1]._oControl.edit:null};E.prototype._getSecondInnerDisplay=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[1]._oControl.display:null};E.prototype._performTokenValidation=function(t,e,i){return new Promise(function(o,s){var a=new y(i.getModel());a.getValueListAnnotationLazy(e).then(function(e){var a=e.primaryValueListAnnotation;if(!a){o();return}i.getModel().read("/"+a.valueListEntitySetName,{success:function(e){if(e.results&&e.results.length===0&&t._oControl.edit){var s=i.getNullable()&&i.getValue()==="";t._oControl.edit.setValueState(s?I.None:I.Error);i._bClientError=!s}else if(!i._bClientError){t._oControl.edit.setValueState(I.None);i._bClientError=null}o()},filters:[new u({path:a.keyField,operator:p.EQ,value1:t.getValue()})],error:function(t){s(t)}})})})};E.prototype._fnGetInnerValuesHelper=function(){var t=[this._getFirstInnerEdit().getValue()];var e=this._getSecondInnerEdit();if(e instanceof S){t.push(e.getSelectedKey())}else{if(e){t.push(e.getValue())}else{var i=this._getSecondInnerDisplay();if(i){t.push(i.getText())}}}return t};E.prototype._performValidation=function(){var t=this._oSmartField._oError;t.bComplex=false;t.bFirst=false;t.bSecond=false;var e=this._oSmartField.getInnerControls();if(this.isComposite()&&e.length===2&&e[0].getBinding("value")){var i=e[0].getBinding("value");var o=i.getValue;i.getValue=this._fnGetInnerValuesHelper.bind(this);this._oSmartField.checkValuesValidity({handleSuccess:true}).then(function(){this._bClientError=false}.bind(this)).catch(function(){this._bClientError=true}.bind(this));i.getValue=o}else{this._oSmartField.checkValuesValidity({handleSuccess:true}).then(function(){this._bClientError=false}.bind(this)).catch(function(){this._bClientError=true}.bind(this))}if(this.isKeepExistingSelected()||this.isBlankSelected()){return}if(this.getValidateTokenExistence()){var s=[];if("valuelist"in this._oAnnotations){s.push(this._performTokenValidation(this.getSmartField(),this._oAnnotations.valuelist,this))}if(this.isComposite()&&"valuelistuom"in this._oAnnotations&&this.getSmartField()._oControl.edit){s.push(this._performTokenValidation(this.getSmartField()._oControl.edit.getItems()[1],this._oAnnotations.valuelistuom,this))}return Promise.all(s)}else{return Promise.resolve()}};E.prototype._handleCompositeInputChange=function(t){var e=this._fnGetInnerValuesHelper(),i=e[0],o=e[1]||"",s;if(this._isCurrencyValue()){s=this._formatCurrencyValue(i,o,true)}else{var a=d.getFloatInstance({parseAsString:true}).parse(i);s=d.getFloatInstance().format(a)}if(!this._oSmartField._oError.bFirst&&!this._oSmartField._oError.bSecond){this._setSmartFieldDisplayText(s,o)}};E.prototype._handleInputChange=function(){var t=this._getInnerEdit().getValue();if(!this.isString()){var e=d.getFloatInstance({parseAsString:true}).parse(t);t=d.getFloatInstance().format(e)}if(!this._oSmartField._oError.bFirst){this._setSmartFieldDisplayText(t,this._getInnerEdit().getValue())}};E.prototype._formatCurrencyValue=function(t,e,i){var o=d.getFloatInstance().parse(t),s=d.getCurrencyInstance().format(o,e);if(i){s=s.replace(e,"").trim()}return s};E.prototype._updateSpecialSelectItems=function(){this._oSelect.removeAggregation("items",this._getKeep(),true);this._oSelect.removeAggregation("items",this._getBlank(),true);this._oSelect.removeAggregation("items",this._getValueHelp(),true);this._oSelect.insertAggregation("items",this._getKeep(),0,true);if(this.getShowValueHelp()){this._oSelect.insertAggregation("items",this._getValueHelp(),1,true)}if(this.getNullable()){this._oSelect.insertAggregation("items",this._getBlank(),this.getShowValueHelp()?2:1,true)}this.invalidate()};E.prototype._removeContextItems=function(){this._oSelect.removeAllItems();this._updateSpecialSelectItems()};E.prototype._updateContextItems=function(){var t,e,i,o;if(!this._oContainer||!this.getDataType()||!this._bIsSmartFieldInitialized){return}this._removeContextItems();if(this.isBoolean()){this._oSelect.addAggregation("items",this._getBoolTrueItem(),true);this._oSelect.addAggregation("items",this._getBoolFalseItem(),true);this._setShowValueHelp(false)}this._aDistinctValues=[];this._mContextItemsData={};this._mValueOccurences={};this._oContainer.getContexts().forEach(function(o){t=this.getModel().getObject(o.getPath())[this.getPropertyName()];if(typeof t==="undefined"||t==null||typeof t==="string"&&!t.trim()){return}if(this.isComposite()){e=this.getModel().getObject(o.getPath())[this.getUnitOfMeasurePropertyName()]||"";i={value:t,unit:e};if(this._aDistinctValues.map(JSON.stringify).indexOf(JSON.stringify(i))===-1){this._aDistinctValues.push(i);this._mValueOccurences[i.unit+i.value]={count:1,value:i,context:o}}else{this._mValueOccurences[i.unit+i.value].count++}}else if(this.isDate()||this.isDateTime()){if(this._aDistinctValues.map(Number).indexOf(+t)===-1){this._aDistinctValues.push(t);this._mValueOccurences[t]={count:1,value:t,context:o}}else{this._mValueOccurences[t].count++}}else if(this._aDistinctValues.indexOf(t)===-1){this._aDistinctValues.push(t);this._mValueOccurences[t]={count:1,value:t,context:o}}else{this._mValueOccurences[t].count++}}.bind(this));o=Object.keys(this._mValueOccurences).map(function(t){return[t,this._mValueOccurences[t]]}.bind(this));o.sort(function(t,e){if(e[1].count!==t[1].count){return e[1].count-t[1].count}else if(this.isComposite()){return e[1].value.value-t[1].value.value}else if(this.isInteger()||this.isFloat()){return e[1].value-t[1].value}else if(this.isDate()||this.isDateTime()){return e[1].value.getTime()-t[1].value.getTime()}else if(t[1].value.localeCompare&&e[1].value.localeCompare){return t[1].value.localeCompare(e[1].value)}else{return 0}}.bind(this));o=o.slice(0,T);this._aDistinctValues=[];o.forEach(function(t){this._addInnerSelectItem(t[1].value,t[1].context);this._aDistinctValues.push(t[1].value)}.bind(this));this._setSmartFieldDisplayText(null,null)};E.prototype._addInnerSelectItem=function(t,e){var i,s;if(typeof t==="undefined"||t==null||this.isBoolean()){return}if(this.isComposite()){i=JSON.stringify([t.value,t.unit])}else if(this.isDate()){i=m.getDateInstance().format(t)}else if(this.isDateTime()){i=m.getDateTimeInstance().format(t)}else{i=String(t)}if(this.isComboBox()){var a=this.getRecordTextPath();s=a?e.getObject(a):i;this._mRecordKeyTextMap[i]=s}else{s=this._extractValueDisplayText(t)}this._oSelect.addItem(new o({key:i,text:s}),true);this._mContextItemsData[i]=t};E.prototype._setContainer=function(t){this._oContainer=t;this._oSmartField.setEntitySet(t.getEntitySet());this._oSmartField._forceInitialise();this._updateContextItems()};E.prototype._isCurrencyValue=function(){return this._oAnnotations&&this._oAnnotations.uom&&this._oAnnotations.uom.property.property["sap:semantics"]=="currency-code"};E.prototype.resetField=function(){this._oSelect.setSelectedItem(this._getKeep());this.getSmartField().setValue("");this.getSmartField().setValueStateText("");this.getSmartField().setValueState(I.None);this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")};return E});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/flexibility/changes/AddMultiEditFields", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartmultiedit/Container","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(e,t,n){"use strict";var r={};r.applyChange=function(e,t,r){var i=e.getContent();var o=r.modifier;var a=r.appComponent;var d=i.field.selector;var l=r.view;var f=i.field.id;var p=i.field.index;var s=i.field.propertyName;var u=e.getDependentControl("form",r);var c=u&&o.getFlexDelegate(u);if(!c){if(this._checkChangeContent(i)){var g=i.field.jsType;var v=i.field.entitySet;var m;var h;return Promise.resolve().then(o.createControl.bind(o,"sap.ui.comp.smartform.GroupElement",r.appComponent,r.view,d||f)).then(function(e){m=e;return this._createGroupElementField(o,r.view,m,g,s,v,r.appComponent)}.bind(this)).then(function(e){h=e;return o.insertAggregation(t,"groupElements",m,p,r.view)}).then(function(){var n=this._getContainerFromGroup(t);if(n){n.indexField(h)}e.setRevertData({newFieldSelector:o.getSelector(m,r.appComponent)})}.bind(this))}}return n._addFieldFromDelegate(u,t,d,f,p,s,e,o,l,a)};r.revertChange=function(e,t,n){var r=e.getRevertData(),i=r.newFieldSelector,o=n.modifier;if(i){var a=o.bySelector(i,n.appComponent,n.view);return Promise.resolve().then(o.removeAggregation.bind(o,t,"groupElements",a)).then(function(){o.destroy(a);var i=this._getContainerFromGroup(t);if(i){i._refreshFields()}var d=r.valueHelpSelector;if(d){var l=n.appComponent;var f=n.view;var p=o.bySelector(d,l,f);var s=e.getDependentControl("form",n);return Promise.resolve().then(o.removeAggregation.bind(o,s,"dependents",p)).then(o.destroy.bind(o,p))}}.bind(this)).then(function(){e.resetRevertData()})}else{return Promise.resolve()}};r.completeChangeContent=function(t,n,r){var i=r.appComponent;var o={field:{}};if(n.bindingPath){o.field.propertyName=n.bindingPath}else{throw new Error("oSpecificChangeInfo.bindingPath or bindingPath attribute required")}if(n.newControlId){o.field.selector=e.getSelector(n.newControlId,i)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(n.jsTypes){o.field.jsType=n.jsType}else if(n.bindingPath){o.field.jsType="sap.ui.comp.smartmultiedit.Field"}else{throw new Error("oSpecificChangeInfo.jsTypes or bindingPath attribute required")}if(n.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{o.field.index=n.index}if(n.entitySet){o.field.entitySet=n.entitySet}if(n.relevantContainerId){t.addDependentControl(n.relevantContainerId,"form",r)}t.setContent(o)};r._checkChangeContent=function(e){var t=e,n=false;if(t){n=e.field&&(e.field.selector||e.field.id)&&e.field.jsType&&e.field.propertyName}return t&&n};r._createGroupElementField=function(e,t,n,r,i,o,a){return Promise.resolve().then(e.createControl.bind(e,r,a,t)).then(function(r){e.setProperty(r,"propertyName",i);if(o){e.setProperty(r,"entitySet",o)}return Promise.resolve().then(e.insertAggregation.bind(e,n,"elements",r,0,t,true)).then(function(){return r})})};r._getContainerFromGroup=function(e){if(e&&typeof e.getParent==="function"&&typeof e.getParent().getParent==="function"&&typeof e.getParent().getParent().getParent==="function"){var n=e.getParent().getParent().getParent();if(n instanceof t){return n}}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiinput/SmartMultiInput", ["sap/ui/core/Core","sap/m/library","sap/m/List","sap/m/Popover","sap/m/StandardListItem","sap/m/MultiInput","sap/m/MultiComboBox","sap/m/Select","sap/m/Token","sap/m/Tokenizer","sap/ui/comp/smartfield/SmartField","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/model/BindingMode","sap/ui/comp/odata/ODataType","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/util/FormatUtil","sap/ui/core/format/DateFormat","sap/ui/comp/smartfilterbar/FilterProvider","sap/base/Log","sap/base/util/deepEqual","sap/ui/comp/library","sap/ui/core/library","sap/ui/core/ResizeHandler","sap/m/Link","sap/m/Text","sap/m/FlexBox","sap/m/HBox","sap/base/util/isEmptyObject","sap/base/security/sanitizeHTML","sap/ui/thirdparty/jquery"],function(t,e,i,o,a,n,r,s,h,l,u,p,d,g,_,f,y,c,m,v,T,x,M,b,k,B,I,C,D,S,E,P){"use strict";var R=M.valuehelpdialog.ValueHelpRangeOperation;var F=M.smartfilterbar.DisplayBehaviour;var H=M.smartfield.TextInEditModeSource;var V=b.ValueState;var L=e.PlacementType;var N="-mInput";var w="-mInputTokenizer";var O="-mInputHBox";var A="-mMoreLink";var z=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var W=u.extend("sap.ui.comp.smartmultiinput.SmartMultiInput",{metadata:{library:"sap.ui.comp",properties:{supportRanges:{type:"boolean",defaultValue:false},supportMultiSelect:{type:"boolean",defaultValue:true},enableODataSelect:{type:"boolean",defaultValue:false},requestAtLeastFields:{type:"string",defaultValue:""},textSeparator:{type:"string",defaultValue:null},singleTokenMode:{type:"boolean",defaultValue:false}},aggregations:{_initialTokens:{type:"sap.m.Token",multiple:true,visibility:"hidden"}},events:{beforeCreate:{allowPreventDefault:true,parameters:{oData:{type:"object"},mParameters:{type:"object"}}},beforeRemove:{allowPreventDefault:true,parameters:{mParameters:{type:"object"}}},tokenUpdate:{parameters:{type:{type:"string"},addedTokens:{type:"sap.m.Token[]"},removedTokens:{type:"sap.m.Token[]"}}},selectionChange:{parameters:{changedItem:{type:"sap.ui.core.Item"},selected:{type:"boolean"}}},selectionFinish:{parameters:{selectedItems:{type:"sap.ui.core.Item[]"}}}}},renderer:function(t,e){u.getMetadata().getRenderer().render(t,e);if(e._oEmptyDash){var i=e.getTokens().length>0?false:true;e._oEmptyDash.setVisible(i);if(i&&e._oMoreLink){e._oMoreLink.setVisible(false)}}}});W.prototype.getTokens=function(){if(this._isReadMode()&&this._oTokenizer){return this._oTokenizer.getTokens()}else if(this._oMultiComboBox&&this._oMultiComboBox.getAggregation("tokenizer")){return this._oMultiComboBox.getAggregation("tokenizer").getTokens()}else if(this._oMultiInput){return this._oMultiInput.getTokens()}return[]};W.prototype.getValue=function(){return this.getTokens()};W.prototype._createMultiInput=function(){var t=this._createAttributes(),e;if(this._oMultiComboBox){this._oMultiComboBox.destroy();this._oMultiComboBox=null}if(this.getSingleTokenMode()&&!this.getBindingContext()){t["maxTokens"]=1}this._oMultiInput=new n(this.getId()+N,t);this._oMultiInput.attachChange(function(t){this._validateValueOnChange(t.getParameter("value"))},this);if(this.getBindingContext()){this._bindMultiInput()}else{e=this.getAggregation("_initialTokens")||[];e.forEach(function(t){this._oMultiInput.addToken(t)}.bind(this))}this._oMultiInput.attachTokenUpdate(function(t){this._validateValueOnChange(this._oMultiInput.getValue());var e=t.getParameters();delete e.id;if(this.getBinding("value").getBindingMode()!=="TwoWay"||!this.getBindingContext()){if(t.getParameter("removedTokens")){t.getParameter("removedTokens").forEach(function(t){t.destroy()})}}this.fireTokenUpdate(e)},this);var i={control:this._oMultiInput,onCreate:"_onMultiInputCreate",params:{type:{type:this._getType(),property:this._oFactory._oMetaData.property}}};this._initMultiInputValueHelp(i);return i};W.prototype._createMultiComboBox=function(){var t=this._createAttributes();if(this.getSingleTokenMode()&&!this.getBindingContext()){t["width"]="100%";delete t["placeholder"]}this._oMultiComboBox=this.getSingleTokenMode()&&!this.getBindingContext()?new s(this.getId()+"mComboBox",t):new r(this.getId()+"mComboBox",t);if(this.getBindingContext()){this._bindMultiComboBox()}else{this._oMultiInput=this._oMultiComboBox._oTokenizer}if(!this.getSingleTokenMode()){this._oMultiComboBox.attachSelectionChange(function(t){var e=t.getParameters();delete e.id;this.fireSelectionChange(e)},this);this._oMultiComboBox.attachSelectionFinish(function(t){var e=t.getParameters();delete e.id;this.oLocalContext=[];this.fireSelectionFinish(e)},this)}else if(this.getSingleTokenMode()&&!this.getBindingContext()){this._oMultiComboBox.attachChange(function(t){var e=t.getParameters();delete e.id;this.fireSelectionChange(e)},this)}var e={control:this._oMultiComboBox,onCreate:"_onCreate",params:{type:{type:this._getType(),property:this._oFactory._oMetaData.property},valuehelp:{annotation:this._getValueListAnnotation(),aggregation:"items",noDialog:true,noTypeAhead:true}}};return e};W.prototype._createAttributes=function(){var t={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var e=this._oFactory.createAttributes(null,this._oFactory._oMetaData.property,t,{event:"change",parameter:"value"});return e};function K(t){var e=t.getParameter("tokens"),i,o,a=0,r=[],s=null,h;this._onCancel();if(this.oControl instanceof n){this.oControl.setValue("");var l=this.oControl.getTokens();var u=[];var p=[];var d=[];l.forEach(function(t){var i=e.some(function(e){return t.getKey()===e.getKey()});if(!i){p.push(t)}else{var o=e.filter(function(e){return t.getKey()===e.getKey()})[0];if(!this.oControl.getBindingContext()&&this.bSupportRanges&&o.getKey().startsWith("range_")){d.push(o)}else{t.setText(o.getText());d.push(t)}}}.bind(this));e.forEach(function(t){var e=l.some(function(e){return e.getKey()===t.getKey()});if(!e){u.push(t);d.push(t)}});this.oControl.setTokens(d);var g=this.oControl.getParent();if(g&&g.getBindingContext()&&g.getBinding("value").getBindingMode()==="TwoWay"){var _=g._getModel(),f=g._getEntitySetName(),y=_._resolveGroup(f),c=_.getDeferredGroups().indexOf(y.groupId)>=0||_.getDeferredBatchGroups().indexOf(y.groupId)>=0;if(!c&&(p.length||u.length)&&d.length){g.setBusyIndicatorDelay(g.getBusyIndicatorDelay());g.setBusy(true)}}this.oControl.fireTokenUpdate({type:"tokensChanged",removedTokens:p,addedTokens:u});a=e.length;while(a--){s=e[a].data("row");if(s){r.push(s)}}}else{if(e[0]){if(this.bIsSingleIntervalRange){i=e[0].data("range");if(i){if(this._sType==="datetime"){h=m.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));if(typeof i.value1==="string"){i.value1=new Date(i.value1)}if(i.operation==="BT"){if(typeof i.value2==="string"){i.value2=new Date(i.value2)}o=h.format(i.value1)+"-"+h.format(i.value2)}else{o=h.format(i.value1)}}else{if(i.operation==="BT"){o=i.value1+"-"+i.value2}else{o=i.value1}}}}else{o=e[0].getKey()}s=e[0].data("row");if(s){r.push(s)}}this.oControl.setValue(o);this.oControl.fireChange({value:o,validated:true})}this._calculateAndSetFilterOutputData(r)}function G(t){var e,i,o,a={};if(t&&this.mOutParams){for(e in this.mOutParams){if(e){i=this.mOutParams[e];if(i!==this.sKey){o=t[i];a[e]=o}}}if(a&&!S(a)){this.fireEvent("valueListChanged",{changes:a})}}}function U(t,e){var i=document.createElement("span");i.style.whiteSpace="nowrap";i.style.maxWidth="fit-content";i.innerHTML=t;i.className="sapMText";e.appendChild(i);var o=e.childNodes;var a=o[o.length-1].offsetWidth;e.removeChild(e.childNodes[o.length-1]);return a}W.prototype._initMultiInputValueHelp=function(t){var e=this._getFilterType(this._oFactory._oMetaData.property.property),i={},o=this._getDateFormatSettings(),a;this._oFactory._getValueHelpDialogTitle(i);if(this._getValueListAnnotation()){t.params.valuehelp={annotation:this._getValueListAnnotation(),aggregation:"suggestionRows",noDialog:false,noTypeAhead:false,supportMultiSelect:this.getSingleTokenMode()?false:this.getSupportMultiSelect(),supportRanges:this.getBindingContext()?false:this.getSupportRanges(),type:e,displayBehaviour:this._getDisplayBehaviour()}}else if(this.getSupportRanges()&&!this.getBindingContext()){a=new y({fieldName:this._getPropertyName(),preventInitialDataFetchInValueHelpDialog:true,model:this.getModel(),control:this._oMultiInput,title:i.dialogtitle,supportMultiSelect:this.getSingleTokenMode()?false:this.getSupportMultiSelect(),supportRanges:true,type:e,dateFormatSettings:o,isUnrestrictedFilter:this._isTimeType(e),displayBehaviour:this._getDisplayBehaviour()});a._onOK=K;a._calculateAndSetODataModelOutputData=G;this._oMultiInput.addValidator(this._validateToken.bind(this))}else{this._oMultiInput.setShowValueHelp(false);this._oMultiInput.addValidator(this._validateToken.bind(this))}};W.prototype._bindMultiInput=function(){var t=this.getBinding("value").getBindingMode();switch(t){case _.OneTime:this._bindMultiInputOneTime();break;case _.OneWay:this._bindMultiInputOneWay();break;case _.TwoWay:default:this._bindMultiInputTwoWay()}};W.prototype._bindMultiInputOneTime=function(){var t=this;this._readNavigationPropertySet().then(function(e){e.results.forEach(function(e){var i=e[t._getPropertyName()];var o=t._getDescriptionFieldName();var a=o?e[o]:"";t._oMultiInput.addToken(t._createToken(i,a))})})};W.prototype._bindMultiInputOneWay=function(){this._bindMultiInputTokens(this._oMultiInput)};W.prototype._bindMultiInputTwoWay=function(){this._bindMultiInputTokens(this._oMultiInput);this._oMultiInput.attachTokenUpdate(function(t){t.getParameter("addedTokens").forEach(this._addToken.bind(this));t.getParameter("removedTokens").forEach(this._removeToken.bind(this))},this)};W.prototype._bindMultiInputTokens=function(t){var e=this._getNavigationPath(),i=this._getSelectExpandParameter();if(!S(i)){t.bindAggregation("tokens",{path:e,parameters:i,factory:this._tokensFactory.bind(this),events:{aggregatedDataStateChange:this._processDataState.bind(this)}})}else{t.bindAggregation("tokens",{path:e,factory:this._tokensFactory.bind(this),events:{aggregatedDataStateChange:this._processDataState.bind(this)}})}};W.prototype._processDataState=function(e){var i=e.getParameter("dataState"),o=this.getBinding("value");if(!i||!i.getChanges().messages){return}if(o&&o.bIsBeingDestroyed){return}var a=i.getMessages();if(a.length){var n=false;var r=a[0];a.forEach(function(t){if(t.getControlIds().indexOf(this.getId())==-1){t.addControlId(this.getId());n=true}}.bind(this));this.setValueState(r.getType());this.setValueStateText(r.getMessage());if(n){t.getMessageManager().getMessageModel().checkUpdate(false,true)}}else{this.setValueState(V.None);this.setValueStateText("")}};W.prototype._getSelectExpandParameter=function(){var t={};if(this.getEnableODataSelect()){t.select=this._addODataSelectParameters()}if(this._oFactory._oMetaData.annotations.text&&this._oFactory._oMetaData.annotations.text.navigationPathHelp){t.expand=this._oFactory._oMetaData.annotations.text.navigationPathHelp}return t};W.prototype._addODataSelectParameters=function(t){var e=this._getPropertyName();if(this._getDescriptionFieldName()){e=e+","+this._getDescriptionFieldName()}if(this.getRequestAtLeastFields()){e=e+","+this.getRequestAtLeastFields()}return e};W.prototype._calculateFieldGroupMetaData=function(){var t,e,i,o;if(this._oFactory._oMeta){e=this._oFactory._oMeta.entitySet;i=this.getModel().getMetaModel().getODataEntitySet(e);o=this.getModel().getMetaModel().getODataEntityType(i.entityType);t={entitySet:i,entityType:o,path:this._getNavigationPath()}}return t};W.prototype._bindMultiComboBox=function(){var t=this.getBinding("value").getBindingMode();switch(t){case _.OneTime:this._bindMultiComboBoxOneTime();break;case _.OneWay:this._bindMultiComboBoxOneWay();break;case _.TwoWay:default:this._bindMultiComboBoxTwoWay()}};W.prototype._bindMultiComboBoxOneTime=function(){var t=this;this._readNavigationPropertySet().then(function(e){var i=e.results.map(function(e){return e[t._getPropertyName()]});t._oMultiComboBox.setSelectedKeys(i)})};W.prototype._bindMultiComboBoxOneWay=function(){this._createAndAttachHelperMultiInput()};W.prototype._bindMultiComboBoxTwoWay=function(){this._createAndAttachHelperMultiInput();this.oLocalContext=[];this._oMultiComboBox.attachSelectionChange(function(t){var e=t.getParameter("selected"),i=t.getParameter("changedItem"),o={},a,n,r;this.setValueState(V.None);this.setValueStateText("");if(e){o[this._getPropertyName()]=i.getKey();r=i.getBindingContext("list")||i.getBindingContext();a=r.getProperty();this._getEntityType().key.propertyRef.forEach(function(t){if(a&&a[t.name]){o[t.name]=a[t.name]}})}else{n=this._oMultiInput.getTokens().filter(function(t){return t.getKey()===i.getKey()})[0]}if(e){this.oLocalContext.push(this._createEntity(o))}else{if(n){this._removeEntity(n.getBindingContext())}else{this.oLocalContext.forEach(function(t,e){if(t.getProperty(this._getPropertyName())===i.getKey()){this._getModel().deleteCreatedEntry(t);this.oLocalContext.splice(e,1)}}.bind(this))}}},this)};W.prototype._readNavigationPropertySet=function(){var t=this;return new Promise(function(e,i){var o=t.getBindingContext(),a=t._getModel(),n=t._getNavigationPath();a.read(n,{context:o,success:function(t){e(t)},error:function(e){t.setValueState(V.Error);t.setValueStateText(e.responseText);i(e)}})})};W.prototype._createAndAttachHelperMultiInput=function(){this._oMultiInput=new n({maxTokens:this.getSingleTokenMode()?1:undefined});this._oMultiInput.setBindingContext(this.getBindingContext());this._oMultiInput.setModel(this._getModel());this._bindMultiInputTokens(this._oMultiInput);var t=this._oMultiInput.getBinding("tokens");function e(){var t=this._oMultiInput.getTokens().map(function(t){return t.getKey()});if(this._oMultiComboBox){var e=this.getBinding("value").getBindingMode();if(e==_.TwoWay){var i=this._oFactory.getValueListProvider();if(i&&i.bInitialised){i._calculateFilterInputData();if(i._mLastFilterInputData&&!x(i._mLastFilterInputData,i.mFilterInputData)){i._filterDropdownRowsByInParameters()}}this._oMultiComboBox.setSelectedKeys(t)}else{this._oMultiComboBox.setSelectedKeys(t)}}}e.call(this);t.attachChange(e,this)};W.prototype._getReadTokenList=function(){if(!this.oReadTokenList){this.oReadTokenList=new i;this.addDependent(this.oReadTokenList)}return this.oReadTokenList};W.prototype._getReadTokenListPopover=function(){if(!this.oReadTokenListPopover){this.oReadTokenListPopover=new o({showArrow:true,placement:L.Auto,showHeader:false,contentMinWidth:"auto",content:[this.oReadTokenList]});this.addDependent(this.oReadTokenListPopover)}return this.oReadTokenListPopover};W.prototype._handleNMoreIndicatorPress=function(){var t=this.getTokens();if(!t){return}var e=this._getReadTokenList();var i=this._getReadTokenListPopover();e.removeAllItems();for(var o=0,n=t.length;o<n;o++){var r=t[o],s=new a({title:r.getText()});e.addItem(s)}if(this._oMoreLink.getDomRef()){i.openBy(this._oMoreLink.getDomRef())}};W.prototype._onResize=function(){if(this._isReadMode()&&this._oTokenizer){this._deregisterResizeHandler();this._oTokenizer.setMaxWidth(this.$().width()+"px");this._oTokenizer.setRenderMode("Narrow");this._oTokenizer.scrollToEnd();if(this.getMode()==="display"&&this.getTokens().length>0){this._onDisplayResize()}this._registerResizeHandler()}};W.prototype._onDisplayResize=function(){if(this.getDomRef()&&this.getDomRef().offsetWidth>0){var t=this.getDomRef().clientWidth,e=this._iHiddenLabelsCount?U("999 "+z.getText("POPOVER_DEFINE_MORE_LINKS"),this.getDomRef()):0,i=!this._iHBoxWidth||this._iHBoxWidth+e>t,o=this._iHiddenLabelsCount>0&&this._iHBoxWidth+e+this._iFirstHiddenTokenLength<t;if(i||o){this._oHBox.removeAllItems();this.getTokens().forEach(function(t){this._oHBox.addItem(this._generateDisplayText(t.getText()))}.bind(this))}}};W.prototype.onBeforeRendering=function(){if(u.prototype.onBeforeRendering){u.prototype.onBeforeRendering.apply(this,arguments)}this._deregisterResizeHandler()};W.prototype.onAfterRendering=function(){if(u.prototype.onAfterRendering){u.prototype.onAfterRendering.apply(this,arguments)}if(this.getMode()==="display"&&this.bControlNotRendered){this._oHBox.removeAllItems();this._oMoreLink.setVisible(false);this.getTokens().forEach(function(t){var e=this._generateDisplayText(t.getText());this._oHBox.addItem(e)},this)}if(this._oMultiComboBox&&this._oMultiInput&&this._oMultiInput.getBindingContext()&&this.getBindingContext()){var t=this.getBindingContext().getPath();var e=this._oMultiInput.getBindingContext().getPath();if(e!==t){this._oMultiInput.setBindingContext(this.getBindingContext())}}this._registerResizeHandler()};W.prototype._registerResizeHandler=function(){if(!this._iResizeHandlerId){this._iResizeHandlerId=k.register(this,this._onResize.bind(this))}};W.prototype._deregisterResizeHandler=function(){if(this._iResizeHandlerId){k.deregister(this._iResizeHandlerId);this._iResizeHandlerId=null}};W.prototype._createTokenizer=function(){this._oTokenizer=new l(this.getId()+w,{editable:false,visible:false,width:"100%"});this._oHBox=new D(this.getId()+O);this._oMoreLink=new B(this.getId()+A,{press:this._handleNMoreIndicatorPress.bind(this),ariaLabelledBy:this.getId()+"-label"});this._oEmptyDash=new I({text:"",visible:true});var t=this._getNavigationPath(),e=this._getSelectExpandParameter();if(this.getBindingContext()){this._bindMultiInputTokens(this._oTokenizer);this._oHBox.bindAggregation("items",{path:t,parameters:e,factory:this._textFactory.bind(this)})}else{this.attachInnerControlsCreated(this._mirrorTokensToDisplayTokenizer,this)}var i=new C({height:"100%",items:[this._oEmptyDash,this._oHBox,this._oMoreLink,this._oTokenizer]});return{control:i,onCreate:"_onCreate"}};W.prototype._textFactory=function(t,e){var i=e.getProperty(this._getPropertyName()),o=i instanceof Date?this._formatValue(i):i.toString(),a=this._getDescriptionFieldName(),n=a?e.getProperty(a):"",r=this._getFormattedText(o,n),s;if(this.getDomRef()&&this.getDomRef().offsetWidth){this.bControlNotRendered=false;s=this._generateDisplayText(r)}else{this.bControlNotRendered=true;s=new I({text:r})}if(this._oEmptyDash){this._oEmptyDash.setVisible(false)}return s};W.prototype._generateDisplayText=function(t){var e=this.getDomRef(),i=e.offsetWidth,o=U("999 "+z.getText("POPOVER_DEFINE_MORE_LINKS"),e),a=new I,n,r,s;t=E(t);if(this._oHBox.getItems().length===0){this._iHBoxWidth=0;this._iHiddenLabelsCount=0;this._iFirstHiddenTokenLength=0}this._oHBox.getItems().filter(function(t){return!t.getVisible()}).forEach(function(t){this._oHBox.removeItem(t)}.bind(this));a.setTooltip(t);t=this._iHBoxWidth===0?t:""+this.getTextSeparator()+""+t;a.setText(t);var h=U(t,e);this._iHBoxWidth+=h;if(this._iHiddenLabelsCount===0&&this._iHBoxWidth<=i){this._oMoreLink.setVisible(false)}else{while(this._iHBoxWidth&&this._iHBoxWidth>i-o){this._iHiddenLabelsCount+=1;if(this._oHBox.getItems()[0]){this._iFirstHiddenTokenLength=U(this._oHBox.getItems()[0].getText(),e);this._iHBoxWidth-=this._iFirstHiddenTokenLength;this._oHBox.removeItem(0)}else{this._iHBoxWidth-=h;a.setVisible(false)}}if(this._oHBox.getItems().length===0&&this._iHiddenLabelsCount===1&&!a.getVisible()){this._iHiddenLabelsCount=0;this._iHBoxWidth+=h;a.setVisible(true);this._oMoreLink.setVisible(false)}else{if(this._oHBox.getItems().length>0){n=this._oHBox.getItems()[0];n.setText(n.getTooltip());if(this._oHBox.getItems().length-1>0){r=this._oHBox.getItems()[this._oHBox.getItems().length-1];s=""+this.getTextSeparator()+""+r.getTooltip();r.setText(s)}a.setText(a.getText()+""+this.getTextSeparator()+"")}else{a.setText(a.getTooltip()+""+this.getTextSeparator()+"")}this._oMoreLink.setVisible(true);this._oMoreLink.setText(this._iHiddenLabelsCount+" "+z.getText("POPOVER_DEFINE_MORE_LINKS"))}}return a};W.prototype._mirrorTokensToDisplayTokenizer=function(){if(this.getMode()==="display"){var t=this._oMultiInput&&this._oMultiInput.getTokens();this._oTokenizer.removeAllTokens();this._oHBox.removeAllItems();this._oMoreLink.setVisible(false);if(!t){t=this.getAggregation("_initialTokens")||[]}t.forEach(function(t){var e=new h({text:t.getText(),key:t.getKey()});this._oTokenizer.addToken(e);var i=this._generateDisplayText(t.getText());this._oHBox.addItem(i)},this)}};W.prototype.getTextSeparator=function(){var t=this.getProperty("textSeparator");if(t){return t}return z.getText("SMARTMULTIINPUT_SEPARATOR")};W.prototype._tokensFactory=function(t,e){var i;this.setBusy(false);if(this._oFactory){var o=e.getProperty(this._getPropertyName());var a=o instanceof Date?this._formatValue(o):o.toString();var n=this._getDescriptionFieldName();var r=n?e.getProperty(n):"";i=this._createToken(a,r,e)}else{i=new h}return i};W.prototype._createToken=function(t,e,i){var o=this._getFormattedText(t,e);var a;a=new h;a.setKey(t);a.setText(o);return a};W.prototype._addToken=function(t){var e={},i,o,a,n=t.data("row"),r=t.data("range");e[this._getPropertyName()]=t.getKey();if(n){this._getEntityType().key.propertyRef.forEach(function(t){if(n[t.name]){e[t.name]=n[t.name]}});if(this._oFactory._aProviders&&this._oFactory._aProviders[0].mOutParams){var s=this._oFactory._aProviders[0].mOutParams;for(o in s){if(o&&o!==this._getPropertyName()){a=s[o];e[o]=n[a]}}}}if(r){e["range"]=r}this.setValueState(V.None);this.setValueStateText("");i=this._createEntity(e);t.setBindingContext(i)};W.prototype._createEntity=function(t){var e=this._getModel(),i=this._getEntitySetName(),o=e._resolveGroup(i),a=this._getNavigationPath(),n=this.fireBeforeCreate({oData:t,mParameters:o});o.refreshAfterChange=true;o.context=this.getBindingContext();if(n){o.properties=t;var r=e.createEntry(a,o);return r}};W.prototype._removeToken=function(t){this._removeEntity(t.getBindingContext());t.destroy()};W.prototype._removeEntity=function(t){var e=this._getModel(),i=this._getEntitySetName(),o=e._resolveGroup(i),a=this.fireBeforeRemove({mParameters:o});var n=e.getDeferredGroups().indexOf(o.groupId)>=0||e.getDeferredBatchGroups().indexOf(o.groupId)>=0;if(n&&this._entityHasPendingCreateChange(e,t)){e.deleteCreatedEntry(t);a=false}o.refreshAfterChange=true;o.context=t;if(a){var r="";e.remove(r,o)}};W.prototype._entityHasPendingCreateChange=function(t,e){var i=t.getPendingChanges();var o=t.getKey(e);return!!i[o]&&x(i[o],e.getObject())};W.prototype._getEntityKeyProperties=function(t){var e=this._getModel(),i=e.oMetadata._getEntityTypeByPath(t.getPath()),o={};i.key.propertyRef.forEach(function(e){var i=e.name;o[i]=t.getProperty(i)});return o};W.prototype.checkClientError=function(){if(this.getMode()==="display"){return false}return!this._validateMultiInput()};W.prototype.getRangeData=function(){var t=this.getTokens(),e=[];t.forEach(function(t){var i;if(t.data("range")){i=t.data("range")}else{i=this._getDefaultTokenRangeData(t)}e.push(i)},this);return e};W.prototype.setRangeData=function(t){if(!this.getBindingContext()){var e=Array.isArray(t)?t:[t];if(!this._oMultiInput){var i=this.getEditable(),o=this.getEnabled(),a=this.getContextEditable();this.setEditable(true);this.setEnabled(true);this.setContextEditable(true);this._updateInnerControlsIfRequired();this.setEditable(i);this.setEnabled(o);this.setContextEditable(a);this._updateInnerControlsIfRequired()}this._oMultiInput.removeAllTokens();e.forEach(function(t){var e=this._getTokenTextFromRangeData(t);var i=new h({text:e,key:e});i.data("range",t);this._oMultiInput.addToken(i)},this);this._mirrorTokensToDisplayTokenizer()}else{T.warning("setRangeData can only be used without property binding")}};W.prototype._getTokenTextFromRangeData=function(t){var e="";switch(t.operation){case R.EQ:e="="+t.value1;break;case R.GT:e=">"+t.value1;break;case R.GE:e=">="+t.value1;break;case R.LT:e="<"+t.value1;break;case R.LE:e="<="+t.value1;break;case R.Contains:e="*"+t.value1+"*";break;case R.StartsWith:e=t.value1+"*";break;case R.EndsWith:e="*"+t.value1;break;case R.BT:e=t.value1+"...";if(t.value2){e+=t.value2}break;default:e=""}if(t.exclude&&e!==""){e="!("+e+")"}return e};W.prototype._getComputedTextInEditModeSource=function(){var t=this.getTextInEditModeSource();if(this.isPropertyInitial("textInEditModeSource")&&this.getMode()==="edit"){t=H.None}return t};W.prototype.getFilter=function(){var t=[this._getPropertyName()],e={},i=this.getRangeData(),o;e[this._getPropertyName()]={ranges:i,items:[]};o=v.generateFilters(t,e);return o&&o.length===1&&o[0]};W.prototype._getDefaultTokenRangeData=function(t){var e={exclude:false,operation:R.EQ,value1:this._parseValue(t.getKey()),value2:"",keyField:this._getPropertyName()};return e};W.prototype._validateToken=function(t){var e=t.text;var i=this._validateValue(e);if(i){var o=new h({key:e,text:e});if(this.getSupportRanges()){var a=this._getDefaultTokenRangeData(o);o.data("range",a);o.setText("="+e)}return o}};W.prototype._validateMultiInput=function(){if(this._oMultiInput.getValueState()!==V.None){return false}if(this.getRequired()&&this.getTokens().length===0){this.setValueStateText(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("VALUEHELPVALDLG_FIELDMESSAGE"));this.setValueState(V.Error);return false}else{this.setValueState(V.None);this.setValueStateText("");return true}};W.prototype._validateValueOnChange=function(t){if(t===""){this.setValueState(V.None);this.setValueStateText("");this._validateMultiInput()}else{this._validateValue(t)}};W.prototype._parseValue=function(t){return this._getType().parseValue(t,"string")};W.prototype._formatValue=function(t){return this._getType().formatValue(t,"string")};W.prototype._validateValue=function(t){try{var e=this._parseValue(t);this._getType().validateValue(e);this.setValueState(V.None);this.setValueStateText("");return true}catch(e){this.setValueState(V.Error);this.setValueStateText(e.message);var i={element:this._oMultiInput,property:"value",type:this._getType(),newValue:t,oldValue:null,exception:e,message:e.message};if(e instanceof d){this.fireParseError(i)}else if(e instanceof g){this.fireValidationError(i)}return false}};W.prototype._getModel=function(){if(this._oFactory){return this._oFactory._oModel}};W.prototype._getDateFormatSettings=function(){var t=this.data("dateFormatSettings");if(typeof t==="string"){try{t=JSON.parse(t)}catch(t){}}return t};W.prototype._getNavigationPath=function(){return this._oFactory._oMetaData.navigationPath};W.prototype._getDescriptionFieldName=function(){var t=this._oFactory._oMetaData.annotations.text;if(t){if(t.navigationPathHelp){return t.navigationPathHelp+"/"+t.property.property.name}return t.property.property.name}};W.prototype._getType=function(){if(!this._oType){var t;if(this._isEdmTimeType()){t=this._getDateFormatSettings()}this._oType=this._oFactory._oTypes.getType(this._oFactory._oMetaData.property,t)}return this._oType};W.prototype._isEdmTimeType=function(){var t=["Edm.DateTime","Edm.DateTimeOffset","Edm.Time"];return t.indexOf(this._oFactory._oMetaData.property.property.type)>-1};W.prototype._isTimeType=function(t){var e=["date","datetime","time"];return e.indexOf(t)>-1};W.prototype._getPropertyName=function(){return this._oFactory._oMetaData.property.property.name};W.prototype._getEntitySetName=function(){return this._oFactory._oMetaData.entitySet.name};W.prototype._getEntityType=function(){return this._oFactory._oMetaData.entityType};W.prototype._getValueListAnnotation=function(){return this._oFactory._oMetaData.annotations.valuelist};W.prototype._getDisplayBehaviour=function(){var t=this._oFactory._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour");if(!t||t===F.auto){t=F.descriptionAndId}return t};W.prototype._getFormattedText=function(t,e){var i=this._getDisplayBehaviour();return E(c.getFormattedExpressionFromDisplayBehaviour(i,t,e))};W.prototype._getFilterType=function(t){if(f.isNumeric(t.type)){return"numeric"}else if(t.type==="Edm.DateTime"&&t["sap:display-format"]==="Date"){return"date"}else if(t.type==="Edm.String"){return"string"}else if(t.type==="Edm.Boolean"){return"boolean"}else if(t.type==="Edm.Time"){return"time"}else if(t.type==="Edm.DateTimeOffset"){return"datetime"}return undefined};W.prototype.setEntitySet=function(){u.prototype.setEntitySet.apply(this,arguments);this.updateBindingContext(false,this._getModel());return this};W.prototype.bindProperty=function(t,e){u.prototype.bindProperty.apply(this,arguments);if(t==="value"){this.updateBindingContext(false,this._getModel())}return this};W.prototype._checkComboBox=function(){var t=this._oFactory._oSelector.checkComboBox();return t&&t.combobox};W.prototype._isReadMode=function(){return!this.getEditable()||!this.getEnabled()||!this.getContextEditable()};function q(){this._onCreate.apply(this,arguments);if(this._aProviders.length>0){this._aProviders[0]._onOK=K;this._aProviders.forEach(function(t){t._calculateAndSetODataModelOutputData=G})}}W.prototype._init=function(){var t=this;u.prototype._init.apply(this,arguments);if(this._oFactory){this._oFactory._createMultiInput=this._createMultiInput.bind(this);this._oFactory._createMultiComboBox=this._createMultiComboBox.bind(this);this._oFactory._createTokenizer=this._createTokenizer.bind(this);this._oFactory._onMultiInputCreate=q;this._oFactory._oSelector.getCreator=function(e){var i=e!==undefined&&e.mode!==undefined?e.mode==="display":t._isReadMode();if(i){return"_createTokenizer"}else if(t._checkComboBox()){return"_createMultiComboBox"}else{return"_createMultiInput"}}}};W.prototype._getEditableForNotExpandedNavigation=function(){return true};W.prototype.exit=function(){u.prototype.exit.apply(this,arguments);this._deregisterResizeHandler();if(this._oMultiInput){this._oMultiInput.destroy()}if(this._oMultiComboBox){this._oMultiComboBox.destroy()}if(this._oTokenizer){this._oTokenizer.destroy()}if(this._oHBox){this._oHBox.destroy()}this._oMultiInput=null;this._oMultiComboBox=null;this._oTokenizer=null;this._oHBox=null};return W});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/SmartTable", ["sap/ui/thirdparty/jquery","sap/m/library","sap/ui/core/library","sap/ui/core/Core","sap/ui/core/ShortcutHintsMixin","sap/ui/core/format/ListFormat","sap/ui/events/KeyCodes","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FilterUtil","sap/m/Column","sap/m/ColumnListItem","sap/m/Label","sap/m/MessageBox","sap/m/Table","sap/m/Text","sap/m/Title","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/m/ToolbarSeparator","sap/m/VBox","sap/m/FlexItemData","sap/ui/comp/library","sap/ui/comp/providers/TableProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/table/AnalyticalColumn","sap/ui/table/AnalyticalTable","sap/ui/table/Column","sap/ui/table/Table","sap/ui/table/TreeTable","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/state/UIState","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/core/format/NumberFormat","sap/ui/Device","sap/base/Log","sap/base/util/deepEqual","sap/base/util/merge","sap/m/ColumnHeaderPopover","sap/m/ColumnPopoverActionItem","sap/m/Menu","sap/m/MenuButton","sap/m/MenuItem","sap/m/Button","sap/m/Link","sap/m/MessageStrip","sap/ui/core/InvisibleMessage","sap/ui/util/openWindow","sap/ui/core/theming/Parameters","sap/m/plugins/ColumnResizer","sap/m/ColumnPopoverSelectListItem","sap/m/table/Util","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/ActionItem","sap/base/util/UriParameters","sap/m/table/columnmenu/QuickActionContainer","sap/m/table/columnmenu/ItemContainer","sap/m/table/columnmenu/QuickAction","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/m/table/columnmenu/QuickGroup","sap/m/table/columnmenu/QuickGroupItem","sap/m/table/columnmenu/QuickTotal","sap/m/table/columnmenu/QuickTotalItem","./flexibility/Utils"],function(jQuery,t,e,i,o,a,n,r,s,l,u,h,d,p,f,_,g,c,m,b,T,y,C,S,v,P,I,E,M,x,A,D,B,F,w,V,L,R,O,U,H,W,N,K,k,z,G,Q,q,j,X,$,Y,Z,J,tt,et,it,ot,at,nt,rt,st,lt,ut,ht,dt,pt,ft,_t,gt,ct,mt,bt,Tt,yt,Ct){"use strict";var St=t.ButtonType;var vt=t.MenuButtonMode;var Pt=t.ToolbarDesign;var It=t.ToolbarStyle;var Et=e.SortOrder;var Mt=e.TitleLevel;var xt=S.smarttable.InfoToolbarBehavior;var At=y.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smarttable/SmartTable.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},enableExport:{type:"boolean",group:"Misc",defaultValue:true},exportType:{type:"sap.ui.comp.smarttable.ExportType",group:"Misc",defaultValue:"UI5ClientPDF"},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},customizeConfig:{type:"object",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:Mt.Auto},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},placeToolbarInTable:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false},initialNoDataText:{type:"string",group:"Misc",defaultValue:null},useInfoToolbar:{type:"sap.ui.comp.smarttable.InfoToolbarBehavior",group:"Behavior",defaultValue:xt.Auto},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},detailsButtonSetting:{type:"sap.ui.core.Priority[]",group:"Behavior"},enableAutoColumnWidth:{type:"boolean",group:"Misc",defaultValue:false},showPasteButton:{type:"boolean",group:"Behavior",defaultValue:false},enablePaste:{type:"boolean",group:"Behavior",defaultValue:true}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},semanticKeyAdditionalControl:{type:"sap.ui.core.Control",multiple:false},dataStateIndicator:{type:"sap.m.plugins.DataStateIndicator",multiple:false}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataRequested:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"}}},showOverlay:{},fieldChange:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},beforeExport:{parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"}}},beforePaste:{allowPreventDefault:true,parameters:{columnInfos:{type:"object[]"}}},paste:{parameters:{result:{type:"object"}}},uiStateChange:{}}},renderer:{apiVersion:2},constructor:function(){this._oTableReady=function(){var t={};t.promise=new Promise(function(e){t.resolve=e});return t}();y.apply(this,arguments);this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._mFieldMetadataByKey={};this._bUseColumnMenu=dt.fromQuery(window.location.search).get("sap-ui-xx-columnmenu")==="true";this._createToolbar();this._updateP13nDialogSettings();this._createTable();this.attachModelContextChange(this._initialiseMetadata,this)}});At.prototype._getP13nDialogSettings=function(){var t=this.data("p13nDialogSettings");if(typeof this._oP13nDialogSettings==="string"){try{t=JSON.parse(this._oP13nDialogSettings)}catch(e){t=null}}return t};At.prototype.getDataStateIndicatorPluginOwner=function(){return this._oTable||this._oTableReady.promise};At.prototype.setDataStateIndicator=function(t){this._handeDataStateEvents(this.getDataStateIndicator(),"detach");this.setAggregation("dataStateIndicator",t,true);this._handeDataStateEvents(this.getDataStateIndicator(),"attach");return this};At.prototype.setCustomizeConfig=function(t){this.setProperty("customizeConfig",t,true);return this};At.prototype.setUseExportToExcel=function(t){var e=this.getUseExportToExcel();this.setProperty("useExportToExcel",t,true);if(e!==this.getUseExportToExcel()){this.setEnableExport(t)}return this};At.prototype.setEnableExport=function(t){var e=this.getEnableExport();this.setProperty("enableExport",t,true);if(e!==this.getEnableExport()){this.setUseExportToExcel(t)}return this};At.prototype._validateCustomizeConfig=function(t){if(!t){return}if(t.isA){z.error("Invalid config property. Provided configuration has been deleted from the customizeConfig property - "+this.getId());this.setCustomizeConfig(null);return}for(var e in t){switch(e){case"textInEditModeSource":this._validateTextInEditModeSource(t);break;case"ignoreInsertRestrictions":this._validateIgnoreInsertRestrictions(t);break;case"autoColumnWidth":this._validateAutoColumnWidth(t);break;default:z.error(e+" is not a supported configuration for the customizeConfig property - "+this.getId());delete t[e];break}}};At.prototype._validateTextInEditModeSource=function(t){if(this._validateCustomizeConfigObjectType(t["textInEditModeSource"])){delete t.textInEditModeSource;z.error("Invalid config property textInEditModeSource. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["textInEditModeSource"],Object.keys(S.smartfield.TextInEditModeSource),"textInEditModeSource")};At.prototype._validateCustomizeConfigObjectType=function(t){if(typeof t!=="object"||!Object.keys(t).length||t.isA){return true}return false};At.prototype._checkAllowedValuesForCustomizeConfig=function(t,e,i){for(var o in t){if(!e.includes(t[o])){z.error("Invalid config property '"+o+"' for the "+i+" property of the customizeConfig - "+this.getId());delete t[o]}}};At.prototype._validateIgnoreInsertRestrictions=function(t){if(this._validateCustomizeConfigObjectType(t["ignoreInsertRestrictions"])){delete t.ignoreInsertRestrictions;z.error("Invalid config property ignoreInsertRestrictions. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["ignoreInsertRestrictions"],[true,false],"ignoreInsertRestrictions")};At.prototype._validateAutoColumnWidth=function(t){if(!this.getEnableAutoColumnWidth()&&t.hasOwnProperty("autoColumnWidth")){delete t.autoColumnWidth;z.error("The autoColumnWidth property is deleted from the customizeConfig, since enableAutoColumnWidth=false on the SmartTable - "+this.getId())}if(this._validateCustomizeConfigObjectType(t["autoColumnWidth"])){delete t.autoColumnWidth;z.error("Invalid config property autoColumnWidth. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}for(var e in t){if(typeof t[e]!=="boolean"&&typeof t[e]!=="object"){delete t[e];z.error("Invalid config property '"+e+"' for the autColumnWidth property of the customizeConfig - "+this.getId())}if(typeof t[e]==="object"){var i=t[e];for(var o in i){if(typeof i[o]==="boolean"){continue}if(typeof i[o]!=="object"){z.error("Expected 'object' or 'boolean', instead "+typeof i[o]+" was passed for '"+o+"' autoColumnWidth customizeConfig property - "+this.getId());delete i[o];continue}var a=i[o];for(var n in a){var r=null;switch(n){case"truncateLabel":r=typeof a[n];if(r!=="boolean"){z.error("The "+n+" property must be of type boolean, instead "+r+" was passed - "+this.getId());delete a[n]}break;case"min":case"max":case"gap":r=typeof a[n];if(r!=="number"){z.error("The "+n+" property must be of type number, instead "+r+" was passed - "+this.getId());delete a[n]}break;default:z.error("Invalid config property '"+n+"' for the autoColumnWidth property of the customizeConfig - "+this.getId());delete a[n]}}}}}};At.prototype._handeDataStateEvents=function(t,e){if(t){t[e+"ApplyFilter"](this._onApplyMessageFilter,this);t[e+"ClearFilter"](this._onClearMessageFilter,this);t[e+"Event"]("filterInfoPress",this._handleInfoToolbarPress,this)}};At.prototype.setHeaderLevel=function(t){if(this.getHeaderLevel()===t){return this}this.setProperty("headerLevel",t,true);this._headerText&&this._headerText.setLevel(t);return this};At.prototype._getP13nFilterMessageStrip=function(){var t,e;if(this._oMessageFilter){e=i.getLibraryResourceBundle("sap.ui.comp");t=new tt({text:e.getText("SMARTTABLE_P13N_FILTER_MESSAGESTRIP"),link:new J({text:e.getText("SMARTTABLE_MESSAGESTRIP_CLEAR_FILTER"),press:[function(){this._fnClearMessageFilter();t.setVisible(false)},this]})})}return t};At.prototype._onApplyMessageFilter=function(t){this._fnClearMessageFilter=t.getParameter("revert");this._oMessageFilter=t.getParameter("filter");t.preventDefault();this._reBindTable()};At.prototype._onClearMessageFilter=function(t){this._oMessageFilter=null;t.preventDefault();this._reBindTable()};At.prototype.init=function(){y.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this._aColumnKeys=[];this._aDeactivatedColumns=[];this._mLazyColumnMap={};this._mMenuShowSortMap=new window.WeakMap};At.prototype._getVariantManagementControl=function(t){var e=null;if(t){if(typeof t==="string"){e=i.byId(t)}else{e=t}if(e){if(!(e instanceof P)){z.error("Control with the id="+t.getId?t.getId():t+" not of expected type");return null}}}return e};At.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseTablePersonalisation()||!this.getPersistencyKey()){return}var t=new N({type:"table",keyName:"persistencyKey",dataSource:"TODO"});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new P(this.getId()+"-variant",{showShare:true})}if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this)}};At.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};At.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};At.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};At.prototype.setTableBindingPath=function(t){this.setProperty("tableBindingPath",t,true);return this};At.prototype.setTableType=function(t){if(this.getTableType()===t){return this}if(this._bInitialising){throw new Error("tableType changed while SmartTable control was initializing - "+this.getId())}this.setProperty("tableType",t);return this};At.prototype.setShowTablePersonalisation=function(t){this.setProperty("showTablePersonalisation",t,true);if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.setVisible(t)}return this};At.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}return this};At.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t,true);if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t);if(this._oSeparator){this._oSeparator.setVisible(t)}}return this};At.prototype.setToolbarStyleClass=function(t){this.setProperty("toolbarStyleClass",t,true);return this};At.prototype.setCustomToolbar=function(t){this._oCustomToolbar=t;return this};At.prototype.getCustomToolbar=function(){return this._oCustomToolbar};At.prototype.setHeader=function(t){var e=this.getProperty("header"),i;this.setProperty("header",t,true);if(this.bIsInitialised&&this._oToolbar){i=!e===!t;if(!i){this._createToolbarContent()}else{this._refreshHeaderText()}}return this};At.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};At.prototype.setEditable=function(t){if((t=!!t)==this.getEditable()){return this}this.setProperty("editable",t,true);if(this._oEditModel){this._oEditModel.setProperty("/editable",t)}if(this._oEditButton){this._oEditButton.setIcon(t?"sap-icon://display":"sap-icon://edit")}if(this._isMobileTable&&this._oTable.setKeyboardMode){this._oTable.setKeyboardMode(t?"Edit":"Navigation")}this._updateVisibleColumnsWidthForEdit();return this};At.prototype.setDemandPopin=function(t){var e=this.getDemandPopin();if(e===t){return this}this.setProperty("demandPopin",t,true);if(this.bIsInitialised){if(t){this._updateColumnsPopinFeature()}else{this._deactivateColumnsPopinFeature()}}return this};At.prototype._refreshHeaderText=function(){if(!this._headerText){return}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=K.getFloatInstance()}var t;var e=this.getHeader();this._headerText.setVisible(!!e);if(this.getShowRowCount()){t=this._getRowCount(true);if(t>0){var i=this._oNumberFormatInstance.format(t);e+=" ("+i+")"}}this._headerText.setText(e);this._updateAriaLabelledByInfo();if(this._bDataLoadPending===false&&this._bUpdateTableAnnouncement){this._bUpdateTableAnnouncement=false;this._updateTableAnnouncement(t)}};At.prototype._updateAriaLabelledByInfo=function(){var t=this._headerText.getId();if(this._oTable&&this._oTable.addAriaLabelledBy){if(this._headerText.getVisible()){if(this._oTable.getAriaLabelledBy().indexOf(t)===-1){this._oTable.addAriaLabelledBy(t)}}else{this._oTable.removeAriaLabelledBy(t)}}};At.prototype._updateTableAnnouncement=function(t){var e=et.getInstance();if(e){var o=i.getLibraryResourceBundle("sap.ui.comp");var a=this.getHeader();if(t===undefined&&this._getRowCount(false)>0){e.announce(o.getText("SMARTTABLE_ANNOUNCEMENT_TABLE_UPDATED",[a]))}else if(t>1){e.announce(o.getText("SMARTTABLE_ANNOUNCEMENT_TABLE_UPDATED_MULT",[a,t]))}else if(t===1){e.announce(o.getText("SMARTTABLE_ANNOUNCEMENT_TABLE_UPDATED_SING",[a,t]))}else{e.announce(o.getText("SMARTTABLE_ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[a]))}}};At.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new b(this.getId()+"-btnFullScreen",{press:[function(){this._toggleFullScreen(!this.bFullScreen)},this]});this._oFullScreenButton.addStyleClass("sapUiCompSmartTableToolbarContent");if(k.system.phone){this._oFullScreenButton.setLayoutData(new c({priority:"NeverOverflow"}))}}this._renderFullScreenButton();this._oToolbar.addContent(this._oFullScreenButton)}};At.prototype._addPasteButton=function(){var t=this.getId()+"-btnPaste";var e=i.byId(t);if(e){this._oToolbar.removeContent(e)}if(this.getShowPasteButton()){if(!e){e=new b(t);e.addStyleClass("sapUiCompSmartTableToolbarContent");sap.ui.require(["sap/m/plugins/PasteProvider"],function(t){e.addDependent(new t({pasteFor:this._oTable.getId()}))}.bind(this))}e.setEnabled(this.getEnablePaste());this._oToolbar.addContent(e)}};At.prototype._createToolbar=function(){var t=null;if(!this._oToolbar){t=this.getCustomToolbar();if(t){this._oToolbar=t}else{this._oToolbar=new g({design:Pt.Transparent,style:this.getTableType()==="ResponsiveTable"?It.Standard:It.Clear});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass())}}this._oToolbar.setLayoutData(new C({shrinkFactor:0}))}};At.prototype._toggleShowHideDetails=function(t){if(!this._oShowHideDetailsButton||t===this.bHideDetails){return}this.bHideDetails=t;if(this.bHideDetails){this._oTable.setHiddenInPopin(this._getImportanceToHide());this._oShowHideDetailsButton.setSelectedKey("hideDetails")}else{this._oTable.setHiddenInPopin([]);this._oShowHideDetailsButton.setSelectedKey("showDetails")}};At.prototype._getImportanceToHide=function(){var t=this.getDetailsButtonSetting()||[];var e=[];if(t.length){e=t}else{e=k.system.phone?["Low","Medium"]:["Low"]}return e};At.prototype._toggleFullScreen=function(t,e){if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;O.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t})};At.prototype._renderFullScreenButton=function(){var t=i.getLibraryResourceBundle("sap.ui.comp"),e;e=this.bFullScreen?t.getText("CHART_MINIMIZEBTN_TOOLTIP"):t.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(e);this._oFullScreenButton.setText(e);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};At.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addPasteButton();this._addEditTogglableToToolbar();this._addShowHideDetailsButton();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();this._addFullScreenButton();this._bToolbarInsertedIntoItems=true;this._placeToolbar()};At.prototype._applyToolbarContentOrder=function(){if(!this.bIsInitialised||!this.getCustomToolbar()){return}var t=this.data("p13nData_ToolbarContentMove");if(!t){return}t=Ct.parseChangeContent(t,function(t){this.data("p13nData_ToolbarContentMove",t)}.bind(this));if(!t||!t.order){return}var e=Ct.getAppComponentForControl(this)||null;var i=-1;var o=t.order;var a=[];var n=this._oToolbar.getContent();for(var r=0;r<o.length;r++){for(var s=0;s<n.length;s++){if(o[r].id===Ct.getSelectorForControl(n[s],e).id){if(i<0||i>s){i=s}a.push(n[s])}}}for(var s=0;s<a.length;s++){this._oToolbar.removeContent(a[s]);this._oToolbar.insertContent(a[s],i);i++}};At.prototype._placeToolbar=function(){if(!this.getPlaceToolbarInTable()){this.insertItem(this._oToolbar,0)}else if(this._isMobileTable){this._oTable.setHeaderToolbar(this._oToolbar)}else{this._oTable.addExtension(this._oToolbar)}};At.prototype.getToolbar=function(){return this._oToolbar};At.prototype._addEditTogglableToToolbar=function(){var t;if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton)}if(this.getEditTogglable()){if(!this._oEditButton){t=i.getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new b(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:t,tooltip:t,press:[function(){var t=this.getEditable();t=!t;this.setEditable(t,true);this.fireEditToggled({editable:t})},this]});this._oEditButton.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.addContent(this._oEditButton)}};At.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new _(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader");this._headerText.addStyleClass("sapUiCompSmartTableToolbarContent");this._headerText.setLevel(this.getHeaderLevel())}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};At.prototype._addSeparatorToToolbar=function(){if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}if(this.getHeader()&&this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(!this._oSeparator){this._oSeparator=new T(this.getId()+"-toolbarSeperator");if(!this.getShowVariantManagement()){this._oSeparator.setVisible(false)}this._oSeparator.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.insertContent(this._oSeparator,0)}if(this._oToolbar){this._oToolbar.addStyleClass("sapMTBHeader-CTX")}};At.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oToolbar.removeContent(this._oVariantManagement);if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContent");this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContentAllowAdaption");if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}}}};At.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,o;if(e){o=e.length;i=0;for(i;i<o;i++){if(e[i]instanceof m){t=true;break}}}if(!t){this._oToolbar.addContent(new m(this.getId()+"-toolbarSpacer").addStyleClass("sapUiCompSmartTableToolbarContent"))}};At.prototype._createShowHideDetailsButton=function(){var t=i.getLibraryResourceBundle("sap.ui.comp");this._oShowHideDetailsButton=new st(this.getId()+"-btnShowHideDetails",{visible:false,items:[new lt({icon:"sap-icon://detail-more",key:"showDetails",tooltip:t.getText("TABLE_SHOWDETAILS_TEXT"),press:[function(){this._toggleShowHideDetails(false)},this]}),new lt({icon:"sap-icon://detail-less",key:"hideDetails",tooltip:t.getText("TABLE_HIDEDETAILS_TEXT"),press:[function(){this._toggleShowHideDetails(true)},this]})]});this._oShowHideDetailsButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oShowHideDetailsButton.setSelectedKey("hideDetails")};At.prototype._addShowHideDetailsButton=function(){if(this._oShowHideDetailsButton){this._oToolbar.removeContent(this._oShowHideDetailsButton)}if(this.getShowDetailsButton()&&this._isMobileTable){if(this.bHideDetails===undefined){this.bHideDetails=true}if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}this._oToolbar.addContent(this._oShowHideDetailsButton)}};At.prototype._addTablePersonalisationToToolbar=function(){var t;if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton)}if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){t=i.getLibraryResourceBundle("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new b(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:t,tooltip:t,press:[function(t){if(!this._bPersDialogOpen){this._bPersDialogOpen=true;this._oPersController.openDialog()}},this]});o.addConfig(this._oTablePersonalisationButton,{messageBundleKey:k.os.macintosh?"SMARTTABLE_SHORTCUT_SHOW_SETTINGS_MAC":"SMARTTABLE_SHORTCUT_SHOW_SETTINGS"},this);this._oTablePersonalisationButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oTablePersonalisationButton.setVisible(this.getShowTablePersonalisation())}this._oToolbar.addContent(this._oTablePersonalisationButton)}};At.prototype._triggerGWExport=function(){var t=i.getLibraryResourceBundle("sap.ui.comp");var e=function(){var t=this._getRowBinding();var e=t.getDownloadUrl("xlsx");e=this._removeExpandParameter(e);var i={url:e};this.fireBeforeExport({exportSettings:i});it(i.url)}.bind(this);var o=this._getRowCount(true);if(o>1e4){d.confirm(t.getText("DOWNLOAD_CONFIRMATION_TEXT",o),{actions:[d.Action.YES,d.Action.NO],onClose:function(t){if(t===d.Action.YES){e()}}})}else{e()}};At.prototype._addExportToExcelToToolbar=function(){if(this._oExportButton){this._oToolbar.removeContent(this._oExportButton)}if(!this.getEnableExport()){return}if(!this._oExportButton){var t=this.getId()+"-btnExcelExport";var e="sap-icon://excel-attachment";var o=i.getLibraryResourceBundle("sap.ui.comp");if(this.getExportType().indexOf("UI5Client")>-1){this._oExportButton=this._createClientExportButton(t,e)}else if(this._bTableSupportsExcelExport&&this.getExportType()=="GW"){var a;a=o.getText("TABLE_EXPORT_TEXT");this._oExportButton=new b(t,{icon:e,text:a,tooltip:a,press:[this._triggerGWExport,this]})}this._setExcelExportEnableState();if(this._oExportButton){this._oExportButton.addStyleClass("sapUiCompSmartTableToolbarContent")}}this._oToolbar.addContent(this._oExportButton)};At.prototype._createClientExportButton=function(t,e){var a=i.getLibraryResourceBundle("sap.ui.comp");var n={fileName:this.getHeader()};if(!this._cachedExcelSettings){this._cachedExcelSettings=n}var r=new $(t,{icon:e,tooltip:a.getText("TABLE_EXPORT_TEXT"),type:St[ot.get({name:"_sap_ui_comp_SmartTable_ExportButton"})],buttonMode:vt.Split,useDefaultActionOnly:true,defaultAction:[function(){this._triggerUI5ClientExport()},this],menu:[new X({items:[new Y({text:a.getText("QUICK_EXPORT"),press:[function(){this._triggerUI5ClientExport()},this]}),new Y({text:a.getText("EXPORT_WITH_SETTINGS"),press:[function(){this._triggerUI5ClientExport(true)},this]})]})]});o.addConfig(r._getButtonControl(),{addAccessibilityLabel:true,messageBundleKey:k.os.macintosh?"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL_MAC":"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL"},this);return r};At.prototype.onkeydown=function(t){if(t.isMarked()){return}if((t.metaKey||t.ctrlKey)&&t.shiftKey&&t.which===n.E){if(this.getUseExportToExcel()&&this.getExportType().indexOf("UI5Client")>-1&&this._oExportButton&&this._oExportButton.getEnabled()){this._triggerUI5ClientExport(true);t.setMarked();t.preventDefault()}}else if((t.metaKey||t.ctrlKey)&&t.which===n.COMMA){if(this.getUseTablePersonalisation()&&this._oTablePersonalisationButton&&this._oTablePersonalisationButton.getVisible()){this._oPersController.openDialog();t.setMarked();t.preventDefault()}}};At.prototype.onThemeChanged=function(){if(this._oExportButton){var t=St[ot.get({name:"_sap_ui_comp_SmartTable_ExportButton"})];this._oExportButton.setType(t)}};At.prototype._loadExportLibrary=function(){if(!this._oExportLibLoadPromise){this._oExportLibLoadPromise=i.loadLibrary("sap.ui.export",true)}return this._oExportLibLoadPromise};At.prototype._getColumnLabel=function(t){var e,i;if(typeof t==="string"){e=t;t=this._getColumnByKey(t)}if(!t){var o=this._oTableProvider.getFieldLabel(this.getEntitySet(),e);if(o&&o.match(/{@i18n>.+}/gi)){var a=this.getModel("@i18n");if(a&&a.isA("sap.ui.model.resource.ResourceModel")){return a.getProperty(o.slice(1,-1).substring(6))||o}}if(!o){var n=this._mFieldMetadataByKey[e];if(n){o=n.label}}return o}if(t.getLabel){i=t.getLabel()}else if(t.getHeader){i=t.getHeader()}return i&&i.getText?i.getText():null};At.prototype._getColumnLeadingProperty=function(t,e){var i;if(t.getLeadingProperty){i=t.getLeadingProperty()}if(!i){var o=e||t.data("p13nData");if(o){i=o["leadingProperty"]}}return i};At.prototype._getColumnWidthNumber=function(t){if(t.indexOf("em")>0){return Math.round(parseFloat(t))}if(t.indexOf("px")>0){return Math.round(parseInt(t)/16)}return""};At.prototype._triggerUI5ClientExport=function(t){var e=this;var o,a,n,r;o=this._createExportColumnConfiguration();if(!o||!o.length){d.error(i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS_EXPORT"),{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return}r=this._getRowBinding();a=this._getColumnLabel.bind(this);n={workbook:{columns:o,hierarchyLevel:this._isTreeTable&&r.getTreeAnnotation?r.getTreeAnnotation("hierarchy-level-for"):undefined,context:{title:this.getHeader()}},dataSource:r,fileName:this.getHeader()};this._loadExportLibrary().then(function(){sap.ui.require(["sap/ui/export/ExportHandler"],function(i){var o,r,s;if(!e._oExportHandler){r=e._oTableProvider.getExportCapabilities(e.getExportType());o=new i(r);o.attachBeforeExport(function(t){e.fireBeforeExport({exportSettings:t.getParameter("exportSettings"),userExportSettings:t.getParameter("userExportSettings")})});e._oExportHandler=o}s=(t?e._oExportHandler.exportAs:e._oExportHandler.export).bind(e._oExportHandler);s(n,a)})})};At.prototype._createExportColumnConfiguration=function(){var t,e,i,o,a,n,r,s,l,u,h,d,p,f=[],_,g,c;var m=function(t,e){return"{"+(parseInt(e)-1)+"}"};t=this._isMobileTable?this._oTable.getColumns(true):this._oTable.getColumns();i=t.length;c=this.data("useUTCDateTime");if(c!=null){if(typeof c==="string"){_=c==="true"}else if(typeof c==="boolean"){_=c}}for(e=0;e<i;e++){r=null;s=null;o=t[e];g=_;if(o.getVisible()){a=o.data("p13nData");r=this._getColumnLeadingProperty(o,a);if(Array.isArray(r)){r=r[0]}if(r){n=this._getColumnLabel(o);l=o.getWidth().toLowerCase()||a.width||"";l=this._getColumnWidthNumber(l);u=a.type==="numeric"?"Number":a.type;p=a.typeInstance;d=null;h=null;if(a.unit){u=a.isCurrency?"Currency":"Number"}else if(p&&p.isA("sap.ui.comp.odata.type.FiscalDate")){var b=p.getFormatter();s=b.getTemplate().replace(/\$(\d)/g,m);h=b.getRegExPattern().toString().slice(1,-1);u="String"}else if(u!="date"&&H.isDateOrTime(a.edmType)){u=H.getTypeName(a.edmType);if(u==="DateTimeOffset"){u="DateTime";g=false}}else if(u==="stringdate"){u="Date";h="YYYYMMDD"}else if(u==="boolean"){u="Boolean";d=H.getType(a.edmType)}else if(a.description){u="String";s=R.getFormattedExpressionFromDisplayBehaviour(a.displayBehaviour,"{0}","{1}")}else if(a.isDigitSequence){u="Number"}else if(u==="string"){u="String"}else if(u==="date"){u="Date"}else if(u==="time"){u="Time"}f.push({columnId:o.getId(),property:a.description?[r,a.description]:r,type:u,inputFormat:h,label:n?n:r,width:l,textAlign:o.getHAlign(),template:s,trueValue:u==="Boolean"&&d?d.formatValue(true,"string"):undefined,falseValue:u==="Boolean"&&d?d.formatValue(false,"string"):undefined,unitProperty:u==="Currency"||u==="Number"?a.unit:undefined,displayUnit:u==="Currency"?true:undefined,precision:a.precision,scale:a.scale,autoScale:u==="Number",utc:u==="DateTime"&&g!=null?g:undefined,timezoneProperty:u==="DateTime"?a.additionalProperty:undefined})}}}return f};At.prototype._removeExpandParameter=function(t){var e=t.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(t,e,i){return i?e.substring(0,1):""});return e};At.prototype._getRowCount=function(t){var e=this._getRowBinding();if(!e){return t?undefined:0}var i;if(!t){i=e.getLength()}else if(typeof e.getCount==="function"){i=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){i=e.getLength()}if(i<0||i==="0"){i=0}return i};At.prototype._setExcelExportEnableState=function(){if(this._oExportButton){var t=this._getRowCount();this._oExportButton.setEnabled(t>0)}};At.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return}var t=this._oP13nDialogSettings;t=this._setIgnoreFromPersonalisationToSettings(t);t=t||{};if(this._isTreeTable){t.stableColumnKeys=[];t.stableColumnKeys.push(this._aColumnKeys[0])}if(this._bIsFilterPanelEnabled){t.filter=t.filter?t.filter:{};t.filter.createMessageStrip=this._getP13nFilterMessageStrip.bind(this)}this._oPersController=new V(this.getId()+"-persoController",{table:this._oTable,columnKeys:this._aColumnKeys,setting:t,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:[this._beforePersonalisationModelDataChange,this],afterPotentialTableChange:[this._afterPersonalisationModelDataChange,this],afterP13nModelDataChange:[this._personalisationModelDataChange,this],requestColumns:[this._personalisationRequestColumns,this]});this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}this._bPersDialogOpen=false}.bind(this));if(this._aDeactivatedColumns.length>0){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}};At.prototype.getVariantManagement=function(){return this._oVariantManagement};At.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;return this._oPersController.openDialog({showReset:false,useAvailablePanels:true,styleClass:t}).then(function(t){if(t){return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder"],function(e){return e.addRTACustomFieldButton(t,this)}.bind(this))}.bind(this))}}.bind(this))};At.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};At.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};At.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=L.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("filter");i("sort");i("group");i("columns")}return t};At.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation)}};At.prototype.setEntitySet=function(t){if(this.getEntitySet()===t){return this}if(this._bInitialising){throw new Error("entitySet changed while SmartTable control was initializing - "+this.getId())}this.setProperty("entitySet",t,true);this._initialiseMetadata();return this};At.prototype._initialiseMetadata=function(t){var e=this,i=e;if(t){i=t.getSource()}if(!i.bIsInitialised){U.handleModelInit(i,i._onMetadataInitialised,[{selector:i},{selector:i._oTable,changeTypes:["addXML","addXMLAtExtensionPoint"]}])}};At.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(this.bIsInitialised){return}this._updateInitialColumns();this._fireBeforeInitialiseAndValidate();this._validateCustomizeConfig(this.getCustomizeConfig());this._createTableProvider();if(!this._oTableProvider){return}this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(!this._aTableViewMetadata){return}if(this.getEnableAutoColumnWidth()){this._oTable.getColumns().forEach(this._setWidthForCustomColumn,this)}if(!this._isMobileTable&&this.getDemandPopin()){this.setDemandPopin(false);z.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false")}this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;delete this._bInitialising;this._updateP13nDialogSettings(true);this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._bMultiUnitBehaviorEnabled=this._oTableProvider.getMultiUnitBehaviorEnabled();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._applyToolbarContentOrder();this._aAlwaysSelect=this._oTableProvider.getRequestAtLeastFields();this._createContent();this._createPersonalizationController();this._oEditModel=new x({editable:this.getEditable()});this.setModel(this._oEditModel,"sm4rtM0d3l");this.attachEvent("_change",this._onPropertyChange,this);this.fireInitialise();if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}};At.prototype._fireBeforeInitialiseAndValidate=function(){if(!this.hasListeners("beforeInitialise")){return}this._bInitialising=true;this.fireEvent("beforeInitialise");this._validateControlConfig();this._updateInitialColumns()};At.prototype._validateControlConfig=function(){var t=this.getItems();if(!t.length){throw new Error("Internals of the SmartTable control changed via beforeInitialise event - "+this.getId())}var e=t.find(function(t){return t.isA(["sap.m.Table","sap.ui.table.Table"])});if(!e){throw new Error("Inner Table removed via beforeInitialise event - "+this.getId())}if(e!==this._oTable){throw new Error("Inner table changed via beforeInitialise event for SmartTable - "+this.getId())}};At.prototype._updateP13nDialogSettings=function(t){this._oP13nDialogSettings=this._getP13nDialogSettings();this._bIsFilterPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.filter?this._oP13nDialogSettings.filter.visible!==false:true;this._bIsSortPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.sort?this._oP13nDialogSettings.sort.visible!==false:true;this._bIsGroupPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.group?this._oP13nDialogSettings.group.visible!==false:true;if(t){this._attachTableCustomFilter()}};At.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){if(this._oSmartFilter.isInitialised()){this._oSmartFilter.search()}else{this._oSmartFilter.attachEventOnce("initialise",function(){this._oSmartFilter.search()},this)}}else{this._reBindTable()}}}};At.prototype._aStaticProperties=["entitySet","ignoredFields","initiallyVisibleFields","ignoreFromPersonalisation","tableType","useTablePersonalisation","enableAutoBinding","persistencyKey","smartFilterId","showDetailsButton","enableAutoColumnWidth","customizeConfig"];At.prototype._aToolbarRelatedProperties=["enableExport","exportType","showFullScreenButton","showPasteButton","editTogglable","placeToolbarInTable"];At.prototype._onPropertyChange=function(t){var e=t.getParameter("name");if(this._aStaticProperties.indexOf(e)>-1){z.error("Property "+e+" cannot be changed after the SmartTable with id "+this.getId()+" is initialised")}if(this._oToolbar&&this._aToolbarRelatedProperties.indexOf(e)>-1){if(e==="exportType"&&this._oExportButton){this._oExportButton.destroy();this._oExportButton=null}this._createToolbarContent()}};At.prototype._createTableProvider=function(){var t,e,i,o,a;e=this.getEntitySet();i=this.getIgnoredFields();t=this.getModel();o=this.data("preserveDecimals");a=this.getCustomizeConfig();if(a){for(var n in a){this["_oCustomizeConfig"+n.charAt(0).toUpperCase()+n.slice(1)]=a[n]}}if(o!=null){if(o==false||typeof o==="string"&&o==="false"){this._bPreserveDecimals=false}else{this._bPreserveDecimals=true}}else{this._bPreserveDecimals=true}if(t&&e){if(this._aExistingColumns.length){if(i){i+=","+this._aExistingColumns.toString()}else{i=this._aExistingColumns.toString()}}this._oTableProvider=new v({entitySet:e,ignoredFields:i,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),smartTableId:this.getId(),isAnalyticalTable:!!this._isAnalyticalTable,isMobileTable:!!this._isMobileTable,dateFormatSettings:this.data("dateFormatSettings"),useUTCDateTime:this.data("useUTCDateTime"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),useSmartToggle:this.data("useSmartToggle"),skipAnnotationParse:this.data("skipAnnotationParse"),lineItemQualifier:this.data("lineItemQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),enableInResultForLineItem:this.data("enableInResultForLineItem"),_semanticKeyAdditionalControl:this.getAggregation("semanticKeyAdditionalControl"),model:t,semanticObjectController:this.getSemanticObjectController(),showDetailsButton:this.getShowDetailsButton(),enableAutoColumnWidth:this.getEnableAutoColumnWidth(),preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions})}};At.prototype._listenToSmartFilter=function(){var t,e,o=false;t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t,"sap.ui.comp.filterbar.FilterBar");if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);o=true}var a=i.getLibraryResourceBundle("sap.ui.comp"),n,r,s={SMARTTABLE_NO_DATA:a.getText("SMARTTABLE_NO_DATA"),SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR:a.getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"),SMARTTABLE_NO_RESULTS:a.getText("SMARTTABLE_NO_RESULTS")};if(this._oTable){n=!this._isMobileTable&&this._oTable.getNoData;r="noData";if(!n){n=this._oTable.getNoDataText;r="noDataText"}}if(n){var l=n.call(this._oTable);if(l&&(!this._isMobileTable||!this._oTable.isPropertyInitial(r))){if(Object.values(s).indexOf(l)==-1){this._vCustomNoData=l}}}e=this.getInitialNoDataText();if(e){o=e==="$FILTERBAR";if(!o&&e!=="$NO_FILTERBAR"){this._setNoDataText(e);return}}if(o){this._setNoDataText(s["SMARTTABLE_NO_DATA"])}else{this._setNoDataText(s["SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"])}};At.prototype._filterChangeEvent=function(){if(this._isTableBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};At.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._oTable.setShowOverlay(t)};At.prototype._findControl=function(t,e){var o,a;if(t){o=i.byId(t);if(!o||!o.isA(e)){a=this._getView();if(a){o=a.byId(t)}}if(o&&!o.isA(e)){o=undefined}}return o};At.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};At.prototype.rebindTable=function(t){if(this.isInitialised()){this._reBindTable(null,t);return}z.error("rebindTable method called before the SmartTable is initialized. Please execute the UI5 Support Assistant 'SmartTable' rules to get more information",this.getId(),"sap.ui.comp.smarttable.SmartTable")};At.prototype._reBindTable=function(t,e){var o,a,n,r,s,l,u=[],h,p,f,_,g,c,m,b={},T={preventTableBind:false};this._bUpdateTableAnnouncement=t&&t.getId&&t.getId()==="search";n=this._getTablePersonalisationData()||{};if(this._oMessageFilter){h=this._oMessageFilter}else{h=n.filters;p=n.excludeFilters}m=n.sorters;if(this._oSmartFilter){l=this._oSmartFilter.getFilters();b=this._oSmartFilter.getParameters()||{}}if(l&&l.length){if(p){u=[new E([l[0],p],true)]}else{u=l}}else if(p){u=[p]}if(h){h=u.concat(h)}else{h=u}f=this._getRequestAtLeastFields();g=this._getRelevantColumnPaths();_=g["select"];if(!_||!_.length){_=f}else{s=f.length;for(r=0;r<s;r++){if(_.indexOf(f[r])<0){_.push(f[r])}}}if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.select){this._mSelectExpandForGroup.select.forEach(function(t){if(_.indexOf(t)<0){_.push(t)}})}o=this._oTable.getBinding(this._sAggregation);if(_.length){this._adaptTreeBindingParameters(_,b,o);b["select"]=_.toString();c=g["expand"]||[];if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.expand){this._mSelectExpandForGroup.expand.forEach(function(t){if(c.indexOf(t)<0){c.push(t)}})}if(c.length){b["expand"]=c.join(",")}}b["useBatchRequests"]=true;if(!m){m=[]}T.filters=h;T.sorter=m;T.parameters=b;T.length=undefined;T.startIndex=undefined;T.events={};this.fireBeforeRebindTable({bindingParams:T,messageFilterActive:!!this._oMessageFilter});if(!T.preventTableBind){m=T.sorter;h=T.filters;b=T.parameters;_=T.parameters["select"];if(!_||!_.length){d.error(i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return}a=this.getTableBindingPath()||"/"+this.getEntitySet();if(this._oTable.resumeUpdateAnalyticalInfo){this._oTable.resumeUpdateAnalyticalInfo(true,false)}this._bDataLoadPending=true;this._bIgnoreChange=false;if(this._bForceTableUpdate){e=true;this._bForceTableUpdate=false}if(!e){if(o&&o.mParameters){var y=b["select"];b["select"]="";var C=o.mParameters["select"];o.mParameters["select"]="";e=!(G(b,o.mParameters,true)&&G(b.custom,o.mParameters.custom)&&!T.length&&!T.startIndex&&a===o.getPath());if(!e){e=!G(y.split(",").sort(),C.split(",").sort())}b["select"]=y;o.mParameters["select"]=C}}if(!this._bNoDataUpdated){this._bNoDataUpdated=true;this._setNoDataText()}else{this._setNoDataText(undefined,(this.getSmartFilterId()||this._bIsFilterPanelEnabled)&&h&&h.length)}if(!o||!this._bIsTableBound||e){At._addBindingListener(T,"change",this._onBindingChange,this);At._addBindingListener(T,"dataRequested",this._onDataRequested,this);At._addBindingListener(T,"dataReceived",this._onDataReceived,this);if(this._isMobileTable){var S=this._oTable?this._oTable.getColumns():[];var v=this._oTemplate?this._oTemplate.getCells():[];if(S.length===v.length){S.forEach(function(t,e){v[e].setBindingContext(t.getVisible()?undefined:null)})}}this._oTable.bindRows({path:a,filters:h,sorter:m,parameters:b,length:T.length,startIndex:T.startIndex,template:this._oTemplate,events:T.events});this._bIsTableBound=true}else{o.sort(m);o.filter(h,"Application")}this._showOverlay(false)}};At.prototype._adaptTreeBindingParameters=function(t,e,i){if(!this._isTreeTable){return}e["numberOfExpandedLevels"]=this._oTable.getExpandFirstLevel()?1:0;e["rootLevel"]=this._oTable.getRootLevel();e["collapseRecursive"]=this._oTable.getCollapseRecursive();if(!i||!i.getTreeAnnotation){return}var o={"hierarchy-level-for":i.getTreeAnnotation("hierarchy-level-for"),"hierarchy-parent-node-for":i.getTreeAnnotation("hierarchy-parent-node-for"),"hierarchy-node-for":i.getTreeAnnotation("hierarchy-node-for"),"hierarchy-drill-state-for":i.getTreeAnnotation("hierarchy-drill-state-for")};for(var a in o){if(o[a]&&t.indexOf(o[a])===-1){t.push(o[a])}}};At.prototype._onDataRequested=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=true;this.fireDataRequested(t.getParameters())};At.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)};At.prototype._onBindingChange=function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"||!this._bDataLoadPending&&e==="change"||e==="add"||e==="remove"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}};At._addBindingListener=function(t,e,i,o){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i.bind(o)}else{var a=t.events[e];t.events[e]=function(){i.apply(o,arguments);a.apply(o,arguments)}}};At.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;this.updateTableHeaderState()}};At.prototype._isTableBound=function(){if(this._bIsTableBound){return true}if(this._oTable){return this._oTable.isBound(this._sAggregation)}return false};At.prototype.setNoData=function(t){this._oNoData=t;if(this._bNoDataUpdated||this._isTableBound()){this._setNoDataText()}return this};At.prototype.getNoData=function(){return this._oNoData};At.prototype._setNoDataText=function(t,e){var o=!this._isMobileTable&&this._oTable.setNoData;if(!o){o=this._oTable.setNoDataText}if(!o){return}if(this._bNoDataUpdated&&this._vCustomNoData){o.call(this._oTable,this._vCustomNoData,true);return}var a=t;if(!a){a=this.getNoData()}if(!a){if(e){a=i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS")}else{a=i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR")}}o.call(this._oTable,a,true)};At.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState()};At.prototype._createContent=function(){var t,e=0,i,o,a,n=[];if(this._aExistingColumns&&this._aExistingColumns.length){this._aColumnKeys=[].concat(this._aExistingColumns.reverse())}if(this._bUseColumnMenu){this._oColumnHeaderPopover=new ut({id:this.getId()+"-columnHeaderMenu"});this._oQuickActionContainer=new pt;this._oColumnHeaderPopover.addAggregation("_quickActions",this._oQuickActionContainer);this._oItemContainer=new ft;this._oColumnHeaderPopover.addAggregation("_items",this._oItemContainer);this._oColumnHeaderPopover.attachBeforeOpen(this._createColumnMenuContent,this)}o=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(t=0;t<e;t++){i=this._aTableViewMetadata[t];if(i.isInitiallyVisible){this._aColumnKeys.push(i.name)}else{n.push(i.name)}if(!(i.isInitiallyVisible||i.inResult)){this._mLazyColumnMap[i.name]=i}else{a=this._createColumnForField(i);this._oTable.addColumn(a)}this._mFieldMetadataByKey[i.name]=i}this._insertIndexedColumns(o);this._aColumnKeys=this._aColumnKeys.concat(n);if(this._isMobileTable&&this.getEnableAutoColumnWidth()){this.setDemandPopin(true);this._oTable.setFixedLayout("Strict");this._oTable.setContextualWidth("auto");this._oTable.addDependent(new at)}this._updateColumnsPopinFeature();if(this.getShowDetailsButton()){this._oTable.setHiddenInPopin(this._getImportanceToHide())}this._storeInitialColumnSettings()};At.prototype._createColumnForField=function(t){var e,i;i=this.getId()+"-"+t.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");e=this._createColumn(t,i);t.isColumnCreated=true;e.data("p13nData",{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,navigationProperty:t.navigationProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,isGroupable:t.sortable&&t.filterable&&t.aggregationRole==="dimension",fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,align:t.align,edmType:t.type,displayBehaviour:t.displayBehaviour,description:t.description,isDigitSequence:t.isDigitSequence,isCurrency:t.isCurrencyField,unit:t.unit,width:t.width,aggregationRole:t.aggregationRole,nullable:t.nullable!=="false"});if(t.filterable&&e.setFilterProperty){e.setFilterProperty(t.name)}if(t.sortable&&e.setSortProperty){e.setSortProperty(t.name)}if(this._bUseColumnMenu&&!e.getAssociation("headerMenu")){e.addAssociation("headerMenu",this.getId()+"-columnHeaderMenu")}if(this.getEnableAutoColumnWidth()){t.width=e.getWidth();if(this.getEditable()){this._updateColumnWidthForEdit(e,t)}}this._registerContentTemplateEvents(t.template);return e};At.prototype._parseIndexedColumns=function(){var t,e,i,o,a,n,r,s,l;var u=this._oTable.getColumns();var h=null;if(this._oTemplate&&this._oTemplate.getCells){h=this._oTemplate.getCells()}if(!u){return null}o=[];e=u.length;for(t=0;t<e;t++){i=u[t];a=i.data("p13nData");n=null;r=null;if(a){n=a.columnIndex;r=a.columnKey}s=-1;if(n!==null&&n!==undefined){s=parseInt(n)}if(!isNaN(s)&&s>-1){if(h){l=h[t];this._oTemplate.removeCell(l)}else{l=null}this._aColumnKeys.splice(t-o.length,1);o.push({index:s,columnKey:r,column:i,template:l});this._oTable.removeColumn(i)}}o.sort(function(t,e){return t.index-e.index});return o};At.prototype._insertIndexedColumns=function(t){var e,i,o;if(!t){return}i=t.length;for(e=0;e<i;e++){o=t[e];this._aColumnKeys.splice(o.index,0,o.columnKey);this._oTable.insertColumn(o.column,o.index);if(o.template){this._oTemplate.insertCell(o.template,o.index)}}};At.prototype._updateColumnsPopinFeature=function(){if(!this._isMobileTable||!this.getDemandPopin()){return}if(!this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(true)}var t=this._oTable.getColumns(true);if(!t){return}t=t.filter(function(t){return t.getVisible()});t.forEach(function(t){if(t.getPopinDisplay()!="WithoutHeader"){t.setPopinDisplay("Inline")}})};At.prototype._storeInitialColumnSettings=function(){var t=L.createArrayFromString(this.getIgnoreFromPersonalisation());this._aInitialSorters=[];L.createSort2Json(this._oTable,this._aInitialSorters,t,this._aTableViewMetadata)};At.prototype._deactivateColumnsPopinFeature=function(){if(!this._isMobileTable){return}if(this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(false)}var t=this._oTable.getColumns();if(!t){return}var e,i=t.length;for(var o=0;o<i;o++){e=t[o];e.setDemandPopin(false);e.setMinScreenWidth("1px")}};At.prototype._registerContentTemplateEvents=function(t){if(t.isA("sap.ui.comp.SmartToggle")){t=t.getEdit()}if(t&&t.attachChange){t.attachChange(function(t){this.fireFieldChange({changeEvent:t})},this)}};At.prototype._updateInitialColumns=function(){var t=this._oTable.getColumns(),e=t.length,i,o;var a=this.getEnableAutoColumnWidth();while(e--){i=t[e];o=i.data("p13nData");if(o&&o.columnKey&&this._aExistingColumns.indexOf(o.columnKey)>=0){continue}if(typeof o==="string"){try{o=JSON.parse(o);i.data("p13nData",o)}catch(t){}}if(o&&o.columnKey){this._aExistingColumns.push(o.columnKey);if(this._bUseColumnMenu&&!i.getAssociation("headerMenu")){i.addAssociation("headerMenu",this.getId()+"-columnHeaderMenu");if(!this._isMobileTable){this._mMenuShowSortMap.set(i,i.getShowSortMenuEntry());i.setShowSortMenuEntry(false)}}}if(a&&this._isMobileTable){var n=i.getHeader();if(n&&n.isPropertyInitial("wrapping")&&n.getMetadata().getProperty("wrapping")){n.setWrapping(false)}}}};At.prototype._getRelevantColumnPaths=function(){var t={},e=[],i=[],o=this._oTable.getColumns(),a,n=o?o.length:0,r,s,l,u,h;var d=function(t,e){var i,o;if(t){o=t.split(",");i=o.length;while(i--){t=o[i];if(t&&e.indexOf(t)<0){e.push(t)}}}};for(a=0;a<n;a++){r=o[a];l=null;if(r.getVisible()||r.getInResult&&r.getInResult()){s=r.data("p13nData");l=this._getColumnLeadingProperty(r,s);if(s){u=s["additionalProperty"];h=s["navigationProperty"]}if(l&&e.indexOf(l)<0){e.push(l)}d(u,e);d(h,i)}}t["select"]=e;t["expand"]=i;return t};At.prototype._createTable=function(){var t=this.getItems(),e=t?t.length:0,i,o;this._sAggregation="rows";while(e--){i=t[e];if(i instanceof F||i instanceof p){break}i=null}if(i){this._oTable=i;if(i instanceof D){this._isAnalyticalTable=true}else if(i instanceof p){this._isMobileTable=true;this._oTemplate=i.getItems()&&i.getItems().length>0?i.getItems()[0]:new u;i.removeAllItems()}else if(i instanceof w){this._isTreeTable=true}this._updateInitialColumns()}else{o=this.getId()+"-ui5table";if(this.getTableType()==="AnalyticalTable"){this._isAnalyticalTable=true;this._oTable=new D(o,{enableCustomFilter:true})}else if(this.getTableType()==="ResponsiveTable"){this._isMobileTable=true;this._oTable=new p(o,{growing:true,autoPopinMode:this.getDemandPopin()});this._oTemplate=new u}else if(this.getTableType()==="TreeTable"){this._isTreeTable=true;this._oTable=new w(o,{selectionMode:"MultiToggle"})}else{this._oTable=new F(o,{selectionMode:"MultiToggle"})}if(this._oTable.setVisibleRowCountMode){this._oTable.setVisibleRowCountMode("Auto")}this.insertItem(this._oTable,2)}this._oTableReady.resolve(this._oTable);this._fColumnPaddingBorder=this._isMobileTable?1:1.1875;if(!this._oTable.getLayoutData()){if(this._oTable instanceof p||this._oTable.getVisibleRowCountMode&&this._oTable.getVisibleRowCountMode()!=="Auto"){this._oTable.setLayoutData(new C({growFactor:1,baseSize:"auto"}))}else{this._oTable.setLayoutData(new C({growFactor:1,baseSize:"0%"}))}}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter())}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false)}this._attachTableCustomFilter();if(this._isAnalyticalTable){this._createColumn=this._createAnalyticalColumn}else if(this._isMobileTable){if(this.getUseTablePersonalisation()){this._oTable.bActiveHeaders=true;this._oTable.attachEvent("columnPress",this._onColumnPress,this);this._oTable.attachSort=function(){this.attachEvent("sort",arguments[0],arguments[1],arguments[2])};this._oTable.detachSort=function(){this.detachEvent("sort",arguments[0],arguments[1])}}this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;if(this.getShowDetailsButton()){this._oTable.attachEvent("popinChanged",this._onPopinChanged,this)}}if(!this._isMobileTable){this._oTable.attachRowsUpdated(function(){this._setExcelExportEnableState()},this)}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true)}this._oTable.attachPaste(this._onInnerTablePaste,this)};At.prototype._attachTableCustomFilter=function(){if(this._oTable.detachCustomFilter){this._oTable.detachCustomFilter(this._onCustomFilter,this)}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()&&this._bIsFilterPanelEnabled){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false)}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._onCustomFilter,this)}}};At.prototype._createResponsivePopover=function(t){this._oFilterButton=new j({text:i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RP_FILTER"),icon:"sap-icon://filter",press:[function(t){this._onCustomFilter(t)},this]});var e=i.getLibraryResourceBundle("sap.ui.comp");this._aSortButton=[new nt({label:e.getText("SMARTTABLE_RP_SORT_ASCENDING"),icon:"sap-icon://sort-ascending",action:[true,this._onCustomSort,this]}),new nt({label:e.getText("SMARTTABLE_RP_SORT_DESCENDING"),icon:"sap-icon://sort-descending",action:[false,this._onCustomSort,this]})];this._oColumnHeaderPopover=new q({items:[this._aSortButton,this._oFilterButton]});if(t){this._oColumnHeaderPopover.addItem(new j({text:i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RP_RESIZE"),icon:"sap-icon://resize-horizontal",press:[function(){at.getPlugin(this._oTable).startResizing(this._oColumnClicked.getDomRef())},this]}))}};At.prototype._createColumnMenuContent=function(t){var e=i.getLibraryResourceBundle("sap.ui.comp");var o=t.getParameter("openBy");var a=o.data("p13nData");var n=window.matchMedia("(hover:none)").matches&&this._isMobileTable&&this.getEnableAutoColumnWidth();this._oColumnClicked=o;this._oQuickActionContainer.removeAllAggregation("quickActions");this._oItemContainer.removeAllAggregation("items");if(this._isMobileTable||!this._aExistingColumns.includes(a.columnKey)||this._mMenuShowSortMap.get(o)){if(!this._oQuickSort){this._oQuickSort=this._createQuickSort(o)}this._updateQuickSort(o);this._oQuickActionContainer.addQuickAction(this._oQuickSort)}if(n){if(!this._oQuickResize){this._oQuickResize=this._createQuickResize(e)}this._oQuickActionContainer.addQuickAction(this._oQuickResize)}if(this._bIsSortPanelEnabled){if(!this._oSortItem){this._oSortItem=this._createSortItem(e)}this._oItemContainer.addItem(this._oSortItem)}if(this._bIsFilterPanelEnabled){if(!this._oFilterItem){this._oFilterItem=this._createFilterItem(e)}this._oItemContainer.addItem(this._oFilterItem)}if((this._isAnalyticalTable||this._isMobileTable)&&this._bIsGroupPanelEnabled){if(!this._oGroupItem){this._oGroupItem=this._createGroupItem(e)}this._oItemContainer.addItem(this._oGroupItem)}this._oPersController&&this._oPersController.preparePersonalization()};At.prototype._createQuickSort=function(t){return new gt({items:[],change:[function(t){var e=t.getParameter("item"),i=e.getSortOrder(),o=this._getColumnByKey(e.getKey());if(i===Et.None){var a=o.data("p13nData");this._onCustomSort(t,a.sorted&&a.sorted.ascending,o)}else{this._onCustomSort(t,i===Et.Ascending,o)}},this]})};At.prototype._updateQuickSort=function(t){var e=t.data("p13nData");var i;this._oQuickSort.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"){this._oQuickSort.addItem(new ct({key:this._getColumnLeadingProperty(t,e),label:this._getColumnLabel(t),sortOrder:Dt(e)}))}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnByKey(e.description);if(i&&i.data("p13nData").sortProperty){this._oQuickSort.addItem(new ct({key:e.description,label:this._getColumnLabel(e.description),sortOrder:Dt(i.data("p13nData"))}))}}if(e.unit){i=this._getColumnByKey(e.unit);if(i&&i.data("p13nData").sortProperty){this._oQuickSort.addItem(new ct({key:e.unit,label:this._getColumnLabel(e.unit),sortOrder:Dt(i.data("p13nData"))}))}}};At.prototype._createQuickResize=function(t){return new _t({label:t.getText("SMARTTABLE_RP_RESIZE"),content:new Z({icon:"sap-icon://resize-horizontal",press:[function(){this._oColumnHeaderPopover.close();at.getPlugin(this._oTable).startResizing(this._oColumnClicked.getDomRef())},this]})})};At.prototype._createSortItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_SORT"),icon:"sap-icon://sort",press:[this._showTableSortDialog,this]})};At.prototype._createFilterItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_FILTER"),icon:"sap-icon://filter",press:[this._onCustomFilter,this]})};At.prototype._createGroupItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_GROUP"),icon:"sap-icon://group-2",press:[this._showTableGroupDialog,this]})};function Dt(t){var e=Et.None;if(t.sorted){e=t.sorted.ascending?Et.Ascending:Et.Descending}return e}At.prototype._onColumnPress=function(t){if(this._bUseColumnMenu){return}this._oColumnClicked=t.getParameter("column");var e=this._oColumnClicked.data("p13nData");var i=window.matchMedia("(hover:none)").matches&&this._isMobileTable&&this.getEnableAutoColumnWidth();if(!e&&!i){return}var o=e.filterProperty;var a=e.sortProperty;if(!this._oColumnHeaderPopover){this._createResponsivePopover(i)}this._oFilterButton.setVisible(!!o&&this._bIsFilterPanelEnabled);var n=!!a&&this._bIsSortPanelEnabled;this._aSortButton.forEach(function(t){t.setVisible(n)});if(o&&this._bIsFilterPanelEnabled||a&&this._bIsSortPanelEnabled||i){this._oColumnHeaderPopover.removeAllAriaLabelledBy();this._oColumnHeaderPopover.addAriaLabelledBy(this._oColumnClicked.getHeader());this._oColumnHeaderPopover.openBy(this._oColumnClicked)}};At.prototype._onCustomSort=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");var a,n;if(o){if(o.sorted&&o.sorted.ascending===e){delete o.sorted;n=Et.None;if(this._isMobileTable){i.setSortIndicator(n)}}else{o.sorted={ascending:e};a=o.sorted;n=a&&a.ascending?Et.Ascending:Et.Descending}this._oTable.fireEvent("sort",{column:i,sortOrder:n,columnAdded:false})}};At.prototype._onCustomFilter=function(t){this._showTableFilterDialog(t.getParameter("column")||this._oColumnClicked)};At.prototype._onPopinChanged=function(t){if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}var e=t.getParameter("visibleInPopin");var i=t.getParameter("hiddenInPopin");var o=t.getSource().getVisibleItems();var a=e.some(function(t){return this._getImportanceToHide().indexOf(t.getImportance())>-1},this);if(o.length&&(i.length||a)){this._oShowHideDetailsButton.setVisible(true)}else{this._oShowHideDetailsButton.setVisible(false)}};At.prototype.getTable=function(){return this._oTable};At.prototype._showTableFilterDialog=function(t){if(this._oPersController){var e={filter:{visible:true}};if(t){e.filter["payload"]={column:t}}this._oPersController.openDialog(e)}};At.prototype._showTableSortDialog=function(){if(this._oPersController){var t={sort:{visible:true}};this._oPersController.openDialog(t)}};At.prototype._showTableGroupDialog=function(){if(this._oPersController){var t={group:{visible:true}};this._oPersController.openDialog(t)}};At.prototype._calcColumnWidth=function(t,e,i){var o;if(i===false){o=true}i=Object.assign({label:e?false:true,defaultWidth:e?4:8,padding:this._fColumnPaddingBorder},i);if(!t||o){return i.defaultWidth}var a=0,n=0,r=Math.max(i.min||0,e?1:2),s=Math.max(r,i.max||19),l=t.additionalProperty||"",u=t.displayBehaviour,h=t.modelType,d=t.type||"";if(s<r){return s}if(e||t.unit||!l||u!="descriptionOnly"){if(t.isImageURL||d=="Edm.Byte"||d=="Edm.SByte"){a+=r}else if(h){a+=rt.calcTypeWidth(h,{defaultWidth:i.defaultWidth,maxWidth:i.max})}else{a+=i.defaultWidth}}if(this._isTreeTable&&t.hierarchy&&t.index==0){a+=3}if(!e){t.ownWidth=a=Math.min(a,s)}if(!e&&u!="idOnly"&&l&&this._oTableProvider&&a<s){l.split(",").forEach(function(e){if(e==t.fieldControlProperty){return}var i=this._oTableProvider.getFieldMetadata(e);var o=Object.assign({padding:.4,max:s-a-.4},t.vertical&&{padding:0,max:s});if(e==t.unit){o.min=3}var n=this._calcColumnWidth(i,true,o);if(t.vertical){a=Math.max(n,a)}else{a+=n}},this);if(u=="descriptionOnly"){t.ownWidth=a}else{t.additionalWidth=a-t.ownWidth}}a=a+(i.gap||0);if(i.label){var p=t.label||t.fieldLabel||"";t.labelWidth=n=rt.calcHeaderWidth(p,i.truncateLabel!=false?a:0,s,r)}a=Math.max(r,a,n);a=Math.min(a,s)+i.padding;a=Math.round(a*100)/100;return a};At.prototype._fetchAutoColumnWidthConfig=function(t){var e=null;if(this._oCustomizeConfigAutoColumnWidth){if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty(t.name)){e=this._oCustomizeConfigAutoColumnWidth[t.name]}else if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty("*")){e=this._oCustomizeConfigAutoColumnWidth["*"]}}if(e&&e===true){e=null}return e};At.prototype._setWidthForCustomColumn=function(t){var e=t.data("p13nData");if(!this._oTableProvider||!e||!e.autoColumnWidth||t.getWidth()){return}var i=e.autoColumnWidth;var o=i.visibleProperty||typeof e.additionalProperty==="string";var a=i.visibleProperty||[this._getColumnLeadingProperty(t,e),e.additionalProperty].join(",");var n=a.split(",");var r=this._oTableProvider.getFieldMetadata(n.shift(),true);if(!r){return}var s=Object.assign({},r);s.label=this._getColumnLabel(t);if(o){s.additionalProperty=n?n.join(","):""}var l=this._calcColumnWidth(s,false,{truncateLabel:i.truncateLabel,min:i.min,max:i.max,gap:i.gap});r.width=l+"rem";t.setWidth(r.width);if(this.getEditable()){this._updateColumnWidthForEdit(t,r,i)}};At.prototype._updateColumnWidthForEdit=function(t,e){if(!e||!e.isColumnCreated||e.type=="Edm.Boolean"||e.semanticObjects){return}var i=this.data("useSmartField")=="true"||this.data("useSmartField")===true;if(i&&e["sap:updatable"]=="false"){return}var o=t.getWidth();if(!this.getEditable()){if(e.editWidth==o){t.setWidth(e.width)}}else if(e.width==o){if(e.editWidth){return t.setWidth(e.editWidth)}if(!this._aEditableColumnAdditionalWidth){var a=this._fColumnPaddingBorder;var n=this.$().closest(".sapUiSizeCompact").length?"_Compact":"";var r=parseFloat(ot.get({name:"_sap_m_InputBase"+n+"_IconWidth"}));a+=parseFloat(ot.get({name:"_sap_m_InputBaseWrapper_Sum_Border"}));a+=parseFloat(ot.get({name:"_sap_m_InputBase"+n+"_InnerPadding"}).split(" ").pop())*2;this._aEditableColumnAdditionalWidth=[a,a+r-.25]}var s=(e.displayBehaviour||"").includes("And");var l=(e.labelWidth||0)+this._fColumnPaddingBorder;if(i&&s&&e.additionalWidth&&e.hasValueListAnnotation&&!e.hasFixedValues){e.editWidth=Math.max(e.ownWidth+this._aEditableColumnAdditionalWidth[1],l)+"rem";return t.setWidth(e.editWidth)}var u=e.isCalendarDate||H.isDateOrTime(e.type);var h=e.hasValueListAnnotation||u;var d=this._aEditableColumnAdditionalWidth[+h];if(i&&s&&!e.additionalWidth&&e.hasValueListAnnotation&&e.hasFixedValues){d=Math.max(e.ownWidth+3+d,l)}else if(e.ownWidth<4||u){d+=e.ownWidth}else{d+=2}var p=parseFloat(o);if(p<d){e.editWidth=d+"rem";t.setWidth(e.editWidth)}}};At.prototype._updateVisibleColumnsWidthForEdit=function(){if(this._oTable&&this._oTableProvider&&this.getEnableAutoColumnWidth()){this._oTable.getColumns().forEach(function(t){if(t.getVisible()){var e=this._getColumnLeadingProperty(t);if(e){var i=this._oTableProvider.getFieldMetadata(e);i&&this._updateColumnWidthForEdit(t,i)}}},this)}};At.prototype._createColumn=function(t,e){var i=new B(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,label:new h(e+"-header",{textAlign:t.align,text:t.label}),sorted:t.sorted,sortOrder:t.sortOrder,tooltip:t.quickInfo,showSortMenuEntry:this._bUseColumnMenu?false:t.sortable&&this._bIsSortPanelEnabled,showFilterMenuEntry:this._bUseColumnMenu?false:t.filterable&&this._bIsFilterPanelEnabled,name:t.fieldName,template:t.template});if(!t.width&&this.getEnableAutoColumnWidth()){var o=this._fetchAutoColumnWidthConfig(t);i.setWidth(this._calcColumnWidth(t,false,o)+"rem")}return i};At.prototype._createAnalyticalColumn=function(t,e){if(t.aggregationRole!=="measure"&&t.isMeasureField&&t.unit&&t.template.addStyleClass){t.template.addStyleClass("sapUiAnalyticalTableSumCellHidden sapUiAnalyticalTableGroupCellHidden")}else if(t.isCurrencyField&&t.template.addStyleClass){t.template.addStyleClass("sapUiCompCurrencyBold")}var i=this.getModel(),o=i&&i.getMetaModel();var a=new A(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,inResult:t.inResult,label:new h(e+"-header",{textAlign:t.align,text:t.label}),tooltip:t.quickInfo,sorted:t.sorted,sortOrder:t.sortOrder,grouped:t.grouped,showIfGrouped:t.grouped,showSortMenuEntry:this._bUseColumnMenu?false:t.sortable&&this._bIsSortPanelEnabled,showFilterMenuEntry:this._bUseColumnMenu?false:t.filterable&&this._bIsFilterPanelEnabled,summed:t.summed,leadingProperty:t.name,template:t.template,groupHeaderFormatter:R.getInlineGroupFormatterFunction(t,true,this._getDateFormatSettings(),this._bPreserveDecimals,true,o)});if(!t.width&&this.getEnableAutoColumnWidth()){var n=this._fetchAutoColumnWidthConfig(t);a.setWidth(this._calcColumnWidth(t,false,n)+"rem")}return a};At.prototype._createMobileColumn=function(e,i){var o=new l(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new h(i+"-header",{textAlign:e.align,text:e.label,tooltip:e.quickInfo,wrapping:!this.getEnableAutoColumnWidth(),wrappingType:t.WrappingType.Hyphenated}),tooltip:e.quickInfo});if(e.importance&&!this._oTableProvider.isLineItemDefaultImportance(e)){o.setImportance(e.importance)}if(this._oTemplate){this._oTemplate.addCell(e.template)}if(e.width){return o.setWidth(e.width)}if(!this.getEnableAutoColumnWidth()){return o.setWidth(e.isImageURL?"3em":"auto")}var a=this._fetchAutoColumnWidthConfig(e);return o.setWidth(this._calcColumnWidth(e,false,a)+"rem")};At.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}return this._oCurrentVariant};At.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true)}if(this._oPersController){if(this._oCurrentVariant===null||jQuery.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization("ResetFull")}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()})};At.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};At.prototype.getUiState=function(){var t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new W({presentationVariant:{SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getRequestAtLeastFields(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId()})};At.prototype.setUiState=function(t){this._setUiState(t,false)};At.prototype.setUiStateAsVariant=function(t){this._setUiState(t,true)};At.prototype._setUiState=function(t,e){var i=t.getPresentationVariant()&&t.getPresentationVariant().RequestAtLeast?[].concat(t.getPresentationVariant().RequestAtLeast):[];if(!G(i,this._getRequestAtLeastFields())){this._aAlwaysSelect=i}if(this._oPersController){if(e){this._oPersController.setPersonalizationDataAsDataSuiteFormat(Q({},t.getPresentationVariant(),t.getSelectionVariant()),true)}else{var o=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};this._oPersController.setDataSuiteFormatSnapshot(Q({},t.getPresentationVariant(),t.getSelectionVariant()),o,true)}}};At.prototype._getRequestAtLeastFields=function(){var t=this.getRequestAtLeastFields();var e=t?t.split(","):[];return e.concat(this._aAlwaysSelect)};At.prototype._personalisationRequestColumns=function(t){var e=t.getParameter("columnKeys"),i,o,a,n,r,s={};a=e.length;for(o=0;o<a;o++){i=e[o];n=this._mLazyColumnMap[i];if(n){r=this._createColumnForField(n);if(this._isMobileTable){this._oTable.addColumn(r)}s[n.name]=r}}this._oPersController.addColumns(s)};At.prototype._beforePersonalisationModelDataChange=function(t){if(this._oTable.suspendUpdateAnalyticalInfo){this._oTable.suspendUpdateAnalyticalInfo()}};At.prototype._afterPersonalisationModelDataChange=function(t){this._updateColumnsPopinFeature();if(this.getEditable()){this._updateVisibleColumnsWidthForEdit()}};At.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i==="Unchanged"){return}if(!(this._bApplyingVariant||this._bDeactivatingColumns)){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}if(this._isTableBound()){if(i==="ModelChanged"){if(e&&e.columns==="ModelChanged"){this._bForceTableUpdate=true;var o;if(this._isMobileTable&&this._oTable.getHiddenInPopin()){o=t.getParameter("runtimeDeltaData").columns.columnsItems.some(function(t){return t.visible&&this._oTable.getHiddenInPopin().includes(this._getColumnByKey(t.columnKey).getImportance())},this)}if(o){this._toggleShowHideDetails(false)}}if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindTable(null)}}else if(i==="TableChanged"&&this._isMobileTable&&this.getEditable()){this._updateMobileHiddenCellBindingContext(t)}}if(this._isMobileTable){this._adaptCustomSort()}this._createInfoToolbar();this.fireUiStateChange()};At.prototype._updateMobileHiddenCellBindingContext=function(t){var e=i.getMessageManager().getMessageModel().getData();if(!e.length){return}var o=e.filter(function(t){return t.validation===true});if(!o.length){return}var a=t.getParameter("runtimeDeltaData").columns.columnsItems.filter(function(t){return t.visible===false});a.forEach(function(t){var o=this._getColumnByKey(t.columnKey),a=this._oTemplate.getCells()[this._oTable.indexOfColumn(o)],n;if(a.isA("sap.ui.comp.SmartToggle")){var r=a.getEdit();n=r.getId()}else{n=a.getId()}if(n){var s=e.find(function(t){var e=t.getControlId();if(e){return e.includes(n)}});if(s){var l=i.byId(s.getControlId());if(l){l.setBindingContext(null)}}}},this)};At.prototype._adaptCustomSort=function(){if(this._oCurrentVariant){var t,i,o,a=[],n;if(this._oCurrentVariant.sort&&this._oCurrentVariant.sort.sortItems){a=this._oCurrentVariant.sort.sortItems}this._oTable.getColumns().forEach(function(r){t=r.data("p13nData");i=t&&t.columnKey;if(i){o=a.filter(function(t){return i===t.columnKey});n=o[0];if(n){if(!t.sorted){t.sorted={ascending:false}}if(n.operation===Et.None){delete t.sorted}else{t.sorted={ascending:n.operation!==Et.Descending}}r.setSortIndicator(n.operation)}else if(t&&t.sorted){t.sorted=null;r.setSortIndicator(e.None)}}else if(r.getSortIndicator()!==Et.None){r.setSortIndicator(Et.None)}},this)}};At.prototype.setUseInfoToolbar=function(t){this.setProperty("useInfoToolbar",t,true);if(this.getTable()){this._createInfoToolbar()}return this};At.prototype._updateInfoToolbar=function(t,e){if(!this._oInfoToolbar){this._oInfoToolbar=new g({active:true,visible:true,design:Pt.Info,content:[new f({id:this.getId()+"-infoToolbarText",text:t,wrapping:false})],press:[e,this._handleInfoToolbarPress,this]})}else{this._oInfoToolbar.setVisible(true);this._oInfoToolbar.getContent()[0].setText(t);this._oInfoToolbar.detachPress(this._handleInfoToolbarPress,this);this._oInfoToolbar.attachPress(e,this._handleInfoToolbarPress,this)}};At.prototype._handleInfoToolbarPress=function(t,e){this._showTableFilterDialog(e)};At.prototype._createInfoToolbar=function(){var t=this.getUseInfoToolbar(),e=this.getTable(),o=this.getId()+"-infoToolbarText",n,r=i.getLibraryResourceBundle("sap.ui.comp");if(t===xt.Off){if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}return}if(this._isMobileTable){if(e.getInfoToolbar()&&!this._oInfoToolbar){z.error("Custom infoToolbar is used, hence set useInfoToolbar property on the SmartTable with id='"+this.getId()+"' to Off");return}var s=this._oCurrentVariant&&this._oCurrentVariant.filter&&this._oCurrentVariant.filter.filterItems,l=s&&s.length;if(l){var u=[],h=a.getInstance();s.forEach(function(t){var e=this._getColumnLabel(t.columnKey);if(e&&u.indexOf(e)===-1){u.push(e)}},this);var d=r.getText("SMARTTABLE_INFOTOOLBAR_FILTER"+(u.length>1?"S":"")+"_ACTIVE",[u.length,h.format(u)]);n=this._getColumnByKey(s[0].columnKey);this._updateInfoToolbar(d,n);if(!e.getInfoToolbar()){e.setInfoToolbar(this._oInfoToolbar)}if(e.getAriaLabelledBy().indexOf(o)===-1){e.addAriaLabelledBy(o)}}else if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}}else if(this._oInfoToolbar){this._oInfoToolbar.setVisible(false)}};At.prototype._getChangeStatus=function(t){if(!t){return"ModelChanged"}if(t.sort==="ModelChanged"||t.filter==="ModelChanged"||t.columns==="ModelChanged"||t.group==="ModelChanged"){return"ModelChanged"}if(t.sort==="TableChanged"||t.filter==="TableChanged"||t.columns==="TableChanged"||t.group==="TableChanged"){return"TableChanged"}return"Unchanged"};At.prototype._getDateFormatSettings=function(){if(this._oTableProvider&&this._oTableProvider._oDateFormatSettings){return this._oTableProvider._oDateFormatSettings}return undefined};At.prototype._getTablePersonalisationData=function(){this._mSelectExpandForGroup=null;if(!this._oCurrentVariant){return null}var t=[],e=[],i=[],o,a,n,l,u,h,d,p,f,_,g={},c={},m="",b;if(this._isMobileTable&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){a=this._oCurrentVariant.group.groupItems[0];if(this._aDeactivatedColumns.indexOf(a.columnKey)<0){u=this._getColumnByKey(a.columnKey);if(u){m=u.getHeader().getText()}_=this._getPathFromColumnKeyAndProperty(a.columnKey,"sortProperty")}if(_){d=_;p=null;var T=this._mFieldMetadataByKey[a.columnKey],y;if(T){p=T.unit||T.description;var C=this.getModel(),S=C&&C.getMetaModel();y=R.getInlineGroupFormatterFunction(T,false,this._getDateFormatSettings(),this._bPreserveDecimals,true,S)}n=new I(d,a.operation==="GroupDescending",function(t){var e=t.getProperty(d),i;if(y){if(p){i=t.getProperty(p)}e=y(e,i)}if(e===undefined||e===null){e=""}return{key:e,text:m?m+": "+e:e}});this._mSelectExpandForGroup={select:[d]};if(T){if(T.additionalProperty){this._mSelectExpandForGroup.select.push(T.additionalProperty)}if(T.navigationProperty){this._mSelectExpandForGroup.expand=[T.navigationProperty]}}t.push(n)}}if(this._oCurrentVariant.sort){l=this._oCurrentVariant.sort.sortItems}else{l=this._aInitialSorters}if(l){l.forEach(function(e,i){var o=e.operation==="Descending";_=null;f=null;if(this._aDeactivatedColumns.indexOf(e.columnKey)<0){_=this._getPathFromColumnKeyAndProperty(e.columnKey,"sortProperty");if(!_&&e.initiallyNotVisibleColumn){_=e.columnKey}}if(_){if(n&&n.sPath===_){n.bDescending=o}else{var a=this._mFieldMetadataByKey[e.columnKey];if(!a){u=this._getColumnByKey(e.columnKey);h=u.data("p13nData")}if(this._bMultiUnitBehaviorEnabled&&(a&&a.isCurrencyField||h&&h.isCurrency)){f=a?a.unit:h.unit;if(f&&!g[f]){g[f]={index:i,descending:o}}}c[_]={};if(c[f]){delete g[f]}else if(g[_]){delete g[_]}t.push(new I(_,o))}}},this);var v=Object.keys(g),P;if(v.length){v.reverse().forEach(function(e){P=n?g[e].index+1:g[e].index;t.splice(P,0,new I(e,g[e].descending))})}}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(t){var o=t.value1,a=t.value2,n;_=null;b=false;u=null;if(this._aDeactivatedColumns.indexOf(t.columnKey)<0){u=this._getColumnByKey(t.columnKey)}if(u){if(u.getFilterProperty){_=u.getFilterProperty()}h=u.data("p13nData");if(h){b=h.type==="time";if(!_){_=h["filterProperty"]}}}if(_){if(b){if(o instanceof Date){o=R.getEdmTimeFromDate(o)}if(a instanceof Date){a=R.getEdmTimeFromDate(a)}}else{var l=h&&h.typeInstance&&h.typeInstance.getName()==="sap.ui.model.odata.type.DateTimeOffset";if(o instanceof Date&&!l&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){o=r.localToUtc(o);a=a?r.localToUtc(a):a}}var d=t.exclude?i:e;if(t.operation==="Empty"){var p=t.exclude?M.NE:M.EQ,f=false,g=false,c=this._oTableProvider&&this._oTableProvider.getFieldMetadata(_);if(h.nullable===true||h.nullable==="true"){g=true}else if(h.nullable===undefined&&c&&c.nullable!=="false"){g=true}if(h.edmType==="Edm.String"||h.type==="string"){f=true}else if(!h.edmType&&!h.type&&c&&c.type==="Edm.String"){f=true}if(f){d.push(new E(_,p,""))}if(g){d.push(new E(_,p,null))}}else{n=t.exclude?s.getTransformedExcludeOperation(t.operation):t.operation;d.push(new E(_,n,o,a))}}},this);if(i.length){o=new E(i,true)}}return{filters:e,excludeFilters:o,sorters:t}};At.prototype._getColumnByKey=function(t){var e,i,o,a,n;if(this._oTable){e=this._oTable.getColumns();o=e.length;for(a=0;a<o;a++){i=e[a];n=i.data("p13nData");if(n&&n.columnKey===t){return i}}}return null};At.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,o,a;o=this._getColumnByKey(t);if(o){if(e=="sortProperty"&&o.getSortProperty){i=o.getSortProperty()}else if(e=="filterProperty"&&o.getFilterProperty){i=o.getFilterProperty()}else if(e=="leadingProperty"&&o.getLeadingProperty){i=o.getLeadingProperty()}if(!i){a=o.data("p13nData");if(a){i=a[e]}}}return i};At.prototype._persistPersonalisation=function(){if(!i.getConfiguration().getDesignMode()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var t=this.getCurrentVariantId();if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:"Personalisation",implicit:true,global:false,overwrite:!!t,key:t,def:true});delete this._bSaving}}};At.prototype.getCurrentVariantId=function(){return this._oVariantManagement?this._oVariantManagement.getCurrentVariantId():""};At.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{z.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist, or is a page variant")}return this};At.prototype.setDetailsButtonSetting=function(t){this.setProperty("detailsButtonSetting",t,true);return this};At.prototype.setEnablePaste=function(t){this.setProperty("enablePaste",t,true);var e=i.byId(this.getId()+"-btnPaste");if(e){e.setEnabled(this.getEnablePaste())}return this};At.prototype.isInitialised=function(){return!!this.bIsInitialised};At.prototype._aAvailablePanels=["Columns","Sort","Filter","Group"];At.prototype.openPersonalisationDialog=function(t){if(!t||this._aAvailablePanels.indexOf(t)<0){z.warning("sap.ui.comp.smarttable.SmartTable.prototype.openPersonalisationDialog: "+t+" is not a valid panel!");return}if(this._oPersController){var e={};e[t.toLowerCase()]={visible:true};this._oPersController.openDialog(e)}};At.prototype.deactivateColumns=function(t){this._aDeactivatedColumns=t||[];this._bDeactivatingColumns=true;if(this._oPersController){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}this._bDeactivatingColumns=false};At.prototype.getDeactivatedColumns=function(){return this._aDeactivatedColumns?this._aDeactivatedColumns.slice():[]};At.prototype._onInnerTablePaste=function(t){if(!this.getEnablePaste()||!this.hasListeners("beforePaste")&&!this.hasListeners("paste")){return}var e=t.getParameter("data");var i=e.slice(0);var o=this._getColumnInfoForPaste();if(this.fireBeforePaste({columnInfos:o})){sap.ui.require(["sap/ui/core/util/PasteHelper"],function(t){t.parse(i,o).then(function(t){this.firePaste({result:t})}.bind(this))}.bind(this))}};At.prototype._getColumnInfoForPaste=function(){var t=[],e=[],i=this._oTable.getColumns(),o,a=i.length,n,r,s,l,u,h;if(this._isMobileTable&&i.length){i=i.sort(function(t,e){return t.getOrder()-e.getOrder()})}for(o=0;o<a;o++){n=i[o];s=null;h=null;u=null;if(n.getVisible()){r=n.data("p13nData");s=this._getColumnLeadingProperty(n,r);l=r.type==="numeric"?"number":r.type;if(r.type==="date"){var d=this._getDateFormatSettings();if(d&&d["UTC"]){var p={displayFormat:"Date"};u=H.getType("Edm.DateTime",d,p)}}if(!u){u=r["typeInstance"]}if(r.isCurrency||l==="number"){h=r.unit}else if(r.description&&r.displayBehaviour!=="idOnly"){h=r.description}}var f={columnId:n.getId(),property:s,ignore:!s,type:u};if(s){t.push(f)}else{e.push(f)}u=H.getType("Edm.String");if(h){t.push({columnId:n.getId(),additionalProperty:true,property:h,type:u})}}return t.concat(e)};At.prototype.exit=function(){var t,e;this.detachEvent("_change",this._onPropertyChange,this);if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter=null}if(this._oTableProvider&&this._oTableProvider.destroy){this._oTableProvider.destroy()}this._oTableProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy()}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oNumberFormatInstance=null;O.cleanUpFullScreen(this);if(this._oEditModel){this._oEditModel.destroy()}if(this._oNoData&&this._oNoData.destroy){this._oNoData.destroy()}this.oNoData=null;if(this._aTableViewMetadata){t=this._aTableViewMetadata.length;while(t--){e=this._aTableViewMetadata[t];if(e&&!e.isColumnCreated&&e.template){e.template.destroy()}}}if(this._oShowHideDetailsButton){this._oShowHideDetailsButton.destroy()}this._oShowHideDetailsButton=null;this._aTableViewMetadata=null;this._mFieldMetadataByKey=null;this._mSelectExpandForGroup=null;this._oEditModel=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._aExistingColumns=null;this._mLazyColumnMap=null;this._aColumnKeys=null;this._aDeactivatedColumns=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;if(this._oToolbar&&!this._bToolbarInsertedIntoItems){this._oToolbar.destroy()}this._oToolbar=null;if(this._oExportButton){this._oExportButton.destroy()}this._oExportButton=null;if(this._oExportHandler){this._oExportHandler.destroy()}this._oExportHandler=null;this._oTablePersonalisationButton=null;this._oP13nDialogSettings=null;if(this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;if(this._oColumnHeaderPopover){this._oColumnHeaderPopover.destroy()}this._oColumnHeaderPopover=null;this._oFilterButton=null;this._aSortButton=null;this._oInfoToolbar=null;this._oTableReady=null;this._oView=null;this._oTable=null};return At});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/flexibility/ToolbarContentMove", ["sap/ui/core/CustomData","sap/ui/fl/changeHandler/condenser/Classification","./Utils"],function(e,t,n){"use strict";function o(e,t,n,o){return new Promise(function(r,a){var i=[];for(var u=0;u<t.length;u++){i.push(e.getProperty(t[u],n))}Promise.all(i).then(function(e){var n=[];for(var a=0;a<e.length;a++){if(e[a]==o){n.push(t[a])}}r(n)})})}function r(e,t,r,a){return new Promise(function(i,u){var s=a?e.getRevertData():e.getContent();var f=r.modifier;f.getAggregation(t,"customData").then(function(u){o(f,u,"key","p13nData_ToolbarContentMove").then(function(o){var u=function(n){f.setProperty(n,"value",s);if(a){e.resetRevertData()}if(t._applyToolbarContentOrder){t._applyToolbarContentOrder()}i()};var l=o.length>0?o[0]:null;if(!l){f.createControl("sap.ui.core.CustomData",r.appComponent,r.view,"testid",{key:"p13nData_ToolbarContentMove",value:null}).then(function(e){var n=f.insertAggregation(t,"customData",e,0,r.view);if(!(n instanceof Promise)){n=Promise.resolve()}n.then(function(){u(e)})})}else{f.getProperty(l,"value").then(function(t){if(!a){e.setRevertData(n.parseChangeContent(t))}u(l)})}})})})}return{applyChange:function(e,t,n){return r(e,t,n,false)},revertChange:function(e,t,n){return r(e,t,n,true)},completeChangeContent:function(e,t,n){},getCondenserInfo:function(e,n){return{affectedControl:e.getSelector(),classification:t.LastOneWins,uniqueKey:"p13nData_ToolbarContentMove"}}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/flexibility/Utils", ["sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t){"use strict";var n={getAppComponentForControl:function(t){return e.getAppComponentForControl(t)},getSelectorForControl:function(e,o){if(!o&&!(o===null)){o=n.getAppComponentForControl(e)}return t.getSelector(e,o)},parseChangeContent:function(e,t){if(typeof e==="string"){try{e=e.replace(/(\\{)/g,"{").replace(/(\\})/g,"}");e=JSON.parse(e);if(t){t(e)}}catch(t){e=null}}return e}};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/PersonalizableInfo", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var t=a.extend("sap.ui.comp.smartvariants.PersonalizableInfo",{metadata:{library:"sap.ui.comp",properties:{type:{type:"string",group:"Misc",defaultValue:null},dataSource:{type:"string",group:"Misc",defaultValue:null},keyName:{type:"string",group:"Misc",defaultValue:null}},associations:{control:{type:"sap.ui.core.Control",multiple:false}}}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagement", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/comp/variants/VariantItem","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/MetadataAnalyser","./SmartVariantManagementAdapter","./SmartVariantManagementBase","sap/base/Log","sap/base/util/merge","sap/ui/base/SyncPromise"],function(jQuery,t,e,i,a,n,r,o,s,l){"use strict";var h;var p;var f;var d=r.extend("sap.ui.comp.smartvariants.SmartVariantManagement",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagement.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null}},aggregations:{personalizableControls:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:true,singularName:"personalizableControl"}},events:{initialise:{},save:{parameters:{tile:{type:"boolean"},name:{type:"string"}}},afterSave:{}}},renderer:{apiVersion:2}});d.prototype.init=function(){r.prototype.init.apply(this);this._bIsInitialized=false;this._bIsVariantAdaptationEnabled=false;this._oStandardVariant=null;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this._oControlPromise=null;this._oPersoControl=null;this._sAppStandardVariantKey=null;this._oSelectionVariantHandler={};this._oAppStdContent=null;this._aPersonalizableControls=[];this._oAdapter=null;this._bApplyingUIState=false;this._mVariants={};this._loadFlex()};d.prototype.setEntitySet=function(t){this.setProperty("entitySet",t,true);this.attachModelContextChange(this._initializeMetadata,this);this._createMetadataPromise();this._initializeMetadata();return this};d.prototype._createMetadataPromise=function(){this._oMetadataPromise=new Promise(function(t,e){this._fResolveMetadataPromise=t}.bind(this))};d.prototype._resolveMetadataPromise=function(){if(this._fResolveMetadataPromise){this._fResolveMetadataPromise()}};d.prototype._initializeMetadata=function(){if(!this.bIsInitialised){i.handleModelInit(this,this._onMetadataInitialised)}};d.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){var t=new a(this.getModel());if(t){this._oAdapter=new n({selectionPresentationVariants:t.getSelectionPresentationVariantAnnotationList(this.getEntitySet())});this.detachModelContextChange(this._initializeMetadata,this);this.bIsInitialised=true;this._resolveMetadataPromise()}}};d.prototype.applySettings=function(t){if(!t||!t.hasOwnProperty("useFavorites")){this.setUseFavorites(true)}r.prototype.applySettings.apply(this,arguments)};d.prototype._createControlWrapper=function(t){var e=null;var i=sap.ui.getCore().byId(t.getControl());if(i){e={control:i,type:t.getType(),dataSource:t.getDataSource(),keyName:t.getKeyName(),loaded:jQuery.Deferred()}}return e};d.prototype._getControlWrapper=function(t){var e=this._getAllPersonalizableControls();if(e&&e.length){for(var i=0;i<e.length;i++){if(e[i].control===t){return e[i]}}}return null};d.prototype.addPersonalizableControl=function(t){var e,i=t.getControl();var a=sap.ui.getCore().byId(i);if(!a){o.error("couldn't obtain the control with the id="+i);return this}this.addAggregation("personalizableControls",t,true);e=this._createControlWrapper(t);if(e){this._aPersonalizableControls.push(e)}if(this.isPageVariant()){return this}this.setPersControler(a);return this};d.prototype._loadFlex=function(){var t=function(){return new Promise(function(t){sap.ui.require(["sap/ui/fl/apply/api/SmartVariantManagementApplyAPI","sap/ui/fl/write/api/SmartVariantManagementWriteAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(e,i,a){h=e;p=i;f=a;t()})})};if(!this._oFlLibrary){if(!this._oPersistencyPromise){this._oPersistencyPromise=new Promise(function(t,e){this._fResolvePersistencyPromise=t;this._fRejectPersistencyPromise=e}.bind(this))}this._oFlLibrary=new Promise(function(e){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){t().then(e)})})}return this._oFlLibrary};d.prototype.setPersControler=function(t){if(h&&p&&f){this._setPersControler(t)}else{this._loadFlex().then(function(){this._setPersControler(t)}.bind(this))}};d.prototype._setPersControler=function(t){if(!this._oPersoControl){if(this._isFlexSupported(t)){this._oPersoControl=t;this._handleGetChanges(t)}}};d.prototype._isFlexSupported=function(t){return f.isFlexSupported({element:t})};d.prototype.setPersistencyKey=function(t){this.setProperty("persistencyKey",t);this.setPersControler(this);return this};d.prototype.isPageVariant=function(){if(this.getPersistencyKey()){return true}return false};d.prototype._getAdapter=function(){return this._oAdapter};d.prototype._getFilterBarAdapter=function(){return this._oSelectionVariantHandler["#"]};d.prototype._handleGetChanges=function(t){if(t&&h){this._oControlPromise=new Promise(function(t,e){Promise.all([this._oMetadataPromise]).then(function(){if(this._bIsBeingDestroyed){return}var i={control:this._oPersoControl,standardVariant:{id:this.STANDARDVARIANTKEY,name:this._determineStandardVariantName(),executeOnSelection:this.bExecuteOnSelectForStandardViaXML}};if(this._getAdapter()){i.variants=this._getAdapter().getODataVariants()}else if(this._getFilterBarAdapter()){i.variants=this._getFilterBarAdapter().variants}h.loadVariants(i).then(function(e){this._fResolvePersistencyPromise();t(e)}.bind(this),function(t){this._fRejectPersistencyPromise(t);e(t)}.bind(this))}.bind(this))}.bind(this))}};d.prototype._getVariantById=function(t){if(this._mVariants&&this._mVariants[t]){return this._mVariants[t]}return null};d.prototype.getVariantContent=function(t,e){var i,a=this._getVariantContent(e);if(a&&this.isPageVariant()&&t){i=this._getControlPersKey(t);if(i){a=this._retrieveContent(a,i)}}return a};d.prototype._getContent=function(t){return t.getContent()};d.prototype._getVariantContent=function(t){var e=this._getVariantById(t);if(e){var i=this._getContent(e);if(i){if(t===this.STANDARDVARIANTKEY&&Object.keys(i).length<1){i=this.getStandardVariant()}return s({},i)}}return null};d.prototype._getAllPersonalizableControls=function(){return this._aPersonalizableControls};d.prototype.removeAllPersonalizableControls=function(){this.removeAllAggregation("personalizableControls");this._aPersonalizableControls=[]};d.prototype.removePersonalizableControl=function(t){var e=this.removeAggregation("personalizableControls",t);if(e){this._aPersonalizableControls.some(function(t,i){if(t.control.getId()===e.getControl()){this._aPersonalizableControls.splice(i,1);return true}return false}.bind(this))}return e};d.prototype.removePersonalizableControlById=function(t){var e=this.getAggregation("personalizableControls");if(e){e.some(function(e,i){if(e.getControl()===t.getId()){this.removePersonalizableControl(e);return true}return false}.bind(this))}};d.prototype._variantItemChange=function(t){var e,i,a;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){a=t.oSource;if(a.getKey()!==this.STANDARDVARIANTKEY){i=t.getParameter("propertyName");if(i==="text"){this.removeVariantItem(a);e=this._getIdxSorted(a.getText());this.insertVariantItem(a,e)}}}};d.prototype._createVariantItem=function(t){var i=0;this._mVariants[t.getVariantId()]=t;var a=new e({key:t.getVariantId(),global:!t.isUserDependent(),lifecycleTransportId:t.getRequest(),lifecyclePackage:t.getPackage(),namespace:t.getNamespace(),readOnly:!t.isEditEnabled(),labelReadOnly:!t.isRenameEnabled(),executeOnSelection:t.getExecuteOnSelection(),text:t.getName(),title:t.getName(),originalTitle:t.getName(),author:t.getOwnerId(),sharing:t.isUserDependent()?"private":"public",remove:t.isDeleteEnabled(),favorite:t.getFavorite(),originalFavorite:t.getFavorite(),executeOnSelect:t.getExecuteOnSelection(),originalExecuteOnSelect:t.getExecuteOnSelection(),rename:t.isRenameEnabled(),contexts:t.getContexts(),originalContexts:t.getContexts(),changeable:t.isEditEnabled(),visible:true});a.attachChange(this._variantItemChange.bind(this));if(t.getVariantId()===this.STANDARDVARIANTKEY){a.setAuthor(this.getStandardItemAuthor())}else{i=this._getIdxSorted(t.getName())}this.insertVariantItem(a,i)};d.prototype._createVariantEntries=function(t){this.removeAllVariantItems();if(t){if(t.standardVariant){this._createVariantItem(t.standardVariant);var e=this._getVariantContent(t.standardVariant.getVariantId());if(Object.keys(e).length>0){this._sAppStandardVariantKey=t.standardVariant.getVariantId();if(this._sAppStandardVariantKey!==this.STANDARDVARIANTKEY){this.setStandardVariantKey(this._sAppStandardVariantKey)}}}if(t.variants){t.variants.forEach(function(t){this._createVariantItem(t)}.bind(this))}this._checkUpdate()}if(this._oPersoControl){if(h&&h.isVariantDownport()){this._enableManualVariantKey(true)}}};d.prototype._addFavorites=function(t){t.forEach(function(t){if(t.key!==this.STANDARDVARIANTKEY){var e=this._getVariantById(t.key);if(e){this._flUpdateVariant(e,{favorite:t.visible})}}}.bind(this))};d.prototype._flUpdateVariant=function(t,e){var i;var a={control:this._oPersoControl,id:t.getVariantId()};if(e.hasOwnProperty("content")||e.hasOwnProperty("name")){var n=s({},a);n.layer=t.getLayer();if(e.hasOwnProperty("content")){n.content=e.content}if(e.hasOwnProperty("name")){n.name=e.name}if(e.hasOwnProperty("packageName")){n.packageName=e.packageName}if(e.hasOwnProperty("transportId")){n.transportId=e.transportId}i=this._flWriteUpdateVariant(n);if(i){this._mVariants[i.getVariantId()]=i}}a={control:this._oPersoControl,id:t.getVariantId()};if(e.hasOwnProperty("favorite")||e.hasOwnProperty("executeOnSelection")){a.isUserDependent=true;if(e.hasOwnProperty("favorite")){a.favorite=e.favorite}if(e.hasOwnProperty("executeOnSelection")){a.executeOnSelection=e.executeOnSelection}i=this._flWriteUpdateVariant(a);if(i){this._mVariants[i.getVariantId()]=i}}};d.prototype._flRemoveVariant=function(t){var e={control:this._oPersoControl,id:t.getVariantId(),layer:t.getLayer()};var i=this._flWriteRemoveVariant(e);if(i){delete this._mVariants[i.getVariantId()]}};d.prototype._flWriteUpdateVariant=function(t){if(p){return p.updateVariant(t)}return null};d.prototype._flWriteRemoveVariant=function(t){if(p){return p.removeVariant(t)}return null};d.prototype._flWriteAddVariant=function(t){if(p){return p.addVariant(t)}return null};d.prototype.flWriteOverrideStandardVariant=function(t){if(p){p.overrideStandardVariant({control:this._oPersoControl,executeOnSelection:t})}};d.prototype.getCurrentVariantId=function(){if(this._bDuringVariantCreation){return"SV1656651501366"}var t=this.getCurrentVariantKey();if(t===this.STANDARDVARIANTKEY){t=""}return t};d.prototype.clearVariantSelection=function(){this.setSelectionKey(this.getStandardVariantKey())};d.prototype.setCurrentVariantId=function(t,e){var i;if(this._oPersoControl){i=this._determineVariantId(t);this.setCurrentVariantKey(i);if(this._oStandardVariant){this.setModified(false);if(!e){this._triggerSelectVariant(i,"SET_VM_ID")}}}};d.prototype._determineVariantId=function(t){var e=t;if(!e||!this.getItemByKey(e)){e=this.getStandardVariantKey()}return e};d.prototype.initialise=function(t,e){var i,a;try{if(e&&t){i=this._getControlWrapper(e);if(!i){o.error("initialise on an unknown control.");return}if(i.bInitialized){o.error("initialise on "+e.getId()+" already executed");return}i.fInitCallback=t}else if(!this.isPageVariant()){i=this._getControlWrapper(this._oPersoControl)}if(this._oPersistencyPromise){this._oPersistencyPromise.then(function(){if(this._oControlPromise&&this._oPersoControl&&i){Promise.all([this._oMetadataPromise,this._oControlPromise,p.isVariantSharingEnabled(),p.isVariantPersonalizationEnabled(),p.isVariantAdaptationEnabled()]).then(function(t){this._dataReceived(t[1],t[2],t[3],t[4],i)}.bind(this),function(i){a="'loadVariants' failed:";if(i&&i.message){a+=" "+i.messages}this._errorHandling(a,t,e)}.bind(this),function(i){if(i&&i.message){a=i.message}else{a="accessing either flexibility functionality or odata metadata."}this._errorHandling("'initialise' failed: "+a,t,e)}.bind(this))}else{this._errorHandling("'initialise' no personalizable component available",t,e)}}.bind(this),function(i){if(i&&i.message){a=i.message}else{a="accessing the flexibility functionality."}this._errorHandling("'initialise' failed: "+a,t,e)}.bind(this))}else{this._errorHandling("'initialise' no '_oPersistencyPromise'  available",t,e)}}catch(i){this._errorHandling("exception occurs during 'initialise' processing",t,e)}};d.prototype._errorHandling=function(t,e,i){var a={variantKeys:[]};this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),t);if(e&&i){e.call(i)}else{this.fireEvent("initialise",a)}if(i.variantsInitialized){i.variantsInitialized()}};d.prototype.isVariantAdaptationEnabled=function(){return this._bIsVariantAdaptationEnabled};d.prototype._dataReceived=function(t,e,i,a,n){var r,o,s={variantKeys:[]};if(this._bIsBeingDestroyed){return}if(!this._bIsInitialized){this._bIsVariantAdaptationEnabled=a;this.setVariantCreationByUserAllowed(i);this.setShowShare(e);this._bIsInitialized=true;this._createVariantEntries(t);o=this._getDefaultVariantKey();if(!o||!this._getVariantById(o)&&o.substring(0,1)!=="#"){o=this.getStandardVariantKey()}r=this._getVariantById(o);if(r){this.setDefaultVariantKey(o);this.setSelectionKey(o)}if(this._sAppStandardVariantKey){this._oAppStdContent=this._getVariantContent(this._sAppStandardVariantKey)}}this._initialize(s,n)};d.prototype._initialize=function(t,e){var i,a=null,n=this.isPageVariant();var r,s=false;if(this._oAppStdContent){if(e.type==="table"||e.type==="chart"){if(n){this._applyControlVariant(e.control,this._oAppStdContent,"STANDARD",true)}else{this._applyVariant(e.control,this._oAppStdContent,"STANDARD",true)}}}if(e.fInitCallback){e.fInitCallback.call(e.control);delete e.fInitCallback;e.bInitialized=true}else{t.variantKeys=Object.keys(this._mVariants);this.fireEvent("initialise",t)}i=this.getCurrentVariantKey();if(i&&i!==this.getStandardVariantKey()){a=this._getVariantContent(i);r=this._getVariantById(i);if(r){s=r.getExecuteOnSelection()}}else if(this._oAppStdContent){a=this._oAppStdContent;if(e.type==="table"||e.type==="chart"){a=null}}var h;if(this._sAppStandardVariantKey){h=this._updateStandardVariant(e,this._oAppStdContent)}else{h=this._setStandardVariant(e)}l.resolve(h).then(function(t){e.loaded.resolve();if(a){if(this._getAdapter()&&i.substring(0,1)==="#"&&Object.entries(a).length===0){this._applyUiState(i,"INIT",s)}else{if(n){this._applyControlVariant(e.control,a,"INIT",true,s)}else{this._applyVariant(e.control,a,"INIT",true,s)}}}if(this.bConsiderXml!==undefined){this._executeOnSelectForStandardVariantByXML(this.bConsiderXml)}if(e.control.variantsInitialized){e.control.variantsInitialized()}if(this.getCurrentVariantKey()===this.getStandardVariantKey()){if(this._getApplyAutomaticallyOnStandardVariant()&&e.control.search){e.control.search()}if(this.getExecuteOnSelectForStandardVariant()&&this._oAppStdContent){var r=this.getItemByKey(this.getCurrentVariantKey());if(r){r.setExecuteOnSelection(true)}}}if(!this.getEnabled()){this.setEnabled(true)}}.bind(this)).catch(function(t){o.error("'_initialize' throws an exception:"+t.message)}).unwrap()};d.prototype._updateVariant=function(t){return l.resolve(this._fetchContentAsync()).then(function(e){if(t.key!==this.getStandardVariantKey()){var i=this._getVariantById(t.key);if(i){if(e){var a=this.getItemByKey(t.key);var n={content:e};if(i.getPackage()){n.transportId=i.getPackage()}if(i.getRequest()){n.packageName=i.getRequest()}if(a){n.executeOnSelection=a.getExecuteOnSelection()}this._flUpdateVariant(i,n);if(t.def===true){this._setDefaultVariantKey(t.key)}}this._afterSave(t,false)}}}.bind(this)).catch(function(t){o.error("'_updateVariant' throws an exception:"+t.message)}).unwrap()};d.prototype._createChangeHeader=function(){if(this.isPageVariant()){return{type:"page",dataService:"n/a"}}var t=this._getAllPersonalizableControls();if(t&&t.length>0){return{type:t[0].type,dataService:t[0].dataSource}}};d.prototype._newVariant=function(t){this._bDuringVariantCreation=true;return l.resolve(this._fetchContentAsync()).then(function(e){var i=this._createChangeHeader();var a={type:i.type,ODataService:i.dataSource,texts:{variantName:t.name},content:e,isVariant:true,isUserDependent:!t.public,executeOnSelection:t.execute};var n=this._flWriteAddVariant({control:this._oPersoControl,changeSpecificData:a});if(n){var r=n.getVariantId();this._mVariants[r]=n;this._flUpdateVariant(n,{favorite:true});this._destroyManageDialog();this._createVariantItem(n);this.setSelectionKey(r);this._bDuringVariantCreation=false;if(t.def===true){this._setDefaultVariantKey(r);this.setDefaultVariantKey(r)}this._afterSave(t,true)}}.bind(this)).catch(function(t){this._bDuringVariantCreation=false;o.error("'_newVariant' throws an exception:"+t.message)}.bind(this)).unwrap()};d.prototype._fetchContent=function(){var t,e,i,a={};var n=this._getAllPersonalizableControls();for(var r=0;r<n.length;r++){t=n[r];if(t&&t.control&&t.control.fetchVariant){i=t.control.fetchVariant();if(i){i=s({},i);if(this.isPageVariant()){e=this._getControlPersKey(t);if(e){a=this._assignContent(a,i,e)}else{o.error("no persistancy key retrieved")}}else{a=i;break}}}}return a};d.prototype._fetchContentAsync=function(){var t,e,i,a={},n=[],r=[];var l=this._getAllPersonalizableControls();for(var h=0;h<l.length;h++){t=l[h];if(t&&t.control&&t.control.fetchVariant){i=t.control.fetchVariant();if(i){if(i&&i instanceof Promise){this.setEnabled(false);n.push(i);r.push(t);continue}i=s({},i);if(this.isPageVariant()){e=this._getControlPersKey(t);if(e){a=this._assignContent(a,i,e)}else{o.error("no persistancy key retrieved")}}else{a=i;break}}}}if(n.length>0){var p=null;var f=new Promise(function(t,e){p=t});Promise.all(n).then(function(t){for(var n=0;n<t.length;n++){i=s({},t[n]);if(this.isPageVariant()){e=this._getControlPersKey(r[n]);if(e){a=this._assignContent(a,i,e)}else{o.error("no persistancy key retrieved")}}else{a=i;break}}p(a)}.bind(this));return f}else{return a}};d.prototype._getControlInfoPersKey=function(t){var e=null;if(t.keyName==="id"){e=t.control.getId()}else{e=t.control.getProperty(t.keyName)}return e};d.prototype._getControlPersKey=function(t){var e=t;if(!t.keyName){e=this._getControlWrapper(t)}return this._getControlInfoPersKey(e)};d.prototype._appendLifecycleInformation=function(t,e){var i;var a=this.getItemByKey(e);if(a){i=a.getLifecycleTransportId();if(i===null||i===undefined){i=""}}return i};d.prototype._renameVariant=function(t){if(t.key!==this.getStandardVariantKey()){if(t){var e=this._getVariantById(t.key);if(e){var i={name:t.name};var a=this._appendLifecycleInformation(e,t.key);if(a!=undefined){i.transportId=a}this._flUpdateVariant(e,i);this._reorderList(t.key)}}}};d.prototype._deleteVariants=function(t){var e;var i=this._getDefaultVariantKey();if(t&&t.length){for(var a=0;a<t.length;a++){var n=t[a];var r=this._getVariantById(n);if(r){e=this._appendLifecycleInformation(r,n);r.setRequest(e);this._flRemoveVariant(r);var o=this.getItemByKey(n);if(o){this.removeVariantItem(o)}if(i&&i===n){this._setDefaultVariantKey("")}}}}};d.prototype._getDefaultVariantKey=function(){var t="";if(h){t=h.getDefaultVariantId({control:this._oPersoControl})}return t};d.prototype._executeOnSelectForStandardVariantByXML=function(t){r.prototype._executeOnSelectForStandardVariantByXML.apply(this,arguments);this._reapplyExecuteOnSelectForStandardVariant(t)};d.prototype._reapplyExecuteOnSelectForStandardVariant=function(t){if(Object.keys(this._mVariants).length>0){this.bConsiderXml=undefined;this.flWriteOverrideStandardVariant(t);var e=this.getStandardVariantKey();var i=this._getVariantById(e);if(i){var a=this.getItemByKey(e);if(a){a.setExecuteOnSelection(i.getExecuteOnSelection());this._reapplyExecuteOnSelectForStandardVariantItem(i.getExecuteOnSelection())}}}else{this.bConsiderXml=t}};d.prototype.setExecuteOnStandard=function(t){this._reapplyExecuteOnSelectForStandardVariant(t)};d.prototype.getExecuteOnStandard=function(){var t=this.getStandardVariantKey();var e=this.getItemByKey(t);if(e){return e.getExecuteOnSelection()}return undefined};d.prototype.registerApplyAutomaticallyOnStandardVariant=function(t){this._fRegisteredApplyAutomaticallyOnStandardVariant=t;return this};d.prototype._getApplyAutomaticallyOnStandardVariant=function(){var t=this.getExecuteOnSelectForStandardVariant();if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()){try{t=this._fRegisteredApplyAutomaticallyOnStandardVariant()}catch(t){o.error("callback for determination of apply automatically on standard variant failed")}}return t};d.prototype._setDefaultVariantKey=function(t){if(p){p.setDefaultVariantId({control:this._oPersoControl,defaultVariantId:t})}};d.prototype._isVariantDownport=function(){var t=false;if(h){t=h.isVariantDownport()}return t};d.prototype._setExecuteOnSelections=function(t){if(t&&t.length){for(var e=0;e<t.length;e++){var i=this._getVariantById(t[e].key);if(i){this._flUpdateVariant(i,{executeOnSelection:t[e].exe})}}}};d.prototype._save=function(t,e){if(p){try{p.save({control:this._oPersoControl}).then(function(){if(!e){if(t){this._updateUser()}this.fireEvent("afterSave")}}.bind(this),function(t){var e="'_save' failed:";if(t&&t.message){e+=" "+t.message}this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),e)}.bind(this))}catch(t){this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),"'_save' throws an exception")}}};d.prototype._updateUser=function(){var t=this.getInitialSelectionKey();var e,i=this._getVariantById(t);if(i){e=i.getOwnerId();if(e){this._assignUser(t,e)}}};d.prototype.fireSave=function(t){var e={};if(t){if(t.hasOwnProperty("tile")){e.tile=t.tile}if(t.overwrite){if(t.key!==this.getStandardVariantKey()){this.fireEvent("save",e);if(t.key===this.STANDARDVARIANTKEY){this._newVariant(t)}else{this._updateVariant(t)}}}else{this.fireEvent("save",e);this._newVariant(t)}}};d.prototype._afterSave=function(t,e){this.setEnabled(true);this.setModified(false);this._save(e)};d.prototype.fireManage=function(t){var e,i=false;if(t){if(t.renamed){for(e=0;e<t.renamed.length;e++){this._renameVariant(t.renamed[e])}}if(t.deleted){this._deleteVariants(t.deleted)}if(t.exe){this._setExecuteOnSelections(t.exe)}if(t.def){var a=this._getDefaultVariantKey();if(a!==t.def){if(!(a===""&&t.def===this.STANDARDVARIANTKEY)){this._setDefaultVariantKey(t.def);i=true}}}if(t.fav&&t.fav.length>0){this._addFavorites(t.fav)}if(t.deleted&&t.deleted.length>0||t.renamed&&t.renamed.length>0||t.exe&&t.exe.length>0||i){this._save()}else if(t.fav&&t.fav.length>0){this._save(false,true)}this.fireEvent("manage",t)}};d.prototype.fireSelect=function(t,e){if(this._oPersoControl&&t&&t.key){this._triggerSelectVariant(t.key,e);this.fireEvent("select",t)}};d.prototype._selectVariant=function(t,e){this.fireSelect({key:t},e)};d.prototype._checkForSelectionHandler=function(t){var e=null,i=Object.keys(this._oSelectionVariantHandler);if(i.length>-1){i.some(function(i){if(t.indexOf(i)===0){e=this._oSelectionVariantHandler[i];return true}return false}.bind(this))}return e};d.prototype._triggerSelectVariant=function(t,e){var i,a,n=false,r=this._checkForSelectionHandler(t);var o=this._getVariantById(t);if(o){i=o.getExecuteOnSelection();if(t===this.getStandardVariantKey()){i=this._getApplyAutomaticallyOnStandardVariant()}n=Object.entries(this._getContent(o)).length===0?false:true}if(n){a=this._getGeneralSelectVariantContent(t,e)}else if(this._getAdapter()&&t.substring(0,1)==="#"){this._applyUiState(t,e,i);return}else if(r){a=this._getSpecialSelectVariantContent(t,e,r)}else{a=this._getGeneralSelectVariantContent(t,e)}if(a){if(this.isPageVariant()){this._applyVariants(a,e,i)}else{this._applyVariant(this._oPersoControl,a,e,false,i)}}};d.prototype._getSpecialSelectVariantContent=function(t,e,i){return i.callback.call(i.handler,t,e)};d.prototype._getGeneralSelectVariantContent=function(t,e){var i=this._getVariantContent(t);if(i){i=s({},i)}return i};d.prototype.currentVariantSetModified=function(t){if(!this._bApplyingUIState){r.prototype.currentVariantSetModified.apply(this,arguments)}};d.prototype._applyControlUiState=function(t,e){if(t&&e){t.loaded.then(function(){if(t.control.setUiStateAsVariant){t.control.setUiStateAsVariant(e)}})}};d.prototype._applyUiState=function(t,e,i){var a,n=this._getAdapter(),r=null,o=this._getAllPersonalizableControls();var s=null;if(n){r=n.getUiState(t);this._bApplyingUIState=true;for(a=0;a<o.length;a++){if(o[a]&&o[a].control&&o[a].loaded){this._applyControlUiState(o[a],r,e);if(o[a].control.search){s=o[a].control}}}this._bApplyingUIState=false;if(i&&s){s.search()}}};d.prototype._applyControlWrapperVariants=function(t,e,i,a){if(t){t.loaded.then(function(){this._applyControlVariant(t.control,e,i,false,a)}.bind(this))}};d.prototype._applyVariants=function(t,e,i){var a,n=this._getAllPersonalizableControls();for(a=0;a<n.length;a++){if(n[a]&&n[a].control&&n[a].loaded){this._applyControlWrapperVariants(n[a],t,e,i)}}};d.prototype._setStandardVariant=function(e){var i=e.control;if(i){if(i.fireBeforeVariantSave){i.fireBeforeVariantSave(t.STANDARD_VARIANT_NAME)}return this._assignStandardVariantAsync(e)}};d.prototype._retrieveContent=function(t,e){var i=t;if(this.isPageVariant()&&t){i=t[e];if(!i&&e===this.getPersistencyKey()&&this._aPersonalizableControls&&this._aPersonalizableControls.length===1){i=t}}return i};d.prototype._assignContent=function(t,e,i){if(this.isPageVariant()){t[i]=e}else{t=e}return t};d.prototype._updateStandardVariant=function(t,e){if(t.control){var i=e;if(this.isPageVariant()){var a=this._getControlPersKey(t);if(a){i=this._retrieveContent(e,a)}}return this._assignStandardVariantForControl(t,i)}return e};d.prototype._assignStandardVariantAsync=function(t){var e=null;if(t.control){if(t.control.fetchVariant){e=t.control.fetchVariant()}if(e instanceof Promise){this.setEnabled(false)}return l.resolve(e).then(function(e){return this._assignStandardVariantForControl(t,e)}.bind(this)).catch(function(t){o.error("'_assignStandardVariant' throws an exception: "+t.message)}).unwrap()}return null};d.prototype._assignStandardVariantForControl=function(t,e){var i=e;if(t){if(this.isPageVariant()){var a=this._getControlPersKey(t.control);if(a){if(!this._oStandardVariant){this._oStandardVariant={}}this._oStandardVariant=this._assignContent(this._oStandardVariant,i,a)}}else{this._oStandardVariant=i}}return this._oStandardVariant};d.prototype.getStandardVariant=function(t){var e,i,a=null;if(this._oStandardVariant){if(!t){a=this._oStandardVariant}else{if(this.isPageVariant()){i=this._getControlWrapper(t);if(i){e=this._getControlPersKey(t);if(e){a=this._retrieveContent(this._oStandardVariant,e)}}}else{if(t===this._oPersoControl){a=this._oStandardVariant}}}}return a};d.prototype._applyVariant=function(t,e,i,a,n){if(t&&t.applyVariant){if(n!=undefined){e.executeOnSelection=n}t.applyVariant(e,i,a)}};d.prototype._applyVariantByPersistencyKey=function(t,e,i){var a=null;this.getAggregation("personalizableControls",[]).some(function(e){var i=sap.ui.getCore().byId(e.getControl());if(i){var n=e.getKeyName();if(i.getProperty(n)===t){a=i}return a!=null}});if(a){var n=this._retrieveContent(e,t);this._applyVariant(a,n,i)}};d.prototype._applyControlVariant=function(t,e,i,a,n){var r,o;o=this._getControlPersKey(t);if(o){r=this._retrieveContent(e,o);if(r){this._applyVariant(t,r,i,a,n)}}};d.prototype.registerSelectionVariantHandler=function(t,e){this._oSelectionVariantHandler[e]=t};d.prototype.unregisterSelectionVariantHandler=function(t){var e=null;if(!this._oSelectionVariantHandler){return}if(typeof t==="string"){e=t}else{Object.keys(this._oSelectionVariantHandler).some(function(i){if(this._oSelectionVariantHandler[i].handler===t){e=i;return true}return false}.bind(this))}if(e){delete this._oSelectionVariantHandler[e]}};d.prototype._setErrorValueState=function(t,e){this.setInErrorState(true);if(e){o.error(e)}};d.prototype.exit=function(){r.prototype.exit.apply(this,arguments);this._aPersonalizableControls=null;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this._fResolvePersistencyPromise=null;this._fRejectPersistencyPromise=null;this._fResolveMetadataPromise=null;this._oMetadataPromise=null;this._fResolveMetadataPromise=null;this._oControlPromise=null;this._oFlLibrary=null;this._oPersistencyPromise=null;this._oPersoControl=null;this._oAppStdContent=null;this._sAppStandardVariantKey=null;this._oSelectionVariantHandler=null;if(this._oAdapter){this._oAdapter.destroy();this._oAdapter=null}this._mVariants=null};return d});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementAdapter", ["sap/ui/comp/state/UIState","sap/ui/core/Element"],function(t,e){"use strict";var n=e.extend("sap.ui.comp.smartvariants.SmartVariantManagementAdapter",{metadata:{library:"sap.ui.comp",properties:{selectionPresentationVariants:{type:"object",group:"Misc",defaultValue:false}}}});n.prototype.getUiState=function(e){var n,a=null,i=e.substring(1);this.getSelectionPresentationVariants().some(function(t){if(t.qualifier===i){a=t}return a!==null});if(a){if(a.uiStateContent){n=a.uiStateContent}else{n=t.createFromSelectionAndPresentationVariantAnnotation(a.text,a.selectionVariant?a.selectionVariant.annotation:null,a.presentationVariant?a.presentationVariant.annotation:null);a.uiStateContent=n}}return n};n.prototype.getODataVariants=function(){var t="#",e=[];var n=this.getSelectionPresentationVariants();if(n){n.forEach(function(n){if(n.qualifier){var a=t+n.qualifier;e.push({id:a,favorite:true,name:n.text})}})}return e};n.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments)};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementBase", ["sap/m/VariantManagement","sap/ui/core/Control","sap/ui/core/library","sap/ui/model/base/ManagedObjectModel","sap/base/Log"],function(t,e,r,a,i){"use strict";var n=r.TitleLevel;var o=e.extend("sap.ui.comp.smartvariants.SmartVariantManagementBase",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagementBase.designtime",properties:{enabled:{type:"boolean",group:"Misc",defaultValue:true},defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showShare:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},standardItemText:{type:"string",group:"Misc",defaultValue:null},useFavorites:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},variantCreationByUserAllowed:{type:"boolean",group:"Misc",defaultValue:true},standardItemAuthor:{type:"string",group:"Misc",defaultValue:"SAP"},displayTextForExecuteOnSelectionForStandardVariant:{type:"string",group:"Misc",defaultValue:""},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:n.Auto},initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},exe:{type:"boolean"},def:{type:"boolean"},global:{type:"boolean"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}},defaultAggregation:"variantItems",aggregations:{_embeddedVM:{type:"sap.m.VariantManagement",multiple:false,visibility:"hidden"},variantItems:{type:"sap.ui.comp.variants.VariantItem",multiple:true,forwarding:{getter:"_getEmbeddedVM",aggregation:"items"}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.openEnd();t.renderControl(e._oVM);t.close("div")}}});o.prototype.init=function(){e.prototype.init.apply(this);this.STANDARDVARIANTKEY="*standard*";this._sStdKey=this.STANDARDVARIANTKEY;this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oVM=new t(this.getId()+"-vm");this.setAggregation("_embeddedVM",this._oVM,true);this._oManagedObjectModel=new a(this);this.setModel(this._oManagedObjectModel,"$compSmartVariants");this._oVM.attachManage(this._fireManage,this);this._oVM.attachSave(this._fireSave,this);this._oVM.attachSelect(this._fireSelect,this);this._oVM.attachCancel(this._fireCancel,this);this._oVM.attachManageCancel(this._fireManageCancel,this);this.setDefaultVariantKey(this.getStandardVariantKey());this.setPopoverTitle(this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"));this._bindProperties()};o.prototype._bindProperties=function(t){this._oVM.bindProperty("defaultKey",{path:"/defaultVariantKey",model:"$compSmartVariants"});this._oVM.bindProperty("creationAllowed",{path:"/variantCreationByUserAllowed",model:"$compSmartVariants"});this._oVM.bindProperty("selectedKey",{path:"/selectionKey",model:"$compSmartVariants"});this._oVM.bindProperty("supportPublic",{path:"/showShare",model:"$compSmartVariants"});this._oVM.bindProperty("supportDefault",{path:"/showSetAsDefault",model:"$compSmartVariants"});this._oVM.bindProperty("supportApplyAutomatically",{path:"/showExecuteOnSelection",model:"$compSmartVariants"});this._oVM.bindProperty("supportFavorites",{path:"/useFavorites",model:"$compSmartVariants"});this._oVM.bindProperty("displayTextForExecuteOnSelectionForStandardVariant",{path:"/displayTextForExecuteOnSelectionForStandardVariant",model:"$compSmartVariants"});this._oVM.bindProperty("level",{path:"/headerLevel",model:"$compSmartVariants"})};o.prototype._getEmbeddedVM=function(){return this._oVM};o.prototype.setShowCreateTile=function(t){this.setProperty("showCreateTile",t);this._oVM._setShowCreateTile(t);return this};o.prototype.getShowCreateTile=function(){return this._oVM._getShowCreateTile()};o.prototype._assignUser=function(t,e){var r=this._oVM._getItemByKey(t);if(r&&!r.getAuthor()){r.setAuthor(e)}};o.prototype.setSelectionKey=function(t){this.setProperty("selectionKey",t);return this};o.prototype.setInitialSelectionKey=function(t){return this.setSelectionKey(t)};o.prototype.getInitialSelectionKey=function(){return this.getSelectionKey()};o.prototype.currentVariantGetModified=function(){return this.getModified()};o.prototype.currentVariantSetModified=function(t){this.setModified(t)};o.prototype._getIdxSorted=function(t){var e=this.getVariantItems();var r=t.toUpperCase();var a=e.findIndex(function(t,e){if(e>0){if(t.getTitle().toUpperCase()>r){return true}}return false});return a>-1?a:e.length};o.prototype._reorderList=function(t){var e=this.getItemByKey(t);if(e){this._destroyManageDialog();this.removeVariantItem(e);var r=this._getIdxSorted(e.getTitle());this.insertVariantItem(e,r)}};o.prototype._getInternalVM=function(){return this.getAggregation("_embeddedVM")};o.prototype.getItemByKey=function(t){var e=this.getVariantItems();for(var r=0;r<e.length;r++){if(t==e[r].getKey()){return e[r]}}return null};o.prototype._determineStandardVariantName=function(){var t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY&&this.getStandardItemText()){t=this.getStandardItemText()}return t};o.prototype.setStandardVariantKey=function(t){this._sStdKey=t};o.prototype.getStandardVariantKey=function(){var t=this._oVM.getStandardVariantKey();return t?t:this._sStdKey};o.prototype.getOverflowToolbarConfig=function(){return{canOverflow:false,invalidationEvents:["save","manage","select"]}};o.prototype._prepareSaveAsKeyUserData=function(t){try{this._getContentAsync().then(function(e){var r={default:t.def,executeOnSelection:t.execute,type:this._getPersoControllerType(),text:t.name,contexts:t.contexts,content:e};this._fGetDataForKeyUser(r);this._cleanUpSaveForKeyUser()}.bind(this))}catch(t){i.error("'_prepareSaveAsKeyUserData' throws an exception:"+t.message);this._fGetDataForKeyUser();this._cleanUpSaveForKeyUser()}};o.prototype._fireCancel=function(t){if(this._fGetDataForKeyUser){this._fGetDataForKeyUser();this._cleanUpSaveForKeyUser()}};o.prototype._fireManageCancel=function(t){if(this._fGetDataForKeyUser){this._fGetDataForKeyUser();this._cleanUpManageViewsForKeyUser()}};o.prototype._fireSelect=function(t){if(!this._fGetDataForKeyUser){this.setModified(false)}this.fireSelect(t.getParameters())};o.prototype._fireSave=function(t){var e=t.getParameters();if(this._fGetDataForKeyUser){this._prepareSaveAsKeyUserData(e);return}if(e.hasOwnProperty("execute")){e.exe=e.execute}if(e.hasOwnProperty("public")){e.global=e.public}this.fireSave(e)};o.prototype._prepareManageKeyUserData=function(t){var e={};var r=false;if(t.hasOwnProperty("def")){var a=t.def;if(a!==this._oVM._sOriginalDefaultKey){e.default=a}}if(t.hasOwnProperty("deleted")){t.deleted.forEach(function(t){if(!e[t]){e[t]={}}e[t].deleted=true;if(this.getSelectionKey()===t){r=true}}.bind(this))}if(t.hasOwnProperty("exe")){t.exe.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].executeOnSelection=t.exe})}if(t.hasOwnProperty("fav")){t.fav.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].favorite=t.visible})}if(t.hasOwnProperty("renamed")){t.renamed.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].name=t.name})}if(t.hasOwnProperty("contexts")){t.contexts.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].contexts=t.contexts})}if(r){this.activateVariant(this.getStandardVariantKey())}this._fGetDataForKeyUser(e);this._cleanUpManageViewsForKeyUser()};o.prototype._syncOriginalProperties=function(t){if(t.fav){t.fav.forEach(function(t){var e=this._oVM._getItemByKey(t.key);if(e){e.setOriginalFavorite(t.visible)}}.bind(this))}if(t.renamed){t.renamed.forEach(function(t){var e=this._oVM._getItemByKey(t.key);if(e){e.setTitle(t.name);e.setOriginalTitle(t.name);e.setText(t.name)}}.bind(this))}if(t.exe){t.exe.forEach(function(t){var e=this._oVM._getItemByKey(t.key);if(e){e.setOriginalExecuteOnSelect(t.exe)}}.bind(this))}if(t.contexts){t.contexts.forEach(function(t){var e=this._oVM._getItemByKey(t.key);if(e){e.setOriginalContexts(t.contexts)}}.bind(this))}};o.prototype._fireManage=function(t){var e=t.getParameters();if(this._fGetDataForKeyUser){this._prepareManageKeyUserData(e)}else{this.fireManage(e);this._syncOriginalProperties(e)}};o.prototype.getFocusDomRef=function(){if(this._oVM){return this._oVM.oVariantPopoverTrigger.getFocusDomRef()}return null};o.prototype.getManageDialog=function(){if(this._oVM){return this._oVM.oManagementDialog}return null};o.prototype.getVariants=function(){return this._oVM.getItems()};o.prototype.getTitle=function(){return this._oVM.getTitle()};o.prototype.setPopoverTitle=function(t){return this._oVM.setPopoverTitle(t)};o.prototype.setEditable=function(t){this.setProperty("editable",t);return this._oVM.setShowFooter(t)};o.prototype.setShowExecuteOnSelection=function(t){this.setProperty("showExecuteOnSelection",t);this._oVM.setSupportApplyAutomatically(t);return this};o.prototype.setShowSetAsDefault=function(t){this.setProperty("showSetAsDefault",t);this._oVM.setSupportDefault(t);return this};o.prototype.setExecuteOnSelectionForStandardDefault=function(t){this.setProperty("executeOnSelectionForStandardDefault",t);this._oVM.setExecuteOnSelectionForStandardDefault(t);return this};o.prototype.setDisplayTextForExecuteOnSelectionForStandardVariant=function(t){this.setProperty("displayTextForExecuteOnSelectionForStandardVariant",t);this._oVM.setDisplayTextForExecuteOnSelectionForStandardVariant(t);return this};o.prototype.setInErrorState=function(t){this.setProperty("inErrorState",t);this._oVM.setInErrorState(t);return this};o.prototype.getInErrorState=function(){return this._oVM.getInErrorState()};o.prototype._updateLayerSpecificInformations=function(){this.getVariants().forEach(function(t){var e=this._getVariantById(t.getKey());if(e){t.setRemove(e.isDeleteEnabled(this._sLayer));t.setRename(e.isRenameEnabled(this._sLayer))}}.bind(this))};o.prototype.setEditable=function(t){this._oVM.setProperty("showFooter",t);return this};o.prototype.setCurrentVariantKey=function(t){this._oVM.setSelectedKey(t)};o.prototype.getCurrentVariantKey=function(){return this._oVM.getSelectedKey()};o.prototype.getModified=function(){return this._oVM.getModified()};o.prototype.setModified=function(t){this._oVM.setModified(t)};o.prototype._enableManualVariantKey=function(t){this._oVM._setShowManualVariantKey(t)};o.prototype.refreshTitle=function(){this._oVM.refreshTitle()};o.prototype.registerApplyAutomaticallyOnStandardVariant=function(t){this._fRegisteredApplyAutomaticallyOnStandardVariant=t;return this};o.prototype.getApplyAutomaticallyOnVariant=function(t){var e=t.executeOnSelect;if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()&&t.key===this._oVM.getStandardVariantKey()){try{e=this._fRegisteredApplyAutomaticallyOnStandardVariant(t)}catch(t){i.error("callback for determination of apply automatically on standard variant failed")}}return e};o.prototype.getPersonalizableControlPersistencyKey=function(){if(this.isPageVariant()){return this.getPersistencyKey()}var t=this._getAllPersonalizableControls();if(t&&t.length===1){return this._getControlPersKey(t[0])}return null};o.prototype.addVariant=function(t,e){this._createVariantItem(t);if(e){this.setDefaultVariantId(t.getVariantId())}};o.prototype.removeVariant=function(t){if(t.variantId){var e=this.getItemByKey(t.variantId);if(e){this.removeVariantItem(e);e.destroy()}delete this._mVariants[t.variantId]}if(t.previousVariantId){this.activateVariant(t.previousVariantId)}if(t.previousDefault){this.setDefaultVariantId(t.previousDefault)}};o.prototype.removeWeakVariant=function(t){if(t.variantId){var e=this.getItemByKey(t.variantId);if(e){this.removeVariantItem(e);e.destroy()}delete this._mVariants[t.variantId]}if(t.previousVariantId){this.setInitialSelectionKey(t.previousVariantId)}if(t.previousDirtyFlag){this.setModified(t.previousDirtyFlag)}if(t.previousDefault){this.setDefaultVariantId(t.previousDefault)}};o.prototype.updateVariant=function(t){var e;if(t){e=this.getItemByKey(t.getVariantId());if(e){e.setExecuteOnSelection(t.getExecuteOnSelection());e.setExecuteOnSelect(t.getExecuteOnSelection());e.setOriginalExecuteOnSelect(t.getExecuteOnSelection());e.setFavorite(t.getFavorite());e.setOriginalFavorite(t.getFavorite());e.setTitle(t.getText("variantName"));e.setOriginalTitle(t.getText("variantName"));e.setText(t.getText("variantName"));if(t.getContexts){e.setContexts(t.getContexts());e.setOriginalContexts(t.getContexts())}}}};o.prototype.activateVariant=function(t){this.setCurrentVariantKey(t);this.setModified(false);this.fireSelect({key:t})};o.prototype.getAllVariants=function(){var t=this._oVM.getItems();if(!t||t.length<1){return[]}var e=[];t.forEach(function(t){if(t.getVisible()){e.push(this._getVariantById(t.getKey()))}}.bind(this));return e};o.prototype.getDefaultVariantId=function(){return this.getDefaultVariantKey()};o.prototype.setDefaultVariantId=function(t){this.setDefaultVariantKey(t)};o.prototype.getPresentVariantId=function(){return this.getCurrentVariantId()?this.getCurrentVariantId():this.STANDARDVARIANTKEY};o.prototype.getPresentVariantText=function(){return this._oVM.getSelectedVariantText(this.getPresentVariantId())};o.prototype.getPresentVariantContent=function(){return this._getContentAsync()};o.prototype._getPersoController=function(){return this._oPersoControl};o.prototype._getPersoControllerType=function(){if(this.isPageVariant()){return"page"}var t=this._getAllPersonalizableControls();if(t&&t.length===1){return t[0].type}return null};o.prototype._isDuplicateSaveAs=function(t){var e=t.trim();if(!e){return true}var r=this._determineStandardVariantName();if(r===e){return true}var a=this.getVariants();for(var i=0;i<a.length;i++){r=a[i].getText().trim();if(r===e){return true}}return false};o.prototype.isNameDuplicate=function(t){var e=t.trim();return this._isDuplicateSaveAs(e)};o.prototype.isNameTooLong=function(e){var r=e.trim();return r.length>t.MAX_NAME_LEN};o.prototype.setStandardItemText=function(t){this.setProperty("standardItemText",t);return this};o.prototype._executeOnSelectForStandardVariantByXML=function(t){this.bExecuteOnSelectForStandardViaXML=t};o.prototype.getExecuteOnSelectForStandardVariant=function(){var t=false;var e=this.getItemByKey(this.getStandardVariantKey());if(e){t=e.getExecuteOnSelection()}return t||this.bExecuteOnSelectForStandardViaXML};o.prototype._reapplyExecuteOnSelectForStandardVariantItem=function(t){var e=this.getStandardVariantKey();if(this._oVM){var r=this._oVM._getItemByKey(e);if(r){r.setExecuteOnSelect(t);r.setOriginalExecuteOnSelect(t)}}};o.prototype.openManageViewsDialogForKeyUser=function(t,e,r){this._sLayer=t.layer;this._fGetDataForKeyUser=e;this._updateLayerSpecificInformations();var a=true;if(r){a=false}this._oVM.openManagementDialog(a,t.rtaStyleClass,t.contextSharingComponentContainer)};o.prototype.openSaveAsDialogForKeyUser=function(t,e,r){this._fGetDataForKeyUser=e;this._oVM.openSaveAsDialog(t,r)};o.prototype._cleanUpSaveForKeyUser=function(){if(this._oRolesComponentContainer){this.oSaveDialog.removeContent(this._oRolesComponentContainer)}this._cleanUpKeyUser()};o.prototype._destroyManageDialog=function(){if(this._oVM){this._oVM.destroyManageDialog()}};o.prototype._cleanUpManageViewsForKeyUser=function(){this._destroyManageDialog();this._cleanUpKeyUser()};o.prototype._cleanUpKeyUser=function(){this.setShowShare(this._bShowShare);this._fGetDataForKeyUser=null;this._sLayer=null;this._oRolesComponentContainer=null};o.prototype._getContentAsync=function(){return Promise.resolve(this._fetchContentAsync())};o.prototype._checkUpdate=function(){this._oVM.getModel("$mVariants").checkUpdate(true)};o.prototype.setDesignTimeMode=function(t){return this._oVM.setShowFooter(!t)};o.prototype.exit=function(){this._oVM.detachManage(this._fireManage,this);this._oVM.detachSelect(this._fireSelect,this);this._oVM.detachSave(this._fireSave,this);this._oVM.detachCancel(this._fireCancel,this);this._oVM.detachManageCancel(this._fireManageCancel,this);if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();this._oManagedObjectModel=undefined}e.prototype.exit.apply(this,arguments);this._oVM=undefined;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this.oResourceBundle=undefined};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementUi2", ["sap/ui/comp/library","./PersonalizableInfo","sap/ui/comp/variants/VariantItem","sap/ui/comp/variants/VariantManagement","sap/base/Log"],function(t,e,a,i,r){"use strict";var n=i.extend("sap.ui.comp.smartvariants.SmartVariantManagementUi2",{metadata:{library:"sap.ui.comp",aggregations:{personalizableControl:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:false}},events:{initialise:{},afterSave:{}}},renderer:{apiVersion:2}});n.prototype.init=function(){i.prototype.init.apply(this);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null;if(this.setLifecycleSupport){this.setLifecycleSupport(false)}this._setBackwardCompatibility(false)};n.prototype.isPageVariant=function(){return false};n.prototype.getVariantContent=function(t,e){var a=null;if(e===this.STANDARDVARIANTKEY){a=this._getStandardVariant()}else{if(this._oVariantSet){var i=this._oVariantSet.getVariant(e);if(i){a=this._getContent(i)}}}return a};n.prototype.getCurrentVariantId=function(){var t="";var e=this._getSelectedItem();if(e){t=e.getKey();if(t===this.STANDARDVARIANTKEY){t=""}}return t};n.prototype.setCurrentVariantId=function(t,e){var a;var i=t;if(!i){i=this.STANDARDVARIANTKEY}else{if(!this.getItemByKey(i)){i=this.STANDARDVARIANTKEY}}if(this._oVariantSet){a=this.getVariantContent(this._oPersController,i);if(a){this._setSelectionByKey(i);if(e!==true){this._applyVariantContent(a)}}}};n.prototype.addPersonalizableControl=function(t){this.setAggregation("personalizableControl",t,true);if(t.getControl()){this._oPersController=sap.ui.getCore().byId(t.getControl())}this._sKeyName=t.getKeyName();return this};n.prototype.initialise=function(){var t=this._getPersistencyKey();if(!t){r.warning("PersistencyKey not set");this.fireEvent("initialise");return}if(sap.ushell&&sap.ushell.Container){var e=this;sap.ushell.Container.getService("Personalization").getContainer(t,{validity:Infinity}).fail(function(){r.error("Loading personalization container failed");e._setErrorValueState(e.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));e.fireEvent("initialise")}).done(function(t){e._readPersonalization(t);e.fireEvent("initialise");e._setStandardVariant();e._setSelectedVariant()});return}r.error("Could not obtain the personalization container");this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));this.fireEvent("initialise")};n.prototype._setSelectedVariant=function(){var t=null;if(this._oVariantSet){var e=this.getSelectionKey();if(e){t=this._oVariantSet.getVariant(e);if(t){this._applyVariant(t)}}}};n.prototype._reCreateVariantEntries=function(){var t=null;var e=null;var i,r;this.removeAllItems();if(this._oVariantSet){var n=this._oVariantSet.getVariantNamesAndKeys();if(n){for(t in n){if(t){r=new a({text:t,key:n[t]});this.addVariantItem(r)}}e=this._oVariantSet.getCurrentVariantKey();i=this._oVariantSet.getVariant(e);if(i){this.setDefaultVariantKey(e);this.setInitialSelectionKey(e)}}}};n.prototype._getVariantSetAdapter=function(){var t=null;if(this._oContainer){t=new sap.ushell.services.Personalization.VariantSetAdapter(this._oContainer)}return t};n.prototype._createVariantEntries=function(){var t=this._getVariantSetAdapter();if(t){this._oVariantSet=t.getVariantSet("filterBarVariantSet");if(this._oVariantSet){this._reCreateVariantEntries()}else{this._oVariantSet=t.addVariantSet("filterBarVariantSet")}}};n.prototype._readPersonalization=function(t){this._oContainer=t;if(this._oContainer){this._createVariantEntries()}};n.prototype._savePersonalizationContainer=function(){var t=this;if(this._oContainer){this._oContainer.save().fail(function(){r.error("Saving personalization data failed");t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"))}).done(function(){r.info("Saving personalization data succeeded");t.fireEvent("afterSave")})}};n.prototype.fireSave=function(t){var e=null,a=null;var i;if(!this._oVariantSet){return}if(t){if(t.overwrite){if(t.key){e=this._oVariantSet.getVariant(t.key)}}else{if(t.name){e=this._oVariantSet.addVariant(t.name);a=e;i=a.getVariantKey();this.replaceKey(t.key,i);this.setInitialSelectionKey(i)}}if(e){this.fireEvent("save",t);var r=this._fetchVariant();if(r){e.setItemValue("filterBarVariant",r.filterBarVariant);e.setItemValue("filterbar",r.filterbar);e.setItemValue("basicSearch","");if(r.basicSearch){e.setItemValue("basicSearch",r.basicSearch)}i=e.getVariantKey();if(t.def){if(i){this._oVariantSet.setCurrentVariantKey(i)}}else{var n=this._oVariantSet.getCurrentVariantKey();if(i===n){this._oVariantSet.setCurrentVariantKey(null)}}}this._savePersonalizationContainer()}}};n.prototype._setStandardVariant=function(){if(this._oPersController&&this._oPersController.fireBeforeVariantSave){this._oPersController.fireBeforeVariantSave(i.STANDARD_NAME)}this._oStandardVariant=this._fetchVariant()};n.prototype._getStandardVariant=function(){return this._oStandardVariant};n.prototype.getStandardVariant=function(){return this._getStandardVariant()};n.prototype._setVariantName=function(t,e,a){var i;var r,n;if(this._oVariantSet){var o=this._oVariantSet.addVariant(a);r=t.getItemValue("filterBarVariant");o.setItemValue("filterBarVariant",r);n=t.getItemValue("filterbar");o.setItemValue("filterbar",n);i=this._oVariantSet.getCurrentVariantKey();if(i===e){this._oVariantSet.setCurrentVariantKey(o.getVariantKey())}this._oVariantSet.delVariant(e);i=o.getVariantKey();this.replaceKey(e,i);this.setInitialSelectionKey(i)}};n.prototype._getVariantNamesAndKeys=function(){return this._oVariantSet.getVariantNamesAndKeys()};n.prototype.fireManage=function(t){var e;var a=null,i=null;var r;if(!this._oVariantSet){return}if(t){a=t.renamed;i=t.deleted;if(a){for(e=0;e<a.length;e++){r=this._oVariantSet.getVariant(a[e].key);if(r){if(r.setVariantName){r.setVariantName(a[e].name)}else{this._setVariantName(r,a[e].key,a[e].name)}}}}if(i){var n=this._oVariantSet.getCurrentVariantKey();for(e=0;e<i.length;e++){r=this._oVariantSet.getVariant(i[e]);if(r){if(n&&n===r.getVariantKey()){this._oVariantSet.setCurrentVariantKey(null)}this._oVariantSet.delVariant(i[e])}}}if(t.def){r=this._oVariantSet.getVariant(t.def);if(r||t.def===this.STANDARDVARIANTKEY){this._oVariantSet.setCurrentVariantKey(t.def)}}if(i&&i.length>0||a&&a.length>0||t.def){this._savePersonalizationContainer()}}};n.prototype.fireSelect=function(t){var e=null;if(t&&t.key){if(this._oVariantSet){if(t.key===this.STANDARDVARIANTKEY){e=this._getStandardVariant()}else{e=this._oVariantSet.getVariant(t.key)}}}if(e){this._applyVariant(e)}};n.prototype._getContent=function(t){var e=null;if(t){if(t.getItemValue){e={filterbar:t.getItemValue("filterbar"),filterBarVariant:t.getItemValue("filterBarVariant")};var a=t.getItemValue("basicSearch");if(a){e.basicSearch=a}}else{e=t}}return e};n.prototype._applyVariant=function(t){var e=this._getContent(t);this._applyVariantContent(e)};n.prototype._applyVariantContent=function(t){if(t&&this._oPersController&&this._oPersController.applyVariant){this._oPersController.applyVariant(t)}};n.prototype._fetchVariant=function(){if(this._oPersController&&this._oPersController.fetchVariant){return this._oPersController.fetchVariant()}return null};n.prototype._getPersistencyKey=function(){if(this._oPersController&&this._sKeyName){return this._oPersController.getProperty(this._sKeyName)}return null};n.prototype._setErrorValueState=function(t){this.setEnabled(false)};n.prototype.exit=function(){i.prototype.exit.apply(this,arguments);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/state/UIState", ["sap/ui/comp/library","sap/ui/base/ManagedObject","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context","sap/ui/thirdparty/jquery"],function(e,t,r,a,n,jQuery){"use strict";var i=t.extend("sap.ui.comp.state.UIState",{metadata:{library:"sap.ui.comp",properties:{presentationVariant:{type:"object"},selectionVariant:{type:"object"},variantName:{type:"string"},valueTexts:{type:"object"},semanticDates:{type:"object"}}}});i._getFilterNamesWithValuesForCurrentLanguage=function(e){var t=[],r=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().getLanguage();if(e&&e.Texts){e.Texts.some(function(e){if(e.Language===r){e.PropertyTexts.forEach(function(e){var r,a=false;for(var n=0;n<t.length;n++){if(t[n].filterName===e.PropertyName){r=t[n];a=true;break}}if(e.PropertyName&&e.ValueTexts&&Object.keys(e.ValueTexts).length>0){e.ValueTexts.forEach(function(t){if(!r){r={filterName:e.PropertyName,keys:[]}}r.keys.push(t.PropertyValue)})}if(!a&&r&&r.keys.length){t.push(r)}});return true}return false})}return t};i._getFilterNamesWithValuesFromSelectOption=function(e,t){var r=[];if(e&&e.SelectOptions){e.SelectOptions.forEach(function(e){var a=t?t.indexOf(e.PropertyName)<0:true;if(a){var n={filterName:e.PropertyName,keys:[]};e.Ranges.forEach(function(e){if(e.Option==="EQ"&&e.Sign==="I"){n.keys.push(e.Low)}});r.push(n)}})}return r};i._determineFiltersWithOnlyKeyValues=function(e,t){var r,a,n=[];e=e||[];t=t||[];t.forEach(function(t){var i={filterName:t.filterName,keys:[]};a=null;e.some(function(e){if(t.filterName===e.filterName){a=e}return a!==null});for(var o=0;o<t.keys.length;o++){r=false;if(a){for(var s=0;s<a.keys.length;s++){if(t.keys[o]===a.keys[s]){r=true;break}}}if(!r){i.keys.push(t.keys[o])}}if(i.keys.length){n.push(i)}});return n};i.determineFiltersWithOnlyKeyValues=function(e,t,r){var a=i._getFilterNamesWithValuesForCurrentLanguage(e);var n=i._getFilterNamesWithValuesFromSelectOption(t,r);return i._determineFiltersWithOnlyKeyValues(a,n)};i.calculateValueTexts=function(e,t){var r=null;var a=function(e,t){var a=null;if(!r){r={Texts:[{ContextUrl:"",Language:sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().getLanguage(),PropertyTexts:[]}]}}for(var n=0;n<r.Texts[0].PropertyTexts.length;n++){if(r.Texts[0].PropertyTexts[n].PropertyName===e){a=r.Texts[0].PropertyTexts[n];break}}if(!a){a={PropertyName:e,ValueTexts:[]};r.Texts[0].PropertyTexts.push(a)}a.ValueTexts.push({PropertyValue:t.key,Text:t.text})};if(t&&e&&e.SelectOptions){e.SelectOptions.forEach(function(e){if(t[e.PropertyName]){if(t[e.PropertyName].ranges){t[e.PropertyName].ranges.forEach(function(t){if(t.hasOwnProperty("text")){a(e.PropertyName,t)}})}if(t[e.PropertyName].items){t[e.PropertyName].items.forEach(function(t){if(t.hasOwnProperty("text")){a(e.PropertyName,t)}})}}})}return r};i.enrichWithValueTexts=function(e,t){var r=false,a,n,i,o=e;n=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().getLanguage().toLowerCase();if(t&&t.Texts){t.Texts.some(function(e){if(e.Language&&e.Language.toLowerCase()===n){a=e}return a!==null});if(a&&a.PropertyTexts){if(!i){i=JSON.parse(e)}a.PropertyTexts.forEach(function(e){var t=i[e.PropertyName];if(t&&t.ranges&&e.ValueTexts){e.ValueTexts.forEach(function(a){var n=null,o=-1;if(a.Text){t.ranges.some(function(e,t){if(!e.exclude&&e.operation==="EQ"&&e.value1===a.PropertyValue){n=e;o=t}return n!=null})}if(n){r=true;if(!t.items){t.items=[]}t.items.push({key:a.PropertyValue,text:a.Text});i[e.PropertyName].ranges.splice(o,1)}})}});if(r){o=JSON.stringify(i)}}}return o};i.createFromSelectionAndPresentationVariantAnnotation=function(e,t,o){var s={};if(t&&t.SelectOptions&&t.SelectOptions.length){s.SelectOptions=t.SelectOptions.map(function(e){return{PropertyName:e.PropertyName.PropertyPath,Ranges:e.Ranges.map(function(e){var t=new n(null,"/");return{Sign:r.getSelectionRangeSignType([e.Sign.EnumMember]),Option:r.getSelectionRangeOptionType([e.Option.EnumMember]),Low:e.Low&&a.format(t,e.Low)||undefined,High:e.High&&a.format(t,e.High)||undefined}})}})}if(t&&t.Parameters&&t.Parameters.length){s.Parameters=t.Parameters.map(function(e){var t=new n(null,"/");return{PropertyName:e.PropertyName.PropertyPath,PropertyValue:e.PropertyValue&&a.format(t,e.PropertyValue)||undefined}})}var u={};if(o&&o.lineItemAnnotation){if(!u.Visualizations){u.Visualizations=[]}var l=[];if(o.lineItemAnnotation.fields){var f=o.lineItemAnnotation.labels;var p=o.lineItemAnnotation.urlInfo;var m=o.lineItemAnnotation.importance;var c=o.lineItemAnnotation.criticality;o.lineItemAnnotation.fields.forEach(function(e){var t={Value:e};t.Label=f[e]?f[e]:null;t.IconUrl=p[e]?p[e]:null;t.Importance=m[e]?m[e]:null;t.Criticality=c[e]?c[e]:null;l.push(t)})}u.Visualizations.push({Type:"LineItem",Content:l})}if(o&&o.chartAnnotation){if(!u.Visualizations){u.Visualizations=[]}u.Visualizations.push({Type:"Chart",Content:{ChartType:o.chartAnnotation.chartType,Measures:o.chartAnnotation.measureFields,MeasureAttributes:Object.keys(o.chartAnnotation.measureAttributes).map(function(e){return{Measure:e,Role:o.chartAnnotation.measureAttributes[e].role}}),Dimensions:o.chartAnnotation.dimensionFields,DimensionAttributes:Object.keys(o.chartAnnotation.dimensionAttributes).map(function(e){return{Dimension:e,Role:o.chartAnnotation.dimensionAttributes[e].role}})}})}if(o&&o.maxItems){u.MaxItems=parseInt(o.maxItems)}if(o&&o.sortOrderFields){u.SortOrder=o.sortOrderFields.map(function(e){return{Property:e.name,Descending:e.descending}})}if(o&&o.groupByFields){u.GroupBy=o.groupByFields}if(o&&o.requestAtLeastFields){u.RequestAtLeast=o.requestAtLeastFields}return new i({presentationVariant:!jQuery.isEmptyObject(u)?u:undefined,selectionVariant:!jQuery.isEmptyObject(s)?s:undefined,variantName:e?e:undefined})};i.calcSemanticDates=function(e,t){var r=null;var a=function(e,t){var a=null;if(!r){r={Dates:[]}}for(var n=0;n<r.Dates.length;n++){if(r.Dates[n].PropertyName===e){a=r.Dates[n];break}}if(!a){a={PropertyName:e,Data:t.conditionTypeInfo.data};r.Dates.push(a)}};if(t&&e&&e.SelectOptions){e.SelectOptions.forEach(function(e){if(t[e.PropertyName]){if(t[e.PropertyName].ranges){if(t[e.PropertyName].hasOwnProperty("conditionTypeInfo")){a(e.PropertyName,t[e.PropertyName])}}}})}return r};i.enrichWithSemanticDates=function(e,t){var r=false,a,n=e;if(t&&t.Dates){if(!a){a=JSON.parse(e)}t.Dates.forEach(function(e){var t=a[e.PropertyName];if(t&&t.ranges&&e.Data){r=true;if(!t.items){t.items=[]}t.ranges[0].semantic=e.Data}});if(r){n=JSON.stringify(a)}}return n};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/transport/TransportDialog", ["sap/ui/fl/transport/TransportDialog"],function(r){"use strict";var a=r.extend("sap.ui.comp.transport.TransportDialog",{metadata:{library:"sap.ui.comp",deprecated:true},renderer:{apiVersion:2}});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/type/Interval", ["sap/ui/comp/util/DateTimeUtil","sap/ui/model/CompositeType","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/core/LocaleData"],function(e,t,i,a,n,r){"use strict";var s=t.extend("sap.ui.comp.type.Interval",{constructor:function(){t.apply(this,arguments);this.sName="Interval";this.bUseInternalValues=true}});s.prototype.formatValue=function(e,t){if(e==undefined||e==null){return null}if(!Array.isArray(e)){throw new i("Cannot format interval: "+e+" is expected as an Array but given the wrong format")}if(e.length<1||e.length>2){throw new i("Cannot format interval: "+e+" is expected as an Array with 1 or 2 entries")}if(!t){t="string"}switch(this.getPrimitiveType(t)){case"string":case"any":if(e[0]===null&&(e.length===1||e[1]===null)){return""}var a=this.oFormatOptions.type;var n=l.call(this,a);var r;var s;var o;if(a){if(a.isA("sap.ui.model.odata.type.Time")){r=a.formatValue(u(e[0]),"string")}else{r=a.formatValue(e[0],"string")}}else{r=e[0]}if(e.length===1||e[1]===null){o=r}else{if(a){if(a.isA("sap.ui.model.odata.type.Time")){s=a.formatValue(u(e[1]),"string")}else{s=a.formatValue(e[1],"string")}}else{s=e[1]}o=n.replace(/\{0\}/g,r).replace(/\{1\}/g,s)}return o;default:throw new i("Don't know how to format Interval to "+t)}};s.prototype.parseValue=function(e,t,i){if((!t||t==="any")&&typeof e==="string"){t="string"}switch(this.getPrimitiveType(t)){case"string":if(!e){return[null,null]}var n=this.oFormatOptions.type;var r=l.call(this,n);var s=o.call(this,n);var u=[];var p=e.indexOf(s);var m=null;var h=null;if(p<0&&s.length>1){s=s.replace(/\s+/g,"");p=e.indexOf(s)}if(p<0&&s!==" - "&&s!=="-"){s=" - ";p=e.indexOf(s)}if(p<0&&s!=="-"){s="-";p=e.indexOf(s)}if(p===0&&s==="-"){p=e.slice(1).indexOf(s);if(p>=0){p++}}if(p<0){m=e;if(!m){throw new a(e+" is not a valid interval")}}else if(p===0){m="";h=e.slice(s.length);if(!h){throw new a(e+" is not a valid interval")}}else{m=e.slice(0,p);h=e.slice(p+s.length);if(!m||!h){throw new a(e+" is not a valid interval")}}if(n){m=n.parseValue(m,"string");if(n.isA("sap.ui.model.odata.type.Time")){m=f(m)}if(p>=0){h=n.parseValue(h,"string");if(n.isA("sap.ui.model.odata.type.Time")){h=f(h)}}}if(r.indexOf("{0}")<r.indexOf("{1}")){u.push(m);u.push(h)}else{u.push(h);u.push(m)}return u;default:throw new a("Don't know how to parse Interval from "+t)}};s.prototype.validateValue=function(e){if(e==undefined||e==null){return}if(!Array.isArray(e)){throw new n("An array is expected")}if(e.length<1||e.length>2){throw new n("There must be only one or two values in the array")}if(e.length===2&&e[1]!==null&&typeof e[0]!==typeof e[1]){throw new n("Low and high value must have the same type")}var t=this.oFormatOptions.type;if(t){if(t.isA("sap.ui.model.odata.type.Time")){t.validateValue(u(e[0]))}else{t.validateValue(e[0])}if(e.length===2&&e[1]!==null){if(t.isA("sap.ui.model.odata.type.Time")){t.validateValue(u(e[1]))}else{t.validateValue(e[1])}}}if(typeof e[0]==="number"){if(e.length===2&&e[1]!==null&&e[0]>e[1]){throw new n("Low value must be smaller than high value")}}else if(e[0]instanceof Date){if(e.length===2&&e[1]instanceof Date&&e[0]>e[1]){throw new n("Low value must be smaller than high value")}}};s.prototype._handleLocalizationChange=function(){delete this._sPattern;delete this._sDelimiter};function l(e){if(this.oFormatOptions.delimiter){return"{0} "+this.oFormatOptions.delimiter+" {1}"}else if(!this._sPattern){var t=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();var i=r.getInstance(t);if(e&&(e.isA("sap.ui.model.type.Time")||e.isA("sap.ui.model.odata.type.Time")||e.isA("sap.ui.model.type.Date")||e.isA("sap.ui.model.odata.type.Date")||e.isA("sap.ui.model.type.DateTime")||e.isA("sap.ui.model.odata.type.DateTime")||e.isA("sap.ui.model.odata.type.DateTimeOffset")||e.isA("sap.ui.model.odata.type.TimeOfDay"))){this._sPattern=i.getIntervalPattern()}else{this._sPattern=i.getMiscPattern("range")}return this._sPattern}else{return this._sPattern}}function o(e){if(this.oFormatOptions.delimiter){return this.oFormatOptions.delimiter}else if(!this._sDelimiter){var t=l.call(this,e);this._sDelimiter=t.replace(/\{0\}/g,"").replace(/\{1\}/g,"");return this._sDelimiter}else{return this._sDelimiter}}function u(t){if(t instanceof Date){t=e.localToUtc(t);return e.dateToEdmTime(t)}else{return t}}function f(t){var i;if(t&&t.ms){i=e.edmTimeToDate(t);return e.utcToLocal(i)}else{return t}}return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/DateTimeUtil", ["sap/ui/core/format/TimezoneUtil"],function(e){"use strict";var t=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,n=sap.ui.getCore().getConfiguration().getTimezone();var i={localToUtc:function(e){var t,n="0",i=e.getFullYear().toString().padStart(4,n)+"-"+(e.getMonth()+1).toString().padStart(2,n)+"-"+e.getDate().toString().padStart(2,n)+"T00:00:00.000Z";t=new Date(i);t.setUTCHours(e.getHours());t.setUTCMinutes(e.getMinutes());t.setUTCSeconds(e.getSeconds());t.setUTCMilliseconds(e.getMilliseconds());return t},utcToLocal:function(e){var t,n="0",i=e.getUTCFullYear().toString().padStart(4,n)+"-"+(e.getUTCMonth()+1).toString().padStart(2,n)+"-"+e.getUTCDate().toString().padStart(2,n)+"T00:00:00.000";t=new Date(i);t.setHours(e.getUTCHours());t.setMinutes(e.getUTCMinutes());t.setSeconds(e.getUTCSeconds());t.setMilliseconds(e.getUTCMilliseconds());return t},dateToEdmTime:function(e){return{__edmType:"Edm.Time",ms:e.valueOf()}},edmTimeToDate:function(e){return new Date(e.ms)},adaptPrecision:function(e,t){var n=e.getMilliseconds(),i;if(isNaN(t)||t>=3||n===0){return e}if(t===0){n=0}else if(t===1){n=Math.floor(n/100)*100}else if(t===2){n=Math.floor(n/10)*10}i=new Date(e);i.setMilliseconds(n);return i},isDate:function(e,t){if(t){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}else{return e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0&&e.getMilliseconds()===0}},normalizeDate:function(e,t){var n;if(this.isDate(e,t)){return e}n=new Date(e);if(t){n.setUTCHours(0,0,0,0)}else{n.setHours(0,0,0,0)}return n},toTimezone:function(t,n){if(!(t instanceof Date)){t=new Date(t)}if(e.isValidTimezone(n)){return e.convertToTimezone(t,n)}return t},localToUiTimezone:function(e){var t=new Date(e.toLocaleString("en-US",{timeZone:n}));var i=e.getTime()-t.getTime();return new Date(e.getTime()-i)},uiTimezoneToLocal:function(e){if(!(e instanceof Date)){e=new Date(e)}var t=new Date(e.toLocaleString("en-US",{timeZone:n}));var i=t.getTime()-e.getTime();return new Date(e.getTime()-i)},uiTimezoneToUtc:function(e){var t=new Date(e.toLocaleString("en-US",{timeZone:"UTC"}));var i=new Date(e.toLocaleString("en-US",{timeZone:n}));var o=i.getTime()-t.getTime();return new Date(e.getTime()-o)},localToTimezone:function(t,i){if(!e.isValidTimezone(i)){return t}var o=new Date(t.toLocaleString("en-US",{timeZone:i}));var r=new Date(t.toLocaleString("en-US",{timeZone:n}));var a=r.getTime()-o.getTime();return new Date(t.getTime()-a)},_parseJsonDateString:function(e){var n=e&&t.exec(e);if(n){var i=new Date(parseInt(n[1]));if(n[2]){var o=parseInt(n[3]);if(n[2]==="-"){o=-o}var r=i.getUTCMinutes();i.setUTCMinutes(r-o);i.__edmType="Edm.DateTimeOffset"}if(!isNaN(i.valueOf())){return i}}},_hasJsonDateString:function(e){return t.test(e)}};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FilterUtil", [],function(){"use strict";return{getTransformedExcludeOperation:function(t){var n={EQ:"NE",GE:"LT",LT:"GE",LE:"GT",GT:"LE",BT:"NB",Contains:"NotContains",StartsWith:"NotStartsWith",EndsWith:"NotEndsWith"}[t];return n?n:t}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FormatUtil", ["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/P13nConditionPanel","sap/ui/comp/odata/ODataType","sap/ui/model/odata/type/Currency","sap/ui/model/odata/type/Unit","sap/base/strings/whitespaceReplacer"],function(e,t,r,n,i,a,o){"use strict";var u={CHAR_FIGURE_SPACE:"",CHAR_PUNCTUATION_SPACE:"",MAX_CURRENCY_DIGITS:3,getFormattedExpressionFromDisplayBehaviour:function(e,t,r){return u.getFormatterFunctionFromDisplayBehaviour(e)(t,r)},getFormatterFunctionFromDisplayBehaviour:function(e,t,r){var n=t?"Whitespace":"";var i=r?"OverrideNoData":"";if(i){switch(e){case"descriptionAndId":return u["_get"+i+"TextFormatterForDescriptionAndId"].bind(r);case"idAndDescription":return u["_get"+i+"TextFormatterForIdAndDescription"].bind(r);case"descriptionOnly":return u["_get"+i+"TextFormatterForDescriptionOnly"].bind(r);default:return u["_get"+i+"TextFormatterForIdOnly"].bind(r)}}switch(e){case"descriptionAndId":return u["_get"+n+i+"TextFormatterForDescriptionAndId"];case"idAndDescription":return u["_get"+n+i+"TextFormatterForIdAndDescription"];case"descriptionOnly":return u["_get"+n+i+"TextFormatterForDescriptionOnly"];default:return u["_get"+n+i+"TextFormatterForIdOnly"]}},_processText:function(e,t){if(t){return e}return e.secondText?e.firstText+" ("+e.secondText+")":e.firstText},_getTextFormatterForDescriptionAndId:function(e,t,r){return u._processText({firstText:t?t:e,secondText:t?e:undefined},r)},_getTextFormatterForIdAndDescription:function(e,t,r){return u._processText({firstText:e,secondText:t?t:undefined},r)},_getTextFormatterForDescriptionOnly:function(e,t,r){return u._processText({firstText:t,secondText:undefined},r)},_getTextFormatterForIdOnly:function(e,t,r){return u._processText({firstText:e,secondText:undefined},r)},_getWhitespaceTextFormatterForDescriptionAndId:function(e,t,r){return o(u._getTextFormatterForDescriptionAndId.apply(u,arguments))},_getWhitespaceTextFormatterForIdAndDescription:function(e,t,r){return o(u._getTextFormatterForIdAndDescription.apply(u,arguments))},_getWhitespaceTextFormatterForDescriptionOnly:function(e,t,r){return o(u._getTextFormatterForDescriptionOnly.apply(u,arguments))},_getWhitespaceTextFormatterForIdOnly:function(e,t,r){return o(u._getTextFormatterForIdOnly.apply(u,arguments))},_getOverrideNoDataTextFormatterForDescriptionAndId:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return u._getTextFormatterForDescriptionAndId.apply(u,arguments)},_getOverrideNoDataTextFormatterForIdAndDescription:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return u._getTextFormatterForIdAndDescription.apply(u,arguments)},_getOverrideNoDataTextFormatterForDescriptionOnly:function(e,t,r){if(t==""){return this.getNotAssignedText()}return u._getTextFormatterForDescriptionOnly.apply(u,arguments)},_getOverrideNoDataTextFormatterForIdOnly:function(e,t,r){if(e==""){return this.getNotAssignedText()}return u._getTextFormatterForIdOnly.apply(u,arguments)},getTextsFromDisplayBehaviour:function(e,t,r){return u.getFormatterFunctionFromDisplayBehaviour(e)(t,r,true)},getFormattedRangeText:function(e,t,n,i){return r.getFormatedConditionText(e,t,n,i)},_initialiseCurrencyFormatter:function(){if(!u._oCurrencyFormatter){u._oCurrencyFormatter=e.getCurrencyInstance({showMeasure:false})}if(!u._fAmountCurrencyFormatter){u._fAmountCurrencyFormatter=function(e,t){var r,n;r=u._oCurrencyFormatter.format(e,t);n=u._oCurrencyFormatter.oLocaleData.getCurrencyDigits(t);return u._applyPadding(r,n,u.MAX_CURRENCY_DIGITS)}}},_initialiseUnitFormatter:function(){if(!u._oUnitFormatter){u._oUnitFormatter=e.getUnitInstance({showMeasure:false,maxFractionDigits:3,minFractionDigits:3})}if(!u._fMeasureUnitFormatter){u._fMeasureUnitFormatter=function(e,t){return u._oUnitFormatter.format(e,t)}}},_applyPadding:function(e,t,r){var n;if(typeof e!=="string"){return""}if(t===0&&r>0){e+=u.CHAR_PUNCTUATION_SPACE}n=r-t;if(n){e=e.padEnd(e.length+n,u.CHAR_FIGURE_SPACE)}return e},_getFractionDigitDifference:function(e,t,r,n){if(!t){return 0}var i=t.indexOf(e.oOutputFormat.oFormatOptions.decimalSeparator);if(i<0){return 0}var a=t.substr(i+1).length;if(a<=n&&a>r){return a-r}if(a>n&&r<n){return n-r}return 0},getAmountCurrencyFormatter:function(e){var t=0,r,n;u._initialiseCurrencyFormatter();return function(i,a,o){var s,c;if(i===undefined||i===null||a==="*"){return""}if(!o){return u._fAmountCurrencyFormatter(i,a)}if(!n){n=o;t=u._getMaxCurrencyFractionDigits(n);if(!r){r=u._getCurrencyInstance(e)}}c=n&&n[a]?n[a].UnitSpecificScale:u._oCurrencyFormatter.oLocaleData.getCurrencyDigits(a);s=r.formatValue([i,a||null,n],"string");if(e){c+=u._getFractionDigitDifference(r,s,c,t)}return u._applyPadding(s,c,t)}},_getMaxCurrencyFractionDigits:function(e){var t=0;for(var r in e){if(e[r].UnitSpecificScale&&e[r].UnitSpecificScale>t){t=e[r].UnitSpecificScale}}return t},_getCurrencyInstance:function(e){return new i({showMeasure:false,preserveDecimals:e})},getCurrencySymbolFormatter:function(){u._initialiseCurrencyFormatter();if(!u._fCurrencySymbolFormatter){u._fCurrencySymbolFormatter=function(e){if(!e||e==="*"){return""}return u._oCurrencyFormatter.oLocaleData.getCurrencySymbol(e)}}return u._fCurrencySymbolFormatter},getMeasureUnitFormatter:function(e){u._initialiseUnitFormatter();var t=0,r,n;return function(i,a,o){if(i===undefined||i===null||a==="*"){return""}if(o){if(!n){n=o;t=u._getMaxMeasureUnitFractionDigit(n);if(!r){r=u._getUnitInstance(e,t)}}i=r.formatValue([i,a,n],"string");var s=n[a]&&n[a].UnitSpecificScale!=null?n[a].UnitSpecificScale:t;if(e){s+=u._getFractionDigitDifference(r,i,s,t)}return u._applyPadding(i,s,t)}return u._fMeasureUnitFormatter(i,a)+u.CHAR_FIGURE_SPACE}},getInlineMeasureUnitFormatter:function(e){var t=0,r,n;if(!u._fInlineMeasureFormatter){u._fInlineMeasureFormatter=function(e,t){if(e===undefined||e===null||t==="*"){return""}if(!t){return e}return e+u.CHAR_FIGURE_SPACE+t}}return function(i,a,o){if(o){if(!n){n=o;t=u._getMaxMeasureUnitFractionDigit(n);if(!r){r=u._getUnitInstance(e,t)}}i=r.formatValue([i,a,n],"string");return i+u.CHAR_FIGURE_SPACE+a}return u._fInlineMeasureFormatter(i,a)}},_getUnitInstance:function(e,t){return new a({showMeasure:false,preserveDecimals:e,maxFractionDigits:t})},_getMaxMeasureUnitFractionDigit:function(e){var t=0;for(var r in e){var n=e[r].UnitSpecificScale;if(n>3){e[r].UnitSpecificScale=3;n=3}if(t<3&&n>t&&n<=3){t=n}}return t},getInlineAmountFormatter:function(e){var t,r;u._initialiseCurrencyFormatter();if(!u._fInlineAmountFormatter){u._fInlineAmountFormatter=function(e,t){var r;if(e===undefined||e===null||t==="*"){return""}r=u._oCurrencyFormatter.format(e,t);return r+u.CHAR_FIGURE_SPACE+t}}return function(n,i,a){if(n===undefined||n===null||i==="*"){return""}if(!a){return u._fInlineAmountFormatter(n,i)}if(!r){r=a;if(!t){t=u._getCurrencyInstance(e)}}var o=t.formatValue([n,i||null,r],"string");return o+u.CHAR_FIGURE_SPACE+i}},getInlineGroupFormatterFunction:function(e,t,r,i,a,o){var s=e.type==="Edm.String"&&!e.isCalendarDate&&!e.isDigitSequence;if(e.unit){return u.getRelevantUnitFormatterFunction(o,e,i)}else if(!t&&s&&e.description){return u.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,a)}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"&&r&&r["UTC"]){var c={displayFormat:"Date"};var f={isCalendarDate:e.isCalendarDate};var m=n.getType(e.type,r,c,f);return function(e){return m.formatValue(e,"string")}}else if(e.modelType){return function(t){return e.modelType.formatValue(t,"string")}}},getWidth:function(e,t,r){var n=e.maxLength||e.precision,i,a;if(!t){t=30}if(!r){r=3;a=true}if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){n="9em"}else if(n){if(e.type==="Edm.String"&&e.description&&e.displayBehaviour&&(e.displayBehaviour==="descriptionAndId"||e.displayBehaviour==="descriptionOnly")){n="Max"}if(n==="Max"){n=t+""}i=parseInt(n);if(!isNaN(i)){i+=.75;if(i>t){i=t}else if(i<r){i=r}n=i+"em"}else{n=null}}if(!n){if(e.type==="Edm.Boolean"){if(a){r+=.25}n=r+"em"}else{n=t+"em"}}return n},getEdmTimeFromDate:function(e){if(!u._oTimeFormat){u._oTimeFormat=t.getTimeInstance({pattern:"'PT'HH'H'mm'M'ss'S'"})}return u._oTimeFormat.format(e)},parseFilterNumericIntervalData:function(e){var t=[],r=e.match(RegExp("^(-?[^-]*)-(-?[^-]*)$"));if(r&&r.length>=2){t.push(r[1]);t.push(r[2])}return t},parseDateTimeOffsetInterval:function(e){var t=e.split("-"),r=[e],n=0;if(t.length%2===0){r=[];for(var i=0;i<t.length/2;i++){n=e.indexOf("-",++n)}r.push(e.substr(0,n).replace(/\s+/g,""));r.push(e.substr(n+1).replace(/\s+/g,""))}return r},_getFilterType:function(e){if(e.isFiscalDate){return"date"}else if(e.isDigitSequence){return"numc"}else if(n.isNumeric(e.type)){return"numeric"}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"){return"date"}else if(e.type==="Edm.DateTimeOffset"){return"datetime"}else if(e.type==="Edm.String"){if(e.isCalendarDate){return"stringdate"}return"string"}else if(e.type==="Edm.Guid"){return"guid"}else if(e.type==="Edm.Boolean"){return"boolean"}else if(e.type==="Edm.Time"){return"time"}return undefined},getWhitespaceReplacer:function(e){return e?o:undefined},getDateTimeWithTimezoneFormatter:function(e){if(!e&&!u._oDateTimeWithTimezone){u._oDateTimeWithTimezone=t.getDateTimeWithTimezoneInstance()}return function(r,n){if(!r){return""}return e?t.getDateTimeWithTimezoneInstance(e).format(r,n):u._oDateTimeWithTimezone.format(r,n)}},getRelevantUnitFormatterFunction:function(e,t,r){var n,i=t.isCurrencyField,a=i?u.getInlineAmountFormatter(r):u.getInlineMeasureUnitFormatter(r);if(e){if(i){e.requestCurrencyCodes().then(function(e){n=e})}else{e.requestUnitsOfMeasure().then(function(e){n=e})}}return function(e,r){if(!n){if(i){return a(e,r)}if(t.modelType){e=t.modelType.formatValue(e,"string")}return a(e,r)}return a(e,r,n)}}};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FullScreenUtil", ["sap/ui/thirdparty/jquery","sap/m/Dialog","sap/ui/core/HTML"],function(jQuery,e,l){"use strict";var o={toggleFullScreen:function(o,a,n,i,r,t){var g;if(a){g=o.$();g.css("height","100%");if(g){if(!o._oHTML){o._oHTML=new l({preferDOM:false,afterRendering:function(){if(o&&o._oHTML){var e=o._oHTML.$(),l;if(e){l=e.children();l.remove();e.css("height","100%");e.append(o.getDomRef())}}}})}if(!o._oFullScreenDialog){o._oFullScreenDialog=new e({showHeader:false,stretch:true,horizontalScrolling:!t,verticalScrolling:!t,beforeClose:function(){if(o&&o._$placeHolder&&i){i.call(o,false)}},content:[o._oHTML]});if(r){o._oFullScreenDialog.addStyleClass(r)}if(n){o._oFullScreenDialog.attachAfterOpen(function(){n.focus();if(o._oGrowingDelegate&&o._oGrowingDelegate.onAfterRendering){o._oOldParent=o.oParent;o.oParent=o._oFullScreenDialog;o._oGrowingDelegate.onAfterRendering();o.oParent=o._oOldParent;delete o._oOldParent}});o._oFullScreenDialog.attachAfterClose(function(){n.focus()})}o._oFullScreenDialog.addStyleClass(g.closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"");o._oFullScreenDialog.addStyleClass("sapUiCompSmartFullScreenDialog")}o._$placeHolder=jQuery(document.createElement("div"));g.before(o._$placeHolder);o._oHTML.setContent("<div></div>")}if(!o._oGrowingDelegate){o._oGrowingDelegate=o._oTable||o._oList;if(o._oGrowingDelegate&&o._oGrowingDelegate.getGrowingScrollToLoad&&o._oGrowingDelegate.getGrowingScrollToLoad()){o._oGrowingDelegate=o._oGrowingDelegate._oGrowingDelegate}else{o._oGrowingDelegate=null}}if(o._oTable&&o._oTable.isA("sap.ui.table.Table")){o._oFullScreenDialog.attachEventOnce("afterOpen",function(){o._oTable.invalidate()})}o._oFullScreenDialog.open()}else if(o._$placeHolder&&o._oHTML){var c=o.getHeight&&o.getHeight();var _=o.$();if(c&&c!==_.css("height")){_.css("height",c)}g=o._oHTML.$();o._$placeHolder.replaceWith(g.children());o._$placeHolder=null;g=null;if(o._oFullScreenDialog){o._oFullScreenDialog.close()}}},cleanUpFullScreen:function(e){if(e._oFullScreenDialog){e._oFullScreenDialog.destroy();e._oFullScreenDialog=null}e._$placeHolder=null;e._oHTML=null;e._oGrowingDelegate=null}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/IdentifierUtil", ["sap/ui/base/DataType"],function(e){"use strict";var a={replace:function(a){var i=e.getType("sap.ui.core.ID");if(!i.isValid(a)){a=a.replace(/[^A-Za-z0-9_.:]+/g,"_");if(!i.isValid(a)){a="A_"+a}}return a}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/MultiUnitUtil", ["sap/m/List","sap/m/ResponsivePopover","sap/m/CustomListItem","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/syncStyleClass","sap/base/util/merge"],function(e,t,a,r,i,o,n){"use strict";var s={isMultiUnit:function(e){return e==="*"},isNotMultiUnit:function(e){return e!=="*"},openMultiUnitPopover:function(s,l){var p=sap.ui.getCore().byId(l.smartTableId);var u=p.getTable();var g=u.getBinding("rows");var d=l.value;var c=l.unit;var m=l.template;var T,f;if(!g||!d||!c){return}var v=s.getSource();var y=v.getParent();if(l.additionalParent){y=y.getParent()}var P=u.getAnalyticalInfoOfRow(y.getParent());if(!P){return}var b,L=[],I=[d,c],C=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_TOTAL_TITLE")||"Total";if(g.aApplicationFilter){L=[].concat(g.aApplicationFilter)}var U=u.getBindingInfo("rows");var A=U&&U.parameters&&U.parameters.custom?n({},U.parameters.custom):undefined;if(P.groupTotal||P.group){var B=P.groupedColumns;for(b=0;b<B.length;b++){f=sap.ui.getCore().byId(B[b]).getLeadingProperty();if(!f){continue}T=g.getAnalyticalInfoForColumn(f);if(T){f=T.dimensionPropertyName}if(f){L.push(new r(f,i.EQ,P.context.getProperty(f)))}}C=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_GROUP_TITLE")||"Subtotal"}else if(!P.grandTotal){var S=Object.getOwnPropertyNames(g.getDimensionDetails());for(b=0;b<S.length;b++){L.push(new r(S[b],i.EQ,P.context.getProperty(S[b])))}C=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_GROUP_TITLE")||"Subtotal"}var w=m.clone();w.unbindProperty("visible");var M=l.smartTableId+"-multiUnitPopover",R,_;R=sap.ui.getCore().byId(M);if(!R){_=new e(M+"-detailsList",{showSeparators:"None",ariaLabelledBy:M+"-title"});_.addStyleClass("sapUiContentPadding sapUiCompMultiCurrency");R=new t(M,{content:_});o("sapUiSizeCompact",u,R);u.addDependent(R)}if(!_){_=sap.ui.getCore().byId(M+"-detailsList")}R.setTitle(C);R.setPlacement(P.grandTotal?"VerticalPreferredTop":"VerticalPreferredBottom");_.bindItems({path:g.getPath(),filters:L,parameters:{select:I.join(","),custom:A},templateShareable:false,template:new a({content:[w]})});R.openBy(v)}};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/valuehelpdialog/ItemsCollection", ["sap/ui/comp/util/FormatUtil","sap/ui/base/ManagedObject","sap/m/Token"],function(t,e,i){"use strict";var s=function(){this.items={}};s.prototype.add=function(t,e){this.items[t]=e};s.prototype.remove=function(t){delete this.items[t]};s.prototype.removeAll=function(){this.items={}};s.prototype.getItem=function(t){return this.items[t]};s.prototype.getItems=function(){var t=[];for(var e in this.items){t.push(e)}return t};s.prototype.getSelectedItemsTokenArray=function(s,r,o){var n=[];for(var a in this.items){var p=this.items[a];var u,f;if(typeof p==="string"){f=a;u=p}else{f=p[s];u=p[r];if(u===undefined){u=this.items[a]}else{if(!o){o="descriptionAndId"}u=t.getFormattedExpressionFromDisplayBehaviour(o,f,u)}}var m=new i({key:e.escapeSettingsValue(f)});m.setText(u);m.setTooltip(typeof u==="string"?u:"");if(typeof p!=="string"){m.data("row",p);m.data("longKey",e.escapeSettingsValue(a))}n.push(m)}return n};s.prototype.getModelData=function(){var t=[];for(var e in this.items){var i=this.items[e];if(typeof i==="string"){i={missing:e}}t.push(i)}return t};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/valuehelpdialog/ValueHelpDialog", ["sap/ui/core/Core","sap/base/Log","sap/ui/comp/library","sap/m/Dialog","sap/m/MessageBox","sap/m/Token","./ItemsCollection","sap/ui/core/library","sap/m/VBox","sap/m/HBox","sap/m/FlexBox","sap/ui/comp/util/FormatUtil","sap/m/DialogRenderer","sap/m/FlexItemData","sap/m/Title","sap/m/Text","sap/m/Label","sap/m/Button","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/Tokenizer","sap/m/Panel","sap/m/StandardListItem","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/library","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/IconPool","sap/ui/table/library","sap/ui/table/Table","sap/ui/table/Column","sap/m/Table","sap/m/Column","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/Device","sap/m/List","sap/m/Link","sap/ui/comp/p13n/P13nFilterPanel","sap/m/P13nConditionPanel","sap/m/P13nItem","sap/m/P13nAnyFilterItem","sap/m/CheckBox","sap/ui/comp/p13n/P13nOperationsHelper","sap/ui/core/format/NumberFormat","sap/ui/core/ResizeHandler","sap/base/strings/whitespaceReplacer"],function(e,t,i,s,a,o,n,l,r,h,_,d,u,c,g,p,T,f,b,S,y,I,m,v,C,B,R,k,E,V,L,F,P,x,O,D,A,M,w,N,H,K,z,G,W,U,j,$){"use strict";var q;var Z=B.ButtonType;var Q=B.OverflowToolbarPriority;var J=B.ListMode;var X=B.ListType;var Y=l.HorizontalAlign;var ee=l.InvisibleMessageMode;var te=i.smartfilterbar.DisplayBehaviour;var ie={DESKTOP_LIST_VIEW:"DESKTOP_LIST_VIEW",DESKTOP_CONDITIONS_VIEW:"DESKTOP_CONDITIONS_VIEW",PHONE_MAIN_VIEW:"PHONE_MAIN_VIEW",PHONE_SEARCH_VIEW:"PHONE_SEARCH_VIEW",PHONE_LIST_VIEW:"PHONE_LIST_VIEW",PHONE_CONDITIONS_VIEW:"PHONE_CONDITIONS_VIEW"};var se=s.extend("sap.ui.comp.valuehelpdialog.ValueHelpDialog",{metadata:{library:"sap.ui.comp",properties:{basicSearchText:{type:"string",group:"Misc",defaultValue:""},supportMultiselect:{type:"boolean",group:"Misc",defaultValue:true},supportRanges:{type:"boolean",group:"Misc",defaultValue:false},supportRangesOnly:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:""},keys:{type:"string[]",group:"Misc",defaultValue:null},descriptionKey:{type:"string",group:"Misc",defaultValue:""},maxIncludeRanges:{type:"string",group:"Misc",defaultValue:"-1"},maxExcludeRanges:{type:"string",group:"Misc",defaultValue:"-1"},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},displayFormat:{type:"string",group:"Misc",defaultValue:""},tokenDisplayBehaviour:{type:"string",group:"Misc",defaultValue:""},filterMode:{type:"boolean",group:"Misc",defaultValue:false},_enhancedExcludeOperations:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"},conditionPanelDefaultOperation:{type:"string",group:"Misc",defaultValue:null}},aggregations:{filterBar:{type:"sap.ui.comp.filterbar.FilterBar",multiple:false}},events:{ok:{parameters:{tokens:{type:"sap.m.Token[]"}}},cancel:{},selectionChange:{parameters:{tableSelectionParams:{type:"object"},updateTokens:{type:"object[]"},useDefault:{type:"boolean",defaultValue:false},table:{type:"object"}}},tokenRemove:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean",defaultValue:false}}},updateSelection:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean",defaultValue:false}}}}},renderer:{apiVersion:2}});se.prototype.setSupportMultiselect=function(e){this.setProperty("supportMultiselect",e);this._updatePropertySupportMultiselect(e);this._oTokenizerGrid.setVisible(e);this._oButtonOk.setVisible(e);return this};se.prototype._updatePropertySupportMultiselect=function(e){if(!this._oTable){return undefined}if(!this._isPhone()){if(this._oTable.setSelectionMode){this._oTable.setSelectionMode(e?V.SelectionMode.MultiToggle:V.SelectionMode.Single)}}else if(this._oTable.setMode){this._oTable.setMode(e?J.MultiSelect:J.SingleSelectLeft)}return this};se.prototype.setSupportRanges=function(e){this.setProperty("supportRanges",e);this._updateNavigationControl();return this};se.prototype.setSupportRangesOnly=function(e){this.setProperty("supportRangesOnly",e);this._updateNavigationControl();return this};se.prototype.setTitle=function(e){this.setProperty("title",e);this._updateDlgTitle();return this};se.prototype.setFilterBar=function(e){this.setAggregation("filterBar",e);if(this._oMainLayout&&e){if(this._isPhone()){if(this._oFilterBar){this._oContentContainer.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}}else if(this._oFilterBar){this._oMainLayout.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}this._oFilterBar=e;this._oFilterBar.attachInitialise(this._handleFilterBarInitialize,this);if(this._oFilterBar){this._oFilterBar.addStyleClass("compVHSearch");if(this._isPhone()){var t=sap.ui.getCore().byId(this._oFilterBar.getBasicSearch());if(t&&t.isA("sap.m.SearchField")){t.setShowSearchButton(true);t.attachSearch(function(e){if(e.mParameters.refreshButtonPressed!==undefined){this.getFilterBar().search()}}.bind(this))}this._oFilterBar.setShowGoOnFB(false);this._oColSearchBox.setLayoutData(new c({shrinkFactor:0}));this._oContentContainer.insertItem(this._oColSearchBox,0);this._oFilterBar.setLayoutData(new c({shrinkFactor:0}));this._oContentContainer.insertItem(this._oFilterBar,1);this._oFilterBar.attachSearch(function(e){this._updateView(ie.PHONE_LIST_VIEW)}.bind(this));if(this._currentViewMode===ie.PHONE_LIST_VIEW){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false);this._handleFilterBarInitialize()}}else{this._oFilterBar._setCollectiveSearch(this._oColSearchBox);this._oMainLayout.insertItem(this._oFilterBar,0)}}if(ne(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar._oSearchButton){this.setInitialFocus(this._oFilterBar._oSearchButton)}if(this._oFilterBar._oBasicSearchField){var i=this._oFilterBar._oBasicSearchField;i.setValue(this.getBasicSearchText());if(!ne(this._oTabBar)){this.setInitialFocus(i)}}}return this};se.prototype._handleFilterBarInitialize=function(){if(this._currentViewMode===ie.PHONE_LIST_VIEW){this._oFilterBar._handleVisibilityOfToolbar();var e=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(e);this._oFilterBar.setShowGoButton(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()))}this._setToolbarSpacerWidth();if(ne(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}};se.prototype.getFilterBar=function(){return this._oFilterBar};se.prototype.setBasicSearchText=function(e){this.setProperty("basicSearchText",e);if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this._oFilterBar._oBasicSearchField.setValue(e)}return this};se.prototype.setTokens=function(e){var t=true;if(e.length){var i=0,s;for(var a=0;a<e.length;a++){var n=e[a];if(n.data("range")){var l=Object.assign({},n.data("range"));s=n.getKey();if(!s){do{s="range_"+i;i++}while(this._oSelectedRanges[s])}var r=this._getFormatedRangeTokenText(l.operation,l.value1,l.value2,l.exclude,l.keyField);this._addToken2Tokenizer(s,r,this._getTokenizer(),l.keyField);this._oSelectedRanges[s]=l;t=false}else{s=n.getKey();var h=n.getText();var _=n.data("longKey");var d=n.data("row");if(!_){_=s}this._oSelectedItems.add(_,d?d:n.getText());var u=new o(oe.call(this,_));u.setKey(_);u.setText(h);u.setTooltip(h);this._getTokenizer().addToken(u)}}}else{this._oSelectedItems.removeAll();this._oSelectedRanges={};this._getTokenizer().destroyTokens()}if(t){this._updateTokenizer()}};se.prototype.open=function(){if(!this._oTable&&!(this._isPhone()&&(this.getSupportRangesOnly()||this.getFilterMode()))){return ae.call(this).then(function(){return this.open()}.bind(this))}this._bIgnoreSelectionChange=false;if(this._oColSearchBox){this._bIsMdcCollectiveSearch=this._oColSearchBox.isA("sap.ui.mdc.filterbar.vh.CollectiveSearchSelect");if(this._bIsMdcCollectiveSearch){this.bCollectiveSearchActive=this._oColSearchBox.getVisible()}else{this.bCollectiveSearchActive=this.oSelectionTitle.getVisible()&&this.oSelectionButton.getVisible();this._oColSearchBox.setVisible(this.bCollectiveSearchActive)}}if(!this._isPhone()){if(this.getSupportRangesOnly()||this.getFilterMode()){this._updateView(ie.DESKTOP_CONDITIONS_VIEW)}if(this.isPropertyInitial("contentWidth")){this.setContentWidth(this._getDefaultContentWidth())}}else{this._updateView(ie.PHONE_MAIN_VIEW)}s.prototype.open.apply(this);if(ne(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}else if(!this._oFilterBar&&this._currentViewMode==="DESKTOP_CONDITIONS_VIEW"){if(this._oFilterPanel&&this._oFilterPanel._oConditionPanel){var e=this._oFilterPanel._oConditionPanel._oConditionsGrid.getAggregation("content")[0].operation;this.setInitialFocus(e)}}return this};se.prototype.getTable=function(){t.warning("Please use getTableAsync to prevent synchronous calls.",this);if(!this._oTable){this._createDefaultTable()}return this._oTable};se.prototype.getTableAsync=function(){if(this._oTablePromise){return this._oTablePromise}else if(!this._oTable){return ae.call(this)}else{return new Promise(function(e){e(this._oTable)}.bind(this))}};se.prototype.setTable=function(e){if(this._oTable){this._oMainLayout.removeItem(this._oTable);if(this._bTableCreatedInternal){this._oTable.destroy();this._oTable=null}}this._bTableCreatedInternal=arguments.length>1&&arguments[1]==true;if(e&&e.isA("sap.ui.comp.smarttable.SmartTable")){this._oTable=e.getTable()}else{this._oTable=e}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._oTable.setEnableBusyIndicator(true);if(this._oTable.isA("sap.ui.table.AnalyticalTable")){q=sap.ui.require("sap/ui/table/AnalyticalColumn")}}this._oTable.setLayoutData(new c({shrinkFactor:0,growFactor:1}));this.theTable=this._oTable;this._initializeTable();this._oMainLayout.addItem(e)};se.prototype._getDefaultContentWidth=function(){var e;if(A.system.desktop){e=1080}else if(A.system.tablet){if(A.orientation.landscape){e=920}else if(A.orientation.portrait){e=600}}return e+"px"};se.prototype.resetTableState=function(){if(this._oTable){if(this._oTable.unbindRows){this._oTable.unbindRows()}this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))}};se.prototype.TableStateSearchData=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))};se.prototype._updateNoDataText=function(e){if(this._oTable){if(this._oTable.setNoData){this._oTable.setNoData(e)}else if(this._oTable.setNoDataText){this._oTable.setNoDataText(e)}}};se.prototype.TableStateDataFilled=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_NODATA"))};se.prototype.TableStateDataSearching=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_SEARCHING"))};se.prototype.init=function(){s.prototype.init.apply(this);this._oTokenIdCount={};this._bTableCreatedInternal=false;this._aIncludeRangeOperations={};this._aExcludeRangeOperations={};this._bInitTokensHaveChanged;this.setStretch(this._isPhone());this.setResizable(!this._isPhone());this.setDraggable(!this._isPhone());this.bCollectiveSearchActive=false;this.addStyleClass("compValueHelpDialog");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._sTableTitle1=this._oRb.getText("VALUEHELPDLG_TABLETITLE1");this._sTableTitle2=this._oRb.getText("VALUEHELPDLG_TABLETITLE2");this._sTableTitleNoCount=this._oRb.getText("VALUEHELPDLG_TABLETITLENOCOUNT");this._currentViewMode=null;this._oSelectedItems=new n;this._oSelectedRanges={};this._oOperationsHelper=new W;this._fnRejectTablePromise;this._createHeaderBar();this._createCollectiveSearch();this._createTokenizer();this._updateTokenizer();this._oNavigationContainer=new r(this.getId()+"-navigationContainer",{width:"100%",layoutData:new c({growFactor:0,shrinkFactor:0})});this._oContentContainer=new r(this.getId()+"-vbox",{width:"100%",height:"100%"}).addStyleClass("compVHContentContainerVbox");this._oContainersWrapper=new _(this.getId()+"-containersWrapper",{alignItems:"Start",height:"100%",width:"100%",direction:"Column",justifyContent:"SpaceBetween",items:[this._oNavigationContainer,this._oContentContainer]});this.addContent(this._oContainersWrapper);this._oMainLayout=new r(this.getId()+"-mainLayout",{fitContainer:true,items:[this._oFilterBar],layoutData:new c({growFactor:1,shrinkFactor:0,styleClass:"mainLayout"})});this._createNavigationControl();this._updateNavigationControl();this._oContentContainer.addItem(this._oMainLayout);if(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode()){this._oContentContainer.addItem(this._oTokenizerGrid)}this._createFooterControls();this.setVerticalScrolling(false);this.setHorizontalScrolling(false);if(!A.system.desktop){this._oContentContainer.attachBrowserEvent("touchmove",function(e){e.setMarked()})}if(!this._isPhone()){this._updateView(ie.DESKTOP_LIST_VIEW)}if(!this._oInvisibleMessage){this._oInvisibleMessage=k.getInstance()}};se.prototype._updateView=function(e){if(this._currentViewMode===e){return}switch(e){case ie.DESKTOP_LIST_VIEW:this._validateRanges(function(){this._oTokenizerGrid.setVisible(this.getSupportMultiselect());this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==ie.DESKTOP_LIST_VIEW){this._oTabBar.setSelectedKey(ie.DESKTOP_LIST_VIEW)}this._oMainLayout.addItem(this._oFilterBar);this._oMainLayout.addItem(this._oTable);this._updateDlgTitle()}.bind(this),function(){this._oTabBar.setSelectedKey(ie.DESKTOP_CONDITIONS_VIEW);this._updateView(ie.DESKTOP_CONDITIONS_VIEW)}.bind(this));break;case ie.DESKTOP_CONDITIONS_VIEW:if(this.getSupportRanges()){this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==ie.DESKTOP_CONDITIONS_VIEW){this._oTabBar.setSelectedKey(ie.DESKTOP_CONDITIONS_VIEW)}this._createAddRanges();this._oButtonOk.setVisible(this.getSupportRangesOnly()||this.getSupportMultiselect());this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}}break;case ie.PHONE_MAIN_VIEW:this.setVerticalScrolling(false);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(true);this._updateNavigationControl();this._oAdvancedSearchLink.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(false);this._bNoneMainView=false;if(!(this._oSelectItemLI.getVisible()&&this._oDefineConditionsLI.getVisible())){this._bNoneMainView=true;if(this._oSelectItemLI.getVisible()){this._updateView(ie.PHONE_LIST_VIEW)}if(this._oDefineConditionsLI.getVisible()){this._updateView(ie.PHONE_CONDITIONS_VIEW)}return}break;case ie.PHONE_LIST_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(this.bCollectiveSearchActive);if(this._bIsMdcCollectiveSearch){this._oColSearchBox.addStyleClass("sapUiTinyMarginBegin");this._oColSearchBox.oVariantText.removeStyleClass("sapUiMdcCollectiveSearchSelectTextPhoneMaxWidth")}this._oMainListMenu.setVisible(false);if(this._oFilterBar){var t=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(t);this._oFilterBar.setShowGoButton(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()));this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(true)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(this.getSupportMultiselect());this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;case ie.PHONE_SEARCH_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(true)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(true);this._oButtonClear.setVisible(this._oFilterBar&&this._oFilterBar.getShowClearOnFB());this._oButtonOk.setVisible(false);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(true);break;case ie.PHONE_CONDITIONS_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(!this._oRanges){this._createAddRanges()}if(this._oRanges){this._oRanges.setVisible(true)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;default:break}if(this._oMainListMenu&&this._oContentContainer){if(this._oFilterBar){this._oFilterBar._handleVisibilityOfToolbar()}this._oContentContainer.rerender()}this._currentViewMode=e;this._updateDlgTitle()};se.prototype._changeTableRowSelectionForKey=function(e,t){var i;var s=this._oTable;this._bIgnoreSelectionChange=true;if(s&&s.isA("sap.ui.table.Table")){var a=s.getBinding("rows");if(a){if(a.aKeys){for(i=0;i<a.aKeys.length;i++){if(decodeURIComponent(a.aKeys[i])===e){if(t){s.addSelectionInterval(i,i)}else{s.removeSelectionInterval(i,i)}break}}}else{this.oRows=s.getBinding("rows");if(this.oRows.aIndices){for(i=0;i<this.oRows.aIndices.length;i++){var o=s.getContextByIndex(this.oRows.aIndices[i]);if(o){var n=o.getObject();if(n[this.getKey()]===e){if(t){s.addSelectionInterval(i,i)}else{s.removeSelectionInterval(i,i)}break}}}}}}}else{for(i=0;i<s.getItems().length;i++){var l=s.getItems()[i];var r=l.getBindingContext().getObject();if(r[this.getKey()]===e){s.setSelectedItem(l,t);break}}}this._bIgnoreSelectionChange=false};se.prototype.update=function(){var e,t,i,s;var a;var o=this._oSelectedItems.getItems();var n={tokenKeys:o,useDefault:false};this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(n)}else{n.useDefault=true}if(n.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");this._oTable.clearSelection();if(this.oRows&&this.oRows.aKeys){var l=this.getKeys();var r=l&&l.length>1?this.getKey()+"=":"";for(t=0;t<o.length;t++){a=o[t];var h=r+"'"+a+"'";for(e=0;e<this.oRows.aKeys.length;e++){var _=this.oRows.aKeys[e];if(_===undefined){continue}_=decodeURIComponent(_);var d=_===a;if(d||_.indexOf(h)>=0){if(!d){this._oSelectedItems.remove(a);var u=this._getTokenByKey(a,this._getTokenizer());if(u){u.setKey(_)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(_,i)}this._oTable.addSelectionInterval(e,e);break}}}}else if(this.oRows&&this.oRows.aIndices){this._oTable.clearSelection();var c=this._oTable.getBinding("rows").getContexts();for(t=0;t<o.length;t++){var g=o[t];for(e=0;e<this.oRows.aIndices.length;e++){s=c[e];if(s){i=s.getObject();if(i[this.getKey()]===g){this._oSelectedItems.add(i[this.getKey()],i);this._oTable.addSelectionInterval(e,e);break}}}}}}else{var p=this._oTable;for(t=0;t<o.length;t++){a=o[t];for(e=0;e<p.getItems().length;e++){var T=p.getItems()[e];var f=T.getBindingContext().getObject();if(f[this.getKey()]===a){p.setSelectedItem(T,true);break}}}}}this._bIgnoreSelectionChange=false;if(this._bTriggerInvisibleTableCountMessageNotInitialLoad){this._bTriggerInvisibleTableCountMessage=true}this._updateTitles();this._bTriggerInvisibleTableCountMessageNotInitialLoad=true};se.prototype._createHeaderBar=function(){this._oTitle=new g(this.getId()+"-title");var e=null;if(this._isPhone()){e=new f(this.getId()+"-back",{visible:false,type:Z.Back,press:function(e){if(this._currentViewMode===ie.PHONE_SEARCH_VIEW){this._updateView(ie.PHONE_LIST_VIEW)}else{this._updateView(ie.PHONE_MAIN_VIEW)}}.bind(this)});this._oBackButton=e}this._oTitle.addStyleClass("sapUiSmallMarginBeginEnd");var t=new b(this.getId()+"-header",{contentLeft:[e,this._oTitle],design:"Header"});this.setCustomHeader(t);this.getCustomHeader().addStyleClass("sapContrastPlus")};se.prototype._createCollectiveSearch=function(){this.oSelectionTitle=new p(this.getId()+"-selTitle",{visible:false,wrapping:false}).addStyleClass("compVHColSearchText");if(A.system.tablet&&!A.system.desktop){this.oSelectionTitle.addStyleClass("compVHColSearchTextTabletMaxWidth")}else{this.oSelectionTitle.addStyleClass("compVHColSearchTextMaxWidth")}this.oSelectionButton=new f(this.getId()+"-selButton",{icon:"sap-icon://slim-arrow-down",tooltip:this._oRb.getText("VALUEHELPVALDLG_SEARCHTEMPLATES_TOOLTIP"),type:Z.Transparent,visible:false,ariaLabelledBy:this.oSelectionTitle}).addStyleClass("compVHColSearchBtn");this._oColSearchBox=new h(this.getId()+"-selBox",{fitContainer:true,visible:this.oSelectionButton.getVisible(),items:[this.oSelectionTitle,this.oSelectionButton]}).addStyleClass("compVHColSearchVBox")};se.prototype._createFooterControls=function(){this._oButtonOk=new f(this.getId()+"-ok",{text:this._oRb.getText("VALUEHELPDLG_OK"),press:this._onCloseAndTakeOverValues.bind(this),visible:this.getSupportMultiselect(),type:Z.Emphasized,layoutData:new S({priority:Q.NeverOverflow})});this._oButtonCancel=new f(this.getId()+"-cancel",{text:this._oRb.getText("VALUEHELPDLG_CANCEL"),press:this._onCancel.bind(this),layoutData:new S({priority:Q.NeverOverflow})});this._oButtonOk.setWidth(this._oButtonCancel.getWidth());if(this._isPhone()){this._oButtonGo=new f(this.getId()+"-go",{text:this._oRb.getText("VALUEHELPDLG_GO"),type:Z.Emphasized,press:this._onGo.bind(this),visible:false,layoutData:new S({priority:Q.NeverOverflow})});this._oButtonClear=new f(this.getId()+"-clear",{text:this._oRb.getText("VALUEHELPDLG_CLEAR"),press:this._onClear.bind(this),visible:false,layoutData:new S({priority:Q.NeverOverflow})});this.addButton(this._oButtonGo);this.addButton(this._oButtonClear)}this.addButton(this._oButtonOk);this.addButton(this._oButtonCancel)};se.prototype._createTokenizer=function(){if(this._oTokenizerGrid){return this._oTokenizerGrid}this._oSelectedTokenTitle=new R(this.getId()+"-selectedTokenTitle");this._oSelectedTokens=new y(this.getId()+"-selectedTokens",{tokenUpdate:function(e){if(this._ignoreRemoveToken){return}if(e.getParameter("type")===y.TokenChangeType.Removed){var t=e.getParameter("removedTokens");var i=[];var s=[];for(var a=0;a<t.length;a++){var o=t[a];var n=o.getKey();if(this._oSelectedRanges&&this._oSelectedRanges[n]){s.push(n);this._removeToken(n)}else{i.push(n);this._oSelectedItems.remove(n);this._removeTokenFromTokenizer(n,this._getTokenizer())}}this._removeRangeByKey(s);var l={tokenKeys:i,useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(l);this._bIgnoreSelectionChange=false}else{l.useDefault=true}if(l.useDefault){i.forEach(function(e){this._changeTableRowSelectionForKey(e,false)}.bind(this))}if(t.length===1){setTimeout(function(){var e=this._getTokenizer().getTokens();if(e){var t=e.length-1;if(t>=0){e[t].focus()}else{this._manageFocusAfterRemoveTokens()}}}.bind(this))}this._updateTitles()}}.bind(this),ariaLabelledBy:this._oSelectedTokenTitle}).addStyleClass("compVHTokensDiv");if(e.getConfiguration().getAccessibility()){this._oSelectedTokens.addAriaDescribedBy(this._oSelectedTokens.getTokensInfoId())}this._oRemoveAllSelectedItemsBtn=new f(this.getId()+"-removeSelItems",{type:Z.Transparent,icon:E.getIconURI("decline"),tooltip:this._oRb.getText("VALUEHELPVALDLG_REMOVETOKENS_TOOLTIP"),press:function(){this._getTokenizer().destroyTokens();this._removeRangeByKey(Object.keys(this._oSelectedRanges));this._oSelectedItems.removeAll();this._bIgnoreSelectionChange=true;if(this._oTable&&this._oTable.clearSelection){this._oTable.clearSelection()}if(this._oTable&&this._oTable.removeSelections){this._oTable.removeSelections()}this._bIgnoreSelectionChange=false;this._updateTitles();this._manageFocusAfterRemoveTokens()}.bind(this),ariaDescribedBy:this._oSelectedTokenTitle}).addStyleClass("compVHRemoveAllBtn");var t=new O(this.getId()+"-selItemsBox",{content:[this._getTokenizer(),this._oRemoveAllSelectedItemsBtn]}).addStyleClass("compVHTokenizerHLayout");this._oIncludeTokenGrid=new D(this.getId()+"-selItemsGrid",{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:[this._oSelectedTokenTitle,t]}).addStyleClass("sapUiRespGridOverflowHidden");this._oTokenizerPanel=new I(this.getId()+"-tokenPanel",{expanded:A.system.desktop,expandable:false,expandAnimation:true,headerText:"",width:"auto",content:[this._oIncludeTokenGrid],expand:function(e){this._updateTokenizer();if(e.mParameters.expand&&this._oTable&&!this._oTable.isA("sap.m.Table")){var t=window.document.getElementById(this.getId()+"-scrollCont");if(t&&t.scrollTop){t.stop().animate({scrollTop:"1000"},1e3)}}}.bind(this)}).addStyleClass("compVHBackgroundTransparent").addStyleClass("compVHTokensPanel").addStyleClass("compValueHelpDialogTokens");if(this._isPhone()){this._getTokenizer().addStyleClass("sapMTokenizerMultiLine")}this._oTokenizerGrid=new D(this.getId()+"-tokenizerGrid",{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:this._oTokenizerPanel}).addStyleClass("compVHDBackground").addStyleClass("sapUiRespGridOverflowHidden");return this._oTokenizerGrid};se.prototype._addToken2Tokenizer=function(e,t,i,s){var a=typeof t==="string"?t:"";var n=this._getTokenByKey(e,i);t=$(t);if(!n){n=new o(oe.call(this,e,s));n.setKey(e);i.addToken(n);this._updateTokenizer()}if(n){n.setText(t);n.setTooltip(a)}};se.prototype._getTokenByKey=function(e,t){var i=t.getTokens();for(var s=0;s<i.length;s++){var a=i[s];if(a.getKey()===e){return a}}return null};se.prototype._removeToken=function(e){this._removeTokenFromTokenizer(e,this._getTokenizer())};se.prototype._removeTokenFromTokenizer=function(e,t){var i=this._getTokenByKey(e,t);if(i){this._ignoreRemoveToken=true;t.removeToken(i);i.destroy();this._ignoreRemoveToken=false;this._updateTokenizer();return true}return false};se.prototype._updateTokenizer=function(){this._bInitTokensHaveChanged=true;var e=false;if(this._oTokenizerPanel){e=this._oTokenizerPanel.getExpanded()}var t=this._getTokenizer().getTokens().length;var i=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS_CONDITIONS");var s=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS_CONDITIONS");var a=i.replace("{0}",t.toString());var o=t===0?s:a;if(this._oTokenizerPanel){if(!e){o="";if(t!==0){o=a}if(o===""){o=s}}this._oTokenizerPanel.setHeaderText(o);this._oSelectedTokenTitle.setText(o)}else{this._oSelectedTokenTitle.setText(o)}this._oRemoveAllSelectedItemsBtn.setEnabled(t!==0);this._oIncludeTokenGrid.removeStyleClass("displayNone")};se.prototype._createNavigationControl=function(){if(!this._isPhone()){this._oTabBar=new v(this.getId()+"-navigation",{expandable:false,items:[new C(this.getId()+"-itemstable",{visible:true,text:this._getTabSearchAndSelectText(),key:ie.DESKTOP_LIST_VIEW}),new C(this.getId()+"-ranges",{visible:true,text:this._getTabRangesText(),key:ie.DESKTOP_CONDITIONS_VIEW})],select:function(e){this._updateView(e.getParameters().key)}.bind(this)});this._oTabBar.setLayoutData(new c({shrinkFactor:0}));this._oNavigationContainer.addItem(this._oTabBar)}else{this._oSelectItemLI=new m(this.getId()+"-itemstable",{type:X.Navigation,title:this._getTabSearchAndSelectText()}).data("key",ie.PHONE_LIST_VIEW);this._oDefineConditionsLI=new m(this.getId()+"-ranges",{type:X.Navigation,title:this._getTabRangesText()}).data("key",ie.PHONE_CONDITIONS_VIEW);this._oMainListMenu=new M(this.getId()+"-navigation",{mode:J.None,items:[this._oSelectItemLI,this._oDefineConditionsLI],itemPress:function(e){if(e){this._updateView(e.mParameters.listItem.data("key"))}}.bind(this)});this._oMainListMenu.setLayoutData(new c({shrinkFactor:0}));this._oContentContainer.addItem(this._oMainListMenu);this._oAdvancedSearchLink=new w(this.getId()+"-advancedSearchLink",{text:this._oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"),press:function(){this._updateView(ie.PHONE_SEARCH_VIEW)}.bind(this)}).addStyleClass("compVHAdvancedSearchLink");this._oAdvancedSearchLink.setLayoutData(new c({shrinkFactor:0,alignSelf:"End"}));this._oContentContainer.addItem(this._oAdvancedSearchLink)}};se.prototype._updateNavigationControl=function(){var e=!this.getSupportRangesOnly();var t=this.getSupportRangesOnly()||this.getSupportRanges();if(this._oTabBar){var i=this._oTabBar.getItems();i[0].setVisible(e);i[1].setVisible(t);this._oTabBar.setVisible(e&&t);this._updateDlgTitle()}if(this._oMainListMenu){this._oSelectItemLI.setVisible(e);this._oDefineConditionsLI.setVisible(t)}};se.prototype._removeRangeByKey=function(e){var t=e;if(typeof t==="string"){t=[t]}t.forEach(function(e,t,i){var s=this._oSelectedRanges[e];if(!s._oGrid){delete this._oSelectedRanges[e];if(this._oFilterPanel){var a=this._oFilterPanel.getConditionPanel();if(i.length==1){a.removeCondition(e)}else{a._removeConditionFromMap(e)}}}},this);if(t.length>1&&this._oFilterPanel){var i=this._oFilterPanel.getConditionPanel();i._clearConditions();i._fillConditions()}};se.prototype._createAddRanges=function(){if(!this._oRanges){if(!sap.ui.require("sap/m/P13nFilterPanel")){sap.ui.require(["sap/m/P13nFilterPanel"],function(){this._oRanges=this._createRanges();this._oMainLayout.addItem(this._oRanges)}.bind(this))}else{this._oRanges=this._createRanges();this._oMainLayout.addItem(this._oRanges)}}else{this._oMainLayout.addItem(this._oRanges)}};se.prototype._createRanges=function(){var e,t;this._oFilterPanel=new N(this.getId()+"-filterPanel",{maxConditions:this.getMaxConditions(),maxIncludes:this.getMaxIncludeRanges(),maxExcludes:this.getMaxExcludeRanges(),containerQuery:true,enableEmptyOperations:true,defaultOperation:this.getConditionPanelDefaultOperation(),filterItemChanged:function(e){var t=e.getParameter("reason");var i=e.getParameter("key");var s=e.getParameter("itemData");if(s&&t==="added"){var a={exclude:s.exclude,keyField:s.columnKey,operation:s.operation,value1:s.value1,value2:s.value2};this._oSelectedRanges[i]=a;var o=new z({key:i,exclude:s.exclude,columnKey:s.columnKey,operation:s.operation});o.setValue1(s.value1);o.setValue2(s.value2);this._oFilterPanel.addFilterItem(o);var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(s&&t==="updated"){var a=this._oSelectedRanges[i];a.exclude=s.exclude;a.keyField=s.columnKey;a.operation=s.operation;a.value1=s.value1;a.value2=s.value2;var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(t==="removed"){delete this._oSelectedRanges[i];this._removeToken(i);this._updateTokenizer()}this._updateTabRangesTitle()}.bind(this)});this._oFilterPanel.bIsSingleIntervalRange=this.bIsSingleIntervalRange;if(this.getProperty("_enhancedExcludeOperations")){this._oFilterPanel._enableEnhancedExcludeOperations()}t=this._oFilterPanel.getConditionPanel();t.setDisplayFormat(this.getDisplayFormat());this._oFilterPanel.setSuggestCallback(this._fSuggestCallback);t._sAddRemoveIconTooltipKey="CONDITION";if(this._aIncludeRangeOperations){for(e in this._aIncludeRangeOperations){this._oFilterPanel.setEnableEmptyOperations(false);this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[e],e)}}if(this._aExcludeRangeOperations){for(e in this._aExcludeRangeOperations){this._oFilterPanel.setEnableEmptyOperations(false);this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[e],e)}}if(this._aRangeKeyFields){this._aRangeKeyFields.forEach(function(e){this._oFilterPanel.addItem(new K({columnKey:e.key,text:e.label,typeInstance:e.typeInstance,type:e.type,maxLength:e.maxLength,formatSettings:e.formatSettings,scale:e.scale,precision:e.precision,isDefault:e.isDefault,values:null,nullable:e.nullable!=="false"}))},this)}if(this._oSelectedRanges){for(var i in this._oSelectedRanges){var s=this._oSelectedRanges[i];var a=new z({key:i,exclude:s.exclude,columnKey:s.keyField,operation:s.operation});a.setValue1(s.value1);a.setValue2(s.value2);this._oFilterPanel.addFilterItem(a)}}var o=new D(this.getId()+"-rangeFieldsGrid",{width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oFilterPanel]}).addStyleClass("sapUiRespGridOverflowHidden");this._sValidationDialogTitle=this._oRb.getText("VALUEHELPVALDLG_TITLE");this._sValidationDialogMessage=this._oRb.getText("VALUEHELPVALDLG_MESSAGE");this._sValidationDialogFieldMessage=this._oRb.getText("VALUEHELPVALDLG_FIELDMESSAGE");return o};se.prototype.suggest=function(e){this._fSuggestCallback=e;if(this._oFilterPanel){this._oFilterPanel.setSuggestCallback(this._fSuggestCallback)}};se.prototype._getKeyFieldByKey=function(e){var t;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(i){if(typeof i!=="string"){if(i.key===e){t=i;return true}}return false})}return t};se.prototype._validateRanges=function(e,t){if(this._oRanges){if(!this._oRanges.getParent()){e();return}var i=this._oFilterPanel.validateConditions();if(!i){a.show(this._sValidationDialogMessage,{icon:a.Icon.WARNING,title:this._sValidationDialogTitle,actions:[a.Action.OK,a.Action.CANCEL],emphasizedAction:a.Action.OK,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(i){if(i===a.Action.OK&&e){e()}if(i===a.Action.CANCEL&&t){t()}}});return}}e()};se.prototype.setUpdateSingleRowCallback=function(e){this.fSingleRowCallback=e;this._updateNavigationControl()};se.prototype._createDefaultTable=function(){if(!this._isPhone()){this.setTable(new L(this.getId()+"-table"),true)}else{this.setTable(new P(this.getId()+"-table"),true);this.TableStateSearchData()}};function ae(){if(!(this._oTablePromise instanceof Promise)){this._oTablePromise=new Promise(function(e,t){this._fnRejectTablePromise=t;if(!this._isPhone()){var i=new L(this.getId()+"-table");this.setTable(i,true);e(i)}else{var i=new P(this.getId()+"-table");this.setTable(i,true);this.TableStateSearchData();e(i)}}.bind(this))}return this._oTablePromise}se.prototype._initializeTable=function(){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._oTable.setTitle(A.system.desktop?this._sTableTitleNoCount:null);if(this._bTableCreatedInternal){this._oTable.setSelectionBehavior(V.SelectionBehavior.Row)}this._oTable.setSelectionMode(this.getSupportMultiselect()?V.SelectionMode.MultiToggle:V.SelectionMode.Single);this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));this._oTable.setVisibleRowCountMode(V.VisibleRowCountMode.Fixed);this._oTable.setMinAutoRowCount(A.system.desktop?5:4);this._oTable.attachRowSelectionChange(function(e){if(this._bIgnoreSelectionChange||!e.getParameter("userInteraction")){return}var t={tableSelectionParams:e.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(t);this._bIgnoreSelectionChange=false;t.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{t.useDefault=true}if(t.useDefault){var i=e.getSource();var s=i.getBinding("rows");var o=i.getSelectedIndices();var n=e.getParameter("rowIndices");var l=e.getParameter("selectAll");var r=s.isLengthFinal?s.isLengthFinal():true;var h,_=o.length;var d;var u=0;if(r){if(s.aKeys){for(h=0;h<_;h++){d=o[h];if(!s.aKeys[d]){u++}}}}else if(l){u=99999999}if(u!==0){var c=function(){s.attachEventOnce("dataReceived",function(){if(l){i.selectAll();n=i.getSelectedIndices()}this._handleSelectionUpdateTokens(i,n)}.bind(this));if(l){if(r){s.getContexts(0,_)}else{s.getContexts(0,u)}}else{s.getContexts(n[0],n[n.length-1])}}.bind(this);if(u<=400){c();return}else{a.show(this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOAD"),{icon:a.Icon.WARNING,title:this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOADTITLE"),actions:[a.Action.OK,a.Action.CANCEL],emphasizedAction:a.Action.OK,initialFocus:a.Action.CANCEL,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(e){if(e===a.Action.OK){c()}else{this.update()}}.bind(this)});return}}this._handleSelectionUpdateTokens(i,n)}this._updateTitles();if(!this.getSupportMultiselect()){this._bIgnoreSelectionChange=true;this._onCloseAndTakeOverValues()}}.bind(this));this._oTable.addStyleClass("compVHMainTable");if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i,s,a,o=t.getProperty("tooltip"),n=t.getProperty("template");if(t.getProperty("type")==="string"){s={path:n};if(Array.isArray(n)){s={parts:[{path:n[0]},{path:n[1]}],formatter:function(e,i){var s=d.getFormattedExpressionFromDisplayBehaviour(t.getProperty("displayBehaviour"),e,i);return $(s)}}}}if(t.getProperty("type")==="boolean"){i=new G(e+"-control",{enabled:false,selected:{path:n}})}else{var l={path:n,type:t.getProperty("oType")};if(Array.isArray(n)){l={parts:[{path:n[0]},{path:n[1]}],formatter:function(e,i){var s=d.getFormattedExpressionFromDisplayBehaviour(t.getProperty("displayBehaviour"),e,i);return $(s)}}}i=new p(e+"-control",{wrapping:false,renderWhitespace:true,text:l,tooltip:s})}if(this._oTable.isA("sap.ui.table.AnalyticalTable")){a=new q(e,{label:"{columns>label}",template:i,width:"{columns>width}",hAlign:i instanceof G?Y.Center:Y.Begin,filterProperty:t.getProperty("filter")})}else{a=new F(e,{label:"{columns>label}",template:i,width:"{columns>width}",hAlign:i instanceof G?Y.Center:Y.Begin,sortProperty:t.getProperty("sort"),sorted:t.getProperty("sorted"),sortOrder:t.getProperty("sortOrder"),filterProperty:t.getProperty("filter")})}if(o){a.applySettings({tooltip:o})}return a}.bind(this))}}else{this._oTable.setMode(this.getSupportMultiselect()?J.MultiSelect:J.SingleSelectLeft);this._oTable.setGrowing(true);this._oTable.attachSelectionChange(function(e){if(this._bIgnoreSelectionChange){return}var t=e.mParameters;var i={tableSelectionParams:e.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(i);this._bIgnoreSelectionChange=false;i.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{i.useDefault=true}if(i.useDefault){var s=t.selected;var a,o=t.listItems.length;for(a=0;a<o;a++){var n=t.listItems[a];var l=n.getBindingContext();var r=l?l.getObject():null;if(r){var h=r[this.getKey()];if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}this._addRemoveTokenByKey(h,r,s)}}}if(!this.getSupportMultiselect()){this._onCloseAndTakeOverValues()}}.bind(this));if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){var e=0;this._oTable.bindAggregation("columns","columns>/cols",function(t,i){var s=i.getProperty("label");var a=this._oTable.getColumns().length>=2;e++;return new x(this._oTable.getId()+"-column"+e,{header:new T(this._oTable.getId()+"-column"+e+"-label",{text:s}),demandPopin:a,minScreenWidth:a?(this._oTable.getColumns().length+1)*10+"rem":"1px"})}.bind(this))}}};se.prototype._handleSelectionUpdateTokens=function(e,t){var i,s=t.length;var a;var o;var n;var l=false;if(e.getBinding("rows").aKeys){l=true}if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}for(i=0;i<s;i++){a=t[i];o=e.getContextByIndex(a);n=o?o.getObject():null;if(n){var r;if(l){r=o.sPath.substring(1)}else{r=n[this.getKey()]}this._addRemoveTokenByKey(r,n,e.isIndexSelected(a))}}};se.prototype._addRemoveTokenByKey=function(e,t,i){try{e=decodeURIComponent(e)}catch(e){}if(i){this._oSelectedItems.add(e,t);this._addToken2Tokenizer(e,this._getFormatedTokenText(e),this._getTokenizer())}else{this._oSelectedItems.remove(e);this._removeTokenFromTokenizer(e,this._getTokenizer())}};se.prototype._onCloseAndTakeOverValues=function(){var e=this;var t=function(){var t;var i=e._oSelectedItems.getSelectedItemsTokenArray(e.getKey(),e.getDescriptionKey(),e.getTokenDisplayBehaviour());if(e._oSelectedRanges){var s=0;for(var a in e._oSelectedRanges){t=e._oSelectedRanges[a];var n=t.tokenValue;if(!n){n=e._getFormatedRangeTokenText(t.operation,t.value1,t.value2,t.exclude,t.keyField)}if(!t._oGrid||t._oGrid.select.getSelected()){var l=new o({key:"range_"+s}).data("range",{exclude:t.exclude,operation:t.operation,keyField:t.keyField,value1:t.value1,value2:t.value2});l.setText(n);l.setTooltip(typeof n==="string"?n:null);i.push(l);s++}}}e.fireOk({tokens:i,_tokensHaveChanged:e._bInitTokensHaveChanged})};this._validateRanges(t)};se.prototype._onCancel=function(){this.fireCancel()};se.prototype._onGo=function(){this._oFilterBar.search()};se.prototype._onClear=function(){this._oFilterBar.clear()};se.prototype._updateTitles=function(){this._updateTableTitle();this._updateTokenizer();this._updateTabSearchAndSelectTitle();this._updateTabRangesTitle();if(this._bTriggerInvisibleTableCountMessageNotInitialLoad&&this._bTriggerInvisibleTableCountMessage){this._addInvisibleMessageSearchAndTableCount()}};se.prototype._addInvisibleMessageSearchAndTableCount=function(){var e=this._oRb.getText("VALUEHELPDLG_SEARCH_RESULT_COUNT",this.nRowCount);this._oInvisibleMessage.announce(e,ee.Polite);this._bTriggerInvisibleTableCountMessage=false};se.prototype._updateDlgTitle=function(){var e="";var t;if(this._oTitle){if(this._oTabBar&&!this._oTabBar.getVisible()&&!this.getFilterMode()){if(this._oTabBar.getSelectedKey()===ie.DESKTOP_LIST_VIEW){e="VALUEHELPDLG_TITLE"}else if(this._oTabBar.getSelectedKey()===ie.DESKTOP_CONDITIONS_VIEW){if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{e="VALUEHELPDLG_RANGESTITLE"}}}else if(this._isPhone()&&!this.getFilterMode()){switch(this._currentViewMode){case ie.PHONE_MAIN_VIEW:e="";break;case ie.PHONE_LIST_VIEW:t=this._getTabSearchAndSelectText();break;case ie.PHONE_SEARCH_VIEW:e="FILTER_BAR_ADV_FILTERS_DIALOG";break;case ie.PHONE_CONDITIONS_VIEW:if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{t=this._getTabRangesText()}break;default:break}}if(!t){t=this.getTitle()}if(e){t=this._oRb.getText(e,t)}if(t){this._oTitle.setText(t);this._oFilterPanel&&this._oFilterPanel.setInnerTitle(this.getTitle())}}};se.prototype._updateTableTitle=function(){if(!this._oTable){return}var e=0;this.oRows=this._oTable.getBinding("rows");if(this.oRows){e=this.oRows.getLength()}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=U.getFloatInstance()}if(e>0&&this.oRows.isLengthFinal&&this.oRows.isLengthFinal()){this.nRowCount=this._oNumberFormatInstance.format(e);this._setTableTitle(this._sTableTitle1.replace("{0}",this.nRowCount))}else{this._setTableTitle(this._sTableTitleNoCount)}};se.prototype._getTabSearchAndSelectText=function(){var e=this._oTable;if(e){if(e.isA("sap.ui.comp.smarttable.SmartTable")){e=e.getTable()}var t=0;if(this._oSelectedItems&&this._oSelectedItems.getItems){t=this._oSelectedItems.getItems().length}if(t>0){return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT",[t])}}return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT").replace("({0})","")};se.prototype._getTabRangesText=function(){if(this._oSelectedRanges&&Object.keys(this._oSelectedRanges).length>0){var e=Object.keys(this._oSelectedRanges).length;return this._oRb.getText("VALUEHELPDLG_RANGES",[e])}return this._oRb.getText("VALUEHELPDLG_RANGES").replace("({0})","")};se.prototype._updateTabSearchAndSelectTitle=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){this._oTabBar.getItems()[0].setText(this._getTabSearchAndSelectText())}if(this._oMainListMenu&&this._oSelectItemLI){this._oSelectItemLI.setTitle(this._getTabSearchAndSelectText())}}};se.prototype._updateTabRangesTitle=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){this._oTabBar.getItems()[1].setText(this._getTabRangesText())}if(this._oMainListMenu&&this._oDefineConditionsLI){this._oDefineConditionsLI.setTitle(this._getTabRangesText())}}};se.prototype._setTableTitle=function(e){if(A.system.desktop&&this._oTable&&!this._oTable.isA("sap.m.Table")){if(this._oTable.getTitle()){this._oTable.getTitle().setText(e)}else{this._oTable.setTitle(e)}}else{this._oTable.addStyleClass("compValueHelpSmallMarginTop")}};se.prototype.onAfterRendering=function(){s.prototype.onAfterRendering.apply(this);this._oButtonOk.setWidth(this._oButtonCancel.$().width()+"px");if(this._oTable){this._updateTitles()}if(!this._isPhone()&&this.getContentHeight()===""){if(this.getSupportRangesOnly()&&(this.getMaxExcludeRanges()==="-1"||this.getMaxIncludeRanges()==="-1")){this.setContentHeight("70%")}else{var e=this.getDomRef("scroll");var t=e.clientHeight;this.setContentHeight(t+"px")}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._oTable.setVisibleRowCountMode(V.VisibleRowCountMode.Auto)}}if(this._oTabBar&&this._oTabBar.getVisible()&&this.getCustomHeader()){this.getCustomHeader().addStyleClass("compValueHelpDialogHeaderNoBoxShadow")}this._bInitTokensHaveChanged=false;this._setToolbarSpacerWidth();this._registerVHResizeHandler()};se.prototype.onsapbackspace=function(e){if(this._ignoreRemoveToken||!e.srcControl||!e.srcControl.isA("sap.m.Token")){return}var t=e.srcControl.getKey?e.srcControl.getKey():"",i=[];if((e.type==="sapbackspace"||e.type==="sapdelete")&&t){if(this._oSelectedRanges&&this._oSelectedRanges[t]){i.push(t);this._removeToken(t)}else{this._oSelectedItems.remove(t);this._removeTokenFromTokenizer(t,this._getTokenizer())}}this._removeRangeByKey(i);var s={tokenKeys:[t],useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(s);this._bIgnoreSelectionChange=false}else{s.useDefault=true}if(s.useDefault){this._changeTableRowSelectionForKey(t,false)}setTimeout(function(){var e=this._getTokenizer().getTokens();if(e){var t=e.length-1;if(t>=0){e[t].focus()}else{this._manageFocusAfterRemoveTokens()}}}.bind(this));this._updateTitles()};se.prototype.onsapdelete=se.prototype.onsapbackspace;se.prototype._getDialogOffset=function(e){var t=e||this._$Window.width();var i={small:600,large:1024};var s=function(e){var t=parseInt(window.getComputedStyle(document.body).fontSize);return e*t*2};var a=1;if(t>i.small&&t<i.large){a=2}else if(t>=i.large){a=2}return{top:s(a),left:s(a)}};se.prototype.exit=function(){s.prototype.exit.apply(this);if(typeof this._fnRejectTablePromise==="function"){this._fnRejectTablePromise()}this.removeDelegate(this._onBeforeRenderingInputEventDelegate);var e=function(e){if(e&&e.destroy){e.destroy()}return null};this._oTokenizerGrid=e(this._oTokenizerGrid);this._oRanges=e(this._oRanges);this._oFilterPanel=e(this._oFilterPanel);if(this._bTableCreatedInternal){this._oTable=e(this._oTable)}this._oTable=null;this.theTable=null;this._oNumberFormatInstance=null;this._oTabBar=e(this._oTabBar);this._oMainListMenu=e(this._oMainListMenu);this._oContentContainer=e(this._oContentContainer);this._oVarManagment=e(this._oVarManagment);this._aRangeKeyFields=e(this._aRangeKeyFields);this._aIncludeRangeOperations=e(this._aIncludeRangeOperations);this._aExcludeRangeOperations=e(this._aExcludeRangeOperations);if(this._oFilterBar){this._oFilterBar.detachInitialise(this._handleFilterBarInitialize);this._oFilterBar=e(this._oFilterBar)}this._oRb=e(this._oRb);this._sTableTitle1=e(this._sTableTitle1);this._sTableTitle2=e(this._sTableTitle2);this._sTableTitleNoCount=e(this._sTableTitleNoCount);this._sValidationDialogTitle=e(this._sValidationDialogTitle);this._sValidationDialogMessage=e(this._sValidationDialogMessage);this._sValidationDialogFieldMessage=e(this._sValidationDialogFieldMessage);this._oSelectedItems=e(this._oSelectedItems);this._oSelectedRanges=e(this._oSelectedRanges);this._oButtonOk=e(this._oButtonOk);this._oButtonCancel=e(this._oButtonCancel);if(this._oButtonGo){this._oButtonGo=e(this._oButtonGo)}if(this._oButtonClear){this._oButtonClear=e(this._oButtonClear)}if(this._oColSearchBox){this._oColSearchBox=e(this._oColSearchBox)}};se.prototype.setRangeKeyFields=function(e){this._aRangeKeyFields=e;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(e){if(e.typeInstance&&e.typeInstance.isA("sap.ui.model.odata.type.DateTime")){var t=e.typeInstance;if(!t.oFormat){t.formatValue(new Date,"string")}if(t.oFormat){t.oFormat.oFormatOptions.UTC=false}}})}};se.prototype.getRangeKeyFields=function(){return this._aRangeKeyFields};se.prototype.setIncludeRangeOperations=function(e,t){t=t||"default";this._aIncludeRangeOperations[t]=e;if(this._oFilterPanel){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[t],t)}};se.prototype.setExcludeRangeOperations=function(e,t){t=t||"default";this._aExcludeRangeOperations[t]=e.map(function(e){return this._oOperationsHelper.getCorrespondingExcludeOperation(e)}.bind(this));if(this._oFilterPanel){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[t],t)}};se.prototype._getFormatedTokenText=function(e){var t=this._oSelectedItems.getItem(e);var i=t[this.getDescriptionKey()];var s=t[this.getKey()];if(i===undefined){if(typeof t==="string"){i=t}else{i=e}}else{i=d.getFormattedExpressionFromDisplayBehaviour(this.getTokenDisplayBehaviour()?this.getTokenDisplayBehaviour():te.descriptionAndId,s,i)}return i};se.prototype._getFormatedRangeTokenText=function(e,t,i,s,a){var o=this._getKeyFieldByKey(a);var n=t;var l=i;var r=true;if(o){if(!o.typeInstance&&H._createKeyFieldTypeInstance){H._createKeyFieldTypeInstance(o)}if(o.typeInstance){n=o.typeInstance.formatValue(t,"string",r);l=o.typeInstance.formatValue(i,"string",r)}}var h=d.getFormattedRangeText(e,n,l,s);if(this._aRangeKeyFields&&this._aRangeKeyFields.length>1&&o&&o.label&&h!==""){h=o.label+": "+h}return h};se.prototype._isPhone=function(){return A.system.phone};se.prototype._hasListeners=function(e){if(this._bTableCreatedInternal){return false}return this.hasListeners(e)};se.prototype._rotateSelectionButtonIcon=function(e){if(!A.system.phone){var t=sap.ui.getCore().byId(this.oSelectionButton.$("img")[0].id);if(e){t.addStyleClass("sapUiVHImageExpand")}else{t.removeStyleClass("sapUiVHImageExpand")}}};se.prototype._getTokenizer=function(){return this._oSelectedTokens};se.prototype._getTabSearchAndSelect=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){return this._oTabBar.getItems()[0]}if(this._oMainListMenu&&this._oSelectItemLI){return this._oSelectItemLI}}return null};se.prototype._getTabDefneConditions=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){return this._oTabBar.getItems()[1]}if(this._oMainListMenu&&this._oDefineConditionsLI){return this._oDefineConditionsLI}}return null};se.prototype._registerVHResizeHandler=function(){j.register(this,this._onVHResize.bind(this))};se.prototype._onVHResize=function(){this._setToolbarSpacerWidth()};se.prototype._setToolbarSpacerWidth=function(){var e,t,i;if(!this._oFilterBar){return}if(this._oFilterBar._oToolbar){t=this._oFilterBar._oToolbar.getContent();for(var s=0;s<t.length;s++){if(t[s].isA("sap.m.ToolbarSpacer")){e=t[s];break}}}if(e&&this._oFilterBar.getBasicSearch()){i=this.getDomRef()&&parseInt(this.getDomRef().style.width);if(i>=1e3){e.setWidth("6rem")}else if(i<1e3&&i>700){e.setWidth("4rem")}else{e.setWidth("0.5rem")}}};se.prototype._manageFocusAfterRemoveTokens=function(){var e,t=this._oFilterPanel?this._oFilterPanel.getConditionPanel():undefined;if(this._currentViewMode.toLowerCase().indexOf("list")>-1){this._oButtonOk.focus()}else{this._onAfterRenderingInputDelegate={onAfterRendering:function(){e.focus()}};this._onBeforeRenderingInputEventDelegate={onBeforeRendering:function(){if(e.getDomRef()){e.removeDelegate(this._onAfterRenderingInputDelegate,this)}}};e=t._oConditionsGrid.getAggregation("content")[0].value1;e.addDelegate(this._onAfterRenderingInputDelegate,this);e.addDelegate(this._onBeforeRenderingInputEventDelegate,this);e.focus()}};function oe(e,t){if(!t){t=this.getKey()}e=e.replace(/[^a-zA-Z0-9]/g,"");t=t.replace(/[^a-zA-Z0-9]/g,"");var i=t?t+"-"+e:e;if(!this._oTokenIdCount[i]){this._oTokenIdCount[i]=0}this._oTokenIdCount[i]++;return this.getId()+"-token-"+i+"_"+this._oTokenIdCount[i]}function ne(e){if(e){var t=e.getItems();return t[0].getVisible()&&t[1].getVisible()}else{return false}}return se});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/EditableVariantItem", ["sap/m/ColumnListItem","sap/m/ColumnListItemRenderer","sap/ui/comp/library"],function(e,t,a){"use strict";var l=e.extend("sap.ui.comp.variants.EditableVariantItem",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},readOnly:{type:"boolean",group:"Misc",defaultValue:false},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false},author:{type:"string",group:"Misc",defaultValue:null},favorite:{type:"boolean",group:"Misc",defaultValue:false},_contexts:{type:"object",group:"Misc",visibility:"hidden",defaultValue:{}}}},renderer:{apiVersion:2}});l.prototype.setContexts=function(e){this.setProperty("_contexts",e)};l.prototype.getContexts=function(){return this.getProperty("_contexts")};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/VariantItem", ["sap/ui/comp/library","sap/m/VariantItem"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.variants.VariantItem",{metadata:{library:"sap.ui.comp",properties:{executeOnSelection:{type:"boolean",group:"Misc",defaultValue:false},readOnly:{type:"boolean",group:"Misc",defaultValue:false},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false},_contexts:{type:"object",group:"Misc",visibility:"hidden",defaultValue:{}}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});a.prototype.setText=function(e){this.setProperty("text",e);this.fireChange({propertyName:"text"});return this};a.prototype.setContexts=function(e){this.setProperty("_contexts",e);return this};a.prototype.getContexts=function(){return this.getProperty("_contexts")};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/VariantManagement", ["sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/library","sap/m/library","sap/m/VBox","sap/m/SearchField","sap/m/ToggleButton","sap/m/RadioButton","sap/m/Column","sap/m/Text","sap/m/Bar","sap/m/Table","sap/m/Page","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Button","sap/m/CheckBox","sap/m/Dialog","sap/m/Input","sap/m/Title","sap/m/Label","sap/m/ResponsivePopover","sap/m/SelectList","sap/m/ObjectIdentifier","sap/ui/comp/library","./EditableVariantItem","./VariantItem","sap/ui/core/InvisibleText","sap/ui/core/Control","sap/ui/core/Icon","sap/ui/core/Item","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/events/KeyCodes"],function(e,t,a,i,n,s,r,o,l,h,d,g,u,c,p,f,y,m,S,v,V,T,_,A,I,M,E,N,b,C,x,D,R,O,K,L){"use strict";var w=a.VerticalAlign;var P=a.ValueState;var F=i.ButtonType;var B=i.PlacementType;var U=i.PopinDisplay;var k=i.ScreenSize;var G=a.TextAlign;var H=a.TitleLevel;var W=i.OverflowToolbarPriority;var z=i.FlexAlignItems;var Y=x.extend("sap.ui.comp.variants.VariantManagement",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/variants/VariantManagement.designtime",properties:{initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showShare:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false},standardItemText:{type:"string",group:"Misc",defaultValue:null},useFavorites:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},variantCreationByUserAllowed:{type:"boolean",group:"Misc",defaultValue:true},standardItemAuthor:{type:"string",group:"Misc",defaultValue:"SAP"}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.core.Item",multiple:true,singularName:"item",deprecated:true},variantItems:{type:"sap.ui.comp.variants.VariantItem",multiple:true,singularName:"variantItem"}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},exe:{type:"boolean"},def:{type:"boolean"},global:{type:"boolean"},lifecyclePackage:{type:"string"},lifecycleTransportId:{type:"string"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapUiCompVarMngmt");e.openEnd();e.renderControl(t.oVariantLayout);e.close("div")}}});Y.STANDARD_NAME=E.STANDARD_VARIANT_NAME;Y.MAX_NAME_LEN=100;Y.FAV_COLUMN=0;Y.NAME_COLUMN=1;Y.SHARE_COLUMN=2;Y.DEF_COLUMN=3;Y.EXEC_COLUMN=4;Y.RESTRICT_COLUMN=5;Y.AUTHOR_COLUMN=6;Y.prototype.init=function(){var a=this;this.STANDARDVARIANTKEY="*standard*";this.setStandardVariantKey(this.STANDARDVARIANTKEY);this.aRemovedVariants=[];this.aRenamedVariants=[];this.aRemovedVariantTransports=[];this.aExeVariants=[];this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.lastSelectedVariantKey=this._sStandardVariantKey;this.bVariantItemMode=false;this.oSelectedItem=null;this.sNewDefaultKey="";this.bManagementTableInitialized=false;this.sTransport=null;this.sPackage=null;this.aEvents=[];this.bEventRunning=false;this.oVariantSelectionPage=null;this.bManualVariantKey=false;this.bFireSelect=false;this.bExecuteOnSelectForStandardViaXML=false;this.bExecuteOnSelectForStandardByUser=null;this.bSupportExecuteOnSelectOnSandardVariant=false;this._bInnerControlsCreated=false;this._bIndustrialSolutionMode=false;this._bVendorLayer=false;this.oModel=new t({enabled:false,selectedVariant:"",creationAllowed:true,saveVariantVisible:true});this.setModel(this.oModel,"save_enablement");this.oVariantInvisbletext=new C({text:{parts:[{path:"save_enablement>/selectedVariant"},{path:"save_enablement>/enabled"}],formatter:function(e,t){if(t){e=a.oResourceBundle.getText("VARIANT_MANAGEMENT_SEL_VARIANT_MOD",[e])}else{e=a.oResourceBundle.getText("VARIANT_MANAGEMENT_SEL_VARIANT",[e])}return e}}});this.oVariantText=new T(this.getId()+"-text",{text:"{save_enablement>/selectedVariant}"});this._setStandardText();this.oVariantText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantText.addStyleClass("sapUICompVarMngmtTitle");this.oVariantText.addStyleClass("sapMTitleStyleH4");if(e.system.phone){this.oVariantText.addStyleClass("sapUICompVarMngmtTextPhoneMaxWidth")}else{this.oVariantText.addStyleClass("sapUICompVarMngmtTextMaxWidth")}this.oVariantModifiedText=new h(this.getId()+"-modified",{visible:"{save_enablement>/enabled}"});this.oVariantModifiedText.setText("*");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtModified");this.oVariantPopoverTrigger=new r(this.getId()+"-trigger",{icon:"sap-icon://slim-arrow-down",type:F.Transparent,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_TRIGGER_TT")});this.oVariantPopoverTrigger.addAriaLabelledBy(this.oVariantInvisbletext);this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtClickable");this.oVariantLayout=new O({content:[this.oVariantText,this.oVariantModifiedText,this.oVariantPopoverTrigger]});this.oVariantLayout.addStyleClass("sapUICompVarMngmtLayout");this.oVariantInvisbletext.setModel(this.oModel,"save_enablement");this.oVariantInvisbletext.toStatic();this.addDependent(this.oVariantLayout)};Y.prototype.getOverflowToolbarConfig=function(){var e={canOverflow:false,invalidationEvents:["save","manage","select"]};return e};Y.prototype._columnVisibilityManagementTable=function(e,t){if(!this.bManagementTableInitialized){return}if(this.oManagementTable){var a=this.oManagementTable.getColumns();if(a&&a.length>=e){a[e].setVisible(t)}}};Y.prototype.setVariantCreationByUserAllowed=function(e){this.setProperty("variantCreationByUserAllowed",e);this.oModel.setProperty("/creationAllowed",e);return this};Y.prototype.setUseFavorites=function(e){this.setProperty("useFavorites",e);this._columnVisibilityManagementTable(Y.FAV_COLUMN,e);return this};Y.prototype.setShowShare=function(e){this.setProperty("showShare",e);this._columnVisibilityManagementTable(Y.SHARE_COLUMN,e);return this};Y.prototype.setShowSetAsDefault=function(e){this.setProperty("showSetAsDefault",e);this._columnVisibilityManagementTable(Y.DEF_COLUMN,e);return this};Y.prototype.setShowExecuteOnSelection=function(e){this.setProperty("showExecuteOnSelection",e);this._columnVisibilityManagementTable(Y.EXEC_COLUMN,e);return this};Y.prototype.setStandardItemText=function(e){this.setProperty("standardItemText",e);var t=this._getSelectedItem();if(!t||t.getKey()===this.getStandardVariantKey()){this.oModel.setProperty("/selectedVariant",e)}return this};Y.prototype._triggerSave=function(){var e=this._createEvent("variantSaveAs",this._handleVariantSaveAs);this._addEvent(e)};Y.prototype._checkNameValidity=function(e,t){var a=false;if(t&&this._getVariantNamesAndKeys){var i=this._getVariantNamesAndKeys();var n=t.getItems();n.forEach(function(e){var t=e.getCells()[Y.NAME_COLUMN];var n=e.getKey();if(t.getValue&&i.hasOwnProperty(t.getValue())&&i[t.getValue()]!==n){t.setValueState(P.Error);t.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_DUPLICATE"));a=true}}.bind(this))}return a};Y.prototype._checkVariantNameConstraints=function(e,t){var a;if(!e){return}a=e.getValue().trim();if(!this._checkIsDuplicate(e,a,this.oManagementTable)){if(a===""){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"))}else if(a.indexOf("{")>-1){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NOT_ALLOWED_CHAR",["{"]))}else if(a.length>Y.MAX_NAME_LEN){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_MAX_LEN",[Y.MAX_NAME_LEN]))}else{e.setValueState(P.None);e.setValueStateText(null)}}if(e.getValueState()!==P.Error){this._checkIsDuplicate(e,a,t)}if(t&&this._getVariantNamesAndKeys){this._checkNameValidity(a,t)}};Y.prototype._focusOnFirstFilterInError=function(e){e.getDomRef().scrollIntoView()};Y.prototype._anyItemInErrorState=function(){var e,t,a;if(this.oManagementTable){e=this.oManagementTable.getItems();if(e){for(a=0;a<e.length;a++){t=e[a].getCells()[Y.NAME_COLUMN];if(t&&t.getValueState&&t.getValueState()===P.Error){this._checkVariantNameConstraints(t,this.oManagementTable);if(t.getValueState()===P.Error){this._focusOnFirstFilterInError(t);return true}}}for(a=0;a<e.length;a++){t=e[a].getCells()[Y.NAME_COLUMN];if(t&&t.isA("sap.m.Input")){this._checkVariantNameConstraints(t,this.oManagementTable);if(t.getValueState()===P.Error){this._focusOnFirstFilterInError(t);return true}}}}}return false};Y.prototype._anyInErrorState=function(e,t){var a,i,n;if(e){a=e.getItems();if(a){for(n=0;n<a.length;n++){i=a[n].getCells()[Y.NAME_COLUMN];if(t&&t===i){continue}if(i&&i.getValueState&&i.getValueState()===P.Error){if(this._checkIsDuplicate(i,i.getValue(),e)){return true}}}}}return false};Y.prototype._checkIsDuplicate=function(e,t,a){var i=this._isDuplicate(e,t,a);if(i){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_ERROR_DUPLICATE":"VARIANT_MANAGEMENT_ERROR_EMPTY"))}else{e.setValueState(P.None);e.setValueStateText(null)}return i};Y.prototype._isDuplicate=function(e,t,a){if(a){return this._isDuplicateManaged(e,t,a)}else{return this._isDuplicateSaveAs(t)}};Y.prototype._isDuplicateManaged=function(e,t,a){var i,n,s;if(a){i=a.getItems();if(i&&i.length>0){for(s=0;s<i.length;s++){n=i[s].getCells()[Y.NAME_COLUMN];if(n===e){continue}if(n){if(n.getValue&&t===n.getValue().trim()){return true}else if(n.getText&&t===n.getText().trim()){return true}else if(n.getTitle&&t===n.getTitle().trim()){return true}}}}else{if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey){return false}}}return false};Y.prototype._isDuplicateSaveAs=function(e){var t=e.trim();if(!t){return true}var a=this._determineStandardVariantName();if(a===t){if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey){return false}return true}var i=this._getItems();for(var n=0;n<i.length;n++){a=i[n].getText().trim();if(a===t){return true}}return false};Y.prototype._createSaveDialog=function(){var t=this;if(!this.oSaveDialog){this.oSaveDialog=new v(this.getId()+"-savedialog",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEDIALOG"),beginButton:this.oSaveSave,endButton:new m(this.getId()+"-variantcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){if(t._fGetDataForKeyUser){t._handleSaveAsCancelPressedForKeyUser()}else{t._bSaveCanceled=true;t.oSaveDialog.close()}}}),content:[this.oLabelName,this.oInputName,this.oLabelKey,this.oInputKey,this.oSaveDialogOptionsGrid],stretch:e.system.phone});this.oSaveDialog.setParent(this);this.oSaveDialog.addStyleClass("sapUiContentPadding");this.oSaveDialog.addStyleClass("sapUiCompVarMngmtSaveDialog")}};Y.prototype._createManagementDialog=function(){var t=this;if(!this.oManagementDialog){this.oManagementDialog=new v(this.getId()+"-managementdialog",{contentWidth:"64%",draggable:true,resizable:true,title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGEDIALOG"),beginButton:this.oManagementSave,endButton:new m(this.getId()+"-managementcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){if(t._fGetDataForKeyUser){t._handleManageCancelPressedForKeyUser()}else{t.aRemovedVariants=[];t.oManagementDialog.close()}}}),content:[this.oManagementTable],stretch:e.system.phone,afterClose:function(){if(t.bFireSelect==true){t.bFireSelect=false;t._fireSelectAsync()}}});this.oManagementDialog.setParent(this);var a=new d;this.oManageDialogSearchField=new s;this.oManageDialogSearchField.attachLiveChange(function(e){this._triggerSearchInManageDialog(e)}.bind(this));a.addContentMiddle(this.oManageDialogSearchField);this.oManagementDialog.setSubHeader(a)}};Y.prototype._handleArrowUpDown=function(e,t){var a=null;var i=this;e.attachBrowserEvent("keydown",function(e){if(e.which===38){if(i.oVariantSelectionPage.getShowSubHeader()){a=document.activeElement.id}}});e.attachBrowserEvent("keyup",function(i){if(i.which===38){if(a&&a===document.activeElement.id){var n=e.getItems();if(n&&n.length>0){var s=sap.ui.getCore().byId(a);if(s===n[0]){t.focus()}}}a=null}});t.attachBrowserEvent("keyup",function(t){if(t.which===40){var a=e.getItems();if(a&&a.length>0){a[0].focus()}}})};Y.prototype._triggerSearch=function(e){if(!e){return}var t=e.getParameters();if(!t){return}this._restoreCompleteList();var a=t.newValue?t.newValue:"";this._triggerSearchByValue(a.toLowerCase())};Y.prototype._triggerSearchByValue=function(e){var t,a,i;this.oSelectedVariantItemKey=null;i=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(i&&i.getText().toLowerCase().indexOf(e)<0){if(this.getSelectionKey()===a){this.oSelectedVariantItemKey=a}this.oVariantList.removeItem(i);i.destroy()}var n=this._getItems();for(var s=0;s<n.length;s++){t=n[s].getText();if(t.toLowerCase().indexOf(e)<0){a=n[s].getKey();i=this.oVariantList.getItemByKey(a);if(i){if(this.getSelectionKey()===a){this.oSelectedVariantItemKey=a}this.oVariantList.removeItem(i);i.destroy()}}}};Y.prototype._triggerSearchInManageDialog=function(e){var t,a,i="",n,s;if(!e){return}var r=e.getParameters();if(!r){return}t=r.newValue?r.newValue.toLowerCase():"";if(this.oManagementTable){var o=this.oManagementTable.getItems();o.forEach(function(e){a=true;i="";s=e.getCells();if(s&&s[Y.NAME_COLUMN]){n=s[Y.NAME_COLUMN];if(n.getTitle){i=n.getTitle()}else if(n.getValue){i=n.getValue()}if(i.toLowerCase().indexOf(t)>=0){a=false}}if(a&&s&&s[Y.AUTHOR_COLUMN]){n=s[Y.AUTHOR_COLUMN];if(n.getText){i=n.getText();if(i.toLowerCase().indexOf(t)>=0){a=false}}}e.setVisible(!a)})}};Y.prototype._considerItem=function(e,t){if(this.getUseFavorites()&&!e){if(this._isIndustrySolutionModeAndVendorLayer()){return true}if(t.getFavorite&&t.getFavorite()){return true}return false}return true};Y.prototype._restoreCompleteList=function(e){var t,a,i,n;this.oVariantList.destroyItems();n=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(!n){n=this._createStandardVariantListItem();if(n){if(this._considerItem(e,n)){this.oVariantList.insertItem(n,0)}else{n.destroy()}}}if(n){if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===n.getKey()){this.oVariantList.setSelectedItem(n);this.oSelectedVariantItemKey=null}}else{if(this.getSelectionKey()==n.getKey()||this.getSelectionKey()===null){this.oVariantList.setSelectedItem(n)}}}i=this._getItems();i.sort(this._compareItems);for(t=0;t<i.length;t++){a=i[t];if(!this._considerItem(e,a)){continue}if(a.getKey()===this.getStandardVariantKey()){continue}n=this.oVariantList.getItemByKey(a.getKey());if(!n){n=this._createVariantListItem(a,t);this.oVariantList.addItem(n)}if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===n.getKey()){this.oVariantList.setSelectedItem(n);this.oSelectedVariantItemKey=null}}else{if(this.getSelectionKey()==n.getKey()){this.oVariantList.setSelectedItem(n)}}}};Y.prototype._determineStandardVariantName=function(){var e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.bVariantItemMode===false){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT")}if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){e=this.getStandardItemText()}}return e};Y.prototype._createStandardVariantListItem=function(){var e,t=null;var a=this._determineStandardVariantName();if(this.bVariantItemMode===true||this.bVariantItemMode===false&&(this.getSelectionKey()===this.getStandardVariantKey()||this.getSelectionKey()===null)){t=new b(this.oVariantPopoverTrigger.getId()+"-item-standard",{key:this.getStandardVariantKey(),readOnly:true,executeOnSelection:this.getExecuteOnSelectForStandardVariant()});t.setText(a);if(this._isIndustrySolutionModeAndVendorLayer()&&this.bVariantItemMode){t.setGlobal(true);t.setReadOnly(false)}if(this.getStandardVariantKey()!==this.STANDARDVARIANTKEY){e=this.getItemByKey(this.getStandardVariantKey());if(e){this._setVariantListItemProperties(e,t);if(e.getFavorite&&!e.getFavorite()&&this.getSelectionKey()===this.getStandardVariantKey()){t.setFavorite(true)}}}else{t.setAuthor(this.getStandardItemAuthor());t.setReadOnly(true);t.setFavorite(this.getStandardFavorite())}}return t};Y.prototype._createVariantListItem=function(e,t){var a=new b(this.oVariantPopoverTrigger.getId()+"-item-"+t,{key:e.getKey(),text:e.getText()});this._setVariantListItemProperties(e,a);return a};Y.prototype._setVariantListItemProperties=function(e,t){if(e.getReadOnly){t.setReadOnly(e.getReadOnly())}if(e.getExecuteOnSelection){t.setExecuteOnSelection(e.getExecuteOnSelection())}if(e.getGlobal){t.setGlobal(e.getGlobal())}if(e.getLifecyclePackage){t.setLifecyclePackage(e.getLifecyclePackage())}if(e.getLifecycleTransportId){t.setLifecycleTransportId(e.getLifecycleTransportId())}if(e.getNamespace){t.setNamespace(e.getNamespace())}if(e.getAccessOptions){t.setAccessOptions(e.getAccessOptions())}if(e.getLabelReadOnly){t.setLabelReadOnly(e.getLabelReadOnly())}if(e.getAuthor){t.setAuthor(e.getAuthor())}if(e.getFavorite){t.setFavorite(e.getFavorite())}if(e.getContexts){t.setContexts(e.getContexts())}};Y.prototype.exit=function(){if(this.oVariantInvisbletext){this.oVariantInvisbletext.destroy(true);this.oVariantInvisbletext=undefined}if(this.oSearchField){this.oSearchField.destroy();this.oSearchField=undefined}if(this.oManageDialogSearchField){this.oManageDialogSearchField.destroy();this.oManageDialogSearchField=undefined}if(this.oVariantManage){this.oVariantManage.destroy();this.oVariantManage=undefined}if(this.oVariantSave){this.oVariantSave.destroy();this.oVariantSave=undefined}if(this.oVariantList){this.oVariantList.destroy();this.oVariantList=undefined}if(this.oInputName){this.oInputName.destroy();this.oInputName=undefined}if(this.oLabelName){this.oLabelName.destroy();this.oLabelName=undefined}if(this.oDefault){this.oDefault.destroy();this.oDefault=undefined}if(this.oSaveSave){this.oSaveSave.destroy();this.oSaveSave=undefined}if(this.oSaveDialog){this.oSaveDialog.destroy();this.oSaveDialog=undefined}if(this.oManagementTable){this.oManagementTable.destroy();this.oManagementTable=undefined}if(this.oManagementSave){this.oManagementSave.destroy();this.oManagementSave=undefined}if(this.oManagementDialog){this.oManagementDialog.destroy();this.oManagementDialog=undefined}if(this.oVariantText){this.oVariantText.destroy();this.oVariantText=undefined}if(this.oVariantPopoverTrigger){this.oVariantPopoverTrigger.destroy();this.oVariantPopoverTrigger=undefined}if(this.oVariantLayout){this.oVariantLayout.destroy();this.oVariantLayout=undefined}if(this.oVariantPopOver){this.oVariantPopOver.destroy();this.oVariantPopOver=undefined}if(this.oVariantSaveAs){this.oVariantSaveAs.destroy();this.oVariantSaveAs=undefined}if(this.oShare){this.oShare.destroy();this.oShare=undefined}if(this.oExecuteOnSelect){this.oExecuteOnSelect.destroy();this.oExecuteOnSelect=undefined}if(this.oCreateTile){this.oCreateTile.destroy();this.oCreateTile=undefined}if(this.oSaveDialogOptionsGrid){this.oSaveDialogOptionsGrid.destroy();this.oSaveDialogOptionsGrid=undefined}if(this.oVariantSelectionPage){this.oVariantSelectionPage.destroy();this.oVariantSelectionPage=undefined}if(this.oErrorVariantPopOver){this.oErrorVariantPopOver.destroy();this.oErrorVariantPopOver=undefined}if(this.oInputKey){this.oInputKey.destroy();this.oInputKey=undefined}if(this.oLabelKey){this.oLabelKey.destroy();this.oLabelKey=undefined}if(this.oModel){this.oModel.destroy();this.oModel=undefined}};Y.prototype.addItem=function(e){e=this.validateAggregation("items",e,true);this.bVariantItemMode=false;this.addAggregation("items",e,false);var t=this.getInitialSelectionKey();this._setSelection(e,t);this._setStandardText();return this};Y.prototype.insertItem=function(e,t){var a=t;e=this.validateAggregation("items",e,true);this.bVariantItemMode=false;this.insertAggregation("items",e,a);var i=this.getInitialSelectionKey();this._setSelection(e,i);this._setStandardText();return this};Y.prototype.removeItem=function(e){e=this.removeAggregation("items",e);return e};Y.prototype.removeAllItems=function(){var e=this.removeAllAggregation("items");this._setSelectedItem(null);return e};Y.prototype.destroyItems=function(){this.destroyAggregation("items");this._setSelectedItem(null);return this};Y.prototype._getItems=function(){if(this.bVariantItemMode){return this.getVariantItems()}else{return this.getItems()}};Y.prototype._removeItem=function(e){if(this.bVariantItemMode){return this.removeVariantItem(e)}else{return this.removeItem(e)}};Y.prototype.getItemByKey=function(e){var t=this._getItems();for(var a=0;a<t.length;a++){if(e==t[a].getKey()){return t[a]}}return null};Y.prototype.addVariantItem=function(e){e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.addAggregation("variantItems",e,false);var t=this.getInitialSelectionKey();this._setSelection(e,t);this._setStandardText();e.attachChange(this._variantItemChange.bind(this,null));return this};Y.prototype.insertVariantItem=function(e,t){var a=t;e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.insertAggregation("variantItems",e,a);var i=this.getInitialSelectionKey();this._setSelection(e,i);this._setStandardText();e.attachChange(this._variantItemChange.bind(this,null));return this};Y.prototype._variantItemChange=function(e,t){var a;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){a=t.getParameter("propertyName");if(a==="text"){if(t.oSource===this._getSelectedItem()){this.oModel.setProperty("/selectedVariant",this._getSelectedItem().getText())}}}};Y.prototype._setSelectedItem=function(e){this.oSelectedItem=e;if(e!=null&&e.getKey()!=this.getStandardVariantKey()){this._setVariantText(e.getText())}else{this._setStandardText()}};Y.prototype._getSelectedItem=function(){return this.oSelectedItem};Y.prototype.setInitialSelectionKey=function(e){this.setProperty("initialSelectionKey",e,true);this._setSelectionByKey(e);return this};Y.prototype.setEnabled=function(e){this.setProperty("enabled",e,false);if(!e){this.oVariantText.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtDisabled")}else{this.oVariantText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtClickable")}return this};Y.prototype.getFocusDomRef=function(){if(this.oVariantPopoverTrigger&&this.getEnabled()){return this.oVariantPopoverTrigger.getFocusDomRef()}};Y.prototype._setSelection=function(e,t){if(e.getKey()===t){this._setSelectedItem(e);this.fireSelect({key:t})}};Y.prototype.addStyleClass=function(e){if(x.prototype.addStyleClass){x.prototype.addStyleClass.apply(this,arguments)}if(this.oVariantPopOver){this.oVariantPopOver.addStyleClass(e)}if(this.oSaveDialog){this.oSaveDialog.addStyleClass(e)}if(this.oManagementDialog){this.oManagementDialog.addStyleClass(e)}};Y.prototype.removeStyleClass=function(e){if(x.prototype.addStyleClass){x.prototype.removeStyleClass.apply(this,arguments)}if(this.oVariantPopOver){this.oVariantPopOver.removeStyleClass(e)}if(this.oSaveDialog){this.oSaveDialog.removeStyleClass(e)}if(this.oManagementDialog){this.oManagementDialog.removeStyleClass(e)}};Y.prototype.clearVariantSelection=function(){this.setInitialSelectionKey(this.getStandardVariantKey());this._setSelectedItem(null)};Y.prototype._setDialogCompactStyle=function(e,t){if(this._checkDialogCompactStyle(e)){t.addStyleClass("sapUiSizeCompact")}else{t.removeStyleClass("sapUiSizeCompact")}};Y.prototype._checkDialogCompactStyle=function(e){if(e.$().closest(".sapUiSizeCompact").length>0){return true}else{return false}};Y.prototype.getSelectionKey=function(){var e=null;var t=this._getSelectedItem();if(t!==null){e=t.getKey()}else if(this.bVariantItemMode){e=this.getStandardVariantKey()}else{e=null}return e};Y.prototype._setSelectionByKey=function(e){var t=this._getItems();var a=false;if(t.length>0){for(var i=0;i<t.length;i++){if(t[i].getKey()===e){this._setSelectedItem(t[i]);a=true;break}}}if(!a){this._setSelectedItem(null)}};Y.prototype.setCurrentVariantKey=function(e){this._setSelectionByKey(e)};Y.prototype.replaceKey=function(e,t){var a=this._getItems();if(a.length>0){for(var i=0;i<a.length;i++){if(a[i].getKey()===e){a[i].setKey(t);if(this.getDefaultVariantKey()==e){this.setDefaultVariantKey(t)}if(this._getSelectedItem()===a[i]){this._setSelectedItem(null)}break}}}};Y.prototype.verifyVariantKey=function(e){return this.getItemByKey(e)?true:false};Y.prototype.createVariantEntry=function(e){var t="SV"+(new Date).getTime();var a=new b({key:t,text:e.name,global:e.global});this.addAggregation("variantItems",a,false);return t};Y.prototype._assignUser=function(e,t){var a=this.getItemByKey(e);if(a&&a.isA("sap.ui.comp.variants.VariantItem")&&!a.getAuthor()){a.setAuthor(t)}};Y.prototype.currentVariantSetModified=function(e){if(this.oModel){this.oModel.setProperty("/enabled",e)}};Y.prototype.currentVariantGetModified=function(){return this.oModel.getProperty("/enabled")};Y.prototype._delayedControlCreation=function(){var e=this;if(this._bInnerControlsCreated){return}this._bInnerControlsCreated=true;this.oVariantManage=new m(this.getId()+"-manage",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGE"),enabled:true,press:function(){e._openVariantManagementDialog()},layoutData:new p({priority:W.High})});this.oVariantSave=new m(this.getId()+"-mainsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),press:function(){var t=e._createEvent("variantSavePressed",e._variantSavePressed);e._addEvent(t)},visible:{parts:[{path:"save_enablement>/creationAllowed"},{path:"save_enablement>/saveVariantVisible"}],formatter:function(e,t){return e&&t}},type:F.Emphasized,layoutData:new p({priority:W.Low})});this.oVariantSave.setModel(this.oModel);this.oVariantSaveAs=new m(this.getId()+"-saveas",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEAS"),press:function(){e._openSaveAsDialog()},visible:"{save_enablement>/creationAllowed}",layoutData:new p({priority:W.Low})});this.oVariantList=new I(this.getId()+"-list",{itemPress:function(t){var a=null;if(t&&t.getParameters()){var i=t.getParameters().item;if(i){a=i.getKey()}}if(a){e.lastSelectedVariantKey=a;e._setSelectionByKey(a);e.oVariantPopOver.close();e.oModel.setProperty("/enabled",false);e.bFireSelect=true}}});this.oVariantList.setNoDataText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NODATA"));this.oSearchField=new s;this.oSearchField.attachLiveChange(function(t){e._triggerSearch(t)});this._handleArrowUpDown(this.oVariantList,this.oSearchField);this.oVariantSelectionPage=new u(this.getId()+"selpage",{subHeader:new f({content:[this.oSearchField]}),content:[this.oVariantList],footer:new c({content:[new y(this.getId()+"-spacer"),this.oVariantSave,this.oVariantSaveAs,this.oVariantManage]}),showSubHeader:false,showNavButton:false,showHeader:false});this.oVariantPopOver=new A(this.getId()+"-popover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),titleAlignment:"Auto",contentWidth:"400px",placement:B.VerticalPreferredBottom,content:[this.oVariantSelectionPage],afterOpen:function(){e.bPopoverOpen=true;e.oVariantPopoverTrigger.setPressed(true);e._markSharedVariants()},afterClose:function(){e.oVariantPopoverTrigger.setPressed(false);if(e.bPopoverOpen){if(e.bFireSelect==true){e.bFireSelect=false;e._fireSelectAsync()}setTimeout(function(){e.bPopoverOpen=false},200)}},contentHeight:"300px"});this.oVariantPopOver.setParent(this);this.oVariantPopOver.addStyleClass("sapUICompVarMngmtPopover");this.oInputName=new V(this.getId()+"-name",{liveChange:function(t){e._checkVariantNameConstraints(this)}});this.oLabelName=new _(this.getId()+"-namelabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")});this.oLabelName.setLabelFor(this.oInputName);this.oLabelName.addStyleClass("sapUiCompVarMngmtSaveDialogLabel");this.oDefault=new S(this.getId()+"-default",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SETASDEFAULT"),enabled:true,visible:true,width:"100%"});this.oExecuteOnSelect=new S(this.getId()+"-execute",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),enabled:true,visible:false,width:"100%"});this.oCreateTile=new S(this.getId()+"-tile",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CREATETILE"),enabled:true,visible:false,width:"100%"});this.oShare=new S(this.getId()+"-share",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARE"),enabled:true,visible:false,select:function(t){var a=e._createEvent("inputfieldChange",e._handleShareSelected);a.args.push(t);e._addEvent(a)},width:"100%"});this.oInputKey=new V(this.getId()+"-key",{liveChange:function(t){e._checkVariantNameConstraints(this)}});this.oLabelKey=new _(this.getId()+"-keylabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_KEY"),required:true});this.oLabelKey.setLabelFor(this.oInputKey);this.oSaveSave=new m(this.getId()+"-variantsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),type:F.Emphasized,press:function(){e._checkVariantNameConstraints(e.oInputName);if(e.oInputName.getValueState()==="Error"){e.oInputName.focus();return}e._bSaveCanceled=false;if(e._fGetDataForKeyUser){e._handleSaveAsPressedForKeyUser()}else{e._triggerSave()}},enabled:true});this.oSaveDialogOptionsGrid=new K({defaultSpan:"L12 M12 S12"});this.oManagementTable=new g(this.getId()+"-managementTable",{contextualWidth:"Auto",fixedLayout:false});this.oManagementSave=new m(this.getId()+"-managementsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),enabled:true,type:F.Emphasized,press:function(){this._saveFromManagementDialog()}.bind(this)})};Y.prototype._saveFromManagementDialog=function(){if(this._anyItemInErrorState()){return}if(!this._fGetDataForKeyUser){var e=this._createEvent("managementSave",this._handleManageSavePressed);this._addEvent(e)}else{this._handleManageSavePressedForKeyUser()}};Y.prototype._openInErrorState=function(){var e=this,t;if(!this.oErrorVariantPopOver){t=new n({fitContainer:true,alignItems:z.Center,items:[new D({size:"4rem",color:"lightgray",src:"sap-icon://message-error"}),new T({titleStyle:H.H2,text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_TEXT1")}),new h({textAlign:G.Center,text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_TEXT2")})]});t.addStyleClass("sapUICompVarMngmtErrorPopover");this.oErrorVariantPopOver=new A(this.getId()+"-errorpopover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),contentWidth:"400px",placement:B.VerticalPreferredBottom,content:[new u(this.getId()+"-errorselpage",{showSubHeader:false,showNavButton:false,showHeader:false,content:[t]})],afterOpen:function(){e.bPopoverOpen=true},afterClose:function(){if(e.bPopoverOpen){e.bPopoverOpen=false}},contentHeight:"300px"});this.oErrorVariantPopOver.attachBrowserEvent("keyup",function(e){if(e.which===32){this.oErrorVariantPopOver.close()}}.bind(this))}if(this.bPopoverOpen){return}this.oErrorVariantPopOver.openBy(this.oVariantLayout)};Y.prototype.showSaveButton=function(e){if(e){this.oVariantSaveAs.setType(F.Default)}else{this.oVariantSaveAs.setType(F.Emphasized)}this.oModel.setProperty("/saveVariantVisible",e)};Y.prototype._openVariantSelection=function(){var e=null,t;if(this.getInErrorState()){this._openInErrorState();return}this._delayedControlCreation();if(this.bPopoverOpen){return}if(this.bVariantItemMode===false&&this.getSelectionKey()!==null){this.showSaveButton(true)}else{this.showSaveButton(false)}e=this._getItems();if(e.length<9){this.oVariantSelectionPage.setShowSubHeader(false)}else{this.oVariantSelectionPage.setShowSubHeader(true);this.oSearchField.setValue("")}this._restoreCompleteList();if(this.currentVariantGetModified()){t=this.oVariantList.getItemByKey(this.getSelectionKey());if(t){if(!t.getReadOnly()||this._isIndustrySolutionModeAndVendorLayer()&&this.getStandardVariantKey()===t.getKey()){this.showSaveButton(true)}}}if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey&&this.getStandardVariantKey()===this.STANDARDVARIANTKEY){this.showSaveButton(false)}this._setDialogCompactStyle(this,this.oVariantPopOver);t=this.oVariantList.getSelectedItem();if(t){this.oVariantPopOver.setInitialFocus(t.getId())}var a=this._oCtrlRef?this._oCtrlRef:this.oVariantLayout;this._oCtrlRef=null;this.oVariantPopOver.openBy(a)};Y.prototype._obtainControl=function(e){if(e&&e.target&&e.target.id){var t=e.target.id;var a=t.indexOf("-inner");if(a>0){t=t.substring(0,a)}return sap.ui.getCore().byId(t)}return null};Y.prototype.handleOpenCloseVariantPopover=function(e){if(this.oVariantPopOver&&this.oVariantPopOver.isOpen()){this.oVariantPopOver.close()}else if(!this.bPopoverOpen){this._oCtrlRef=this._obtainControl(e);this._openVariantSelection()}else if(this.getInErrorState()&&this.oErrorVariantPopOver&&this.oErrorVariantPopOver.isOpen()){this.oErrorVariantPopOver.close()}};Y.prototype._initalizeManagementTableColumns=function(){if(this.bManagementTableInitialized){return}this.oManagementTable.addColumn(new l({width:"3rem",visible:this.getUseFavorites()&&!this._isIndustrySolutionModeAndVendorLayer()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")}),width:"16rem"}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTTYPE"),wrappingType:"Hyphenated"}),demandPopin:true,popinDisplay:U.Inline,minScreenWidth:k.Tablet,visible:this.getShowShare()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),wrappingType:"Hyphenated"}),hAlign:G.Center,demandPopin:true,popinDisplay:U.Block,minScreenWidth:k.Tablet,visible:this.getShowSetAsDefault()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),wrappingType:"Hyphenated"}),hAlign:this.getDisplayTextForExecuteOnSelectionForStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()?G.Begin:G.Center,demandPopin:true,popinDisplay:U.Block,minScreenWidth:k.Tablet,visible:this.getShowExecuteOnSelection()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VISIBILITY"),wrappingType:"Hyphenated"}),width:"8rem",demandPopin:true,popinDisplay:U.Inline,minScreenWidth:k.Tablet,visible:false}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_AUTHOR")}),demandPopin:true,popinDisplay:U.Block,minScreenWidth:k.Tablet}));this.oManagementTable.addColumn(new l({header:new C({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")}),hAlign:G.Center}));this.bManagementTableInitialized=true};Y.prototype._initalizeSaveAsDialog=function(){this.oSaveDialogOptionsGrid.removeAllContent();this.oDefault.setVisible(this.getShowSetAsDefault());this.oShare.setVisible(this.getShowShare());this.oExecuteOnSelect.setVisible(this.getShowExecuteOnSelection());this.oCreateTile.setVisible(this.getShowCreateTile());if(this.getShowSetAsDefault()){this.oSaveDialogOptionsGrid.addContent(this.oDefault)}if(this.getShowShare()){this.oSaveDialogOptionsGrid.addContent(this.oShare)}if(this.getShowExecuteOnSelection()){this.oSaveDialogOptionsGrid.addContent(this.oExecuteOnSelect)}if(this.getShowCreateTile()){this.oSaveDialogOptionsGrid.addContent(this.oCreateTile)}};Y.prototype.ontap=function(e){if(this.getEnabled()){if(this.oVariantPopoverTrigger&&!this.bPopoverOpen){this.oVariantPopoverTrigger.focus()}this.handleOpenCloseVariantPopover(e)}};Y.prototype.onkeyup=function(e){if(e.which===L.ENTER||e.which===L.F4||e.which===L.SPACE||e.altKey===true&&e.which===L.ARROW_UP||e.altKey===true&&e.which===L.ARROW_DOWN){if(this.getEnabled()){this._oCtrlRef=this._obtainControl(e);this._openVariantSelection()}}};Y.prototype.onAfterRendering=function(){this.oVariantText.$().off("mouseover").on("mouseover",function(){this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtTriggerBtnHover")}.bind(this));this.oVariantText.$().off("mouseout").on("mouseout",function(){this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtTriggerBtnHover")}.bind(this))};Y.prototype.onBeforeRendering=function(){var e=function(e){var t,a=0;for(var i=0;i<e.length;i++){t=e[i].$().width();if(t>a){a=t}}return a};if(this.oSaveDialogOptionsGrid&&this.oSaveDialog&&this.oSaveDialog.getVisible()){var t=this.oSaveDialogOptionsGrid.getContent();if(t&&t.length>0){var a=this.oSaveDialogOptionsGrid.$().width();var i=e(t);var n=32;var s=12;if(!this._checkDialogCompactStyle(this.oSaveDialog)){n=48;s=18}if(n+i+s>a/2){this.oSaveDialogOptionsGrid.setDefaultSpan("L12 M12 S12")}}}};Y.prototype._markSharedVariants=function(){var e,t,a=this._getItems();for(var i=0;i<a.length;i++){t=a[i];if(t.getGlobal&&t.getGlobal()){e=this.oVariantList.getItemByKey(t.getKey());if(e){var n=e.$();if(n){n.addClass("sapUiCompVarMngmtSharedVariant")}}}}};Y.prototype._variantSavePressed=function(){var e=this._getSelectedItem();if(!e){if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){e=new b({key:this.STANDARDVARIANTKEY,global:this._isIndustrySolutionModeAndVendorLayer()});e.setText(this._determineStandardVariantName())}else{e=this.getItemByKey(this.getStandardVariantKey())}}var t=false;if(this.getDefaultVariantKey()===e.getKey()){t=true}if(e.getLifecyclePackage&&e.getGlobal()==true){var a=this;var i=function(i,n){a.oVariantPopOver.close();a.sPackage=i;a.sTransport=n;a.fireSave({name:e.getText(),overwrite:true,key:e.getKey(),def:t,global:a._isIndustrySolutionModeAndVendorLayer()&&a.getStandardVariantKey()===a.getStandardVariantKey(),lifecyclePackage:a.sPackage,lifecycleTransportId:a.sTransport});e.setLifecycleTransportId(a.sTransport);a.oModel.setProperty("/enabled",false);a._eventDone()};var n=function(e){a.sTransport=null;a.sPackage=null;a._cancelAllEvents()};this._assignTransport(e,i,n,this.oVariantText)}else{this.oVariantPopOver.close();this.fireSave({name:e.getText(),overwrite:true,key:e.getKey(),def:t});this.oModel.setProperty("/enabled",false);this._eventDone()}};Y.prototype._assignTransport=function(e,t,a,i){var n={type:"variant",name:"",namespace:""};n["package"]="";if(e!==null){n["package"]=e.getLifecyclePackage();n["name"]=e.getKey();n["namespace"]=e.getNamespace()}var s=function(e){var a;var i;i=e.getParameters().selectedTransport;a=e.getParameters().selectedPackage;t(a,i)};var r=function(e){a(e)};if(this.getLifecycleSupport()){var o=null;if(e){o=e.getLifecycleTransportId()}if(o!=null&&o.trim().length>0){t(n["package"],o)}else{this._getTransportSelection().then(function(e){e.selectTransport(n,s,r,this._checkDialogCompactStyle(i),i)}.bind(this))}}else{t(n["package"],"")}};Y.prototype._getTransportSelection=function(){if(this.getTransportSelection){return this.getTransportSelection()}else{return this._getFlTransportSelection()}};Y.prototype._getFlTransportSelection=function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/write/api/SmartVariantManagementWriteAPI"],function(t){e(t._getTransportSelection())})})})};Y.prototype.getDefaultVariantKey=function(){var e=this.getProperty("defaultVariantKey");if(e===""){if(this.bVariantItemMode){e=this.getStandardVariantKey()}}return e};Y.prototype._compareItems=function(e,t){var a=e.getText();var i=t.getText();var n=a.toUpperCase();var s=i.toUpperCase();if(n==s){if(a==i){return 0}if(a<i){return-1}if(a>i){return 1}}if(n<s){return-1}if(n>s){return 1}};Y.prototype._accessOptionsText=function(e){var t=null;switch(e){case"R":t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER");break;case"RD":t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE");break;default:t=null}return t};Y.prototype._openSaveAsDialog=function(){this._initSaveAsDialog();this.oSaveDialog.open()};Y.prototype._initSaveAsDialog=function(){this._initalizeSaveAsDialog();this.oInputName.setValue(this.oModel.getProperty("/selectedVariant"));this.oInputName.setEnabled(true);this.oInputName.setValueState(P.None);this.oInputName.setValueStateText(null);this.oDefault.setSelected(false);this.oShare.setSelected(false);this.oCreateTile.setSelected(false);this.oExecuteOnSelect.setSelected(false);if(this._isIndustrySolutionModeAndVendorLayer()){this.oInputName.setValue(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"))}this._createSaveDialog();this._setDialogCompactStyle(this,this.oSaveDialog);this.oVariantPopOver.close();this.sTransport=null;this.sPackage=null;if(this.bManualVariantKey){this.oInputKey.setVisible(true);this.oInputKey.setEnabled(true);this.oInputKey.setValueState(P.None);this.oInputKey.setValueStateText(null);this.oLabelKey.setVisible(true)}else{this.oInputKey.setVisible(false);this.oLabelKey.setVisible(false)}};Y.prototype._checkManageItemNameChange=function(e){var t="";var a=null;var i=this;a=e.getCells()[Y.NAME_COLUMN];t=a.getValue();t=t.trim();var n=e;var s=n.getKey();this._checkVariantNameConstraints(a,this.oManagementTable);if(a.getValueState()===P.Error){this._eventDone();return}if(this.oVariantList.getItemByKey(s).getText().trim()===t){this._eventDone();return}if(n.getGlobal()){var r=function(e,t){n.setLifecyclePackage(e);n.setLifecycleTransportId(t);i._eventDone()};var o=function(e){if(i&&i.oVariantList){var t=i.oVariantList.getItemByKey(s);a.setValue(t.getText())}i._cancelAllEvents()};this._createManagementDialog();this._assignTransport(n,r,o,this.oManagementDialog)}else{this._eventDone()}};Y.prototype._handleManageSavePressed=function(){var e=this.oManagementTable.getItems();var t,a;var i=false;var n="";var s=null;var r=0;var o=[];for(var l=0;l<e.length;l++){t=this.oVariantList.getItemByKey(e[l].getKey());a=e[l].getCells()[Y.NAME_COLUMN];if(a&&a.getValue){n=a.getValue()}else if(a&&a.getTitle){n=a.getTitle()}else if(a&&a.getText){n=a.getText()}n=n.trim();if(t.getText()!==n){this.aRenamedVariants.push({key:t.getKey(),name:n});s=this.getItemByKey(e[l].getKey());s.setText(n);if(s.setLifecyclePackage){s.setLifecyclePackage(e[l].getLifecyclePackage());s.setLifecycleTransportId(e[l].getLifecycleTransportId())}if(this.lastSelectedVariantKey===t.getKey()){this._setVariantText(n)}}if(this.getUseFavorites()&&!this._isIndustrySolutionModeAndVendorLayer()){var h=e[l].getKey();if(this._mFavoriteChanges&&this._mFavoriteChanges[h]!==undefined){var d=this._mFavoriteChanges[h];if(h===this.STANDARDVARIANTKEY){if(this.getStandardFavorite()!==d){o.push({key:h,visible:d});this.setStandardFavorite(d)}}else{s=this.getItemByKey(e[l].getKey());if(s&&t.getFavorite&&t.getFavorite()!==d){o.push({key:h,visible:d});s.setFavorite(d)}}}}if(this.getShowExecuteOnSelection()&&t.getExecuteOnSelection&&e[l].getCells()[Y.EXEC_COLUMN].isA("sap.m.CheckBox")&&t.getExecuteOnSelection()!=e[l].getCells()[Y.EXEC_COLUMN].getSelected()){var g=e[l].getCells()[Y.EXEC_COLUMN].getSelected();var u=this.getItemByKey(e[l].getKey());if(!u&&this.getSupportExecuteOnSelectOnSandardVariant()&e[l].getKey()===this.getStandardVariantKey()){u=new b}if(u&&u.setExecuteOnSelection){u.setExecuteOnSelection(g);if(this.getSupportExecuteOnSelectOnSandardVariant()&e[l].getKey()===this.getStandardVariantKey()){this._executeOnSelectForStandardVariantByUser(g)}this.aExeVariants.push({key:t.getKey(),exe:g});if(u.setLifecyclePackage&&!u.getReadOnly()){u.setLifecyclePackage(e[l].getLifecyclePackage());u.setLifecycleTransportId(e[l].getLifecycleTransportId())}}}}if(this.oManagementDialog){this.oManagementDialog.close()}if(this.bVariantItemMode===false){if(this.getDefaultVariantKey()!=this.sNewDefaultKey){var c=null;if(this.sNewDefaultKey==this.getStandardVariantKey()){c=this.getItemByKey(this.getDefaultVariantKey());this.fireSave({name:c.getText(),overwrite:true,key:c.getKey(),def:false})}else{c=this.getItemByKey(this.sNewDefaultKey);this.fireSave({name:c.getText(),overwrite:true,key:c.getKey(),def:true})}}}if(this.sNewDefaultKey!=this.getDefaultVariantKey()){this.setDefaultVariantKey(this.sNewDefaultKey)}for(r=0;r<this.aRemovedVariants.length;r++){t=this.getItemByKey(this.aRemovedVariants[r]);for(var p=0;p<this.aRemovedVariantTransports.length;p++){if(this.aRemovedVariants[r]===this.aRemovedVariantTransports[p].key){var f=this.aRemovedVariantTransports[p];if(t.setLifecyclePackage){t.setLifecycleTransportId(f.transport)}break}}}this.fireManage({renamed:this.aRenamedVariants,deleted:this.aRemovedVariants,exe:this.aExeVariants,def:this.getDefaultVariantKey(),fav:o});for(r=0;r<this.aRemovedVariants.length;r++){t=this.getItemByKey(this.aRemovedVariants[r]);if(t){this._removeItem(t);t.destroy()}if(this.lastSelectedVariantKey===this.aRemovedVariants[r]){i=true;this._setSelectedItem(null);this.oModel.setProperty("/enabled",false)}}if(i){this.bFireSelect=true}this._eventDone()};Y.prototype._createEvent=function(e,t){var a={name:e,fFunc:t,args:[]};return a};Y.prototype._handleNextEvent=function(){if(this.aEvents.length>0){if(!this.bEventRunning){this.bEventRunning=true;var e=this.aEvents.pop();e.fFunc.apply(this,e.args)}}};Y.prototype._addEvent=function(e){this.aEvents.push(e);this._handleNextEvent()};Y.prototype._cancelAllEvents=function(){this.aEvents=[];this.bEventRunning=false};Y.prototype._eventDone=function(){this.bEventRunning=false;this._handleNextEvent()};Y.prototype._handleManageExecuteOnSelectionChanged=function(e){var t=this;var a=e.getParent();if(a&&a.getGlobal()&&!a.getReadOnly()){var i=function(e,i){a.setLifecyclePackage(e);a.setLifecycleTransportId(i);t._eventDone()};var n=function(a){e.setSelected(!e.getSelected());t._cancelAllEvents()};this._createManagementDialog();this._assignTransport(a,i,n,this.oManagementDialog)}else{this._eventDone()}};Y.prototype._handleManageDeletePressed=function(e){var t=this,a;var i=function(){var e=null,a=t.oManagementTable.getItems();a.some(function(a){if(a.getKey()===t.getStandardVariantKey()){e=a;return true}});return e};this._anyInErrorState(this.oManagementTable,e.getParent().getCells()[Y.NAME_COLUMN]);a=i();var n=e.getParent();if(n.getGlobal()){var s=function(e,i){var s=n.getKey();t.aRemovedVariants.push(s);t.oManagementTable.removeItem(n);if(t.getShowSetAsDefault()){if(n.getKey()===t.sNewDefaultKey){if(a){a.getCells()[Y.DEF_COLUMN].setSelected(true);a.getCells()[Y.DEF_COLUMN].fireSelect({selected:true})}else{t.setStandardVariantKey(t.STANDARDVARIANTKEY)}t.sNewDefaultKey=t.getStandardVariantKey()}}n.destroy();var r={key:s,transport:i};t.aRemovedVariantTransports.push(r);t._eventDone()};var r=function(e){t._cancelAllEvents()};this._createManagementDialog();this._assignTransport(n,s,r,this.oManagementDialog)}else{this.aRemovedVariants.push(n.getKey());this.oManagementTable.removeItem(n);if(this.getShowSetAsDefault()){if(n.getKey()===this.sNewDefaultKey){if(a){a.getCells()[Y.DEF_COLUMN].setSelected(true);a.getCells()[Y.DEF_COLUMN].fireSelect({selected:true})}this.sNewDefaultKey=this.getStandardVariantKey()}}n.destroy();this._eventDone()}var o=sap.ui.getCore().byId(this.getId()+"-managementcancel");if(o){o.focus()}};Y.prototype._handleShareSelected=function(e){var t=this;if(e.getParameters&&e.getParameters()&&e.getParameters().selected){var a=function(e,a){t.sTransport=a;t.sPackage=e;t._eventDone()};var i=function(e){t.oShare.setSelected(false);t.sTransport=null;t.sPackage=null;t._cancelAllEvents()};this._createSaveDialog();this._assignTransport(null,a,i,this.oSaveDialog)}else{this.sTransport=null;this.sPackage=null;this._eventDone()}};Y.prototype._handleVariantSaveAs=function(){var e="SV"+(new Date).getTime();var t=this.oInputName.getValue();var a=this.oInputKey.getValue();var i="";var n="";var s=false;var r=false;var o=null;t=t.trim();if(t==""){this.oInputName.setValueState(P.Error);this.oInputName.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return}a=a.trim();if(this.bManualVariantKey&&a==""){this.oInputKey.setValueState(P.Error);this.oInputKey.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return}if(this.bManualVariantKey){e=a}if(this.oSaveDialog){this.oSaveDialog.close()}if(this.oExecuteOnSelect!==null){s=this.oExecuteOnSelect.getSelected()}if(this.oCreateTile!==null){r=this.oCreateTile.getSelected()}if(this.bVariantItemMode){o=new b({key:e,readOnly:false,executeOnSelection:s,global:this.oShare.getSelected(),lifecycleTransportId:this.sTransport,lifecyclePackage:this.sPackage});o.setText(t);this.addVariantItem(o);this._setSelectedItem(o)}else{o=new R({key:e});o.setText(t);this.addItem(o);this._setSelectedItem(o)}if(this.oDefault.getSelected()){this.setDefaultVariantKey(e)}if(this.oShare.getSelected()){n=this.sPackage;i=this.sTransport}this.fireSave({name:t,overwrite:false,def:this.oDefault.getSelected(),key:e,exe:this.oExecuteOnSelect.getSelected(),tile:r,global:this.oShare.getSelected(),lifecyclePackage:n,lifecycleTransportId:i});this.oModel.setProperty("/enabled",false);this._eventDone()};Y.prototype.setBackwardCompatibility=function(e){this._setBackwardCompatibility(e)};Y.prototype._setBackwardCompatibility=function(e){if(this.getItems().length===0&&this.getVariantItems().length===0){this.bVariantItemMode=!e}this._setStandardText()};Y.prototype._setStandardText=function(){var e=this.getSelectionKey();if(e===null||e===this.getStandardVariantKey()){if(this.bVariantItemMode==false){this._setVariantText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"))}else{this._setVariantText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"))}if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){this._setVariantText(this.getStandardItemText())}}};Y.prototype._setVariantText=function(e){var t,a=this.extractBindingInfo(e),i=e;if(typeof a==="object"&&a.model&&a.path){t=this.getModel(a.model);if(t){i=t.getProperty(a.path)}}this.oModel.setProperty("/selectedVariant",i)};Y.prototype._getVariantText=function(e){return this.oModel.getProperty("/selectedVariant")};Y.prototype._updateVariantInvisibletext=function(e,t){if(t){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_MODIFIED",[e])}return e};Y.prototype._setFavoriteIcon=function(e,t){e.setSrc(t?"sap-icon://favorite":"sap-icon://unfavorite");e.setTooltip(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_FAV_DEL_TOOLTIP":"VARIANT_MANAGEMENT_FAV_ADD_TOOLTIP"));e.setAlt(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_FAV_DEL_ACC":"VARIANT_MANAGEMENT_FAV_ADD_ACC"))};Y.prototype._isFavoriteSelected=function(e){return e.getSrc()==="sap-icon://unfavorite"};Y.prototype._openVariantManagementDialog=function(){var e;var t=null;var a=0;var i;var n;var s;var r;var l;var d;var g;var u;var c,p,f,y,v,T;var _=this;this._mFavoriteChanges={};this.oManagementSave.setEnabled(true);this.oManagementSave.setTooltip(null);this.oManagementTable.destroyItems();c=function(e){_._checkVariantNameConstraints(this,_.oManagementTable)};p=function(e){var t=_._createEvent("inputfieldChange",_._checkManageItemNameChange);t.args.push(this.getParent());_._addEvent(t)};v=function(e){var t=_._isFavoriteSelected(e.oSource),a=this.getParent();if(a&&_.sNewDefaultKey!==a.getKey()){_._mFavoriteChanges[a.getKey()]=t;_._setFavoriteIcon(e.oSource,t)}};f=function(e){var t=e.getParameters().selected===true,a=this.getParent();if(a){if(t){_.sNewDefaultKey=a.getKey();_._mFavoriteChanges[a.getKey()]=t}var i=a.getCells()[Y.FAV_COLUMN];if(i&&a.getFavorite){if(t){_._setFavoriteIcon(i,true)}else if(_._mFavoriteChanges[a.getKey()]!==undefined){_._setFavoriteIcon(i,_._mFavoriteChanges[a.getKey()])}else{_._setFavoriteIcon(i,a.getFavorite()===true)}}}};y=function(e){var t=_._createEvent("executeOnSelectionChange",_._handleManageExecuteOnSelectionChanged);t.args.push(this);_._addEvent(t)};T=function(e){var t=_._createEvent("manageDeletePressed",_._handleManageDeletePressed);t.args.push(this);_._addEvent(t)};if(this.oManageDialogSearchField){this.oManageDialogSearchField.setValue("")}this._initalizeManagementTableColumns();this.sNewDefaultKey=this.getDefaultVariantKey();this._restoreCompleteList(true);if(this.oVariantList.getItems()[0].getKey()!==this.getStandardVariantKey()&&this.bVariantItemMode==false){e=new b(this.oVariantManage.getId()+"-item-standard",{key:this.getStandardVariantKey(),text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),readOnly:true,executeOnSelection:false});this.oVariantList.insertItem(e,0)}if(this.getUseFavorites()){e=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(e){this.oVariantList.removeItem(e)}}t=this.oVariantList.getItems();if(this.getUseFavorites()){t.sort(this._compareItems);if(e){this.oVariantList.insertItem(e);t.splice(0,0,e)}}for(var A=0;A<t.length;A++){if(t[A].getReadOnly()||t[A].getLabelReadOnly()){var I=t[A].getAccessOptions();u=this._accessOptionsText(I)}else{u=null}if(t[A].getReadOnly()){u=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER")}else if(t[A].getLabelReadOnly()===true){u=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE")}if(t[A].getKey()===this.getStandardVariantKey()){u=null}i=new N(this.oVariantManage.getId()+"-edit-"+a,{key:t[A].getKey(),global:t[A].getGlobal(),readOnly:t[A].getReadOnly(),lifecyclePackage:t[A].getLifecyclePackage(),lifecycleTransportId:t[A].getLifecycleTransportId(),namespace:t[A].getNamespace(),labelReadOnly:t[A].getLabelReadOnly(),author:t[A].getAuthor(),favorite:t[A].getFavorite(),vAlign:w.Middle});n=new D(this.oVariantManage.getId()+"-fav-"+a,{press:v});n.addStyleClass("sapUICompVarMngmtFavColor");if(t[A].getFavorite){this._setFavoriteIcon(n,t[A].getFavorite())}i.addCell(n);if(t[A].getKey()===this.getStandardVariantKey()||t[A].getReadOnly()===true||t[A].getLabelReadOnly()===true){n=new M(this.oVariantManage.getId()+"-text-"+a,{});n.setTitle(t[A].getText());if(u){n.setTooltip(u)}}else{n=new V(this.oVariantManage.getId()+"-input-"+a,{liveChange:c,change:p});n.setValue(t[A].getText())}i.addCell(n);if(t[A].getGlobal()){g=this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARED")}else{g=this.oResourceBundle.getText("VARIANT_MANAGEMENT_PRIVATE")}s=new h(this.oVariantManage.getId()+"-type-"+a,{text:g,wrapping:false});s.addStyleClass("sapUICompVarMngmtType");i.addCell(s);r=new o(this.oVariantManage.getId()+"-def-"+a,{groupName:this.oVariantManage.getId(),select:f});if(this.sNewDefaultKey===t[A].getKey()||t[A].getKey()===this.getStandardVariantKey()&&this.sNewDefaultKey===""){r.setSelected(true);if(t[A].getFavorite){this._setFavoriteIcon(i.getCells()[0],true)}}i.addCell(r);l=new S(this.oVariantManage.getId()+"-exe-"+a,{selected:false,enabled:false,select:y});if(t[A].getExecuteOnSelection){if(t[A].getKey()===this.getStandardVariantKey()&&this.getSupportExecuteOnSelectOnSandardVariant()){l.setEnabled(true);if(this.bExecuteOnSelectForStandardByUser!==null){l.setSelected(this.bExecuteOnSelectForStandardByUser)}else{l.setSelected(t[A].getExecuteOnSelection())}}else{l.setEnabled(!t[A].getReadOnly());l.setSelected(t[A].getExecuteOnSelection())}if(u){l.setTooltip(u)}}i.addCell(l);i.addCell(new h);s=new h(this.oVariantManage.getId()+"-author-"+a,{text:t[A].getAuthor(),textAlign:"Begin"});i.addCell(s);d=new m(this.oVariantManage.getId()+"-del-"+a,{icon:"sap-icon://decline",enabled:true,type:F.Transparent,press:T,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DELETE")});if(t[A].getReadOnly&&t[A].getReadOnly()){d.setEnabled(false);d.setVisible(false)}i.addCell(d);this.oManagementTable.addItem(i);a++}this.aRemovedVariants=[];this.aRemovedVariantTransports=[];this.aRenamedVariants=[];this.aExeVariants=[];this._createManagementDialog();this._setDialogCompactStyle(this,this.oManagementDialog);e=this.oVariantList.getSelectedItem();if(e){this.lastSelectedVariantKey=e.getKey()}this.oVariantPopOver.close();this.oManagementDialog.open()};Y.prototype._assignColumnInfoForDeleteButton=function(e){if(!this._oInvisibleDeleteColumnName){this._oInvisibleDeleteColumnName=new C({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")});this._createManagementDialog();this.oManagementDialog.addContent(this._oInvisibleDeleteColumnName)}if(this._oInvisibleDeleteColumnName){e.addAriaLabelledBy(this._oInvisibleDeleteColumnName)}};Y.prototype._enableManualVariantKey=function(e){this.bManualVariantKey=e};Y.prototype._fireSelectAsync=function(e){var t;if(e===undefined||e===null){var a=this._getSelectedItem();if(a===null){t=this.getStandardVariantKey()}else{t=a.getKey()}}this.fireSelect({key:t})};Y.prototype.setSupportExecuteOnSelectOnSandardVariant=function(e){this.bSupportExecuteOnSelectOnSandardVariant=e};Y.prototype.getSupportExecuteOnSelectOnSandardVariant=function(){return this.bSupportExecuteOnSelectOnSandardVariant};Y.prototype._executeOnSelectForStandardVariantByXML=function(e){this.bExecuteOnSelectForStandardViaXML=e};Y.prototype._executeOnSelectForStandardVariantByUser=function(e){this.bExecuteOnSelectForStandardByUser=e};Y.prototype.getExecuteOnSelectForStandardVariant=function(){if(this.getSupportExecuteOnSelectOnSandardVariant()){if(this.bExecuteOnSelectForStandardByUser!==null){return this.bExecuteOnSelectForStandardByUser}}return this.bExecuteOnSelectForStandardViaXML};Y.prototype.getStandardVariantKey=function(){return this._sStandardVariantKey};Y.prototype.setStandardVariantKey=function(e){this._sStandardVariantKey=e};Y.prototype._setVendorLayer=function(e){this._bVendorLayer=e};Y.prototype.setStandardFavorite=function(e){this._isFavorite=e};Y.prototype.getStandardFavorite=function(){return this._isFavorite};Y.prototype._isIndustrySolutionModeAndVendorLayer=function(){if(this._getIndustrySolutionMode()&&this._bVendorLayer){return true}return false};Y.prototype._setIndustrySolutionMode=function(e){this._bIndustrialSolutionMode=e};Y.prototype._getIndustrySolutionMode=function(){return this._bIndustrialSolutionMode};return Y});
sap.ui.require.preload({
	"sap/ui/comp/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.comp","type":"library","embeds":[],"applicationVersion":{"version":"1.108.14"},"title":"SAPUI5 library with smart controls.","description":"SAPUI5 library with smart controls.","ach":"CA-UI5-CMP\\n\\t\\t\\t","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.108","libs":{"sap.ui.core":{"minVersion":"1.108.14"},"sap.m":{"minVersion":"1.108.14"},"sap.ui.fl":{"minVersion":"1.108.14","lazy":true},"sap.ui.mdc":{"minVersion":"1.108.14","lazy":true},"sap.ui.table":{"minVersion":"1.108.14","lazy":true},"sap.chart":{"minVersion":"1.108.14","lazy":true},"sap.ui.layout":{"minVersion":"1.108.14","lazy":true},"sap.suite.ui.microchart":{"minVersion":"1.108.14","lazy":true}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartLineMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smartmicrochart.SmartDeltaMicroChart","sap.ui.comp.smartmicrochart.SmartRadialMicroChart","sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart","sap.ui.comp.smartmicrochart.SmartComparisonMicroChart","sap.ui.comp.smartmicrochart.SmartColumnMicroChart","sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart","sap.ui.comp.smartmicrochart.SmartMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartlist.SmartList","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2","sap.ui.comp.transport.TransportDialog","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement"],"elements":["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SemanticGroupElement","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem","sap.ui.comp.navpopover.NavigationContainer","sap.ui.comp.smartvariants.SmartVariantManagementAdapter"],"types":["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartchart.SelectionMode","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smartfield.CriticalityRepresentationType","sap.ui.comp.smartfield.TextInEditModeSource","sap.ui.comp.smartfield.Importance","sap.ui.comp.TextArrangementType","sap.ui.comp.smarttable.TableType","sap.ui.comp.smarttable.ExportType","sap.ui.comp.smartlist.ListType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType","sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation","sap.ui.comp.smartfilterbar.SelectOptionSign","sap.ui.comp.smartfilterbar.DisplayBehaviour","sap.ui.comp.smartform.SmartFormValidationMode"],"interfaces":["sap.ui.comp.smartform.SmartFormLayout","sap.ui.comp.IFormGroupElement"]}}}}',
	"sap/ui/comp/smartchart/SmartChart.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
(function(){"use strict";var t=sap.ui.require("sap/ui/performance/Measurement");if(t&&t.getActive()){t.start("SmartChartInit","Measurement of SmartChart init time")}})();sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/comp/util/DateTimeUtil","sap/m/Button","sap/m/Text","sap/m/FlexItemData","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/m/ToolbarSeparator","sap/m/ToolbarSpacer","sap/m/VBox","sap/ui/comp/providers/ChartProvider","sap/ui/comp/smartfilterbar/FilterProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/comp/personalization/Util","sap/ui/Device","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/state/UIState","sap/m/SelectionDetails","sap/m/SelectionDetailsItem","sap/m/SelectionDetailsItemLine","sap/m/Title","sap/ui/comp/util/FormatUtil","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/core/InvisibleText","sap/m/OverflowToolbarLayoutData","sap/m/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/ChartWrapper","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/performance/Measurement","sap/base/Log","sap/base/util/merge","sap/chart/TimeUnitType","sap/ui/core/CustomData","sap/ui/core/ResizeHandler","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/util/FilterUtil","sap/ui/core/aria/HasPopup"],function(jQuery,t,e,i,a,r,o,s,n,h,l,u,c,p,d,_,f,m,g,b,C,y,v,T,S,D,B,V,P,w,I,M,O,A,L,F,R,x,N,H,E,U,z,j,q,k){"use strict";var Z=A.ToolbarDesign;var K=A.ListMode;var G=A.ListType;var W=A.PlacementType;var X=t.personalization.ChangeType;var $=t.personalization.ResetType;var J=t.smartchart.SelectionMode;var Y;var Q;var tt;var et;var it;var at;var rt;var ot;var st;var nt;var ht;var lt;var ut;var ct;var pt;var dt;var _t;var ft;var mt;var gt=u.extend("sap.ui.comp.smartchart.SmartChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartchart/SmartChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},ignoredChartTypes:{type:"string",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useChartPersonalisation:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},persistencyKey:{type:"string",group:"Misc",defaultValue:null},currentVariantId:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showDrillButtons:{type:"boolean",group:"Misc",defaultValue:true},showZoomButtons:{type:"boolean",group:"Misc",defaultValue:true},showSemanticNavigationButton:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},showDownloadButton:{type:"boolean",group:"Misc",defaultValue:false},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},showDrillBreadcrumbs:{type:"boolean",group:"Misc",defaultValue:false},showChartTooltip:{type:"boolean",group:"Misc",defaultValue:true},showLegendButton:{type:"boolean",group:"Misc",defaultValue:true},legendVisible:{type:"boolean",group:"Misc",defaultValue:true},selectionMode:{type:"sap.ui.comp.smartchart.SelectionMode",group:"Misc",defaultValue:J.Multi},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:true},useTooltip:{type:"boolean",group:"Misc",defaultValue:true},useListForChartTypeSelection:{type:"boolean",group:"Misc",defaultValue:true},showChartTypeSelectionButton:{type:"boolean",group:"Misc",defaultValue:true},noData:{type:"string",group:"Misc",defaultValue:null},showToolbar:{type:"boolean",group:"Misc",defaultValue:true},toolbarStyle:{type:"sap.m.ToolbarStyle",group:"Appearance"},showDimensionsTitle:{type:"boolean",group:"Misc",defaultValue:true},showMeasuresTitle:{type:"boolean",group:"Misc",defaultValue:true},activateTimeSeries:{type:"boolean",group:"Misc",defaultValue:false},notAssignedText:{type:"string",group:"Misc",defaultValue:""}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{toolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},selectionDetailsItemActions:{type:"sap.ui.core.Item",multiple:true},selectionDetailsActions:{type:"sap.ui.core.Item",multiple:true},selectionDetailsActionGroups:{type:"sap.ui.core.Item",multiple:true}},events:{initialise:{},initialized:{},beforeRebindChart:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"}}},showOverlay:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},selectionDetailsActionPress:{parameters:{action:{type:"sap.ui.core.Item"},itemContexts:{type:"sap.ui.model.Context"},level:{type:"sap.m.SelectionDetailsActionLevel"}}},chartDataChanged:{parameters:{changeTypes:{type:"object"}}},uiStateChange:{}}},renderer:{apiVersion:2}});gt.prototype.init=function(){u.prototype.init.call(this);this.addStyleClass("sapUiCompSmartChart");this.setFitContainer(true);this._bUpdateToolbar=true;this._oChartTypeModel=null;var t=new f({items:[]});this.setModel(t,"$smartChartTypes");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");if(!this.getLayoutData()){this.setLayoutData(new r({growFactor:1,baseSize:"auto"}))}};gt.prototype._getVariantManagementControl=function(t){var e=null;if(t){if(typeof t==="string"){e=sap.ui.getCore().byId(t)}else{e=t}if(e){if(!(e instanceof d)){N.error("Control with the id="+typeof t.getId=="function"?t.getId():t+" not of expected type");return null}}}return e};gt.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseChartPersonalisation()||!this.getPersistencyKey()){return}var t=new _({type:"chart",keyName:"persistencyKey",dataSource:this.getEntitySet()});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new d(this.getId()+"-variant",{showShare:true})}if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this)}};gt.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};gt.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};gt.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};gt.prototype.setUseChartPersonalisation=function(t){this.setProperty("useChartPersonalisation",t,true);this._bUpdateToolbar=true;return this};gt.prototype.setUseTooltip=function(t){this.setProperty("useTooltip",t,true);this._createTooltipOrPopover();return this};gt.prototype._createTooltipOrPopover=function(){if(this.getUseTooltip()&&this.getShowChartTooltip()){this._toggleChartTooltipVisibility(true)}else{this._createPopover()}};gt.prototype._createPopover=function(){if(this._oChart){if(!nt&&!this._bVizPopoverRequested){nt=sap.ui.require("sap/viz/ui5/controls/Popover");if(!nt){sap.ui.require(["sap/viz/ui5/controls/Popover"],bt.bind(this));this._bVizPopoverRequested=true}}if(!this._oPopover&&nt&&!this._oChart._getVizFrame()._connectPopover){this._oPopover=new nt({})}if(this._oPopover){this._oPopover.connect(this._oChart.getVizUid())}}};function bt(t){nt=t;this._bVizPopoverRequested=false;if(!this._bIsBeingDestroyed){this._createPopover()}}gt.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};gt.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}this._bUpdateToolbar=true;return this};gt.prototype.setToolbar=function(t){if(this._oToolbar){this.removeItem(this._oToolbar)}this._oToolbar=t;this._bUpdateToolbar=true;this._oToolbar.setLayoutData(new r({shrinkFactor:0}));this.insertItem(this._oToolbar,0);this._oToolbar.setVisible(this.getShowToolbar());this._oToolbar.setStyle(this.getToolbarStyle());return this};gt.prototype.getToolbar=function(){return this._oToolbar};gt.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();return this};gt.prototype._refreshHeaderText=function(){if(!this._headerText){this._bUpdateToolbar=true;return}var t=this.getHeader();this._headerText.setText(t);if(this._oSeparator){if(t){this._oSeparator.setVisible(true)}else{this._oSeparator.setVisible(false)}}};gt.prototype._createToolbar=function(){if(!this._oToolbar){this._oToolbar=new o({design:Z.Transparent});this._oToolbar.addStyleClass("sapUiCompSmartChartToolbar");this._oToolbar.addStyleClass("sapMTBHeader-CTX");this._oToolbar.setLayoutData(new r({shrinkFactor:0}));this.insertItem(this._oToolbar,0);this._oToolbar.setVisible(this.getShowToolbar());this._oToolbar.setStyle(this.getToolbarStyle())}};gt.prototype._createToolbarContent=function(){this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addSemanticNavigationButton();this._addDetailsButton();this._addDrillUpDownButtons();this._addLegendButton();this._addZoomInOutButtons();this._addDownloadButton();this._addPersonalisationToToolbar();this._addFullScreenButton();this._addChartTypeToToolbar();if(this._oToolbar&&(this._oToolbar.getContent().length===0||this._oToolbar.getContent().length===1&&this._oToolbar.getContent()[0]instanceof l)){this.removeItem(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null}};gt.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t);if(this._oVariantManagement&&this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t)}return this};gt.prototype.setShowDetailsButton=function(t){this.setProperty("showDetailsButton",t);if(this._oSelectionDetails){this._oSelectionDetails.setVisible(t);if(this._oDrillDownTextButton){this._oDrillDownTextButton.setVisible(t)}this._setBehaviorTypeForDataSelection()}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(!t)}return this};gt.prototype.setShowChartTypeSelectionButton=function(t){this.setProperty("showChartTypeSelectionButton",t);if(this._oChartTypeButton){this._oChartTypeButton.setVisible(t)}return this};gt.prototype.setShowDownloadButton=function(t){this.setProperty("showDownloadButton",t);if(this._oDownloadButton){this._oDownloadButton.setVisible(t)}return this};gt.prototype.setShowDrillBreadcrumbs=function(t){this.setProperty("showDrillBreadcrumbs",t);if(this._oDrillBreadcrumbs){this._oDrillBreadcrumbs.setVisible(t)}if(this._oDrillUpButton){this._oDrillUpButton.setVisible(!t)}return this};gt.prototype.setShowChartTooltip=function(t){this.setProperty("showChartTooltip",t);this._toggleChartTooltipVisibility(t);return this};gt.prototype._setBehaviorTypeForDataSelection=function(){if(this.getShowDetailsButton()){this._oChart.setVizProperties({interaction:{behaviorType:"noHoverBehavior"}})}else if(this._oChart.getVizProperties().interaction.behaviorType){var t=this._oChart.getVizProperties().interaction;delete t.behaviorType;this._oChart.setVizProperties({interaction:t})}};gt.prototype._addDrillBreadcrumbs=function(){if(!this._oDrillBreadcrumbs&&this.getShowDrillBreadcrumbs()){if((!lt||!ut)&&!this._bBreadcrumbsRequested){lt=sap.ui.require("sap/m/Breadcrumbs");ut=sap.ui.require("sap/m/Link");if(!lt){sap.ui.require(["sap/m/Breadcrumbs","sap/m/Link"],Ct.bind(this));this._bBreadcrumbsRequested=true}}if(this._oChart&&lt&&ut){this._oDrillBreadcrumbs=new lt(this.getId()+"-drillBreadcrumbs",{visible:this.getShowDrillBreadcrumbs()}).addStyleClass("sapUiCompSmartChartBreadcrumbs");this.insertItem(this._oDrillBreadcrumbs,1);this._updateDrillBreadcrumbs();this._oChart.attachDrilledUp(function(t){this._updateDrillBreadcrumbs()}.bind(this));this._oChart.attachDrilledDown(function(t){this._updateDrillBreadcrumbs()}.bind(this))}}};function Ct(t,e){lt=t;ut=e;this._bBreadcrumbsRequested=false;if(!this._bIsBeingDestroyed){this._addDrillBreadcrumbs()}}gt.prototype.getDrillStackFilters=function(){var t=this._oChart.getDrillStack();var e=[];var i=function(t){if(!t){return}if(t&&t.sPath&&t.sOperator){e.push(t)}if(t.aFilters){t.aFilters.forEach(function(t){i(t)})}};t.forEach(function(t){i(t.filter)});return e};gt.prototype._getDrillStackDimensions=function(){var t=this._oChart.getDrillStack();var e=[];t.forEach(function(t){t.dimension.forEach(function(t){if(t!=null&&t!=""&&e.indexOf(t)==-1){e.push(t)}})});return e};gt.prototype._updateDrillBreadcrumbs=function(){if(!this._oDrillBreadcrumbs){return}var t=this._oChart.getDrillStack();var e=[];if(t){t.reverse();t.forEach(function(t,i,a){if(t.dimension.length>0&&typeof this._oChart.getDimensionByName(t.dimension[t.dimension.length-1])!="undefined"){if(this.getShowDrillBreadcrumbs()){this._oDrillBreadcrumbs.setVisible(true)}var r=this._oChart.getDimensionByName(t.dimension[t.dimension.length-1]).getLabel();if(i==0){this._oDrillBreadcrumbs.setCurrentLocationText(r)}else{var o=new ut({text:r,press:function(t){var e=this._oDrillBreadcrumbs.indexOfLink(t.getSource());this._oChart.drillUp(e+1);this._oChart.fireDeselectData(t);this._updateDrillBreadcrumbs()}.bind(this)});e.push(o)}}else{if(i==0){this._oDrillBreadcrumbs.setVisible(false)}}}.bind(this))}var i=this._oDrillBreadcrumbs.getLinks();e.reverse();var a=false;if(i.length!==e.length){a=true}else{for(var r=0;r<e.length;r++){if(e[r].getText()!=i[r].getText()){a=true;break}}}if(a){if(this._oDrillBreadcrumbs.getLinks()){this._oDrillBreadcrumbs.removeAllLinks()}for(var r=0;r<e.length;r++){this._oDrillBreadcrumbs.addLink(e[r])}}};gt.prototype._addDetailsButton=function(){this._oSelectionDetails=new D(this.getId()+"-selectionDetails",{visible:this.getShowDetailsButton(),customData:[new U({key:"sap-ui-custom-settings",value:{"sap.ui.dt":{designtime:"sap/ui/comp/designtime/smartchart/SmartChartDetails.designtime"}}})]});this._oSelectionDetails.registerSelectionDetailsItemFactory([],function(t,e,i,a){var r=[];var o=function(e){var e=t[s].value;if(e){return e instanceof Object?e:e.toString()}else{return e}};for(var s=0;s<t.length;s++){r.push(new V({label:t[s].label,value:o(t[s].value),unit:t[s].unit}))}return new B({enableNav:function(){if(this._determineSemanticObjectsforDetailsPopover(e,i).length>0){return true}else{return false}}.bind(this)(),lines:r}).setBindingContext(i)}.bind(this));this._oSelectionDetails.attachNavigate(function(t){if(t.getParameter("direction")==="back"){t.getParameter("content").destroy()}else{this._navigateToSemanticObjectDetails(t)}}.bind(this));this._oSelectionDetails.attachActionPress(function(t){var e=[];t.getParameter("items").forEach(function(t){e.push(t.getBindingContext())});this.fireSelectionDetailsActionPress({id:t.getParameter("id"),action:t.getParameter("action"),itemContexts:e,level:t.getParameter("level")})}.bind(this));this._oSelectionDetails.attachBeforeOpen(function(t){var e=this._oSelectionDetails.getItems();e.forEach(function(t){var e=this._getDetailsActionsClones();e.selectionDetailsItemActions.forEach(function(e){t.addAction(e)})}.bind(this));var i=this._getDetailsActionsClones().selectionDetailsActions;this._oSelectionDetails.removeAllActions();i.forEach(function(t){this._oSelectionDetails.addAction(t)}.bind(this));var a=this._getDetailsActionsClones().selectionDetailsActionGroups;this._oSelectionDetails.removeAllActionGroups();a.forEach(function(t){this._oSelectionDetails.addActionGroup(t)}.bind(this))}.bind(this));this._oSelectionDetails.attachBeforeClose(function(t){if(this._oNavigationContainer){this._oNavigationContainer.destroy()}}.bind(this));this._oToolbar.addContent(this._oSelectionDetails);this._addDrillDownTextButton()};gt.prototype._getDetailsActionsClones=function(){var t={selectionDetailsItemActions:[],selectionDetailsActions:[],selectionDetailsActionGroups:[]};this.getSelectionDetailsItemActions().forEach(function(e){t.selectionDetailsItemActions.push(e.clone())});this.getSelectionDetailsActions().forEach(function(e){t.selectionDetailsActions.push(e.clone())});this.getSelectionDetailsActionGroups().forEach(function(e){t.selectionDetailsActionGroups.push(e.clone())});return t};gt.prototype._addDownloadButton=function(){if(!this._oDownloadButton){this._oDownloadButton=new s(this.getId()+"btnDownload",{type:"Transparent",text:this._oRb.getText("CHART_DOWNLOADBTN_TEXT"),tooltip:this._oRb.getText("CHART_DOWNLOADBTN_TOOLTIP"),icon:"sap-icon://download",visible:this.getShowDownloadButton(),enabled:false,press:function(t){if(window.navigator&&window.navigator.msSaveOrOpenBlob){var e=new window.Blob([this._getVizFrame().exportToSVGString()],{type:"image/svg+xml"});window.navigator.msSaveOrOpenBlob(e)}else{this._downloadChartPNG()}}.bind(this)});this._oToolbar.addContent(this._oDownloadButton)}};gt.prototype._downloadChartSVG=function(){var t=this.getHeader();var e=document.createElement("a");e.setAttribute("href","data:image/svg+xml,"+encodeURIComponent(this._getVizFrame().exportToSVGString()));e.setAttribute("download",t?t:"Chart"+".svg");e.click()};gt.prototype._downloadChartPNG=function(){var t=this.getHeader();var e=this._getVizFrame().exportToSVGString();var i=document.createElement("canvas");var a=i.getContext("2d");var r=new Image;r.width=i.width=document.getElementById(this._oChart.getId()).offsetWidth;r.height=i.height=document.getElementById(this._oChart.getId()).offsetHeight;r.onload=function(){a.drawImage(r,0,0);var e=document.createElement("a");e.setAttribute("href",i.toDataURL());e.setAttribute("download",t?t:"Chart"+".png");e.click()};r.setAttribute("crossOrigin","anonymous");r.src="data:image/svg+xml,"+encodeURIComponent(e)};gt.prototype._addFullScreenButton=function(){var t;if(this.getShowFullScreenButton()){t=new s(this.getId()+"-btnFullScreen",{type:"Transparent",press:function(){this._toggleFullScreen(!this.bFullScreen)}.bind(this),enabled:false});this.oFullScreenButton=t;this._renderFullScreenButton();this._oToolbar.addContent(t)}};gt.prototype._addZoomInOutButtons=function(){var t=this;this._oZoomInButton=new s(this.getId()+"-btnZoomIn",{type:"Transparent",text:this._oRb.getText("CHART_ZOOMINBTN_TEXT"),tooltip:this._oRb.getText("CHART_ZOOMINBTN_TOOLTIP"),icon:"sap-icon://zoom-in",press:function(){if(t._oChart){t._oChart.zoom({direction:"in"});this._oZoomInPressed=true;this._toggleZoomButtonEnablement()}}.bind(this),visible:this.getShowZoomButtons(),enabled:false});this._oZoomOutButton=new s(this.getId()+"-btnZoomOut",{type:"Transparent",text:this._oRb.getText("CHART_ZOOMOUTBTN_TEXT"),tooltip:this._oRb.getText("CHART_ZOOMOUTBTN_TOOLTIP"),icon:"sap-icon://zoom-out",press:function(){if(t._oChart){t._oChart.zoom({direction:"out"});this._oZoomOutPressed=true;this._toggleZoomButtonEnablement()}}.bind(this),visible:this.getShowZoomButtons(),enabled:false});this._oToolbar.addContent(this._oZoomInButton);this._oToolbar.addContent(this._oZoomOutButton)};gt.prototype._toggleZoomButtonEnablement=function(){var t=this._oChart.getZoomInfo().currentZoomLevel;if(t===undefined){return}else if(t===null){this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(false)}else if(t===0){if(this._oZoomInPressed){this._oZoomInButton.focus();this._oZoomInPressed=false}this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(true)}else if(t===1){if(this._oZoomOutPressed){this._oZoomOutButton.focus();this._oZoomOutPressed=false}this._oZoomInButton.setEnabled(false);this._oZoomOutButton.setEnabled(true)}else{if(this._oZoomOutButton.getEnabled()==false){this._oZoomOutButton.setEnabled(true)}if(this._oZoomInButton.getEnabled()==false){this._oZoomInButton.setEnabled(true)}}};gt.prototype.setShowZoomButtons=function(t){this.setProperty("showZoomButtons",t);if(this._oZoomInButton){this._oZoomInButton.setVisible(t)}if(this._oZoomOutButton){this._oZoomOutButton.setVisible(t)}return this};gt.prototype.setShowFullScreenButton=function(t){this.setProperty("showFullScreenButton",t);if(this.oFullScreenButton){this.oFullScreenButton.setVisible(t)}return this};gt.prototype.setLegendVisible=function(t){this.setProperty("legendVisible",t);this._setLegendVisible(t);return this};gt.prototype._setLegendVisible=function(t){var e=this._getVizFrame();if(e){e.setLegendVisible(t)}};gt.prototype._getVizFrame=function(){var t=null;if(this._oChart){t=this._oChart.getAggregation("_vizFrame")}return t};gt.prototype._addLegendButton=function(){var t=this;this._oLegendButton=new n(this.getId()+"-btnLegend",{type:"Transparent",text:this._oRb.getText("CHART_LEGENDBTN_TEXT"),tooltip:this._oRb.getText("CHART_LEGENDBTN_TOOLTIP"),icon:"sap-icon://legend",press:function(){t.setLegendVisible(!t.getLegendVisible());this.setPressed(t.getLegendVisible())},pressed:this.getLegendVisible(),visible:this.getShowLegendButton(),enabled:false});this._oToolbar.addContent(this._oLegendButton)};gt.prototype.setShowLegendButton=function(t){this.setProperty("showLegendButton",t);if(this._oLegendButton){this._oLegendButton.setVisible(t)}return this};gt.prototype.setShowSemanticNavigationButton=function(t){this.setProperty("showSemanticNavigationButton",t);if(this._oSemanticalNavButton){this._oSemanticalNavButton.setVisible(t)}else{if(t){this._addSemanticNavigationButton()}}return this};gt.prototype._addSemanticNavigationButton=function(){var t=this;if(!this._oSemanticalNavButton&&this.getShowSemanticNavigationButton()&&this._oToolbar){this._oSemanticalNavButton=new i(this.getId()+"-btnNavigation",{type:"Transparent",text:this._oRb.getText("CHART_SEMNAVBTN"),tooltip:this._oRb.getText("CHART_SEMNAVBTN_TOOLTIP"),visible:this.getShowSemanticNavigationButton(),enabled:false});this._oNavHandler=new I({control:this._oSemanticalNavButton,navigationTargetsObtained:function(t){var e=t.getParameters().mainNavigation;if(e){var i=t.getSource().getBindingContext().getObject();var a=this._getField(t.getSource().getFieldName());var r=w.getTextsFromDisplayBehaviour(a.displayBehaviour,i[a.name],i[a.description]);e.setDescription(r.secondText);t.getParameters().show(r.firstText,e,undefined,undefined)}t.getParameters().show()}.bind(this)});var e=this.getSemanticObjectController();if(e){this._oNavHandler.setSemanticObjectController(e)}this._oSemanticalNavButton.attachPress(function(e){if(this._aSemanticObjects&&this._aSemanticObjects.length>0){if(this._aSemanticObjects.length===1){var i=T.getSemanticObjectsFromProperty(this._aSemanticObjects[0]);if(i){this._oNavHandler.setFieldName(this._aSemanticObjects[0].name);this._oNavHandler.setSemanticObject(i.defaultSemanticObject);this._oNavHandler.setAdditionalSemanticObjects(i.additionalSemanticObjects);this._oNavHandler.openPopover()}}else{t._semanticObjectList(this._aSemanticObjects,this._oNavHandler)}}}.bind(this));if(this._oChart){this._attachDataPointHandling()}else{this.attachInitialized(function(){this._attachDataPointHandling()}.bind(this))}var a=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(this._oSemanticalNavButton,a+1)}};gt.prototype._attachDataPointHandling=function(){if(this._oChart){this._oChart.attachDeselectData(function(){this._aSemanticObjects=this._setSelectionDataPointHandling(this._oNavHandler)}.bind(this));this._oChart.attachSelectData(function(){this._aSemanticObjects=this._setSelectionDataPointHandling(this._oNavHandler)}.bind(this))}};gt.prototype.setSelectionMode=function(t){this.setProperty("selectionMode",t);if(this._oChart){this._oChart.setSelectionMode(t)}return this};gt.prototype._setSelectionDataPointHandling=function(t){var e=this._setSelectionDataPoint(t);if(e&&e.length>0){this._oSemanticalNavButton.setEnabled(true)}else{this._oSemanticalNavButton.setEnabled(false)}return e};gt.prototype._setSemanticObjectsContext=function(t){var e,i,a=null;e=t.getParameter("item").getBindingContext();if(e){i=e.getObject();if(i){a=this._determineSemanticObjectsforDetailsPopover(i,e)}}return a};gt.prototype._setSelectionDataPoint=function(t){var e,i,a=null,r;var o=this._oChart.getSelectedDataPoints();if(!o||!o.dataPoints||o.dataPoints.length===0){return a}if(o.dataPoints.length===1){e=o.dataPoints[0].context;if(e){i=e.getObject();if(i){a=this._determineSemanticObjects(i,e);if(a&&a.length>0){t.setBindingContext(e)}}}return a}r=[];for(var s=0;s<o.dataPoints.length;s++){e=o.dataPoints[s].context;if(e){i=e.getObject();if(i){r.push(i)}}}if(r&&r.length>0){a=this._condensBasedOnSameValue(r);if(a&&a.length>0){t.setBindingContext(o.dataPoints[o.dataPoints.length-1].context)}}return a};gt.prototype._condensBasedOnSameValue=function(t){var e=null,i,a,r;e=this._determineSemanticObjects(t[0]);if(e&&e.length>0){for(var o=0;o<e.length;o++){a=e[o];r=a.name;if(this._bAllValuesAreEqual(t,r)){if(!i){i=[]}i.push(a)}}e=i}return e};gt.prototype._bAllValuesAreEqual=function(t,e){var i,a;for(var r=0;r<t.length;r++){i=t[r];if(r===0){a=i[e];continue}if(a!=i[e]){return false}}return true};gt.prototype._semanticObjectList=function(t,e){var i,a,r,o;if(this._oChart){if((!ct||!pt||!dt)&&!this._bSemanticObjectListRequested){ct=sap.ui.require("sap/m/ResponsivePopover");pt=sap.ui.require("sap/m/List");dt=sap.ui.require("sap/m/StandardListItem");if(!ct||!pt||!dt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/StandardListItem"],yt.bind(this));this._bSemanticObjectListRequested=true;this._oSemanticObjectListAttr={object:t,nav:e}}}if(!ct||!pt||!dt){return}a=new pt({mode:K.SingleSelectMaster,selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var a=t.mParameters.listItem.data("semObj");if(a){e.setFieldName(t.mParameters.listItem.data("fieldName"));e.setSemanticObject(a.defaultSemanticObject);e.setAdditionalSemanticObjects(a.additionalSemanticObjects);e.openPopover()}}i.close()}});for(var s=0;s<t.length;s++){o=t[s];r=new dt({title:o.fieldLabel,type:G.Active});r.data("semObj",T.getSemanticObjectsFromProperty(o));r.data("fieldName",o.name);a.addItem(r)}i=new ct({title:this._oRb.getText("CHART_SEMNAVBTN"),showHeader:false,contentWidth:"12rem",placement:W.Left});i.addContent(a);i.openBy(this._oSemanticalNavButton)}};function yt(t,e,i){ct=t;pt=e;dt=i;this._bSemanticObjectListRequested=false;if(!this._bIsBeingDestroyed){this._semanticObjectList(this._oSemanticObjectListAttr.object,this._oSemanticObjectListAttr.nav)}delete this._oSemanticObjectListAttr}gt.prototype._semanticObjectListForDetails=function(t,e){var i,a,r;if(!this._oChart){return undefined}i=new pt({mode:K.SingleSelectMaster,rememberSelections:false,itemPress:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var i=t.mParameters.listItem.data("semObj");if(i){var a=new I({fieldName:t.mParameters.listItem.data("fieldName"),control:t.mParameters.listItem,semanticObject:i.defaultSemanticObject,additionalSemanticObjects:i.additionalSemanticObjects,navigationTargetsObtained:function(t){var i=t.getParameters().mainNavigation;if(i){var a=e.getObject();var r=this._getField(t.getSource().getFieldName());var o=w.getTextsFromDisplayBehaviour(r.displayBehaviour,a[r.name],a[r.description]);i.setDescription(o.secondText);t.getParameters().show(o.firstText,i,undefined,undefined)}t.getParameters().show()}.bind(this)});a._getNavigationContainer().then(function(t){this._oNavigationContainer=t;var e=t.getDirectLink();if(e){a._fireInnerNavigate({text:e.getText(),href:e.getHref()});window.location.href=e.getHref();t.destroy();return}t.attachBeforePopoverOpen(function(){this._oSelectionDetails.setPopoverModal(true)}.bind(this));t.attachAfterPopoverClose(function(){this._oSelectionDetails.setPopoverModal(false)}.bind(this));this._oSelectionDetails.navTo("",t)}.bind(this),function(t){N.error("NavigationContainer could not be determined: "+t)})}}}.bind(this)});R.getDistinctSemanticObjects().then(function(o){for(var s=0;s<t.length;s++){r=t[s];if(r["com.sap.vocabularies.Common.v1.SemanticObject"]&&r["com.sap.vocabularies.Common.v1.SemanticObject"].String&&R.hasDistinctSemanticObject([r["com.sap.vocabularies.Common.v1.SemanticObject"].String],o)){a=new dt({title:r.fieldLabel,type:G.Navigation});a.setBindingContext(e);a.data("semObj",T.getSemanticObjectsFromProperty(r));a.data("fieldName",r.name);i.addItem(a)}}});return i};gt.prototype._determineSemanticObjects=function(t,e){var i,a,r=[];if(t){for(i in t){if(i){a=this._getField(i);if(a&&a.isDimension&&a.isSemanticObject){r.push(a)}}}}if(r){r.sort(function(t,e){return t.fieldLabel.localeCompare(e.fieldLabel)})}return r};gt.prototype._determineSemanticObjectsforDetailsPopover=function(t,e){var i,a,r=[];if(t){for(i in t){if(i){a=this._getField(i);if(a&&a.isDimension&&a.isSemanticObject){r.push(a)}}}}if(r){r.sort(function(t,e){return t.fieldLabel.localeCompare(e.fieldLabel)})}return r};gt.prototype._addDrillUpDownButtons=function(){if(this.getShowDrillButtons()){var t=this;this._oDrillUpButton=new s(this.getId()+"-btnDrillUp",{type:"Transparent",tooltip:this._oRb.getText("CHART_DRILLUPBTN_TOOLTIP"),text:this._oRb.getText("CHART_DRILLUPBTN_TEXT"),icon:"sap-icon://drill-up",press:function(){if(t._oChart){t._oChart.drillUp()}},visible:!this.getShowDrillBreadcrumbs(),enabled:false});this._oDrillDownButton=new s(this.getId()+"-btnDrillDown",{type:"Transparent",text:this._oRb.getText("CHART_DRILLDOWNBTN_TEXT"),icon:"sap-icon://drill-down",press:function(e){t._drillDown(e)},visible:!this.getShowDetailsButton(),enabled:false,ariaHasPopup:k.ListBox});this._oToolbar.addContent(this._oDrillUpButton);this._oToolbar.addContent(this._oDrillDownButton)}};gt.prototype._addDrillDownTextButton=function(){this._oDrillDownTextButton=new i(this.getId()+"-btnDrillDownText",{type:"Transparent",text:this._oRb.getText("CHART_DRILLDOWNBTN_TEXT"),tooltip:this._oRb.getText("CHART_DRILLDOWNBTN_TOOLTIP"),enabled:false,visible:this.getShowDetailsButton(),layoutData:new O({closeOverflowOnInteraction:false}),press:function(t){this._drillDown(t)}.bind(this)});this._oToolbar.addContent(this._oDrillDownTextButton)};gt.prototype.setShowDrillButtons=function(t){this.setProperty("showDrillButtons",t);if(this._oDrillUpButton){this._oDrillUpButton.setVisible(t)}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(t)}return this};gt.prototype._triggerSearchInPopover=function(t,e){var i,a,r,o,s,n;if(!t||!e){return}i=t.getParameters();if(!i){return}s=i.newValue?i.newValue.toLowerCase():"";if(this._oChart){n=e.getItems();for(a=0;a<n.length;a++){o=n[a].getTooltip();r=n[a].getTitle();if(r&&r.toLowerCase().indexOf(s)>-1||o&&o.toLowerCase().indexOf(s)>-1){n[a].setVisible(true)}else{n[a].setVisible(false)}}}};gt.prototype._drillDown=function(t,e){var i=this,a,r,o,s,n,h,l,u,c,p,d;if(this._oChart){if((!ct||!pt||!_t||!ft||!dt)&&!this._bDrillDownRequested){ct=sap.ui.require("sap/m/ResponsivePopover");pt=sap.ui.require("sap/m/List");_t=sap.ui.require("sap/m/Bar");ft=sap.ui.require("sap/m/SearchField");dt=sap.ui.require("sap/m/StandardListItem");if(!ct||!pt||!_t||!ft||!dt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/Bar","sap/m/SearchField","sap/m/StandardListItem"],vt.bind(this));this._bDrillDownRequested=true;this._oDrillDownSource=t.getSource()}}if(!ct||!pt||!_t||!ft||!dt){return}h=new pt({mode:K.SingleSelectMaster,selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){if(t.mParameters.listItem.getType()===G.Inactive){return}var e=t.mParameters.listItem.data("dim");if(e){i._oChart.drillDown(e)}}a.close()}});l=new _t;u=new ft({placeholder:this._oRb.getText("CHART_DRILLDOWN_SEARCH")});var _=new M({text:this._oRb.getText("CHART_DRILLDOWN_SEARCH")});u.addAriaLabelledBy(_.getId());u.attachLiveChange(function(t){i._triggerSearchInPopover(t,h)});l.addContentMiddle(_);l.addContentMiddle(u);a=new ct({contentWidth:"25rem",contentHeight:"20rem",placement:W.Bottom,subHeader:l});a.addStyleClass("sapUiCompSmartChartDrillDownPopover");if(y.system.desktop){var _=new M({text:this._oRb.getText("CHART_DRILLDOWN_TITLE")});a.setShowHeader(false);a.addContent(_);a.addAriaLabelledBy(_);if(a.getSubHeader()&&a.getSubHeader().getVisible()&&u.getVisible()&&u.getEnabled()){d=new M({text:this._oRb.getText("CHART_DRILLDOWN_SEARCH_AVAILABLE")});a.addContent(d);a.addAriaLabelledBy(d)}}else{a.setTitle(this._oRb.getText("CHART_DRILLDOWN_TITLE"))}a.addContent(h);r=this._getDrillStackDimensions();o=this._getSortedDimensions();if(o.length<7){l.setVisible(false);d.destroy()}for(c=0;c<o.length;c++){s=o[c];if(r.indexOf(s.getName())>-1){continue}p=this._oChartProvider.getViewField(s.getName());if(!p.filterable&&this._oChart.getSelectedDataPoints().count>0){continue}n=new dt({title:s.getLabel(),type:G.Active});n.data("dim",s);h.addItem(n)}a.openBy(t?t.getSource():e)}};function vt(t,e,i,a,r){ct=t;pt=e;_t=i;ft=a;dt=r;this._bDrillDownRequested=false;if(!this._bIsBeingDestroyed){this._drillDown(null,this._oDrillDownSource)}delete this._oDrillDownSource}gt.prototype._navigateToSemanticObjectDetails=function(t){var e=this._setSemanticObjectsContext(t);if(e&&e.length>0){if(e.length===1){var i=T.getSemanticObjectsFromProperty(e[0]);if(i){var a=t.getParameter("item");var r=new I({fieldName:e[0].name,control:a,semanticObject:i.defaultSemanticObject,additionalSemanticObjects:i.additionalSemanticObjects,navigationTargetsObtained:function(t){var e=t.getParameters().mainNavigation;if(e){var i=a.getBindingContext().getObject();var r=this._getField(t.getSource().getFieldName());var o=w.getTextsFromDisplayBehaviour(r.displayBehaviour,i[r.name],i[r.description]);e.setDescription(o.secondText);t.getParameters().show(o.firstText,e,undefined,undefined)}t.getParameters().show()}.bind(this)});r._getNavigationContainer().then(function(t){this._oNavigationContainer=t;this._oNavigationContainer.attachBeforePopoverOpen(function(){this._oSelectionDetails.setPopoverModal(true)}.bind(this));this._oNavigationContainer.attachAfterPopoverClose(function(){this._oSelectionDetails.setPopoverModal(false)}.bind(this));this._oSelectionDetails.navTo("",this._oNavigationContainer)}.bind(this),function(t){N.error("NavigationContainer could not be determined")})}}else{var o=t.getParameter("item").getBindingContext();if((!pt||!dt)&&!this._bObjectListRequested){pt=sap.ui.require("sap/m/List");dt=sap.ui.require("sap/m/StandardListItem");if(!pt||!dt){sap.ui.require(["sap/m/List","sap/m/StandardListItem"],Tt.bind(this));this._bObjectListRequested=true;this._oObjectListAttr={context:o,objects:e}}}if(pt&&dt){var s=this._semanticObjectListForDetails(e,o);this._oSelectionDetails.navTo(this._oRb.getText("CHART_SEMNAVBTN"),s)}}}};function Tt(t,e){pt=t;dt=e;this._bObjectListRequested=false;if(!this._bIsBeingDestroyed){var i=this._semanticObjectListForDetails(this._oObjectListAttr.objects,this._oObjectListAttr.context);this._oSelectionDetails.navTo(this._oRb.getText("CHART_SEMNAVBTN"),i)}delete this._oObjectListAttr}gt.prototype._addHeaderToToolbar=function(){if(this._oToolbar){if(!this._headerText){this._headerText=new P({});this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartChartHeader")}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)}};gt.prototype._addSeparatorToToolbar=function(){if(this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oSeparator=new h;this._oToolbar.insertContent(this._oSeparator,0);if(!this._oToolbar.getHeight()){this._oToolbar.setHeight("auto")}}else if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}};gt.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0)}else if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement)}}};gt.prototype._addSpacerToToolbar=function(){if(this._indexOfSpacerOnToolbar()===-1){this._oToolbar.addContent(new l)}};gt.prototype._indexOfSpacerOnToolbar=function(){var t=this._oToolbar.getContent(),e,i;if(t){i=t.length;e=0;for(e;e<i;e++){if(t[e]instanceof l){return e}}}return-1};gt.prototype._getP13NSettings=function(){return{dimeasure:{visible:true,payload:{availableChartTypes:this.getAvailableChartTypes()}},sort:{visible:true},filter:{visible:true},contentWidth:"48rem"}};gt.prototype._addPersonalisationToToolbar=function(){if(this.getUseChartPersonalisation()){if(!this._oChartPersonalisationButton){this._oChartPersonalisationButton=new s(this.getId()+"-btnPersonalisation",{type:"Transparent",icon:"sap-icon://action-settings",text:this._oRb.getText("CHART_PERSOBTN_TEXT"),tooltip:this._oRb.getText("CHART_PERSOBTN_TOOLTIP"),press:function(t){if(this._oPersController){this._oPersController.openDialog(this._getP13NSettings())}}.bind(this),enabled:false})}this._oToolbar.addContent(this._oChartPersonalisationButton)}else if(this._oChartPersonalisationButton){this._oToolbar.removeContent(this._oChartPersonalisationButton)}};gt.prototype.getVariantManagement=function(){return this._oVariantManagement};gt.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;var i=this._getP13NSettings();i.styleClass=t;i.showReset=false;this._oPersController.openDialog(i)};gt.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};gt.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};gt.prototype._addChartTypeToToolbar=function(){this._oChartTypeButton=this._createChartTypeButton();this._oToolbar.addContent(this._oChartTypeButton)};gt.prototype._createChartTypeButton=function(){var t=new s(this.getId()+"-btnChartType",{visible:this.getShowChartTypeSelectionButton(),enabled:false,type:"Transparent",text:this._oRb.getText("CHART_TYPEBTN_TEXT"),ariaHasPopup:k.ListBox,layoutData:new O({closeOverflowOnInteraction:false}),press:function(t){this._displayChartTypes(t)}.bind(this)});return t};gt.prototype._displayChartTypes=function(t,e){var i=this,a,r,o,s,n=false;if(this._bAvailableChartListIsOpen){return}if(this._oChart&&(t||e)){if((!ct||!pt||!_t||!ft||!dt)&&!this._bChartTypesRequested){ct=sap.ui.require("sap/m/ResponsivePopover");pt=sap.ui.require("sap/m/List");_t=sap.ui.require("sap/m/Bar");ft=sap.ui.require("sap/m/SearchField");dt=sap.ui.require("sap/m/StandardListItem");if(!ct||!pt||!_t||!ft||!dt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/Bar","sap/m/SearchField","sap/m/StandardListItem"],St.bind(this));this._bChartTypesRequested=true;this._oChartTypesSource=t.getSource()}}if(!ct||!pt||!_t||!ft||!dt){return}var h=t?t.getSource():e;var l=new dt({title:"{$smartChartTypes>text}",icon:"{$smartChartTypes>icon}",selected:"{$smartChartTypes>selected}"});r=new pt({mode:K.SingleSelectMaster,items:{path:"$smartChartTypes>/items",template:l},selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var e=t.mParameters.listItem.getBinding("title");if(e){var r=e.getContext();if(r){var o=r.getObject();if(o&&o.key){i._setChartType(o.key);i._enrichPassedButton(i._oChartTypeButton,i._oChart.getChartType())}}}}n=true;i._rerenderControlInFullscreen();a.close()}});o=new _t;s=new ft({placeholder:this._oRb.getText("CHART_TYPE_SEARCH")});s.attachLiveChange(function(t){i._triggerSearchInPopover(t,r)});o.addContentRight(s);a=new ct({placement:W.Bottom,subHeader:o,contentWidth:"25rem"});a.addStyleClass("sapUiCompSmartChartTypePopover");a.attachAfterClose(function(t){if(!n){}i._bAvailableChartListIsOpen=false});a.setModel(this.getModel("$smartChartTypes"),"$smartChartTypes");if(y.system.desktop){var u=new M({text:this._oRb.getText("CHART_TYPELIST_TEXT")});a.setShowHeader(false);a.addContent(u);a.addAriaLabelledBy(u)}else{a.setTitle(this._oRb.getText("CHART_TYPELIST_TEXT"))}a.addContent(r);if(r.getItems().length<7){o.setVisible(false)}this._bAvailableChartListIsOpen=true;a.openBy(h)}};function St(t,e,i,a,r){ct=t;pt=e;_t=i;ft=a;dt=r;this._bChartTypesRequested=false;if(!this._bIsBeingDestroyed){this._displayChartTypes(null,this._oChartTypesSource)}delete this._oChartTypesSource}var Dt={bar:"sap-icon://horizontal-bar-chart",bullet:"sap-icon://horizontal-bullet-chart",bubble:"sap-icon://bubble-chart",column:"sap-icon://vertical-bar-chart",combination:"sap-icon://business-objects-experience",dual_bar:"sap-icon://horizontal-bar-chart",dual_column:"sap-icon://vertical-bar-chart",dual_combination:"sap-icon://business-objects-experience",dual_horizontal_combination:"sap-icon://business-objects-experience",dual_horizontal_stacked_combination:"sap-icon://business-objects-experience",dual_line:"sap-icon://line-chart",dual_stacked_bar:"sap-icon://full-stacked-chart",dual_stacked_column:"sap-icon://vertical-stacked-chart",dual_stacked_combination:"sap-icon://business-objects-experience",donut:"sap-icon://donut-chart",heatmap:"sap-icon://heatmap-chart",horizontal_stacked_combination:"sap-icon://business-objects-experience",line:"sap-icon://line-chart",pie:"sap-icon://pie-chart",scatter:"sap-icon://scatter-chart",stacked_bar:"sap-icon://full-stacked-chart",stacked_column:"sap-icon://vertical-stacked-chart",stacked_combination:"sap-icon://business-objects-experience",treemap:"sap-icon://Chart-Tree-Map",vertical_bullet:"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart",waterfall:"sap-icon://vertical-waterfall-chart",horizontal_waterfall:"sap-icon://horizontal-waterfall-chart"};gt.prototype._rerenderControlInFullscreen=function(){if(this.bFullScreen){this._oChart.setLayoutData(new r({baseSize:"100%"}));this.invalidate(this._oChart)}};gt.prototype._getMatchingIcon=function(t){var e=Dt[t];if(!e){e=""}return e};gt.prototype._enrichPassedButton=function(t,e,i){if(!t){return}if(i===undefined){i=e;var a=this._retrieveChartTypeDescription(e);if(a&&a.text){i=a.text}}t.data("chartType",e);var r=this._getMatchingIcon(e);t.setIcon(r?r:"sap-icon://vertical-bar-chart");var o=this._oChart.getChartType()===e?"CHART_TYPE_TOOLTIP":"CHART_TYPE_UNSEL_TOOLTIP";t.setTooltip(this._oRb.getText(o,[i]))};gt.prototype._updateAvailableChartType=function(){var t=this,e,i,a=[];e=this.getModel("$smartChartTypes");if(!e){return}i={items:a};var r=this._oChart.getChartType();this.getAvailableChartTypes().forEach(function(e){var i={key:e.key,text:e.text,icon:t._getMatchingIcon(e.key),selected:r===e.key};a.push(i)});e.setData(i);if(this._oSegmentedButton){this._updateVisibilityOfChartTypes(this._oSegmentedButton)}this._updateVizTooltipFormatter()};gt.prototype._createPersonalizationController=function(){if(this._oPersController){return}var t=this.data("p13nDialogSettings");if(typeof t==="string"){try{t=JSON.parse(t)}catch(e){t=null}}t=this._setIgnoreFromPersonalisationToSettings(t);t=t||{};var e=F.createChartWrapper(this._oChart,this._oChart.data("p13nData"),this._aColumnKeysOrdered);if(this.$()&&this.$().closest(".sapUiSizeCompact").length>0){this._oChart.addStyleClass("sapUiSizeCompact")}var i=this._oChart.setVisibleMeasures;var a=function(t,e){this.setProperty("visibleMeasures",t,e);var i=this._getDrillStateTop();if(!this._bIsInitialized){this._createDrillStack()}else{i.measures=this.getProperty("visibleMeasures")}if(!e){this._invalidateBy({source:this,keys:{binding:true,dataSet:true,vizFrame:true}})}return this}.bind(this._oChart);this._oPersController=new L(this.getId()+"-persoController",{table:e,setting:t,resetToInitialTableState:!this.getUseVariantManagement(),afterP13nModelDataChange:this._personalisationModelDataChange.bind(this),beforePotentialTableChange:function(t){this._oChart.setVisibleMeasures=a}.bind(this),afterPotentialTableChange:function(t){this._oChart.setVisibleMeasures=i}.bind(this)});this._oPersController.attachDialogConfirmedReset(function(){if(this._oDrillBreadcrumbs){this._updateDrillBreadcrumbs()}var t=sap.ui.getCore().byId(this.getId()+"-btnChartType");if(t){this._enrichPassedButton(t,this._oChart.getChartType())}}.bind(this));this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}}.bind(this))};gt.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=C.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("dimeasure");i("filter");i("sort")}return t};gt.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i===X.Unchanged){return}this._fireChartDataChanged(e);if(!this._bApplyingVariant){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}this._updateAvailableChartType();this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType());this._checkDimensionColoring();if(!this._bDisableTimeseriesUTC&&!this._oChart.getVizProperties().general.showAsUTC){try{if(!this._oChart.getVizProperties().general.showAsUTC){this._oChart.setVizProperties({general:{showAsUTC:true}})}if(this._bWorkaroundVizFormatter){this._oChart.setVizProperties({timeAxis:{levelConfig:{day:{visible:true,formatString:"MediumDay"},month:{visible:true,formatString:"MediumMonth"}}}})}}catch(t){N.error("Couldn't set showAsUTC=true")}}if(i===X.TableChanged){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false)}}else if(i===X.ModelChanged&&this._bIsChartBound){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindChart()}}if(this._oDrillBreadcrumbs){this._updateDrillBreadcrumbs()}this.fireUiStateChange()};gt.prototype._fireChartDataChanged=function(t){var e={dimeasure:false,filter:false,sort:false};for(var i in t){if(t[i]!=="Unchanged"){e[i]=true}}this.fireChartDataChanged({changeTypes:e})};gt.prototype._getChangeStatus=function(t){if(!t){return X.ModelChanged}if(t.sort===X.ModelChanged||t.filter===X.ModelChanged||t.dimeasure===X.ModelChanged||t.group===X.ModelChanged){return X.ModelChanged}if(t.sort===X.TableChanged||t.filter===X.TableChanged||t.dimeasure===X.TableChanged||t.group===X.TableChanged){return X.TableChanged}return X.Unchanged};gt.prototype.setEntitySet=function(t){this.setProperty("entitySet",t);this._initialiseMetadata();return this};gt.prototype.propagateProperties=function(){u.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata()};gt.prototype._initialiseMetadata=function(){if(!this._bMetadataIsInitialised){v.handleModelInit(this,this._onMetadataInitialised,true)}};gt.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this._bMetadataIsInitialised){this._listenToSmartFilter();this._createToolbar();this._createVariantManagementControl();this._createToolbarContent();this._bMetadataIsInitialised=true;if(mt){this._initialiseInnerChart()}if(x.getActive()){x.end("SmartChartInit")}if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}}};gt.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindChart()}}else if(!this._oChart){this._createTempNoData()}}};gt.prototype._createTempNoData=function(){var t=new a({text:this.getNoData()});this._oNoDataStruct=new u({items:[t],justifyContent:"Center",alignItems:"Center",height:"100%"});this.insertItem(this._oNoDataStruct,2)};gt.prototype._createChartProvider=function(){var t,e;e=this.getEntitySet();t=this.getModel();if(t&&!this._bChartCreated){this._aAlwaysSelect=[];this._aInitialSorters=[];this._addDrillBreadcrumbs();this._bChartCreated=true}if(t&&e){this._oChartProvider=new c({entitySet:e,ignoredFields:this.getIgnoredFields(),dateFormatSettings:this.data("dateFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDimensionDisplayBehaviour"),skipAnnotationParse:this.data("skipAnnotationParse"),chartQualifier:this.data("chartQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),model:t,chartLibrary:Y,useTimeSeries:this.getActivateTimeSeries(),notAssignedText:this.getNotAssignedText()})}};gt.prototype._listenToSmartFilter=function(){this._fetchSmartFilter();if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindChart,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this)}};gt.prototype.setNoData=function(t){if(this._oChart){this._oChart.setCustomMessages({NO_DATA:t})}this.setProperty("noData",t);return this};gt.prototype.getNoData=function(){var t=this.getProperty("noData");if(!this.getProperty("noData")){if(!this._oChart){this._fetchSmartFilter();if(this._oSmartFilter){t=this._oRb.getText("CHART_NO_DATA")}else{t=this._oRb.getText("CHART_NO_DATA_WITHOUT_FILTERBAR")}}else{t=this._oRb.getText("CHART_NO_RESULTS")}}return t};gt.prototype._fetchSmartFilter=function(){var t=null;t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t)};gt.prototype._filterChangeEvent=function(){if(this._bIsChartBound&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};gt.prototype._adjustOverlayHeight=function(){if(y.browser.safari||y.browser.chrome){var t=this._oChart.$(),e=t.find(".sapUiCompSmartChartOverlay");if(e.length===1){e.height(t.height())}}};gt.prototype._renderOverlay=function(t){if(this._oChart){var e=this._oChart.$(),i=e.find(".sapUiCompSmartChartOverlay");if(t&&i.length===0){i=jQuery("<div>").addClass("sapUiOverlay sapUiCompSmartChartOverlay").css("z-index","1");e.append(i);this._adjustOverlayHeight();this.sOverlayResizeListenerId=z.register(e,this._adjustOverlayHeight.bind(this))}else if(!t){i.remove();z.deregister(this.sOverlayResizeListenerId)}}};gt.prototype.showOverlay=function(t){this._showOverlay(t)};gt.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._hasOverlay=t;this._renderOverlay(t)};gt.prototype._findControl=function(t){var e,i;if(t){e=sap.ui.getCore().byId(t);if(!e){i=this._getView();if(i){e=i.byId(t)}}}return e};gt.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};gt.prototype._updateInResultDimensions=function(){var t=this._getInResultDimensionTotal();var e=function(t){var e=this._oChart.getInResultDimensions();if(e.length!=t.length){return false}for(var i=0,a=e.length;i<a;i++){if(e[i]!=t[i]){return false}}return true}.bind(this);if(t.length>0&&!e(t)){this._oChart.setInResultDimensions(t)}};gt.prototype._initialiseInnerChart=function(){this._createChart();this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._assignData();this._createContent();this._createPersonalizationController();this._oChart.attachRenderComplete(this._toggleZoomButtonEnablement,this);this._oSelectionDetails.attachSelectionHandler("_selectionDetails",this._oChart);this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType());this._enableToolbarButtons();this._checkDimensionColoring();this._updateDrillBreadcrumbs();this.bIsInitialised=true;this.fireInitialise();this.fireInitialized();this.applyVariant(this.fetchVariant())}}};gt.prototype._enableToolbarButtons=function(){if(this._oDrillUpButton&&this._oDrillDownButton){this._oDrillUpButton.setEnabled(true);this._oDrillDownButton.setEnabled(true)}if(this._oDrillDownTextButton){this._oDrillDownTextButton.setEnabled(true)}if(this._oLegendButton){this._oLegendButton.setEnabled(true)}if(this._oZoomInButton&&this._oZoomOutButton){this._oZoomInButton.setEnabled(true);this._oZoomOutButton.setEnabled(true)}if(this._oDownloadButton){this._oDownloadButton.setEnabled(true)}if(this._oChartPersonalisationButton){this._oChartPersonalisationButton.setEnabled(true)}if(this.oFullScreenButton){this.oFullScreenButton.setEnabled(true)}if(this._oChartTypeButton){this._oChartTypeButton.setEnabled(true)}};function Bt(t,e,i,a,r,o,s,n,h,l){Y=t;Q=e;tt=i;it=a;at=r;rt=o;ot=s;st=n;ht=h;et=l;this._bChartRequested=false;if(!this._bIsBeingDestroyed){this._reBindChart()}}gt.prototype.rebindChart=function(){if(!this._bMetadataIsInitialised){N.error("rebindChart method called before the metadata is initialized. Please execute the UI5 Support Assistant 'SmartChart' rules to get more information",this.getId(),"sap.ui.comp.smartChart")}this._reBindChart()};gt.prototype._reBindChart=function(){var t,e,i=[],a,r,o,s={},n={preventChartBind:false};if(!this._oChart){if((!Y||!Q||!it||!at||!rt||!ot||!ht)&&!this._bChartRequested){Y=sap.ui.require("sap/chart/library");Q=sap.ui.require("sap/chart/Chart");tt=sap.ui.require("sap/chart/ColoringType");it=sap.ui.require("sap/chart/data/Dimension");at=sap.ui.require("sap/chart/data/HierarchyDimension");rt=sap.ui.require("sap/chart/data/TimeDimension");ot=sap.ui.require("sap/chart/data/Measure");st=sap.ui.require("sap/chart/data/MeasureSemantics");ht=sap.ui.require("sap/viz/ui5/controls/VizTooltip");et=sap.ui.require("sap/viz/ui5/format/ChartFormatter");if(!Y||!Q||!it||!at||!rt||!ot||!ht){sap.ui.getCore().loadLibrary("sap.chart",{async:true}).then(function(){sap.ui.require(["sap/chart/library","sap/chart/Chart","sap/chart/ColoringType","sap/chart/data/Dimension","sap/chart/data/HierarchyDimension","sap/chart/data/TimeDimension","sap/chart/data/Measure","sap/chart/data/MeasureSemantics","sap/viz/ui5/controls/VizTooltip","sap/viz/ui5/format/ChartFormatter"],Bt.bind(this));this._bChartRequested=true}.bind(this))}}if(!Y||!Q||!it||!at||!rt||!ot||!ht){return}this._initialiseInnerChart()}t=this._getChartPersonalisationData()||{};a=t.filters;r=t.excludeFilters;o=t.sorters;if(this._oSmartFilter){e=this._oSmartFilter.getFilters();s=this._oSmartFilter.getParameters()||{}}if(e&&e.length){if(r){i=[new g([e[0],r],true)]}else{i=e}}else if(r){i=[r]}if(a){a=i.concat(a)}else{a=i}this._updateInResultDimensions();s["entitySet"]=this.getEntitySet();if(!o){o=[]}n.filters=a;n.sorter=o;n.parameters=s;n.events={};this.fireBeforeRebindChart({bindingParams:n});if(!n.preventChartBind&&this._oChartViewMetadata){o=n.sorter;a=n.filters;s=n.parameters;this._oChart.setBusy(true);this._bDataLoadPending=true;gt._addBindingListener(n,"change",this._onDataLoadComplete.bind(this));gt._addBindingListener(n,"dataReceived",this._onDataReceived.bind(this));var h={path:this.getChartBindingPath()||"/"+this.getEntitySet(),parameters:s,filters:a,events:n.events};if(!this._bIsChartBound){h.sorter=o}if(n.length){h.length=n.length}else{var l=this._oChartProvider.getMaxItems();if(l>0){h.length=l}}this._oChart.bindData(h);if(this._bIsChartBound){this._oChart.getBinding("data").sort(o)}this._showOverlay(false);this._bIsChartBound=true}};gt.prototype._validateSorters=function(t){var e=[];var i=this._oChart.getVisibleDimensions().concat(this._oChart.getVisibleMeasures());if(t){t.forEach(function(t){i.forEach(function(i){if(t.sPath===i){e.push(t)}})})}return e};gt.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._onDataLoadComplete(t,true);this.fireDataReceived(t)};gt._addBindingListener=function(t,e,i){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i}else{var a=t.events[e];t.events[e]=function(){i.apply(this,arguments);a.apply(this,arguments)}}};gt.prototype._onDataLoadComplete=function(t,e){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false)}if(this._bDataLoadPending||e){this._bDataLoadPending=false;this._updateAvailableChartType();this._oChart.setBusy(false)}};gt.prototype._assignData=function(){if(this._oChartViewMetadata&&this._oChart){this._oChart.resetLayout();if(this._oChartViewMetadata.measureFields&&this._oChartViewMetadata.measureFields.length>0){this._oChart.setVisibleMeasures(this._oChartViewMetadata.measureFields)}if(this._oChartViewMetadata.dimensionFields&&this._oChartViewMetadata.dimensionFields.length>0){this._oChart.setVisibleDimensions(this._oChartViewMetadata.dimensionFields)}if(!this.getChartType()&&this._oChartViewMetadata.chartType){this._setChartType(this._oChartViewMetadata.chartType)}}};gt.prototype._createP13nObject=function(t){if(t.sortable&&t.sorted){var e={columnKey:t.name,operation:t.sortOrder};if(t.sortIndex!=null){this._aInitialSorters.splice(t.sortIndex,0,e)}else{this._aInitialSorters.push(e)}}return{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,isMeasure:t.isMeasure,isDimension:t.isDimension,isHierarchyDimension:t.isHierarchyDimension,hierarchyLevel:t.hierarchyLevel,aggregationRole:t.aggregationRole,label:t.label,tooltip:t.quickInfo,sorted:t.sorted,sortOrder:t.sortOrder,criticality:t.valueCriticality}};gt.prototype._createContent=function(){var t,e=0,i,a,r,o=[],s;var n=[];this._aColumnKeysOrdered=[];Object.assign(this._aColumnKeysOrdered,this._oChartViewMetadata.dimensionFields);this._aColumnKeysOrdered=this._aColumnKeysOrdered.concat(this._oChartViewMetadata.measureFields);e=this._oChartViewMetadata.fields.length;var h=this._oChartViewMetadata.dimensionFields||[];var l=this._oChartViewMetadata.measureFields||[];for(t=0;t<e;t++){a=null;i=this._oChartViewMetadata.fields[t];i.label=i.fieldLabel||i.name;if(this._aColumnKeysOrdered.indexOf(i.name)===-1){this._aColumnKeysOrdered.push(i.name)}if(this._oChart.getDimensionByName(i.name)===undefined&&this._oChart.getMeasureByName(i.name)===undefined){s=this._createP13nObject(i);r={name:i.name,label:i.label,tooltip:i.quickInfo}}if(i.inResult){this._aAlwaysSelect.push(i.name)}if(i.isDimension||i.isHierarchyDimension||h.indexOf(i.name)!=-1){if(this._oChart.getDimensionByName(i.name)===undefined){if(i.isDimension){if(i.isTimeDimension&&this.getActivateTimeSeries()){a=new rt(r);var u=i.timeUnitType;if(E.hasOwnProperty(i.timeUnitType)){a.setTimeUnit(E[u])}if(!this._bDisableTimeseriesUTC){try{a._setIsUTC(true)}catch(t){N.error("Couldn't set UTC settings on TimeDimension")}}}else{a=new it(r)}}else{r.level=i.hierarchyLevel;a=new at(r)}this._oChart.addDimension(a);if(i.description&&(!i.isTimeDimension||!this.getActivateTimeSeries())){a.setTextProperty(i.description);a.setTextFormatter(w.getFormatterFunctionFromDisplayBehaviour(i.displayBehaviour,false,this))}else if(i.dateFormatter&&(!i.isTimeDimension||!this.getActivateTimeSeries())){a.setTextFormatter(i.dateFormatter)}else if(i.isDimension&&(!i.isTimeDimension||!this.getActivateTimeSeries())){a.setTextFormatter(function(t,e){if(t===""){return this.getNotAssignedText()}else{return t}}.bind(this))}}else{var c=this._oChart.getDimensionByName(i.name).data("p13nData");if(c){this._oChart.getDimensionByName(i.name).data("p13nData",typeof c==="string"?JSON.parse(c):c)}}}else if(i.isMeasure||l.indexOf(i.name)!=-1){if(this._oChart.getMeasureByName(i.name)===undefined){a=new ot(r);this._oChart.addMeasure(a);if(i.dataPoint){n.push({dataPoint:i.dataPoint,measure:a})}if(i.unit){a.setUnitBinding(i.unit)}}else{var c=this._oChart.getMeasureByName(i.name).data("p13nData");if(c){this._oChart.getMeasureByName(i.name).data("p13nData",typeof c==="string"?JSON.parse(c):c)}}}else if(i.sortable||i.filterable){o.push(s)}if(a){if(i.role){a.setRole(i.role)}a.data("p13nData",s)}}if(this._oChart){this._oChart.data("p13nData",o)}if(n.length>0){this._enrichFromDataPoints(n)}};gt.prototype._getField=function(t){var e,i,a;if(t&&this._oChartViewMetadata&&this._oChartViewMetadata.fields){a=this._oChartViewMetadata.fields.length;for(i=0;i<a;i++){e=this._oChartViewMetadata.fields[i];if(e.name===t){return e}}}return null};gt.prototype.attachInitialise=function(t,e,i){this.attachEvent("initialise",t,e,i);mt=true;sap.ui.getCore().loadLibrary("sap.chart");Y=sap.ui.requireSync("sap/chart/library");Q=sap.ui.requireSync("sap/chart/Chart");tt=sap.ui.requireSync("sap/chart/ColoringType");it=sap.ui.requireSync("sap/chart/data/Dimension");at=sap.ui.requireSync("sap/chart/data/HierarchyDimension");rt=sap.ui.requireSync("sap/chart/data/TimeDimension");ot=sap.ui.requireSync("sap/chart/data/Measure");st=sap.ui.requireSync("sap/chart/data/MeasureSemantics");ht=sap.ui.requireSync("sap/viz/ui5/controls/VizTooltip");et=sap.ui.requireSync("sap/viz/ui5/format/ChartFormatter");if(this._bMetadataIsInitialised){this._initialiseInnerChart()}N.error("The event 'initialise' is deprecated, please use 'initialized' instead");return this};gt.prototype._createChart=function(){if(this._oNoDataStruct){this._oNoDataStruct.destroy()}var t=this.getItems(),e=t?t.length:0,i,a=this;var o;this._bDisableTimeseriesUTC=true;while(e--){i=t[e];if(i instanceof Q){break}i=null}if(i){this._oChart=i;try{o=this.data("dateFormatSettings")?JSON.parse(this.data("dateFormatSettings")):{};if(o.hasOwnProperty("UTC")){this._bDisableTimeseriesUTC=!o["UTC"]}if(o.hasOwnProperty("style")&&o["style"].toLowerCase()=="medium"){this._bWorkaroundVizFormatter=true}}catch(t){}}else{var s={uiConfig:{applicationSet:"fiori"},busyIndicatorDelay:0,vizProperties:{title:{text:""},plotArea:{dataLabel:{hideWhenOverlap:false}},general:{groupData:false},valueAxis:{title:{visible:a.getShowMeasuresTitle()}},categoryAxis:{title:{visible:a.getShowDimensionsTitle()},layout:{autoHeight:true,autoWidth:true}}},selectionMode:this.getSelectionMode(),width:"100%"};try{o=this.data("dateFormatSettings")?JSON.parse(this.data("dateFormatSettings")):{};if(o.hasOwnProperty("UTC")){s.vizProperties.general.showAsUTC=!!o["UTC"];this._bDisableTimeseriesUTC=!o["UTC"];if(o.hasOwnProperty("style")&&o["style"].toLowerCase()=="medium"){s.timeAxis={levelConfig:{day:{visible:true,formatString:"MediumDay"},month:{visible:true,formatString:"MediumMonth"}}};this._bWorkaroundVizFormatter=true}}}catch(t){}this._oChart=new Q(s);if(this.getHeight()){this._oChart.setHeight("100%")}this._toggleChartTooltipVisibility(this.getShowChartTooltip());this._setBehaviorTypeForDataSelection();this.insertItem(this._oChart,2)}if(y.browser.safari||y.browser.chrome||y.browser.firefox){this.addStyleClass("sapUiCompSmartChartInnerChartHeight")}this.setLegendVisible(this.getLegendVisible());if(!this._oChart.getLayoutData()){var n={growFactor:1};var h=this.getLayoutData();if(h&&h.getBaseSize){n.baseSize=h.getBaseSize()}else{n.baseSize="100%"}this._oChart.setLayoutData(new r(n))}if(this.getChartType()){this._setChartType(this.getChartType())}this._oChart.attachRenderComplete(function(){if(this._hasOverlay){setTimeout(function(){this._showOverlay(true)}.bind(this),0)}this._oChart.getLayoutData().setGrowFactor(1)}.bind(this));this._oChart.setCustomMessages({NO_DATA:this.getNoData()});this._createTooltipOrPopover()};gt.prototype._toggleChartTooltipVisibility=function(t){if(this._oChart){if(t){if(!this._vizTooltip){this._vizTooltip=new ht}this._vizTooltip.connect(this._oChart.getVizUid())}else{if(this._vizTooltip){this._vizTooltip.destroy()}}}};gt.prototype._updateVizTooltipFormatter=function(){if(this._vizTooltip){if(this._oChart.getChartType().match(/100/)!==null){this._vizTooltip.setFormatString(et.DefaultPattern.PERCENT)}else{this._vizTooltip.setFormatString(et.DefaultPattern.STANDARDFLOAT)}}};gt.prototype.getChart=function(){if(!this._oChart&&this._bMetadataIsInitialised){sap.ui.getCore().loadLibrary("sap.chart");Y=sap.ui.requireSync("sap/chart/library");Q=sap.ui.requireSync("sap/chart/Chart");tt=sap.ui.requireSync("sap/chart/ColoringType");it=sap.ui.requireSync("sap/chart/data/Dimension");at=sap.ui.requireSync("sap/chart/data/HierarchyDimension");rt=sap.ui.requireSync("sap/chart/data/TimeDimension");ot=sap.ui.requireSync("sap/chart/data/Measure");st=sap.ui.requireSync("sap/chart/data/MeasureSemantics");ht=sap.ui.requireSync("sap/viz/ui5/controls/VizTooltip");et=sap.ui.requireSync("sap/viz/ui5/format/ChartFormatter");this._initialiseInnerChart()}else if(!this._bMetadataIsInitialised){N.error("Accesing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!")}N.error("This function is deprecated, please use getChartAsync instead");return this._oChart};gt.prototype.getChartAsync=function(){if(!this._oChart&&this._bMetadataIsInitialised){return new Promise(function(t,e){sap.ui.require(["sap/chart/library","sap/chart/Chart","sap/chart/ColoringType","sap/chart/data/Dimension","sap/chart/data/HierarchyDimension","sap/chart/data/TimeDimension","sap/chart/data/Measure","sap/chart/data/MeasureSemantics","sap/viz/ui5/controls/VizTooltip","sap/viz/ui5/format/ChartFormatter"],function(i,a,r,o,s,n,h,l,u,c){Y=i;Q=a;tt=r;it=o;at=s;rt=n;ot=h;st=l;ht=u;et=c;if(!this._oChart){this._initialiseInnerChart()}if(this._oChart){t(this._oChart)}else{e("The inner chart couldn't be created")}}.bind(this))}.bind(this))}else if(!this._bMetadataIsInitialised){N.error("Accessing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!");return Promise.reject(new Error("Accessing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!"))}else{return Promise.resolve(this._oChart)}};gt.prototype._getChartTypes=function(){var t;try{t=Y.api.getChartTypes()}catch(e){t={};N.error("sap.chart.api.getChartTypes throws an exception.\n"+e.toString())}return t};gt.prototype.getAvailableChartTypes=function(){var t,e,i=[],a,r={},o;if(this._oChart){o=C.createArrayFromString(this.getIgnoredChartTypes());r=this._getChartTypes();a=this._oChart.getAvailableChartTypes().available;if(a){for(t=0;t<a.length;t++){e=a[t].chart;if(o.indexOf(e)<0){i.push({key:e,text:r[e]})}}}}return i};gt.prototype._getAllChartTypes=function(){var t,e=[],i,a;a=C.createArrayFromString(this.getIgnoredChartTypes());i=this._getChartTypes();for(t in i){if(t){if(a.indexOf(t)<0){e.push({key:t,text:i[t]})}}}return e};gt.prototype._retrieveChartTypeDescription=function(t){var e=this._getChartTypes();return{key:t,text:e[t]}};gt.prototype._setChartType=function(t){if(this._oChart){var e=this._oChart.getHeight();this._oChart.setChartType(t);this._aDetailsEntries=[];this._toggleMeasureUnitBinding(t,this._oChart.getMeasures());this._oChart.setHeight(e)}};gt.prototype._toggleMeasureUnitBinding=function(t,e){if(typeof e!="undefined"&&e instanceof Array){if(t.substring(0,4)==="100_"){e.forEach(function(t){t.setUnitBinding()})}else{if(this._oChartProvider){var i=this._oChartProvider._aODataFieldMetadata;e.forEach(function(t){for(var e=i.length-1;e>=0;e--){if(i[e].name==t.getName()){if(i[e]["Org.OData.Measures.V1.ISOCurrency"]&&i[e]["Org.OData.Measures.V1.ISOCurrency"].Path){t.setUnitBinding(i[e]["Org.OData.Measures.V1.ISOCurrency"].Path)}else if(i[e]["Org.OData.Measures.V1.Unit"]&&i[e]["Org.OData.Measures.V1.Unit"].Path){t.setUnitBinding(i[e]["Org.OData.Measures.V1.Unit"].Path)}break}}})}}}};gt.prototype._getDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getDimensions()}return t};gt.prototype._getVisibleDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getVisibleDimensions()}return t};gt.prototype._getMeasures=function(){var t=[];if(this._oChart){t=this._oChart.getMeasures()}return t};gt.prototype._getVisibleMeasures=function(){var t=[];if(this._oChart){t=this._oChart.getVisibleMeasures()}return t};gt.prototype._getSortedDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getDimensions();if(t){t.sort(function(t,e){if(t.getLabel()&&e.getLabel()){return t.getLabel().localeCompare(e.getLabel())}})}}return t};gt.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}return this._oCurrentVariant};gt.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oPersController){if(this._oCurrentVariant===null||jQuery.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization($.ResetFull)}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()})};gt.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};gt.prototype.getUiState=function(){if(!this.isInitialised()){N.error("SmartChart: Called getUiState() before inner structure was initialized. This will force a synchronous load of dependencies.");this.getChart()}var t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new S({presentationVariant:{ContextUrl:"",MaxItems:this._oChartProvider?this._oChartProvider.getMaxItems():undefined,SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getInResultDimensionTotal(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId()})};gt.prototype.setUiState=function(t){if(this._oPersController){var e=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};this._oPersController.setDataSuiteFormatSnapshot(H({},t.getPresentationVariant(),t.getSelectionVariant()),e,true)}this._setInResultDimensionFromVariant(t)};gt.prototype.setUiStateAsVariant=function(t){if(this._oPersController){this._oPersController.setPersonalizationDataAsDataSuiteFormat(H({},t.getPresentationVariant(),t.getSelectionVariant()),true)}this._setInResultDimensionFromVariant(t)};gt.prototype._setInResultDimensionFromVariant=function(t){if(t.getPresentationVariant()&&this._oChart){this._oChart.setInResultDimensions(t.getPresentationVariant().RequestAtLeast)}else{this._oUiStateRequestAtLeast=t.getPresentationVariant().RequestAtLeast}};gt.prototype.setRequestAtLeastFields=function(t){this.setProperty("requestAtLeastFields",t);if(this._oChart){this._updateInResultDimensions()}return this};gt.prototype._getInResultDimensionTotal=function(){var t=[];if(this.getRequestAtLeastFields()){t=this.getRequestAtLeastFields().split(",")}t=t.concat(this._aAlwaysSelect);if(this._oChart){t=t.concat(this._oChart.getInResultDimensions())}if(this._oUiStateRequestAtLeast){t.concat(this._oUiStateRequestAtLeast);this._oUiStateRequestAtLeast=null}return t.filter(function(t,e,i){return e==i.indexOf(t)})};gt.prototype._getFieldTooltip=function(t){var e=this._getFieldByKey(t);if(e){return e.quickInfo}return""};gt.prototype._getFieldByKey=function(t){var e,i=null;if(this._oChartViewMetadata&&this._oChartViewMetadata.fields){for(e=0;e<this._oChartViewMetadata.fields.length;e++){i=this._oChartViewMetadata.fields[e];if(t===i.name){return i}}return null}};gt.prototype._getByKey=function(t,e){var i,a,r,o;if(t){a=t.length;for(i=0;i<a;i++){r=t[i];o=r.data("p13nData");if(o&&o.columnKey===e){return r}}}return null};gt.prototype._getDimensionByKey=function(t){if(this._oChart){return this._getByKey(this._oChart.getDimensions(),t)}return null};gt.prototype._getMeasureByKey=function(t){if(this._oChart){return this._getByKey(this._oChart.getMeasures(),t)}return null};gt.prototype._getChartObjByKey=function(t){var e=this._getDimensionByKey(t);if(!e){e=this._getMeasureByKey(t)}return e};gt.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,a,r;a=this._getChartObjByKey(t);if(a){r=a.data("p13nData");if(r){i=r[e]}}return i};gt.prototype._getChartPersonalisationData=function(){if(!this._oCurrentVariant){return null}var t=[],i=[],a=[],r,o,s;if(this._oCurrentVariant.sort){o=this._oCurrentVariant.sort.sortItems}else{o=this._aInitialSorters}if(o){o.forEach(function(e){var i=e.operation==="Descending";s=e.columnKey;t.push(new m(s,i))},this)}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(t){var r=t.value1,o=t.value2;s=t.columnKey;if(r instanceof Date&&this._oChartProvider&&this._oChartProvider.getIsUTCDateHandlingEnabled()){r=e.localToUtc(r);o=o?e.localToUtc(o):o}if(t.exclude){if(t.operation==="Empty"){a.push(new g(s,"NE",t.operation==="Empty"?"":r))}else{a.push(new g(s,q.getTransformedExcludeOperation(t.operation),t.operation==="Empty"?"":r,o))}}else if(t.operation==="Empty"){i.push(new g(s,"EQ",""))}else{i.push(new g(s,t.operation,r,o))}},this);if(a.length){r=new g(a,true)}}return{filters:i,excludeFilters:r,sorters:t}};gt.prototype._persistPersonalisation=function(){if(!sap.ui.getCore().getConfiguration().getDesignMode()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var t=this.getCurrentVariantId();if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:"Personalisation",implicit:true,global:false,overwrite:!!t,key:t,def:true});delete this._bSaving}}};gt.prototype.getCurrentVariantId=function(){var t="";if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId()}return t};gt.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{N.error("sap.ui.comp.smartchart.SmartChart.prototype.setCurrentVariantId: VariantManagement does not exist or is a page variant")}return this};gt.prototype._adjustHeight=function(){if(this._oChart){var t=0,e=0;var i=this.getDomRef()?this.getDomRef().offsetHeight:0;if(i===0){return}if(this._oToolbar&&this._oToolbar.getDomRef()){t=this._oToolbar.getDomRef().offsetHeight}if(this._oDrillBreadcrumbs&&this._oDrillBreadcrumbs.getDomRef()){var a=this._oDrillBreadcrumbs.getDomRef().parentNode?this._oDrillBreadcrumbs.getDomRef().parentNode:this._oDrillBreadcrumbs.getDomRef();e=a.offsetHeight}var r=i-t-e;this._oChart.setHeight(r+"px");this._updateDrillBreadcrumbs();if(this._hasOverlay){setTimeout(function(){this._showOverlay(true)}.bind(this),0)}}};gt.prototype._toggleFullScreen=function(t,e){if(!this.oFullScreenButton||t===this.bFullScreen&&!e){return}if(t==true&&this._oChart){this._sChartHeight=this._oChart.getHeight();this._oChart.setHeight("100%")}this.bFullScreen=t;j.toggleFullScreen(this,this.bFullScreen,this.oFullScreenButton,this._toggleFullScreen,"sapContrastPlus",true);if(!t){this._adjustHeight()}this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t});if(t==false&&this._oChart){this._oChart.setHeight(this._sChartHeight)}};gt.prototype._renderFullScreenButton=function(){this.oFullScreenButton.setTooltip(this.bFullScreen?this._oRb.getText("CHART_MINIMIZEBTN_TOOLTIP"):this._oRb.getText("CHART_MAXIMIZEBTN_TOOLTIP"));this.oFullScreenButton.setText(this.bFullScreen?this._oRb.getText("CHART_MINIMIZEBTN_TEXT"):this._oRb.getText("CHART_MAXIMIZEBTN_TEXT"));this.oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};gt.prototype._enrichFromDataPoints=function(t){var e=t.length;var i=[];var a={};for(var r=0;r<e;r++){this._interpretDataPoint(t[r].dataPoint,t[r].measure,a,i)}if(i.length>0){this._oChart.setActiveColoring({coloring:tt.Criticality,parameters:{measure:i}});this._oChart.setColorings({Criticality:{MeasureValues:a}})}};gt.prototype._interpretDataPoint=function(t,e,i,a){this._setSemanticPatterns(t,e);if(e.setBoundaryValues){this._setBoundaryValues(t,e)}if(t.Criticality||t.CriticalityCalculation){i[t.Value.Path]=this._oChartProvider.provideSemanticColoring(t);a.push(t.Value.Path)}};gt.prototype._setSemanticPatterns=function(t,e){var i=t.TargetValue?t.TargetValue.Path:null;var a=t.ForecastValue?t.ForecastValue.Path:null;e.setSemantics(st.Actual);if(i!=null){var r=this._oChart.getMeasureByName(i);if(r){r.setSemantics(st.Reference)}else{N.error("sap.ui.comp.SmartChart: "+t.TargetValue.Path+" is not a valid measure")}}if(a){var o=this._oChart.getMeasureByName(a);if(o){o.setSemantics(st.Projected)}else{N.error("sap.ui.comp.SmartChart: "+t.ForecastValue.Path+" is not a valid measure")}}e.setSemanticallyRelatedMeasures({referenceValueMeasure:i,projectedValueMeasure:a})};gt.prototype._setBoundaryValues=function(t,e){var i={};if(t.MinimumValue){i.minimum=t.MinimumValue}if(t.MaximumValue){i.maximum=t.MaximumValue}if(i.minimum||i.maximum){e.setBoundaryValues(i)}};gt.prototype.isInitialised=function(){return!!this.bIsInitialised};gt.prototype.exit=function(){this._oRb=null;if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindChart,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this)}if(this._oChartProvider&&this._oChartProvider.destroy){this._oChartProvider.destroy()}this._oChartProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy()}if(this._oSegmentedButton){this._oSegmentedButton.removeAllButtons();this._oButtonChart1.destroy();this._oButtonChart2.destroy();this._oButtonChart3.destroy();this._oButtonChart4.destroy();this._oButtonChart5.destroy();this._oButtonChart1=null;this._oButtonChart2=null;this._oButtonChart3=null;this._oButtonChart4=null;this._oButtonChart5=null}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oVariantManagement=null;this._destroyPopover();j.cleanUpFullScreen(this);if(this._oDetailsPopover){this._oDetailsPopover.destroy();if(this._oRelatedAppsMasterList){this._oRelatedAppsMasterList.destroy()}}if(this.oChart){this._oChart.detachRenderComplete(this._toggleZoomButtonEnablement,this)}this._oCurrentVariant=null;this._oChartViewMetadata=null;this._aAlwaysSelect=null;this._aInitialSorters=null;this._oSmartFilter=null;this._oToolbar=null;this._oChartPersonalisationButton=null;this._oView=null;this._oChart=null;this._bDisableTimeseriesUTC=null;this._bWorkaroundVizFormatter=null};gt.prototype._processResizeHandler=function(t){if(t){this.sResizeListenerId=null;if(y.system.desktop){this.sResizeListenerId=z.register(this,this._adjustHeight.bind(this))}else{y.orientation.attachHandler(this._adjustHeight,this);y.resize.attachHandler(this._adjustHeight,this)}}else{if(y.system.desktop&&this.sResizeListenerId){z.deregister(this.sResizeListenerId);this.sResizeListenerId=null}else{y.orientation.detachHandler(this._adjustHeight,this);y.resize.detachHandler(this._adjustHeight,this)}}};gt.prototype.setShowToolbar=function(t){if(this._oToolbar){this._oToolbar.setVisible(t)}return this.setProperty("showToolbar",t,true)};gt.prototype.setToolbarStyle=function(t){if(this._oToolbar){this._oToolbar.setStyle(t)}return this.setProperty("toolbarStyle",t,true)};gt.prototype.setShowDimensionsTitle=function(t){if(this._oChart){this._oChart.setVizProperties({categoryAxis:{title:{visible:t}}})}return this.setProperty("showDimensionsTitle",t,true)};gt.prototype.setShowMeasuresTitle=function(t){if(this._oChart){this._oChart.setVizProperties({valueAxis:{title:{visible:t}}})}return this.setProperty("showMeasuresTitle",t,true)};gt.prototype._checkDimensionColoring=function(){var t=this._getVisibleDimensions(),e,i={Criticality:{DimensionValues:{}}},a;for(var r=0;r<t.length;r++){e=this._getField(t[r]);a=this._oChartProvider.calculateDimensionColoring(e);if(a){if(this._sColoringDimension!=e.name){i.Criticality.DimensionValues[e.name]=a;this._oChart.setActiveColoring({coloring:tt.Criticality,parameters:{dimension:e.name}});this._oChart.setColorings(i);this._sColoringDimension=e.name}return}}};gt.prototype.getIdForLabel=function(){if(this._headerText){return this._headerText.getId()}return u.prototype.getIdForLabel.apply(this,[])};return gt});
}
});
//# sourceMappingURL=library-preload.js.map
